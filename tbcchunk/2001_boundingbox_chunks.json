[
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- roman [jeremytammik/RevitLookup] Revit api. Retrieve all parameters and categories (Discussion #183)\n\n- How to get the BoundingBox that corresponds to the shape of the Family\n  https://forums.autodesk.com/t5/revit-api-forum/how-to-get-the-boundingbox-that-corresponds-to-the-shape-of-the/m-p/12089970\n\n- Transform of linked element creates an empty outline\n  https://forums.autodesk.com/t5/revit-api-forum/transform-of-linked-element-creates-an-empty-outline/m-p/12089717#M72649\n\n- nice svg path explanation --  https://www.nan.fyi/svg-paths\n\n- claude.ai\n  https://claude.ai/chats\n  You have to use a USA or UK VPN.\n  A competitor to OpenAI. Can upload big files. Any better for coding?\n  Video about it: https://www.youtube.com/watch?v=dofH3EBjK1o\n  Falls euch der aktuelle zustand der KI-Entwicklung interessieren sollteâ€¦ ich habe nach der vertragsunterzeichnung andere arbeiten ausgefuehrt, und bin im laufe dessen auch auf eine neuen konkurrenten von ChatGPT gestossen, namens Claude.AI:\n  https://claude.ai\n  ChatGPT: bisher ueber 13 millarden $, Microsoft hauptsponsor\n  Claude.AI: bisher 1.5 millarden $, Google hauptsponsor.\n  [claude versus chatgpt](https://duckduckgo.com/?q=claude+versus+chatgpt)\n  Ich habe claude.ai gebeten, den kuri architektenvertrag auszuwerten, und dann nach sinn und unsinn von hoai gefragt.\n  Unten sind die antworten angehaengt.\n  /Users/jta/a/doc/revit/tbc/git/a/img/claudeai*\n  summarise my last blog post\n  You could batch that last one to summarize all of your blog posts programmatically for SEO.\n\n- Why transformative AI is really, really hard to achieve\n  https://zhengdongwang.com/2023/06/27/why-transformative-ai-is-really-really-hard-to-achieve.html\n\ntwitter 2:\n\nAspects of axis-aligned bounding boxes and bounding box transformation with the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/all_params_all_cats\n\nAspects of axis-aligned bounding boxes, SVG paths and AI news\n&ndash; BoundingBox is axis-aligned\n&ndash; BoundingBox transformation\n&ndash; Interactive explanation of SVG path\n&ndash; Claude.AI\n&ndash; Relativising the impact of AI...\n\n\ntwitter 1:\n\nGround-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and bounding box transformation with the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/all_params_all_cats\n\nGround-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and AI news\n&ndash; All categories and parameters\n&ndash; BoundingBox is axis-aligned\n&ndash; BoundingBox transformation\n&ndash; Interactive explanation of SVG path\n&ndash; Claude.AI\n&ndash; Relativising the impact of AI...\n\nlinkedin 1:\n\nGround-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and bounding box transformation with the #RevitAPI\n\nhttps://autode.sk/all_params_all_cats\n\n- All categories and parameters\n- BoundingBox is axis-aligned\n- BoundingBox transformation\n- Interactive explanation of SVG path\n- Claude.AI\n- Relativising the impact of AI...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Bounding Boxes Axis Alignment and Transformation",
    "local_header_href": "#bounding-boxes-axis-alignment-and-transformation",
    "chunk_text": "### Bounding Boxes Axis Alignment and Transformation\n\n<!--\nToday we present ground-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and AI news:\n-->\n\nToday we look at some aspects axis-aligned bounding boxes, bounding box transformation and AI news:\n\n<!--\n- [All categories and parameters](#2)\n    - [Summary](#2.1)\n    - [Solution](#2.2)\n    - [Result](#2.3)\n    - [Limitations](#2.4)\n-->\n\n- [BoundingBox is axis-aligned](#3)\n- [BoundingBox transformation](#4)\n- [Interactive explanation of SVG path](#5)\n- [Claude.AI](#6)\n- [Relativising the impact of AI](#7)\n\n<!--"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "All Categories and Parameters",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> All Categories and Parameters\n\nRoman [Nice3point](https://github.com/Nice3point), principle maintainer of RevitLookup, presents a new discovery; in his own words:\n\nI made a new discovery for me.\nAs far as I know, it is impossible to get a list of all built-in parameters using the public Revit API.\nWe are offered an `enum`, but we cannot get the `Parameter` itself from it.\nBy exploring private unmanaged code using reflection and pointers, I managed to do it, as described in\nthe [RevitLookup discussion 183 &ndash; retrieve all parameters and categories](https://github.com/jeremytammik/RevitLookup/discussions/183):\n\n<center>\n<img src=\"img/rk_get_all_bips.png\" alt=\"Get all built-in parameters\" title=\"Get all built-in parameters\" width=\"600\"/>\n</center>\n\n####<a name=\"2.1\"></a> Summary\n\nI recently came across a problem from my business partner who wanted to get all the built-in Revit parameters to extract metadata such as data type, units, storage type, etc. As we know, this is not possible using the Autodesk Revit public API.\n\nSimilar situation with categories; we can't get all the built-in categories; so far, the only known available way is to get them from the document settings, but it contains a very truncated list:\n\n<center>\n<img src=\"img/rk_get_all_bips_1_categories.png\" alt=\"Only some categories\" title=\"Only some categories\" width=\"600\"/>\n</center>\n\nBy the way,\n[The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples/tree/master) include\nsome related naive attempts in\nthe [module `CmdCategories.cs`](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/CmdCategories.cs).\n\n####<a name=\"2.2\"></a> Solution\n\nWe can use private code with reflection and pointers; we only need a document.\nThe point of the method is not to get them but create it.\n\nExample code to get all parameters:\n\n<pre class=\"prettyprint\">\npublic static List&lt;Parameter&gt; GetBuiltinParameters(\n  Document document)\n{\n  const BindingFlags bindingFlags = BindingFlags.NonPublic\n    | BindingFlags.Instance | BindingFlags.DeclaredOnly;\n\n  var documentType = typeof(Document);\n  var parameterType = typeof(Parameter);\n  var assembly = Assembly.GetAssembly(parameterType);\n  var aDocumentType = assembly.GetType(\"ADocument\");\n  var elementIdType = assembly.GetType(\"ElementId\");\n  var elementIdIdType = elementIdType.GetField(\"&lt;alignment member&gt;\", bindingFlags)!;\n  var getADocumentType = documentType.GetMethod(\"getADocument\", bindingFlags)!;\n  var parameterCtorType = parameterType.GetConstructor(bindingFlags, null,\n    new[] {aDocumentType.MakePointerType(), elementIdType.MakePointerType()},\n    null)!;\n\n  var builtinParameters = Enum.GetValues(typeof(BuiltInParameter));\n  var parameters = new List&lt;Parameter&gt;(builtinParameters.Length);\n  foreach (BuiltInParameter builtinParameter in builtinParameters)\n  {\n    var elementId = Activator.CreateInstance(elementIdType);\n    elementIdIdType.SetValue(elementId, builtinParameter);\n\n    var handle = GCHandle.Alloc(elementId);\n    var elementIdPointer = GCHandle.ToIntPtr(handle);\n    Marshal.StructureToPtr(elementId, elementIdPointer, true);\n\n    var parameter = (Parameter) parameterCtorType.Invoke(\n      new[] {getADocumentType.Invoke(document, null), elementIdPointer});\n    parameters.Add(parameter);\n    handle.Free();\n  }\n\n  return parameters;\n}\n</pre>\n\nExample code to get all categories:\n\n<pre class=\"prettyprint\">\npublic static List&lt;Category&gt; GetBuiltinCategories(\n  Document document)\n{\n  const BindingFlags bindingFlags = BindingFlags.NonPublic\n    | BindingFlags.Instance | BindingFlags.DeclaredOnly;\n\n  var documentType = typeof(Document);\n  var categoryType = typeof(Category);\n  var assembly = Assembly.GetAssembly(categoryType);\n  var aDocumentType = assembly.GetType(\"ADocument\");\n  var elementIdType = assembly.GetType(\"ElementId\");\n  var elementIdIdType = elementIdType.GetField(\"&lt;alignment member&gt;\", bindingFlags)!;\n  var getADocumentType = documentType.GetMethod(\"getADocument\", bindingFlags)!;\n  var categoryCtorType = categoryType.GetConstructor(bindingFlags, null,\n    new[] {aDocumentType.MakePointerType(), elementIdType.MakePointerType()},\n    null)!;\n\n  var builtInCategories = Enum.GetValues(typeof(BuiltInCategory));\n  var categories = new List&lt;Category&gt;(builtInCategories.Length);\n  foreach (BuiltInCategory builtInCategory in builtInCategories)\n  {\n    var elementId = Activator.CreateInstance(elementIdType);\n    elementIdIdType.SetValue(elementId, builtInCategory);\n\n    var handle = GCHandle.Alloc(elementId);\n    var elementIdPointer = GCHandle.ToIntPtr(handle);\n    Marshal.StructureToPtr(elementId, elementIdPointer, true);\n\n    var category = (Category) categoryCtorType.Invoke(\n      new[] {getADocumentType.Invoke(document, null), elementIdPointer});\n    categories.Add(category);\n    handle.Free();\n  }\n\n  return categories;\n}\n</pre>\n\n####<a name=\"2.3\"></a> Result\n\nAs a result, we have created all the parameters and all the categories of the entire `Enum`:\n\n<center>\n<img src=\"img/rk_get_all_bips_2_all_params.png\" alt=\"All built-in parameters\" title=\"All built-in parameters\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">All built-in parameters</p>\n\n<img src=\"img/rk_get_all_bips_3_all_cats.png\" alt=\"All built-in categories\" title=\"All built-in categories\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">All built-in categories</p>\n</center>\n\n####<a name=\"2.4\"></a> Limitations\n\nCreated parameters have no binding to any element, and consequently have no value, only metadata.\n\nMany thanks to Roman for this interesting in-depth research and documentation!\n\n-->"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "BoundingBox is Axis-Aligned",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> BoundingBox is Axis-Aligned\n\nLet's move on to the more mundane question\nof [how to get the `BoundingBox` that corresponds to the shape of the family](https://forums.autodesk.com/t5/revit-api-forum/how-to-get-the-boundingbox-that-corresponds-to-the-shape-of-the/m-p/12089970):\n\n**Question:** I would like to inquire about `BoundingBox`.\nIn the left image, the area of the BoundingBox is similar to the shape of the pipe;\nhowever, in the right one, the BoundingBox is much larger than its pipe:\n\n<center>\n<img src=\"img/pipe_boundingbox.png\" alt=\"Pipe bounding box\" title=\"Pipe bounding box\" width=\"600\"/>\n</center>\n\nIt seems that this happens only for Pipes (probably for System Families).\nFor FamilyInstance, it seems that they always have a same size for BoundingBox, even if they are rotated.\n\nIs there a way to know the area of the Family, which always corresponds to its shape, regardless of it being rotated or not?\n\n**Answer:**  No, this does not only happen for pipes.\nThis happens for all kinds of objects that have different dimensions in different directions and are placed at an angle to the cardinal axes.\nFor instance, a vertical wall at a 45-degree angle in the XY plane will exhibit the exact same behaviour.\nThis behaviour is intentional.\nThe Revit bounding box is always aligned with the cardinal axes.\nThat makes it extremely fast and efficient to work with.\nWikipedia calls this\nan [axis-aligned bounding box](https://en.wikipedia.org/wiki/Minimum_bounding_box#Axis-aligned_minimum_bounding_box)."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "BoundingBox Transformation",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> BoundingBox Transformation\n\nThat question leads over nicely to the explanation why\nthe [transform of linked element creates an empty outline](https://forums.autodesk.com/t5/revit-api-forum/transform-of-linked-element-creates-an-empty-outline/m-p/12089717),\nsolved by appropriately transforming the bounding box:\n\n**Question:** I want to create an outline from a linked element's bounding box to use in a `BoundingBoxIntersectsFilter`.\nMy approach below works for some cases, but where a link or element is rotated beyond a certain limit, the bounding box goes askew and the `Outline(XYZ, XYZ)` method returns an empty outline.\nI've tried scaling the bounding box up with an offset which fixes some cases, but not all of them.\nSome advice on solutions would be appreciated.\n\n\n<center>\n<img src=\"img/xform_boundingbox_1.png\" alt=\"Non-rotated link\" title=\"Non-rotated link\" width=\"400\"/> <!-- Pixel Height: 647 Pixel Width: 793 -->\n<p style=\"font-size: 80%; font-style:italic\">Non-rotated link</p>\n\n<img src=\"img/xform_boundingbox_2.png\" alt=\"Rotated link\" title=\"Rotated link\" width=\"400\"/> <!-- Pixel Height: 746 Pixel Width: 961 -->\n<p style=\"font-size: 80%; font-style:italic\">Rotated link</p>\n</center>\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "get the elements bounding box",
    "local_header_href": "#get-the-elements-bounding-box",
    "chunk_text": "# get the elements bounding box\n\ns_BBox = element.get_BoundingBox(doc.ActiveView)"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "apply the link documents transform",
    "local_header_href": "#apply-the-link-documents-transform",
    "chunk_text": "# apply the link documents transform\n\ns_BBox_min = link_trans.OfPoint(s_BBox.Min)\ns_BBox_max = link_trans.OfPoint(s_BBox.Max)"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "make the outline",
    "local_header_href": "#make-the-outline",
    "chunk_text": "# make the outline\n\nnew_outline = Outline(s_BBox_min, s_BBox_max)"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "make the filter",
    "local_header_href": "#make-the-filter",
    "chunk_text": "# make the filter\n\nbb_filter = BoundingBoxIntersectsFilter(new_outline)\n</pre>\n\n**Answer:** Yes.\nYou can corrupt the bounding box by transforming it.\nI would suggest the following:\n\n- Extract all eight corner vertices of the bounding box\n- Transform all eight vertices as individual points\n- Create a new bounding box from the eight transformed results\n\n[The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples/tree/master) include\nthe [method `ExpandToContain`](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/Util.cs#L2724-L2739) to\ncreate and enlarge a bounding box point by point that will come in handy for the last step:\n\n<pre class=\"prettyprint\">\n  /// &lt;summary&gt;\n  ///   Expand the given bounding box to include\n  ///   and contain the given point.\n  /// &lt;/summary&gt;\n  public static void ExpandToContain(\n    this BoundingBoxXYZ bb,\n    XYZ p)\n  {\n    bb.Min = new XYZ(Math.Min(bb.Min.X, p.X),\n      Math.Min(bb.Min.Y, p.Y),\n      Math.Min(bb.Min.Z, p.Z));\n\n    bb.Max = new XYZ(Math.Max(bb.Max.X, p.X),\n      Math.Max(bb.Max.Y, p.Y),\n      Math.Max(bb.Max.Z, p.Z));\n  }\n</pre>\n\n**Response:** Hi Jeremy, this solution works well, thanks."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Interactive Explanation of SVG Path",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Interactive Explanation of SVG Path\n\nI made good use of and learned to love SVG paths working on\nthe [room polygon and furniture picker in SVG](http://thebuildingcoder.typepad.com/blog/2012/10/room-polygon-and-furniture-picker-in-svg.html) and\nimplementing [2D SVG editing on mobile device with Raphael](http://thebuildingcoder.typepad.com/blog/2013/02/2d-svg-editing-on-mobile-device-with-rapha%C3%ABl.html).\n\nIf you would like to enjoy a much nicer explanation of the concepts of SVG paths than I had access to back then, take a quick dive\ninto [understanding SVG paths](https://www.nan.fyi/svg-paths)."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Claude.AI",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Claude.AI\n\nChatGPT has a new competitor,\n[claude.ai](https://claude.ai).\n\nEric Boehlke of [truevis BIM Consulting](https://truevis.com) pointed it out to me, saying:\n\n> You can create an account in the USA or UK, or use VPN to get there.\nA competitor to OpenAI. Can upload big files. Any better for coding?\n\nI tested it myself by asking it to summarise\nmy [last blog post](https://thebuildingcoder.typepad.com/blog/2023/07/rbp-materials-their-assets-and-the-visual-api.html),\nevaluate a German architectural contract without providing any hint of what it might be, and discuss\nthe German [HOAI](https://de.wikipedia.org/wiki/Honorarordnung_f%C3%BCr_Architekten_und_Ingenieure).\nThe results were completely satisfying in all three cases:\n\n<center>\n<img src=\"img/claudeai_tbc2000.png\" alt=\"Claude.AI analyses blog post\" title=\"Claude.AI analyses blog post\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">Claude.AI analyses blog post</p>\n\n<img src=\"img/claudeai_archvertrag.png\" alt=\"Claude.AI analyses a German architectural contract\" title=\"Claude.AI analyses a German architectural contract\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">Claude.AI analyses a German architectural contract</p>\n\n<img src=\"img/claudeai_hoai.png\" alt=\"Claude.AI discusses the HOAI\" title=\"Claude.AI discusses the HOAI\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">Claude.AI discusses the HOAI</p>\n</center>\n\nEric suggests:\n\n> You could batch that blog post analysis to summarise all of your blog posts programmatically for SEO."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Relativising the Impact of AI",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Relativising the Impact of AI\n\nLet's close with some wise and pertinent thoughts &ndash; not following the hype &ndash; on the possible impact of AI on our life and economy, presented in the explanation\nof [why transformative AI is really, really hard to achieve](https://zhengdongwang.com/2023/06/27/why-transformative-ai-is-really-really-hard-to-achieve.html)."
  }
]