[
  {
    "original_filename": "0416_debug_in_vs2010",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0416_debug_in_vs2010",
    "header_text": "Debugging in Visual Studio 2010 Express",
    "local_header_href": "#debugging-in-visual-studio-2010-express",
    "chunk_text": "<h3>Debugging in Visual Studio 2010 Express</h3><p>Yesterday was the first day of the Revit API training in Munich.\nAs usual, I was able to learn something new.\n\n<p>Frank Neuberg of <a href=\"www.max-boegl.de\">MAX BÖGL</a> assembled and tested the following summary of information sources related to using Visual Studio 2010 and its Express version for creating and debugging a Revit add-in.\n\n<p>I've summarized some information sources to set up an integrated debugging process for class library projects together with Revit.exe (2011) in C# Visual Studio 2010 Express Edition:\n\n<p>Currently available information on the web/blogs:\n\n<ol>\n<li>\n<a href=\"http://through-the-interface.typepad.com/through_the_interface/2006/07/debugging_using.html\">\nDebugging using Express Editions</a> (July 06, 2006 by Kean Walmsley)\n\n<li>\n<a href=\"http://connect.microsoft.com/VisualStudio/feedback/details/487949/debugging-external-application\">\nDebugging external application</a> (September 03, 2009 by Mike Cvelide)\n\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/07/visual-studio-2010-and-the-net-framework.html\">\nVisual Studio 2010 and the .NET Framework</a> (July 20, 2010 by Jeremy Tammik)\n\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/debugging-with-visual-studio-2010-and-rvtsamples.html\">\nDebugging with Visual Studio 2010 and RvtSamples</a> (April 14, 2010 by Jeremy Tammik)\n\n<li>\n<a href=\"http://blog.rodhowarth.com/2010/04/revit-api-visual-studio-2010-and-revit.html\">\nVisual Studio 2010 and Revit API debugging issues</a> (April 15, 2010 by Rod Howarth)\n\n</li></li></li></li></li></ol>\n<p>Summary of changes to enable debugging class libraries with Revit.exe:\n\n<p><strong>A.</strong> Edit the Revit.exe.config file (normally located in the Revit Program directory).\nAdd the following section (preferably at the end of the file):\n\n<pre>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">startup</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">    &lt;</span><span class=\"maroon\">supportedRuntime</span><span class=\"blue\"> </span><span class=\"red\">version</span><span class=\"blue\">=</span>\"<span class=\"blue\">v2.0.50727</span>\"<span class=\"blue\"> /&gt;</span>\n<span class=\"blue\">  &lt;/</span><span class=\"maroon\">startup</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">&lt;/</span><span class=\"maroon\">configuration</span><span class=\"blue\">&gt;</span>\n</pre>\n<p><strong>B.</strong> Edit your C# project file (like 'myCSProject.csproj') manually and add the last lines specifying the StartAction and StartProgram tags to each PropertyGroup for which you want to enable debugging with Revit.exe:\n\n<pre>\n<span class=\"blue\">&lt;</span><span class=\"maroon\">PropertyGroup</span><span class=\"blue\"> </span><span class=\"red\">Condition</span><span class=\"blue\">=</span>\"<span class=\"blue\"> '$(Configuration)|$(Platform)' == 'Debug %28For Release build of Revit%29|AnyCPU' </span>\"<span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">OutputPath</span><span class=\"blue\">&gt;</span>bin\\Debug\\<span class=\"blue\">&lt;/</span><span class=\"maroon\">OutputPath</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">AllowUnsafeBlocks</span><span class=\"blue\">&gt;</span>false<span class=\"blue\">&lt;/</span><span class=\"maroon\">AllowUnsafeBlocks</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">BaseAddress</span><span class=\"blue\">&gt;</span>285212672<span class=\"blue\">&lt;/</span><span class=\"maroon\">BaseAddress</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">CheckForOverflowUnderflow</span><span class=\"blue\">&gt;</span>false<span class=\"blue\">&lt;/</span><span class=\"maroon\">CheckForOverflowUnderflow</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">ConfigurationOverrideFile</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;/</span><span class=\"maroon\">ConfigurationOverrideFile</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">DefineConstants</span><span class=\"blue\">&gt;</span>DEBUG;TRACE<span class=\"blue\">&lt;/</span><span class=\"maroon\">DefineConstants</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">DocumentationFile</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;/</span><span class=\"maroon\">DocumentationFile</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">DebugSymbols</span><span class=\"blue\">&gt;</span>true<span class=\"blue\">&lt;/</span><span class=\"maroon\">DebugSymbols</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">FileAlignment</span><span class=\"blue\">&gt;</span>4096<span class=\"blue\">&lt;/</span><span class=\"maroon\">FileAlignment</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">Optimize</span><span class=\"blue\">&gt;</span>false<span class=\"blue\">&lt;/</span><span class=\"maroon\">Optimize</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">RegisterForComInterop</span><span class=\"blue\">&gt;</span>false<span class=\"blue\">&lt;/</span><span class=\"maroon\">RegisterForComInterop</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">RemoveIntegerChecks</span><span class=\"blue\">&gt;</span>false<span class=\"blue\">&lt;/</span><span class=\"maroon\">RemoveIntegerChecks</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">TreatWarningsAsErrors</span><span class=\"blue\">&gt;</span>false<span class=\"blue\">&lt;/</span><span class=\"maroon\">TreatWarningsAsErrors</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">WarningLevel</span><span class=\"blue\">&gt;</span>4<span class=\"blue\">&lt;/</span><span class=\"maroon\">WarningLevel</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">DebugType</span><span class=\"blue\">&gt;</span>full<span class=\"blue\">&lt;/</span><span class=\"maroon\">DebugType</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">ErrorReport</span><span class=\"blue\">&gt;</span>prompt<span class=\"blue\">&lt;/</span><span class=\"maroon\">ErrorReport</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">UseVSHostingProcess</span><span class=\"blue\">&gt;</span>true<span class=\"blue\">&lt;/</span><span class=\"maroon\">UseVSHostingProcess</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">StartAction</span><span class=\"blue\">&gt;</span>Program<span class=\"blue\">&lt;/</span><span class=\"maroon\">StartAction</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">  &lt;</span><span class=\"maroon\">StartProgram</span><span class=\"blue\">&gt;</span>C:\\Program Files\\Revit Architecture 2011\\Program\\Revit.exe<span class=\"blue\">&lt;/</span><span class=\"maroon\">StartProgram</span><span class=\"blue\">&gt;</span>\n<span class=\"blue\">&lt;/</span><span class=\"maroon\">PropertyGroup</span><span class=\"blue\">&gt;</span>\n</pre>\n<p><strong>C.</strong> Unfortunately the new entry for debugging with Revit.exe is not visible in the project property pallette &gt; Tab: 'Debugging' within the C# IDE - EE, but it works anyway:</p>\n<center>\n<img alt=\"Visual Studio 2010 Express debgging tab\" src=\"img/vs2010_debug.png\"/>\n</center>\n<p>Many thanks to Frank for testing and documenting this for us!\n</p></p></p></p></p></p></p></p>"
  }
]