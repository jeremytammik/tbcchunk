[
  {
    "original_filename": "1969_chain_idling",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Andrea Tassera @dre_tas\nYou wanted to see my presentation at #AU2022 on #DevoOps for \n@AutodeskRevit\n plugins, but missed it for some reason (sore feet and hungover as the most common)? No judgement here. We've all been there.\nYou can now find the recording here\nhttps://www.autodesk.com/autodesk-university/class/Deploy-Better-Plugins-Faster-Through-CICD-and-Unit-Testing-Azure-DevOps-2022\n\n- Paul F. Aubin @paulfaubin\nWere you at #autodeskuniversity2022? \nhttps://twitter.com/hashtag/autodeskuniversity2022?src=hashtag_click\n\nRecorded classes are now posted. You can see mine (Taming Parametric Curvature in the Revit Family Editor) right here (complete with downloadable sample files and a step-by-step handout):\n#rev\nhttps://twitter.com/hashtag/rev?src=hashtag_click\n\nhttps://www.autodesk.com/autodesk-university/class/Taming-Parametric-Curved-Geometry-Revit-Family-Editor-2022\n\n- Chuong Ho\nhttps://www.linkedin.com/posts/chuongmep_dynamo-bim-developer-activity-6984467588034543616-U7b6?utm_source=share&utm_medium=member_desktop\nHi everyone, I'm happy to tell you today that I've published a book online about Dynamo called Awesome Dynamo.\nThe Awesome Dynamo project celebrates and aggregates authors, essential and complete content with a large contribution from the community, the main purpose of which is to store dynamo core values and make it easy to learn, apply to work and explore power of Dynamo.\nI'm in the process of working and perfecting it, so please help me if you can.\nEbook Online : https://lnkd.in/gHM3XVFn -- https://chuongmep.github.io/Awesome-Dynamo/intro.html\nGithub : https://lnkd.in/gHNqyjKH -- https://github.com/chuongmep/Awesome-Dynamo\n#Dynamo #BIM #Developer #Autodesk #NoteBook\n\n- I would like to launch a Command After the Export File Form Closes\n  https://forums.autodesk.com/t5/revit-api-forum/i-would-like-to-launch-a-command-after-the-export-file-form/td-p/11494782\n\nThe standard Revit API approach to launch a command after the previous one has been completed is to use the Idling event:\n\nhttps://www.revitapidocs.com/2023/56145d84-e948-730a-dc72-2a7b88a50a99.htm\nhttps://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28\n\nHowever, there are other possibilities as well. For example, check out these recent discussions on similar topics:\n\nhttps://forums.autodesk.com/t5/revit-api-forum/can-you-chain-idling-events/m-p/11484370\n\n[Exporting to DWG after Dynamo script being executed](https://forums.autodesk.com/t5/revit-api-forum/exporting-to-dwg-after-dynamo-script-being-executed/m-p/11487750)\n\n- ricaun solves\n  Can you chain Idling events?\n  https://forums.autodesk.com/t5/revit-api-forum/can-you-chain-idling-events/m-p/11484370\n\n- This is pretty mind-blowing: a podcast that is entirely generated by artificial intelligence where Joe Rogan interviews Steve Jobs. \n  https://podcast.ai\n\n twitter:\n\nAU 2022 classes and a new Dynamo book online, external events, Idling and launching a command after closing a form in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon https://autode.sk/chainidling\n\nAU 2022 classes are available online now, as well as a new Dynamo book and resources project.\nI also present some ongoing nitty-gritty discussions on external events and <code>Idling</code>\n&ndash; Modern add-in deployment and testing\n&ndash; Parametric curvature in families\n&ndash; Awesome Dynamo online book project\n&ndash; Launching command after closing form\n&ndash; Chaining Idling events and other solutions...\n\nlinkedin:\n\nAU 2022 classes and a new Dynamo book online, external events, Idling and launching a command after closing a form in the #RevitAPI\n\nhttps://autode.sk/chainidling\n\n- Modern add-in deployment and testing\n- Parametric curvature in families\n- Awesome Dynamo online book project\n- Launching command after closing form\n- Chaining Idling events and other solutions...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\" height=\"\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n<pre class=\"code\">\n</pre>\n\n-->"
  },
  {
    "original_filename": "1969_chain_idling",
    "header_text": "Can You Avoid Chaining Idling?",
    "local_header_href": "#can-you-avoid-chaining-idling",
    "chunk_text": "### Can You Avoid Chaining Idling?\n\nAU 2022 classes are available online now, as well as a new Dynamo book and resources project.\nI also present some ongoing nitty-gritty discussions on external events and `Idling`:\n\n- [Modern add-in deployment and testing](#2)\n- [Parametric curvature in families](#3)\n- [Awesome Dynamo online book project](#4)\n- [Launching command after closing form](#5)\n- [Chaining Idling events and other solutions](#6)"
  },
  {
    "original_filename": "1969_chain_idling",
    "header_text": "Deployment and Testing",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Deployment and Testing\n\nAndrea [@dre_tas](https://twitter.com/dre_tas) Tassera shared his presentation at #AU2022 on #DevoOps for @AutodeskRevit,\n[Deploy Better Plugins Faster Through CI/CD and Unit Testing in Azure DevOps](https://www.autodesk.com/autodesk-university/class/Deploy-Better-Plugins-Faster-Through-CICD-and-Unit-Testing-Azure-DevOps-2022):\n\n> At Woods Bagot we managed to cut the deployment time of our tools from days to minutes, while increasing quality and reliability, by repurposing common concepts and tools from the Software Development world.\nBy implementing a DevOps philosophy in your workflow, not only do you deliver automation tools quicker, but you also empower your teams from the start, improving communication and collaboration and promoting professional growth.\nYou increase quality and reliability of the software product deployed, thanks to automated testing and a faster feedback cycle.\nMoreover, with the ability of more frequent faster releases, backed up by live monitoring systems, developers can deploy tools that are tailored to the users and really respond to their needs.\nThe session will showcase how Woods Bagot has developed a full workflow for their Revit toolbar through the use an Azure DevOps pipeline, but the principles can be applied to any platform that benefits from automation tools."
  },
  {
    "original_filename": "1969_chain_idling",
    "header_text": "Parametric Curvature in Families",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Parametric Curvature in Families\n\nPaul F. [@paulfaubin](https://twitter.com/paulfaubin) Aubin\ndiscussed [Taming Parametric Curvature in the Revit Family Editor](https://www.autodesk.com/autodesk-university/class/Taming-Parametric-Curved-Geometry-Revit-Family-Editor-2022),\ncomplete with downloadable sample files and a step-by-step handout:\n\n> Have you ever tried to control the shape of a curved form parametrically in the Family Editor?\nIf so, you’ve no doubt discovered that flexing them sometimes throws you a curveball.\nIn this session we’ll explore several techniques to tame your unruly parametric curves.\nWe’ll look at examples of circles, arcs, quarter round, half round, arches, and we’ll even check out some splines.\nWe’ll look at both simple and compound curves.\nWe’ll work primarily in the traditional Family Editor but most techniques apply to the massing Family Editor environment as well. We’ll explore curvature and rotation, using both armatures (or rigs) and formulas to constrain flexing behavior. We’ll even throw in some trigonometry for good measure! After this session, I cannot guarantee that you’ll never have another misbehaving curve in your family content, but what I can promise is that you’ll come away with several useful tools to help you tame them when curve-mischief strikes!"
  },
  {
    "original_filename": "1969_chain_idling",
    "header_text": "Awesome Dynamo Online Book Project",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Awesome Dynamo Online Book Project\n\nChuong Ho [initiated](https://www.linkedin.com/posts/chuongmep_dynamo-bim-developer-activity-6984467588034543616-U7b6)\nthe online book project Awesome Dynamo.\n\n> The Awesome Dynamo project celebrates and aggregates authors, essential and complete content with a large contribution from the community, the main purpose of which is to store Dynamo core values and make it easy to learn, apply to work and explore power of Dynamo.\n\n> I'm in the process of working and perfecting it, so please help me if you can:\n\n> - [Ebook Online](https://chuongmep.github.io/Awesome-Dynamo/intro.html)\n- [GitHub repository](https://github.com/chuongmep/Awesome-Dynamo)"
  },
  {
    "original_filename": "1969_chain_idling",
    "header_text": "Launching Command after Closing Form",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Launching Command after Closing Form\n\nSeveral recent [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) threads\ndeal with questions on chaining sequences of functionality, e.g.,\n[I would like to launch a command after the export file form closes](https://forums.autodesk.com/t5/revit-api-forum/i-would-like-to-launch-a-command-after-the-export-file-form/td-p/11494782):\n\n**Question:** I have a custom button that launches the DXF Export window.\nI would like to be able to Launch another method after the Export window is closed.\nCurrently, my code opens the Export Form and then launches my other method, but I need the second method to process using information from the form.\nIs there a way to do this? \n\n**Answer:** The standard Revit API approach to launch a command after the previous one has been completed is to use\nthe [Idling event](https://www.revitapidocs.com/2023/56145d84-e948-730a-dc72-2a7b88a50a99.htm).\nExplanations and many samples are provided in the topic group\non [Idling and external events for modeless access and driving Revit from outside](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28).\n\nHowever, there are other possibilities as well.\nFor example, check out these other recent discussions on similar topics:\n\n- [Exporting to DWG after Dynamo script being executed](https://forums.autodesk.com/t5/revit-api-forum/exporting-to-dwg-after-dynamo-script-being-executed/m-p/11487750)\n- [Can you chain Idling events?](https://forums.autodesk.com/t5/revit-api-forum/can-you-chain-idling-events/m-p/11484370)\n\nIn both of those, simpler solutions seem to be possible.\nWe always recommand keeping to the [KISS principle](https://en.wikipedia.org/wiki/KISS_principle)."
  },
  {
    "original_filename": "1969_chain_idling",
    "header_text": "Chaining Idling Events and Other Solutions",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Chaining Idling Events and Other Solutions\n\nAt the time of writing, the discussion is not yet wrapped up\non [Can you chain Idling events?](https://forums.autodesk.com/t5/revit-api-forum/can-you-chain-idling-events/m-p/11489054)\n\n**Question:** Is it possible to chain Idling events?\n\nSay I have two functions, `FuncA` and `FuncB`.\nI want to run FuncA the first time Revit idles, then run FuncB after FuncA is done running and Revit idles again.\nInside my FuncA handler, I am removing the handler to FuncA from `UIApp.Idling`, but I cannot assign a new handler because I don't have a valid API context.\nIs there a way for me to achieve my intended behavior?\nMy goal is\nto [download a file from a server and then open that file](https://forums.autodesk.com/t5/revit-api-forum/internal-exception-downloading-file-from-server-and-the-opening/m-p/11388140).\n\n**Answer 1:** This doesn't sound like a good idea in general.\n\nWhen Revit idles you want to run FunctionA; when it idles again you want to run FunctionA but with different settings,  i.e., subscribe to FunctionA and change what FunctionA does based on what it did last.\nThen, after a set number of things that FunctionA does, unsubscribe.\nIn the end, you are waiting for the same event in-between doing tasks with the same function.\n\nYou can use static variable etc. to store stage of FunctionA.\n\n**Answer 2:** Afaik, you cannot chain them directly, but you can easily achieve the same effect:\n\n- Subscribe to the Idling event and attach `handlerA`\n- In `handlerA`, unsubscribe from the `Idling` event, then subscribe to the `Idling` event and attach `handlerB`\n\nDepending on other factors, Revit may or may not execute other actions in between the two event handler calls, but their relative order should be preserved.\n\nYou say, I cannot assign a new handler because I don't have a valid API context.\n\nWhy not? Within the Idling event handler, I thought you do have a valid Revit API context.\n\nQuestion: why do the actions A and B have to be executed separately? Can't you just execute them both within the same Idling event handler?\n\n**Answer 3:** You should create a queue service for that, subscribing and unsubscribing Revit events in your App as static.\n\nSomething like this [IdlingQueueService.cs](https://gist.github.com/ricaun/11b272c5bec46f05c3fe49525fcc3fdf) maybe helps.\n\nYou can register the service in your `IExternalApplication` and add some `Action` to run on the `Idling` event;\neach one is gonna run in a different Idling Event.\n\n**Response:** Thank you all for your responses. I have tried 3 different solutions all to no success...\n\nIf I step back from all the details of my implementation, my problem is really not too complicated.\nI just wish I could run the `Execute` function of `IExternalCommand` like below.\n\n<pre class=\"code\">\n  public Result Execute(\n    ExternalCommandData commandData,\n    ref string message,\n    ElementSet elements)\n  {\n    Object1 obj1 = new Object1(commandData)\n    \n    await obj1.func1;\n    await obj1.func2;\n    obj1.func3;  // THIS IS THE ONLY REVIT INTERACTION\n    \n    return Autodesk.Revit.UI.Result.Succeeded;\n  }\n</pre>\n\nThis doesn't work because I cannot make the `Execute` function `async` but this is the theory.\nNot being able to `await` `func1` and `func2` is what is causing me to dive so deep into idling events.\n\nFunc1 and Func2 have nothing to do with Revit:\n\n- Func1 calls a web server to do authentication in a webview\n- Func2 calls a web server to download Revit files\n- Func3 opens those files and uses that data to manipulate the current document.\n\nThank you all for the guidance\n\n**Answer:** You forgot to explain that you are using 'await' functions.\n\nRevit does not like async stuff, and your code looks odd.\nHow can you add an await without an async method...\n\nTo work with async and Revit use the [Revit.Async](https://github.com/KennanChan/Revit.Async) package, so the package gonna manage the Idling stuff.\n\n**Response:** Sorry, I just edited my reply for clarity.\nI am not actually running the functions with await as shown. That is how I would do it if the Execute function could be made async.\n\nFunc1 and Func2 are async functions which is why I am/was trying to run them in idling events.\n\n**Answer:** One thing that is important is that when an IExternalCommand is running the Idling is not gonna trigger until the command ends.\nThe Idling means the Revit is not busy doing something and is ready to receive some user interaction.\n\nI guess the best approach in your case should be to use Revit.Async package with something like this.\n\n<pre class=\"code\">\n  public async Task Execute()\n  {\n    await func1;\n    await func2;\n    await RevitTask.RunAsync(func3);  //THIS IS THE ONLY REVIT INTERACTION\n  }\n</pre>\n\nUsing the RevitTask you can run the func3 in Revit context.\n\nStarting again from scratch:\n\nOne correct, reliable and effective approach to address the situation you describe is to implement\nan [external event](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28).\n\nIn the event handler, simply run the code to execute `func3`.\n\nAll the rest has nothing to do with Revit and does not require the Revit API.\n\nTherefore, you can execute it independently, externally, and simply raise the external event after `func1` and `func2` have completed successfully.\n\nOh dear. I just noticed your statement:\n\n> Func1 and Func2 are async functions which is why I am/was trying to run them in idling events.\n\nWell, that is just about the opposite of what you could or should do.\nOr at least it is not intended, afaict.\n\nRevit and its API is single threaded.\nThe `Idling` event handler is single threaded.\nSo, as long as that event handler is busy executing, e.g., your func1 and func2, it will block Revit from doing anything else.\n\nThe purpose of the Idling event is to enable you to execute some action as soon as Revit has stopped being occupied with and therefore blocked by other tasks.\n\nThis confirms my preceding answer: it seems to me that an appropriate way to handle this would be to disconnect func1 and func2 from Revit and your add-in as much as possible, and let them trigger an external event when they are completed, to execute func3.\n\n**Response:** So, what I ended up doing is below.\nIt seems to work but would love some feedback if it's unsafe:\n\n- The main IExternalCommand Execute function just subscribes to an idling event.\n- The event handler is an async function.\n- In the async event handler function, I await the 3 functions and wrap the third one with RevitTask. \n\nThis still feels like the original idling action is unnecessary and I should be able to just dive right into the async func1, but other than that this works!\n\n**Question:** How would you recommend disconnecting Func1 and Func2? The functions are async in that they use async functions in them but I don't need them to run truly asynchronously. Blocking Revit is fine for them. At all points in my code base, I am awaiting the results of the async functions so that everything runs essentially synchronously. All of my problems are due to the fact that the Revit execute function cannot be made \"async\" so I cannot \"await\" func1 and func2. \n\nI can't imagine that this is the first time this problem has been encountered. It's a pretty standard workflow assuming that other plugins need some sort of authentication. First send an HTTP request to a server, then following a successful response, do all the Revit stuff.\n\n**Answer:** Yes, this is a standard situation, and I described the standard solution above.\nNo need for async anything, just create an external event X, raise the event when func1 and func2 have completed, and execute func3 in the external event X handler.\nNo Idling needed, no async needed.\n\n**Response:** Oh maybe I need to learn more about how async works in C# if it's different than JS development.\n\nI would expect that if run func1 and func2 without the await flag, func2 will start before func1 has completed and the external event will be raised before func1 and func2 are completed. This would not work for my code since I would be trying to run code before the authentication step (func1) is completed.\n\nHave I misunderstood? Thanks.\n\n**Answer:** In the context of the Revit. API, I would recommend scrapping async completely.\nThat will totally simplify things.\n\n**Response:** haha I wish, but I still need to send requests to external servers. I can't think of a way to do that without async.\n\n**Answer:** Well, I did myself, many times,\n[connecting desktop and cloud](https://github.com/jeremytammik/FireRatingCloud).\n\nNot very long ago, `async` did not exist.\nPush and pull functionality was up and running for decades before async was invented in the form you know it,\ncf. the [history of C&#35;](https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-version-history).\n\nThat said, [Kennan Chen](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/3373609),\n[author](https://github.com/KennanChan) of\n[Revit.Async](https://github.com/KennanChan/Revit.Async),\nunderlines the suggestion above \nby Luiz Henrique [@ricaun](https://github.com/ricaun) Cassettari:\n\n> This seems to be a highly matched case that Revit.Async is designed to solve.\n\n> I came up with the idea of Revit.Async for a cloud-based RFA management system.\nThe main use case was to query the server about the information of an RFA file (your function 1),\nthen download it (your function 2) and finally place it with Revit API (your function 3).\nI used a pattern similar to Revit.Async to chain them up and it worked like a charm.\n\n> I suggest you to take a look at Revit.Async and you will not be disappointed.\n\nLet's wrap up for the time being with two jokes:\n\n- Knock, knock\n- An `async` function\n- Who's there?\n\n<center>\n<img src=\"img/async_await_cat_in_tree.png\" alt=\"Async and await\" title=\"Async and await\" width=\"800\" height=\"\"/> <!-- 960 x 928 -->\n<p style=\"font-size: 80%; font-style:italic\">\n<a href=\"https://jordicabot.com\">Jordi Cabot</a> via <a href=\"https://pin.it/3U3OOWG\">Pinterest</a></p>\n</center>"
  }
]