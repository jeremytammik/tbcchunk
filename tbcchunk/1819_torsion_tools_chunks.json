[
  {
    "original_filename": "1819_torsion_tools",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n</head>\n\n<!---\n\n- Torsion Tools Update #2 - Copy Linked Legends, Schedules and Reference Views\n  https://youtu.be/C2dBRqXl9UA\n  <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/C2dBRqXl9UA\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n  GitHub: https://github.com/TorsionTools/R20\n  Autodesk Revit 2020 API Visual Studio Solution Template with Code Examples for Common Tools\n  Update #2 will walk through the added tools to Copy Legends, Schedules, and Reference Views  from a Linked Model. \n  The Copy Legends and Schedules tools allow you to select the Link to copy them from, and then select the Legends or Schedules you would like to copy. It will check to see if they already exist in the project and prompt you if they do. \n  The Linked Views tool will allow you to select a Linked Model, Title Block, Viewport Type and then the Views you would like from the Linked Model. It will create a drafting view in the current Document with the Name, Detail Number and Sheet of the Linked Model.\n\n- in 15056740 [Adding Project Template to 'New Project' via API]\nhttps://forums.autodesk.com/t5/revit-api-forum/adding-project-template-to-new-project-via-api/m-p/8585348\nPeter @cig_ad Ciganek just discovered:\n> Autodesk.Revit.ApplicationServices.Application.CurrentUsersDataFolderPath returns the path where Revit.ini is located.\n\n- in [localization website](https://forums.autodesk.com/t5/revit-api-forum/localization-website/m-p/8500166),\nSusan Renna pointed out the new location for the Autodesk NeXLT localization website:\n> You can find it here:  https://ls-wst.autodesk.com/app/nexlt-plus/app/home/search\n\n- calculate volume and area of triangulated solid\n  https://stackoverflow.com/questions/1406029/how-to-calculate-the-volume-of-a-3d-mesh-object-the-surface-of-which-is-made-up\n  https://forge.autodesk.com/blog/get-volume-and-surface-area-viewer\n\ntwitter:\n\nRevit.ini file path, NeXLT localization URL and Torsion Tools two for the #RevitAPI #DynamoBim @AutodeskForge @AutodeskRevit #bim #ForgeDevCon http://bit.ly/torsiontoolstwo\n\nMore Revit API tutorial material and tools, plus a couple of hints from the Revit API discussion forum and the Forge blog\n&ndash; Torsion Tools two\n&ndash; Retrieve path to Revit.ini\n&ndash; Updated NeXLT localization URL\n&ndash; Volume and area of triangulated solid...\n\nlinkedin:\n\nRevit.ini file path, NeXLT localization URL and Torsion Tools two for the #RevitAPI\n\nhttp://bit.ly/torsiontoolstwo\n\nMore Revit API tutorial material and tools, plus a couple of hints from the Revit API discussion forum and the Forge blog:\n\n- Torsion Tools two\n- Retrieve path to Revit.ini\n- Updated NeXLT localization URL\n- Volume and area of triangulated solid...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"100\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1819_torsion_tools",
    "header_text": "Ini File, Localisation and Torsion Tools Two",
    "local_header_href": "#ini-file-localisation-and-torsion-tools-two",
    "chunk_text": "### Ini File, Localisation and Torsion Tools Two\n\nMore Revit API tutorial material and tools plus a couple of hints from the Revit API discussion forum and the Forge blog:\n\n- [Torsion Tools two](#2)\n- [Retrieve path to Revit.ini](#3)\n- [Updated NeXLT localization URL](#4)\n- [Volume and area of triangulated solid](#5)"
  },
  {
    "original_filename": "1819_torsion_tools",
    "header_text": "<a name=\"2\"></a>Torsion Tools Two",
    "local_header_href": "#a-name2atorsion-tools-two",
    "chunk_text": "#### <a name=\"2\"></a>Torsion Tools Two\n\nContinuing right on from the\nfruitful [collection of videos and tutorials](https://thebuildingcoder.typepad.com/blog/2020/02/search-for-getting-started-tutorials-and-videos.html) presented\nyesterday, an update to\nthe [Torsion Tools add-in template with code examples for common tools](https://thebuildingcoder.typepad.com/blog/2020/01/torsion-tools-command-event-and-info-in-da4r.html) introduced last week:\n\n- [Torsion Tools Update #2 &ndash; Copy Linked Legends, Schedules and Reference Views](https://youtu.be/C2dBRqXl9UA):\n\n> Autodesk Revit 2020 API Visual Studio Solution Template with Code Examples for Common Tools.\nUpdate #2 walks through the added tools to copy legends, schedules, and reference views from a linked model.\n\n> The Copy Legends and Schedules tools allow you to select the Link to copy them from, then select the Legends or Schedules you would like to copy.\nIt will check whether they already exist in the project and prompt you if they do.\n\n> The Linked Views tool allows you to select a linked model, title block, viewport type and then the views you would like from the linked model.\nIt creates a drafting view in the current document with the name, detail number and sheet of the linked model.\n\n> [TorsionTools GitHub repo](https://github.com/TorsionTools/R20)\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/C2dBRqXl9UA\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</center>\n\nMany thanks to Torsion Tools for creating and sharing this powerful resource!"
  },
  {
    "original_filename": "1819_torsion_tools",
    "header_text": "<a name=\"3\"></a>Retrieve Path to Revit.ini",
    "local_header_href": "#a-name3aretrieve-path-to-revitini",
    "chunk_text": "#### <a name=\"3\"></a>Retrieve Path to Revit.ini\n\nA small note from\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [adding project template to 'New Project' via API](https://forums.autodesk.com/t5/revit-api-forum/adding-project-template-to-new-project-via-api/m-p/8585348) by \nPeter @cig_ad Ciganek:\n\n> The *Autodesk.Revit.ApplicationServices.Application* property `CurrentUsersDataFolderPath` returns the path where Revit.ini is located."
  },
  {
    "original_filename": "1819_torsion_tools",
    "header_text": "<a name=\"4\"></a>Updated NeXLT Localization URL",
    "local_header_href": "#a-name4aupdated-nexlt-localization-url",
    "chunk_text": "#### <a name=\"4\"></a>Updated NeXLT Localization URL\n\nIn another small not from \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non the [localization website](https://forums.autodesk.com/t5/revit-api-forum/localization-website/m-p/8500166),\nSusan Renna points out the new URL:\n\n> You can find the Autodesk NeXLT localization website here:\n[ls-wst.autodesk.com/app/nexlt-plus/app/home/search](https://ls-wst.autodesk.com/app/nexlt-plus/app/home/search)"
  },
  {
    "original_filename": "1819_torsion_tools",
    "header_text": "<a name=\"5\"></a>Volume and Area of Triangulated Solid",
    "local_header_href": "#a-name5avolume-and-area-of-triangulated-solid",
    "chunk_text": "#### <a name=\"5\"></a>Volume and Area of Triangulated Solid\n\nFinally, a useful generic pure geometry utility that might come in handy in the Revit environment as well\n[to calculate the volume of a 3D mesh object, the surface of which is made up triangles](https://stackoverflow.com/questions/1406029/how-to-calculate-the-volume-of-a-3d-mesh-object-the-surface-of-which-is-made-up):\n\n[Reading this paper](http://chenlab.ece.cornell.edu/Publication/Cha/icip01_Cha.pdf),\nit is actually a pretty simple calculation.\n\nThe trick is to calculate the **signed volume** of a tetrahedron &ndash; based on your triangle and topped off at the origin.\nThe sign of the volume comes from whether your triangle is pointing in the direction of the origin\n(The normal of the triangle is itself dependent upon the order of your vertices, which is why you don't see it explicitly referenced below).\n\nThis all boils down to the following simple function:\n\n<pre class=\"code\">\n  public float SignedVolumeOfTriangle(Vector p1, Vector p2, Vector p3) {\n    var v321 = p3.X*p2.Y*p1.Z;\n    var v231 = p2.X*p3.Y*p1.Z;\n    var v312 = p3.X*p1.Y*p2.Z;\n    var v132 = p1.X*p3.Y*p2.Z;\n    var v213 = p2.X*p1.Y*p3.Z;\n    var v123 = p1.X*p2.Y*p3.Z;\n    return (1.0f/6.0f)*(-v321 + v231 + v312 - v132 - v213 + v123);\n  }\n</pre>\n\nA driver uses it to calculate the volume of the mesh:\n\n<pre class=\"code\">\n  public float VolumeOfMesh(Mesh mesh) {\n    var vols = from t in mesh.Triangles\n      select SignedVolumeOfTriangle(t.P1, t.P2, t.P3);\n    return Math.Abs(vols.Sum());\n  }\n</pre>\n\nAdam Nagy picked this up and used it\nto [calculate volume and surface area in the Forge viewer](https://forge.autodesk.com/blog/get-volume-and-surface-area-viewer),\nverifying that the resulting values match the corresponding properties provided by Inventor:\n\n<center>\n<img src=\"img/forge_viewer_volume_surface_area.png\" alt=\"Volume and surface area in the Forge viewer\" title=\"Volume and surface area in the Forge viewer\" width=\"600\"/> <!-- 800 -->\n</center>"
  }
]