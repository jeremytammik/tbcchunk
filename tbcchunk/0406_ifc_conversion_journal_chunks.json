[
  {
    "original_filename": "0406_ifc_conversion_journal",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0406_ifc_conversion_journal",
    "header_text": "IFC Import and Conversion Journal Script",
    "local_header_href": "#ifc-import-and-conversion-journal-script",
    "chunk_text": "<h3>IFC Import and Conversion Journal Script</h3><p>In the past, people repeatedly asked how to \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/05/vb-samples-and-other-questions.html#1\">\nexport a Revit model to IFC</a>.\n\nThe ability to programmatically save to IFC format has been added in the Revit 2011 API, as we can see from the section 'Export model to IFC' in the Revit API help file RevitAPI.chm What's New section, which notes that the new method Document.Export taking an IFCExportOptions argument exports the document to the Industry Standard Classes (IFC) format.\n\n<p>The inverse functionality, programmatically importing an IFC file into Revit, has not been frequently requested, nor is it currently available in the API. \nBeing asked about this prompted me to try to nonetheless find a solution for this requirement, and I can now proudly present a workaround based on the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/07/journal-file-replay.html\">\njournaling mechanism</a> to \n\nsolve it, which we already discussed as a possibility to \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/02/selection-questions.html#1248007\">\ninvoke a Revit command</a> in \n\naddition to the abovementioned \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/05/vb-samples-and-other-questions.html#1\">\nIFC export</a>.\n\n<p>The new IFC loading issue stems from the following question:\n\n<p><strong>Question:</strong> I am trying to find a solution to achieve the following steps:\n\n<ul>\n<li>Open an IFC file in Revit.\n<li>Save it as an RVT file.\n<li>Link the RVT file to an opened document. \n</li></li></li></ul>\n<p>I am having trouble implementing the first step. \nThe Application class does not seem to provide a dedicated method to open an IFC file and the generic OpenDocumentFile method does not work with IFC files. \nWhen I try to use it, it throws an exception saying that the file cannot be opened.\n\n<p>How can I load an IFC file into a Revit document with the API?\n\n<p><strong>Answer:</strong> As mentioned above, the Revit 2011 API allows you to export to IFC format, but importing from IFC is not supported, and the OpenDocumentFile method does work with IFC files either. \n\n<p>I also tested opening an IFC file by simply specifying it on the Revit command line like this:\n\n<pre>\n\"C:\\Program Files\\Autodesk\\Revit Architecture \n  2011\\Program\\Revit.exe\" C:\\tmp\\walls.ifc\n</pre>\n<p>That results in a similar error message:</p>\n<center>\n<img alt=\"IFC open failed\" src=\"img/ifc_open_failed.png\"/>\n</center>\n<p>Since we cannot open the IFC file using the API, nor specify it on the command line, the only alternative I can think of is to somehow make use of the user interface to do so.\nHappily, the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/07/journal-file-replay.html\">\njournal file replay</a> functionality\n\nprovides the facility to repeat user interface actions.\n\n<p>Please note that the journaling mechanism was originally created for QA and regression tests, and its (mis-) use for automating tasks in Revit is completely unsupported.\nStill, if it works, you may find it useful nonetheless.\n\n<p>I designed and tested a workaround to make use of the journaling mechanism to load and convert the IFC file, and it performs well in my initial tests. This is what I did:\n\n<ol>\n<li>Copy an IFC file to a specific hard-coded location, e.g. C:\\tmp\\import.ifc.\n<li>Start up Revit.\n<li>Open the file through the user interface.\n<li>Save it to another hardcoded location, e.g. C:\\tmp\\export.rvt.\n<li>Quit Revit.\n</li></li></li></li></li></ol>\n<p>Now look at the journal file that was automatically generated by this sequence of actions. \nIt is the most recent file in the Journals subdirectory of the Revit main installation folder, e.g. \n\n<pre>\nC:\\Program Files\\Autodesk\\Revit Architecture \n  2011\\Journals\\journal.0186.txt\n</pre>\n<ol start=\"6\">\n<li>Save the journal file for future use, e.g. as C:\\tmp\\open_ifc_save_rvt_journal.txt.\n</li></ol>\n<p>Now you can programmatically achieve your IFC to RVT file conversion by the following steps:\n\n<ol>\n<li>Copying the source IFC file to C:\\tmp\\import.ifc.\n<li>Run Revit with the journal file as a command line argument, e.g. \n</li></li></ol>\n<pre>\n\"C:\\Program Files\\Autodesk\\Revit \n  Architecture 2011\\Program\\Revit.exe\" \n  C:\\tmp\\open_ifc_save_rvt_jounrnal.txt\n</pre>\n<ol start=\"3\">\n<li>The resulting target file has been saved as C:\\tmp\\export.rvt and can now be moved to its final filename and destination directory.\n</li></ol>\n<p>Linking the resulting RVT file to an opened document can be performed in a separate later step and is left as an exercise to the reader  :-) \n\n<p><strong>Response:</strong> With your very clear instructions, I tested what you suggest to automate the transformation from IFC to RVT format. \n\n<p>It works perfectly. \n\n<p>I did not investigate before this time the content of a Revit journal file. \nHey, it is a vbs file working on an object class CrsJournalScript with LOTS of comments. \nWhat you suggest can be upgraded with writing our own script file and execute it in a shell from .NET to simulate the first part of the process I need to implement.\n\n<p>But I noticed that this kind of manipulation with journaling mechanism is unsupported. \nWWW tells me I am not the first to think about playing with journal files.\n\n<p>Thanks for this solution that seems to be the only one that could help me for now. \nOn the other hand, I hope that IFC files will be accepted by the OpenDocumentFile method in future releases.\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  }
]