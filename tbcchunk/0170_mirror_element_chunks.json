[
  {
    "original_filename": "0170_mirror_element",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<style>\n.blue { color: blue; }\n.teal { color: teal; }\n.maroon { color: maroon; }\n.green { color: green; }\n.gray { color: gray; }\n</style>"
  },
  {
    "original_filename": "0170_mirror_element",
    "header_text": "Mirror an Element",
    "local_header_href": "#mirror-an-element",
    "chunk_text": "<h3>Mirror an Element</h3><p>We already discussed \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/05/transform-an-element.html\">\ntransformation of elements</a> using Move and Rotate.\n\nHere is a question regarding the related method Mirror that also deserves attention:</p><p><strong>Question:</strong>\nI am trying to mirror a family instance element using the X axis as the mirror line. \nI am creating a new line using the NewLine method and then supplying a reference to that to the Document.Mirror method, but this is causing Revit to crash.\nThe Reference property of my line is always null. \nI am doing it like this because I saw an example showing how to mirror a column element through its analytical model curve reference. \nHow can I successfully mirror my family instance element if I have no such reference?</p><p><strong>Answer:</strong>\nWhat you experience is expected. \nIn your code, you are creating an abstract geometrical line at the application level.\nThe resulting object is an abstract geometry entity and not a document element, and therefore no reference is available for this entity. \nIn this case, you should not use the overload of the Mirror method that takes a Reference argument.\nYou can simply use the one taking a Geometry.Line argument instead and use the line itself directly.\nIf you really wanted to use a reference, you could also create a model line in the document and access its reference using the Line.GeometryCurve.Reference property.\nNormally, one would prefer not to create model elements if it is possible to use only in memory objects.\nHere is the complete code of a minimal but complete external command Execute method which mirrors the currently selected elements around the X axis:</p><pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">CmdResult</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">Application</span> app = commandData.Application;\n  <span class=\"teal\">Document</span> doc = app.ActiveDocument;\n \n  <span class=\"teal\">ElementSet</span> els = doc.Selection.Elements;\n \n  <span class=\"teal\">Line</span> line = app.Create.NewLine( \n    <span class=\"teal\">XYZ</span>.Zero, <span class=\"teal\">XYZ</span>.BasisX, <span class=\"blue\">true</span> );\n \n  doc.Mirror( els, line );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">CmdResult</span>.Succeeded;\n}\n</pre><p>Many thanks to Saikat Bhattacharya for handling this case!</p>"
  }
]