[
  {
    "original_filename": "1820_sheet_from_view",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n</head>\n\n<!---\n\n- get sheet from view \n  12966349 [Get ViewSheet from View]\n  https://forums.autodesk.com/t5/revit-api-forum/get-viewsheet-from-view/m-p/7075550\n\ntwitter:\n\nGetting title block data and ViewSheet from View in the #RevitAPI #DynamoBim @AutodeskForge @AutodeskRevit #bim #ForgeDevCon http://bit.ly/titleblockdata\n\nToday, let's highlight two view related data access topics\n&ndash; Get ViewSheet from View\n&ndash; Title block data access...\n\nlinkedin:\n\nGetting title block data and ViewSheet from View in the #RevitAPI\n\nhttp://bit.ly/titleblockdata\n\nToday, let's highlight two view related data access topics:\n\n- Get ViewSheet from View\n- Title block data access...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"100\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1820_sheet_from_view",
    "header_text": "Getting Title Block Data and ViewSheet from View",
    "local_header_href": "#getting-title-block-data-and-viewsheet-from-view",
    "chunk_text": "### Getting Title Block Data and ViewSheet from View\n\nToday, let's highlight two view related data access topics:\n\n- [Get ViewSheet from View](#2)\n- [Title block data access](#3)"
  },
  {
    "original_filename": "1820_sheet_from_view",
    "header_text": "<a name=\"2\"></a>Get ViewSheet from View",
    "local_header_href": "#a-name2aget-viewsheet-from-view",
    "chunk_text": "#### <a name=\"2\"></a>Get ViewSheet from View\n\nAn interesting in-depth conversation in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non how to [get ViewSheet from View](https://forums.autodesk.com/t5/revit-api-forum/get-viewsheet-from-view/m-p/7075550) presents\ntwo different approaches to determine relationships between sheets and the views they host:\n\n**Question:** Is there a way to get the `ViewSheet` or `ElementId` of the `ViewSheet` from a `View` that is placed on that sheet?\n\nI can get the sheet name and sheet number from the provided parameters but do not see one for the actual ViewSheet.\nAm I missing something?\nThe only thing I can think of to do without this info is to loop through all ViewSheets to match the one with the same sheet number (since sheet number is required to be unique).   \n\n**Answer:** Have you looked at the sample code provided in the [description of the ViewSheet class](http://www.revitapidocs.com/2017/af2ee879-173d-df3a-9793-8d5750a17b49.htm)?\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ICollection</span>&lt;<span style=\"color:#2b91af;\">ElementId</span>&gt;&nbsp;views&nbsp;=&nbsp;viewSheet.GetAllPlacedViews();\n&nbsp;&nbsp;message&nbsp;+=&nbsp;<span style=\"color:#a31515;\">&quot;\\nNumber&nbsp;of&nbsp;views&nbsp;in&nbsp;the&nbsp;sheet&nbsp;:&nbsp;&quot;</span>&nbsp;+&nbsp;views.Count;\n</pre>\n\nIf all else fails, you could use this relationship and invert it, just as you suggest.\n \nThe [View.Title property](http://www.revitapidocs.com/2017/bfa96650-310e-5385-3a9d-1a1248b623ce.htm) also\ngenerally consists of the view name plus other modifiers, such as the view type, sheet number, area scheme, and/or assembly type, depending on the specifics of the view:\n \n**Response:** You must have misunderstood my question.  I don't have the ViewSheet in order to use the method to get its placed views.  I have a view, that I know is on a sheet (because its sheet number parameter is not null), but I want to get a direct reference to that sheet that it is placed on.  It seems to me that you are still suggesting that I must loop through all ViewSheets to get the View that I'm concerned with.  Thanks.\n\n**Answer:** Yes, indeed, that is exactly what I am suggesting.\n\nGet all the view sheets, keep track of them and the views they host, and invert that relationship, as described in one of the very early discussions by The Building Coder back in 2008 on a [relationship inverter](http://thebuildingcoder.typepad.com/blog/2008/10/relationship-in.html).\n\nThat gives you a complete dictionary lookup both ways: you can look up the sheet hosting any view and you can look up all the views hosted by any sheet, instantaneously.\n\nIt takes a moment to set up the relationships; after that, all data is available and lookup is very fast.\n\n**Other answer:** I maybe have a workaround for this question, something similar I assume.\n\nSelect some views in the Project Browser to know if the views are placed on sheet(s).\n\nThen, run a macro or external command to execute something like code below.\n\nIf the view is placed on a sheet, it shows the sheet number, sheet name and whatever data you are interested in from the ViewSheet referenced by the views selected in the Project Browser:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">void</span>&nbsp;GetViewSheetFromView(&nbsp;<span style=\"color:#2b91af;\">UIDocument</span>&nbsp;uidoc&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc&nbsp;=&nbsp;uidoc.Document;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;data&nbsp;=&nbsp;<span style=\"color:#a31515;\">&quot;&quot;</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ICollection</span>&lt;<span style=\"color:#2b91af;\">ElementId</span>&gt;&nbsp;selectedIds&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;uidoc.Selection.GetElementIds();\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">ElementId</span>&nbsp;selectedid&nbsp;<span style=\"color:blue;\">in</span>&nbsp;selectedIds&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">View</span>&nbsp;e&nbsp;=&nbsp;doc.GetElement(&nbsp;selectedid&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">View</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">View</span>&nbsp;v&nbsp;<span style=\"color:blue;\">in</span>&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">View</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;<span style=\"color:#2b91af;\">View</span>&gt;()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Where(&nbsp;q&nbsp;=&gt;&nbsp;q.Id.Equals(&nbsp;e.Id&nbsp;)&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;thisSheet&nbsp;=&nbsp;<span style=\"color:#a31515;\">&quot;&quot;</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">ViewSheet</span>&nbsp;vs&nbsp;<span style=\"color:blue;\">in</span>&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">ViewSheet</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;<span style=\"color:#2b91af;\">ViewSheet</span>&gt;()&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">ElementId</span>&nbsp;eid&nbsp;<span style=\"color:blue;\">in</span>&nbsp;vs.GetAllPlacedViews()&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">View</span>&nbsp;ev&nbsp;=&nbsp;doc.GetElement(&nbsp;eid&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">View</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;ev.Id&nbsp;==&nbsp;v.Id&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisSheet&nbsp;+=&nbsp;vs.SheetNumber&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;&nbsp;-&nbsp;&quot;</span>&nbsp;+&nbsp;vs.Name&nbsp;+&nbsp;<span style=\"color:#2b91af;\">Environment</span>.NewLine;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">break</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;thisSheet&nbsp;!=&nbsp;<span style=\"color:#a31515;\">&quot;&quot;</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;+=&nbsp;v.ViewType&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;:&nbsp;&quot;</span>&nbsp;+&nbsp;v.Name&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;&nbsp;&quot;</span>&nbsp;+&nbsp;<span style=\"color:#2b91af;\">Environment</span>.NewLine&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;thisSheet.TrimEnd(&nbsp;<span style=\"color:#a31515;\">&#39;&nbsp;&#39;</span>,&nbsp;<span style=\"color:#a31515;\">&#39;,&#39;</span>&nbsp;)&nbsp;+&nbsp;<span style=\"color:#2b91af;\">Environment</span>.NewLine;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;+=&nbsp;v.ViewType&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;:&nbsp;&quot;</span>&nbsp;+&nbsp;v.Name&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;&nbsp;&quot;</span>&nbsp;+&nbsp;<span style=\"color:#2b91af;\">Environment</span>.NewLine&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;thisSheet.TrimEnd(&nbsp;<span style=\"color:#a31515;\">&#39;&nbsp;&#39;</span>,&nbsp;<span style=\"color:#a31515;\">&#39;,&#39;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;+=&nbsp;<span style=\"color:#a31515;\">&quot;&nbsp;NOT&nbsp;ON&nbsp;SHEET&nbsp;&quot;</span>&nbsp;+&nbsp;<span style=\"color:#2b91af;\">Environment</span>.NewLine&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;\\n&quot;</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(&nbsp;<span style=\"color:#a31515;\">&quot;View&nbsp;Report&quot;</span>,&nbsp;data&nbsp;);\n&nbsp;&nbsp;}\n</pre>\n\n<center>\n<img src=\"img/GetViewSheetFromView.png\" alt=\"Get ViewSheet from View\" title=\"Get ViewSheet from View\" width=\"800\"/> <!-- 1815 -->\n</center>\n\n**Yet another answer:** You can perhaps get VIEWPORT_SHEET_NUMBER from Parameters.\n\n**Yet another answer:** As suggested above, using the BIP for viewport sheet number with an ElementParameterFilter is probably the best approach.\nSheet numbers are unique in each Revit model, so it is safe to search by them and get the right result.\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">Public</span>&nbsp;<span style=\"color:blue;\">Function</span>&nbsp;TObj43(<span style=\"color:blue;\">ByVal</span>&nbsp;commandData&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:#2b91af;\">ExternalCommandData</span>,\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">ByRef</span>&nbsp;message&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:blue;\">String</span>,&nbsp;<span style=\"color:blue;\">ByVal</span>&nbsp;elements&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:#2b91af;\">ElementSet</span>)&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:#2b91af;\">Result</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">If</span>&nbsp;commandData.Application.ActiveUIDocument&nbsp;<span style=\"color:blue;\">Is</span>&nbsp;<span style=\"color:blue;\">Nothing</span>&nbsp;<span style=\"color:blue;\">Then</span>&nbsp;<span style=\"color:blue;\">Return</span>&nbsp;<span style=\"color:#2b91af;\">Result</span>.Cancelled&nbsp;<span style=\"color:blue;\">Else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;AcView&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:#2b91af;\">View</span>&nbsp;=&nbsp;commandData.Application.ActiveUIDocument.ActiveGraphicalView\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;P_Ns&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;=&nbsp;AcView.Parameter(<span style=\"color:#2b91af;\">BuiltInParameter</span>.VIEWPORT_SHEET_NUMBER)\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">If</span>&nbsp;P_Ns&nbsp;<span style=\"color:blue;\">Is</span>&nbsp;<span style=\"color:blue;\">Nothing</span>&nbsp;<span style=\"color:blue;\">Then</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">GoTo</span>&nbsp;Monday\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">End</span>&nbsp;<span style=\"color:blue;\">If</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;Txt&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:blue;\">String</span>&nbsp;=&nbsp;P_Ns.AsString\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">If</span>&nbsp;<span style=\"color:blue;\">String</span>.IsNullOrEmpty(Txt)&nbsp;<span style=\"color:blue;\">Then</span>&nbsp;<span style=\"color:blue;\">GoTo</span>&nbsp;Monday&nbsp;<span style=\"color:blue;\">Else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;SeFR&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:#2b91af;\">FilterRule</span>&nbsp;=&nbsp;<span style=\"color:#2b91af;\">ParameterFilterRuleFactory</span>.CreateEqualsRule(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">New</span>&nbsp;<span style=\"color:#2b91af;\">ElementId</span>(<span style=\"color:#2b91af;\">BuiltInParameter</span>.SHEET_NUMBER),&nbsp;Txt,&nbsp;<span style=\"color:blue;\">True</span>)\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;PFilt&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:blue;\">New</span>&nbsp;<span style=\"color:#2b91af;\">ElementParameterFilter</span>(SeFR,&nbsp;<span style=\"color:blue;\">False</span>)\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;FEC&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:blue;\">New</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(AcView.Document)\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;ECF&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:blue;\">New</span>&nbsp;<span style=\"color:#2b91af;\">ElementClassFilter</span>(<span style=\"color:blue;\">GetType</span>(<span style=\"color:#2b91af;\">ViewSheet</span>))\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;LandF&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:blue;\">New</span>&nbsp;<span style=\"color:#2b91af;\">LogicalAndFilter</span>(ECF,&nbsp;PFilt)\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;Els&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:#2b91af;\">List</span>(<span style=\"color:blue;\">Of</span>&nbsp;<span style=\"color:#2b91af;\">Element</span>)&nbsp;=&nbsp;FEC.WherePasses(LandF).ToElements\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">If</span>&nbsp;Els.Count&nbsp;&lt;&gt;&nbsp;1&nbsp;<span style=\"color:blue;\">Then</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">GoTo</span>&nbsp;Monday\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Dim</span>&nbsp;TD&nbsp;<span style=\"color:blue;\">As</span>&nbsp;<span style=\"color:blue;\">New</span>&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>(<span style=\"color:#a31515;\">&quot;Was&nbsp;this&nbsp;your&nbsp;sheet...&quot;</span>)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TD.MainInstruction&nbsp;=&nbsp;Txt&nbsp;&amp;&nbsp;<span style=\"color:#a31515;\">&quot;-&quot;</span>&nbsp;&amp;&nbsp;Els(0).Name\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TD.MainContent&nbsp;=&nbsp;<span style=\"color:#a31515;\">&quot;Note&nbsp;that&nbsp;view&nbsp;types&nbsp;that&nbsp;can&nbsp;appear&nbsp;on&nbsp;&quot;</span>&nbsp;_\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;multiple&nbsp;sheets&nbsp;(Legends,&nbsp;Images,&nbsp;Schedules&nbsp;etc.)&nbsp;will&nbsp;&quot;</span>&nbsp;_\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;&nbsp;not&nbsp;be&nbsp;returned&nbsp;by&nbsp;this&nbsp;method.&quot;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TD.Show()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">GoTo</span>&nbsp;Friday\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">End</span>&nbsp;<span style=\"color:blue;\">If</span>\nMonday:\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(<span style=\"color:#a31515;\">&quot;Something&nbsp;went&nbsp;amiss...&quot;</span>,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;We&nbsp;looked&nbsp;hard&nbsp;in&nbsp;many&nbsp;places&nbsp;but&nbsp;were&nbsp;unable&nbsp;to&nbsp;&quot;</span>&nbsp;_\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;find&nbsp;your&nbsp;sheet&nbsp;on&nbsp;this&nbsp;occasion.&quot;</span>)\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Return</span>&nbsp;<span style=\"color:#2b91af;\">Result</span>.Failed\nFriday:\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">Return</span>&nbsp;<span style=\"color:#2b91af;\">Result</span>.Succeeded\n&nbsp;&nbsp;<span style=\"color:blue;\">End</span>&nbsp;<span style=\"color:blue;\">Function</span>\n</pre>\n\n**Yet another answer:** Here is a pretty quick way of checking for a specific sheet:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">private</span>&nbsp;<span style=\"color:#2b91af;\">ViewSheet</span>&nbsp;CheckSheet(&nbsp;<span style=\"color:blue;\">string</span>&nbsp;_sheetNumber&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ParameterValueProvider</span>&nbsp;pvp&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ParameterValueProvider</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementId</span>(&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.SHEET_NUMBER&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilterStringRuleEvaluator</span>&nbsp;fsr&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilterStringEquals</span>();\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilterRule</span>&nbsp;fRule&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilterStringRule</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pvp,&nbsp;fsr,&nbsp;_sheetNumber,&nbsp;<span style=\"color:blue;\">true</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementParameterFilter</span>&nbsp;filter&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementParameterFilter</span>(&nbsp;fRule&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfCategory(&nbsp;<span style=\"color:#2b91af;\">BuiltInCategory</span>.OST_Sheets&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WherePasses(&nbsp;filter&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.FirstOrDefault()&nbsp;<span style=\"color:blue;\">is</span>&nbsp;<span style=\"color:#2b91af;\">ViewSheet</span>&nbsp;vs&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;vs;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n</pre>\n\n**Summary:** I believe this last solution is unbeatable if you are interested in one single lookup.\n\nIt uses a parameter filter and the `SHEET_NUMBER` built-in parameter.\n\nProbably, the VB function `TObj43` above is similarly efficient.\n\n`GetViewSheetFromView` demonstrates the lookup of the inverted relationship I described, but just for one single view.\n\nThat code could be used to store the entire relationships mapping sheet to hosted views and the inverted one mapping each view to hosting sheets for all views and sheets. That might possibly be more efficient if you frequently need to look up several different view to sheet relationships.\n\nThank you all for the very illuminating and helpful answers!"
  },
  {
    "original_filename": "1820_sheet_from_view",
    "header_text": "<a name=\"3\"></a>Title Block Data Access",
    "local_header_href": "#a-name3atitle-block-data-access",
    "chunk_text": "#### <a name=\"3\"></a>Title Block Data Access\n\n**Question:** I am searching for some sample code for use in a Design Automation API project.\n \nRather than reinvent to wheel, I thought you might have a snippet handy showing how to read Revit drawing title block attributes like these:\n\n<center>\n<img src=\"img/title_block_data_access.png\" alt=\"Title block data access\" title=\"Title block data access\" width=\"600\"/> <!-- 1390 -->\n</center>\n\n**Answer:** I discussed accessing\nthe [title block of a sheet](https://thebuildingcoder.typepad.com/blog/2009/11/title-block-of-sheet.html) myself\nback in 2009, but that information is rather antiquated now.\n\nThe question was also raised and answered in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [TitleBlock](https://forums.autodesk.com/t5/revit-api-forum/titleblock/td-p/3802588),\nand that information is perfectly valid.\n\nAh, I now found a more recent and useful article on how\nto [determine sheet size](https://thebuildingcoder.typepad.com/blog/2010/05/determine-sheet-size.html) that\nshould provide all you need.\n\nThe code is included in\n[The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples)\n[module CmdSheetSize.cs](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/BuildingCoder/CmdSheetSize.cs).\n\nThe title block instances are family instance elements.\nYou can access the title block element using a filtered element collector, e.g.:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>&nbsp;title_block_instances\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfCategory(&nbsp;<span style=\"color:#2b91af;\">BuiltInCategory</span>.OST_TitleBlocks&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">FamilyInstance</span>&nbsp;)&nbsp;);\n</pre>\n\nYou can loop through these elements and retrieve the required data from their built-in parameters, such as SHEET_NAME, SHEET_NUMBER, SHEET_DRAWN_BY, SHEET_CHECKED_BY etc., like this:\n\n<pre class=\"code\">\n  <span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">FamilyInstance</span>&nbsp;e&nbsp;<span style=\"color:blue;\">in</span>&nbsp;a&nbsp;)\n  {\n  &nbsp;&nbsp;p&nbsp;=&nbsp;e.get_Parameter(\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.SHEET_NUMBER&nbsp;);\n   \n  &nbsp;&nbsp;<span style=\"color:#2b91af;\">Debug</span>.Assert(&nbsp;<span style=\"color:blue;\">null</span>&nbsp;!=&nbsp;p,\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;expected&nbsp;valid&nbsp;sheet&nbsp;number&quot;</span>&nbsp;);\n   \n  &nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;sheet_number&nbsp;=&nbsp;p.AsString();\n   \n  &nbsp;&nbsp;p&nbsp;=&nbsp;e.get_Parameter(\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.SHEET_WIDTH&nbsp;);\n   \n  &nbsp;&nbsp;<span style=\"color:#2b91af;\">Debug</span>.Assert(&nbsp;<span style=\"color:blue;\">null</span>&nbsp;!=&nbsp;p,\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;expected&nbsp;valid&nbsp;sheet&nbsp;width&quot;</span>&nbsp;);\n   \n  &nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;swidth&nbsp;=&nbsp;p.AsValueString();\n  &nbsp;&nbsp;<span style=\"color:blue;\">double</span>&nbsp;width&nbsp;=&nbsp;p.AsDouble();\n\n    . . . \n  }\n</pre>\n\nAls always, you can use [RevitLookup](https://github.com/jeremytammik/RevitLookup) to explore this data interactively yourself in your own model to see which properties are available where and what other title block information may be of interest to your application."
  }
]