[
  {
    "original_filename": "0225_enumerations",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0225_enumerations",
    "header_text": "Display Strings and Enumerations",
    "local_header_href": "#display-strings-and-enumerations",
    "chunk_text": "<h3>Display Strings and Enumerations</h3><p><strong>Question:</strong> I need to get the string value displayed in the Revit user interface for some parameters whose values only contain an integer value, such as:\n\n<ul>\n<li>Wall Function: the API returns an integer value, whereas the UI displays \"Exterior\".\n<li>Wrapping at Inserts: again, the API returns an integer value, whereas the UI displays \"Both\".\n</li></li></ul>\n<p>Is there a general way to get a mapping between the integer values and the display strings for all such items in Revit?\n\n<p><strong>Answer:</strong> For a parameter containing a double value representing a length or an area, you can retrieve the raw internal database value using the Parameter.AsDouble method, and the AsValueString method will return the string representation as displayed in the Revit user interface, honouring the current unit settings.\n\n<p>Unfortunately, for the enumerated parameter values you are interested in, the parameter value is just a normal integer value, and AsValueString can do nothing to convert it to the user interface display string.\nPlease note that these display strings are localised, i.e. language dependent, so they cannot simply be hard-wired into the API.\nRevit does not provide any API method to retrieve the mapping from the internal integer values to the display strings programmatically.\n\nThe mapping can be created manually by setting every option of the parameter in the user interface and then checking its integer value using RvtMgdDbg, which is obviously tedious and inefficient.\n\n<p>In the case of the wall function, this results in the following value mapping:\n\n<ul>\n<li>0 Interior\n<li>1 Exterior\n<li>2 Foundation\n<li>3 Retaining\n<li>4 Soffit\n<li>5 Core-shaft\n</li></li></li></li></li></li></ul>\n<p>The wall function is also represented by the WallFunction Enumeration in the API, which has the following values:\n\n<ul>\n<li>Soffit\n<li>Retaining  \n<li>Foundation  \n<li>Exterior  \n<li>Interior\n</li></li></li></li></li></ul>\n<p>Converting these enumeration values to integers does return the same numbers as those listed above.\nHowever, in this case, the Core-shaft entry is missing in the enumeration.\n\n<p>Whenever you run into an integer-valued parameter like this, it is worth while checking the Revit API help file to see whether a corresponding enumeration type is available.\nYou may of course run into parameters for which this is not the case, or where some of the values displayed in the user interface are missing in the API, but in many cases this can save at least some of the manual effort described above.\n\n<p>My colleague Augusto Goncalves points out that this is an apt place to mention that you can use the .NET Enum class to get some information about the enumeration values, for example like this:\n\n<pre class=\"code\">\n<span class=\"green\">// list enum values:</span>\n \n<span class=\"blue\">string</span>[] enumValues = <span class=\"teal\">Enum</span>.GetNames( \n  <span class=\"blue\">typeof</span>( Autodesk.Revit.Enums.<span class=\"teal\">WallFunction</span> ) );\n \n<span class=\"teal\">StringBuilder</span> values \n  = <span class=\"blue\">new</span> <span class=\"teal\">StringBuilder</span>( <span class=\"maroon\">\"Values are: \"</span> );\n \n<span class=\"blue\">foreach</span>( <span class=\"blue\">string</span> s <span class=\"blue\">in</span> enumValues )\n{\n  values.AppendFormat( <span class=\"maroon\">\"\\n{0}\"</span>, s );\n}\n \nSystem.Windows.Forms.<span class=\"teal\">MessageBox</span>.Show( \n  values.ToString() );\n \n<span class=\"green\">// convert an enum value to string:</span>\n \nAutodesk.Revit.Enums.<span class=\"teal\">WallFunction</span> aValue \n  = Autodesk.Revit.Enums.<span class=\"teal\">WallFunction</span>.Interior;\n \n<span class=\"blue\">string</span> aValueName = <span class=\"teal\">Enum</span>.GetName( \n  aValue.GetType(), aValue );\n \nSystem.Windows.Forms.<span class=\"teal\">MessageBox</span>.Show( \n  <span class=\"teal\">String</span>.Format( <span class=\"maroon\">\"The value is: {0}\"</span>, aValueName ) );\n</pre>\n<p>By the way, conversion to a string can also be achieved even more simply and directly by using aValue.ToString().\n</p></p></p></p></p></p></p></p></p></p>"
  }
]