[
  {
    "original_filename": "0335_textnote_alignment",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0335_textnote_alignment",
    "header_text": "RevitLookup and TextNote Alignment",
    "local_header_href": "#revitlookup-and-textnote-alignment",
    "chunk_text": "<h3>RevitLookup and TextNote Alignment</h3><p>To take a break from all the exciting Revit 2011 oriented news and dash off a quick post while continuing my preparations for the Revit programming introduction workshop here in Warsaw, I thought I would simply present a recent case handled by my colleague Saikat Bhattacharya.\nWhile doing so, however, I ran into yet another 2011 related issue concerning RevitLookup, previously known as RvtMgdDbg, which I thought I should mention before diving into the details of the case.\n\n<h4>RevitLookup</h4>\n<p>Both I and many others have repeatedly extolled the virtues of \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/02/rvtmgddbg.html\">RvtMgdDbg</a>,\n\nthe Revit database exploration and snooping tool.\nThe in-depth description above is based on the version for Revit 2009.\nA \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/10/rvtmgddbg-for-revit-2010.html\">version for Revit 2010</a> is \n\nalso available.\nOne issue with this tool in the past has been that although it is an invaluable and irreplaceable debugging and exploration tool, it has been developed and managed by a separate team.\nThat has now happily changed.\nFrom Revit 2011 onwards, this tool has been taken over by the team that manages the Revit SDK and is thus included there.\nSince the Revit SDK is included in the Revit setup files, RevitLookup is now available with every installation of Revit.\nAt the same time, the old name RvtMgdDbg was deemed unpronounceable and it has therefore been renamed to RevitLookup.\nWith that small but important and happy bit of information out of the way, let us look at an example of using it.\n\n<h4>TextNote Alignment</h4>\n<p><strong>Question:</strong> I am trying to copy a TextNote from one Revit document to another. \nI need to access the TextAlignment value in order to pass it to the Create.NewTextNote method in the target document. \nUsing RevitLookup, I can see that the TextNote object has a HORIZ_ALIGN parameter which defines the horizontal alignment, but I cannot find a corresponding parameter for the vertical alignment within the TextNote or the TextNoteType object. \nWhich object contains the vertical alignment information, so I can combine both the horizontal and vertical alignment for the call to the Create.NewTextNote method? \nHere is a screenshot of RevitLookup displaying the HORIZ_ALIGN parameter:</p>\n<center>\n<img alt=\"HORIZ_ALIGN parameter\" src=\"img/text_align_horiz.png\"/>\n</center>\n<p><strong>Answer:</strong> Your screen snapshot above shows RevitLookup exploring the officially available parameters on the TextNote object.\nMany Revit elements have more parameters attached to them than the ones displayed in the official parameters collection.\nThe additional ones can be displayed by iterating over all possible values of the built-in parameters enumeration and trying to obtain a corresponding parameter for each.\nThis iteration is performed by RevitLookup if you click the 'Built-in Enums Snoop' button.\nDoing that, you will discover that the text note vertical alignment information is stored in the built-in parameter TEXT_ALIGN_VERT, which is also located on the TextNote object. \nHere is a screen snapshot showing how to access the value in RevitLookup:</p>\n<center>\n<img alt=\"TEXT_ALIGN_VERT parameter\" src=\"img/text_align_vert.png\"/>\n</center>\n<p>To explore the meanings of the integer values stored in the TEXT_ALIGN_VERT parameter, I created three different text notes with varying vertical alignments using the API and looked at each of them in RevitLookup.\nThat showed that the internal values for the built-in parameter for the different vertical alignments correspond to the following TextAlignFlags:\n\n<pre>\nTextAlignFlags.TEF_ALIGN_TOP = 512\nTextAlignFlags.TEF_ALIGN_MIDDLE = 1024\nTextAlignFlags.TEF_ALIGN_BOTTOM = 2048\n</pre>\n<p>You can thus extract the integer value of the TEXT_ALIGN_VERT parameter on the TextNote object and use it to recreate an equivalent new object with the same vertical alignment via the NewTextNote method.\n\n</p></p></p></p>"
  },
  {
    "original_filename": "0335_textnote_alignment",
    "header_text": "RevitLookup",
    "local_header_href": "#revitlookup",
    "chunk_text": "<h4>RevitLookup</h4><p>Both I and many others have repeatedly extolled the virtues of \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/02/rvtmgddbg.html\">RvtMgdDbg</a>,\n\nthe Revit database exploration and snooping tool.\nThe in-depth description above is based on the version for Revit 2009.\nA \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/10/rvtmgddbg-for-revit-2010.html\">version for Revit 2010</a> is \n\nalso available.\nOne issue with this tool in the past has been that although it is an invaluable and irreplaceable debugging and exploration tool, it has been developed and managed by a separate team.\nThat has now happily changed.\nFrom Revit 2011 onwards, this tool has been taken over by the team that manages the Revit SDK and is thus included there.\nSince the Revit SDK is included in the Revit setup files, RevitLookup is now available with every installation of Revit.\nAt the same time, the old name RvtMgdDbg was deemed unpronounceable and it has therefore been renamed to RevitLookup.\nWith that small but important and happy bit of information out of the way, let us look at an example of using it.\n\n<h4>TextNote Alignment</h4>\n<p><strong>Question:</strong> I am trying to copy a TextNote from one Revit document to another. \nI need to access the TextAlignment value in order to pass it to the Create.NewTextNote method in the target document. \nUsing RevitLookup, I can see that the TextNote object has a HORIZ_ALIGN parameter which defines the horizontal alignment, but I cannot find a corresponding parameter for the vertical alignment within the TextNote or the TextNoteType object. \nWhich object contains the vertical alignment information, so I can combine both the horizontal and vertical alignment for the call to the Create.NewTextNote method? \nHere is a screenshot of RevitLookup displaying the HORIZ_ALIGN parameter:</p>\n<center>\n<img alt=\"HORIZ_ALIGN parameter\" src=\"img/text_align_horiz.png\"/>\n</center>\n<p><strong>Answer:</strong> Your screen snapshot above shows RevitLookup exploring the officially available parameters on the TextNote object.\nMany Revit elements have more parameters attached to them than the ones displayed in the official parameters collection.\nThe additional ones can be displayed by iterating over all possible values of the built-in parameters enumeration and trying to obtain a corresponding parameter for each.\nThis iteration is performed by RevitLookup if you click the 'Built-in Enums Snoop' button.\nDoing that, you will discover that the text note vertical alignment information is stored in the built-in parameter TEXT_ALIGN_VERT, which is also located on the TextNote object. \nHere is a screen snapshot showing how to access the value in RevitLookup:</p>\n<center>\n<img alt=\"TEXT_ALIGN_VERT parameter\" src=\"img/text_align_vert.png\"/>\n</center>\n<p>To explore the meanings of the integer values stored in the TEXT_ALIGN_VERT parameter, I created three different text notes with varying vertical alignments using the API and looked at each of them in RevitLookup.\nThat showed that the internal values for the built-in parameter for the different vertical alignments correspond to the following TextAlignFlags:\n\n<pre>\nTextAlignFlags.TEF_ALIGN_TOP = 512\nTextAlignFlags.TEF_ALIGN_MIDDLE = 1024\nTextAlignFlags.TEF_ALIGN_BOTTOM = 2048\n</pre>\n<p>You can thus extract the integer value of the TEXT_ALIGN_VERT parameter on the TextNote object and use it to recreate an equivalent new object with the same vertical alignment via the NewTextNote method.\n\n</p></p></p>"
  },
  {
    "original_filename": "0335_textnote_alignment",
    "header_text": "TextNote Alignment",
    "local_header_href": "#textnote-alignment",
    "chunk_text": "<h4>TextNote Alignment</h4><p><strong>Question:</strong> I am trying to copy a TextNote from one Revit document to another. \nI need to access the TextAlignment value in order to pass it to the Create.NewTextNote method in the target document. \nUsing RevitLookup, I can see that the TextNote object has a HORIZ_ALIGN parameter which defines the horizontal alignment, but I cannot find a corresponding parameter for the vertical alignment within the TextNote or the TextNoteType object. \nWhich object contains the vertical alignment information, so I can combine both the horizontal and vertical alignment for the call to the Create.NewTextNote method? \nHere is a screenshot of RevitLookup displaying the HORIZ_ALIGN parameter:</p><center>\n<img alt=\"HORIZ_ALIGN parameter\" src=\"img/text_align_horiz.png\"/>\n</center><p><strong>Answer:</strong> Your screen snapshot above shows RevitLookup exploring the officially available parameters on the TextNote object.\nMany Revit elements have more parameters attached to them than the ones displayed in the official parameters collection.\nThe additional ones can be displayed by iterating over all possible values of the built-in parameters enumeration and trying to obtain a corresponding parameter for each.\nThis iteration is performed by RevitLookup if you click the 'Built-in Enums Snoop' button.\nDoing that, you will discover that the text note vertical alignment information is stored in the built-in parameter TEXT_ALIGN_VERT, which is also located on the TextNote object. \nHere is a screen snapshot showing how to access the value in RevitLookup:</p><center>\n<img alt=\"TEXT_ALIGN_VERT parameter\" src=\"img/text_align_vert.png\"/>\n</center><p>To explore the meanings of the integer values stored in the TEXT_ALIGN_VERT parameter, I created three different text notes with varying vertical alignments using the API and looked at each of them in RevitLookup.\nThat showed that the internal values for the built-in parameter for the different vertical alignments correspond to the following TextAlignFlags:\n\n<pre>\nTextAlignFlags.TEF_ALIGN_TOP = 512\nTextAlignFlags.TEF_ALIGN_MIDDLE = 1024\nTextAlignFlags.TEF_ALIGN_BOTTOM = 2048\n</pre>\n<p>You can thus extract the integer value of the TEXT_ALIGN_VERT parameter on the TextNote object and use it to recreate an equivalent new object with the same vertical alignment via the NewTextNote method.\n\n</p></p>"
  }
]