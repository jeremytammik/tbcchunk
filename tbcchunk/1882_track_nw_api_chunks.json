[
  {
    "original_filename": "1882_track_nw_api",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- week of rest until the twelfth night\n  https://en.wikipedia.org/wiki/Twelfth_Night_(holiday)\n\n- filter for detail lines\n  Collect All Detail Lines of a Particular SubCategory\n  https://forums.autodesk.com/t5/revit-api-forum/collect-all-detail-lines-of-a-particular-subcategory/td-p/9956260\n  \n- modification tracking\n  https://data-shapes.io/2016/12/31/modification-tracking-with-dynamo-and-data-shapes\n  Modification Tracking with Dynamo\n\n- 17292711 [Most optimized way of getting a complete set of property categories and properties in a model.]\n  \n- new\n  Node.js Best Practices\n  https://github.com/goldbergyoni/nodebestpractices\n\n-  old\n  The early history of programming and the C language\n  https://arstechnica.com/features/2020/12/a-damn-stupid-thing-to-do-the-origins-of-c/\n\ntwitter:\n\nNode.js best practices, retrieving NavisWorks model properties, filtering for detail lines subcategory and Revit project modification tracking with the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://autode.sk/subcatfilter\n\nI played around a bit with the NavisWorks API and discovered a nice Revit project modification tracking tool in Dynamo\n&ndash; Filter for detail lines subcategory\n&ndash; Revit project modification tracking\n&ndash; Retrieving all NavisWorks model properties\n&ndash; Node.js best practices\n&ndash; Early history of programming and C...\n\nlinkedin:\n\nNode.js best practices, retrieving NavisWorks model properties, filtering for detail lines subcategory and Revit project modification tracking with the #RevitAPI\n\nhttp://autode.sk/subcatfilter\n\nI played around a bit with the NavisWorks API and discovered a nice Revit project modification tracking tool in Dynamo:\n\n- Filter for detail lines subcategory\n- Revit project modification tracking\n- Retrieving all NavisWorks model properties\n- Node.js best practices\n- Early history of programming and C...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk \n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n<p style=\"font-size: 80%; font-style:italic\">\n<a href=\"\"></a>\n</p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1882_track_nw_api",
    "header_text": "Line Subcategory Filter, Modification Tracker and NW",
    "local_header_href": "#line-subcategory-filter-modification-tracker-and-nw",
    "chunk_text": "### Line Subcategory Filter, Modification Tracker and NW\n\nHappy New Year!\n\nAs always, there is lots going on in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160),\nwhere Richard [RPThomas108](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/1035859) Thomas\nis providing tremendous help on all the really hard questions requiring both Revit API understanding and\nin-depth product usage experience.\n\nI played around a bit with the NavisWorks API in the week of rest and the peaceful time until \nthe [twelfth night](https://en.wikipedia.org/wiki/Twelfth_Night_(holiday)),\nand discovered a very nice Revit project modification tracking tool in Dynamo:\n\n- [Filter for detail lines subcategory](#2)\n- [Revit project modification tracking](#3)\n- [Retrieving all NavisWorks model properties](#4)\n- [Node.js best practices](#5)\n- [Early history of programming and C](#6)"
  },
  {
    "original_filename": "1882_track_nw_api",
    "header_text": "Filter for Detail Lines Subcategory",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Filter for Detail Lines Subcategory\n\nOne of the threads addressed by Richard is on filtering for detail lines,\nto [collect all detail lines of a particular subcategory](https://forums.autodesk.com/t5/revit-api-forum/collect-all-detail-lines-of-a-particular-subcategory/td-p/9956260):\n\n**Question:** From reading The Building Coder's post \non [retrieving all available line styles](https://thebuildingcoder.typepad.com/blog/2013/08/retrieving-all-available-line-styles.html),\nit is my understanding that detail line elements can be collected via FilteredElementCollector once a subcategory is selected.\n\nI have a line style subcategory and would like to collect all the detail lines of that style.\n\nHow do I do that?\n\nFor context, I quote from the link above:\n\n> While the Revit API does not provide a true 'Line style' element, the line styles are actually subcategories of the Lines category. Therefore, the FilteredElementCollector cannot easily be used for this in a single statement, like in your examples above. \n\n> It should be possible to retrieve the line styles without a line instance, though.\n\n> Here’s a macro that lists all subcategories of the Lines category:\n\n<pre class=\"code\">\n<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">void</span>&nbsp;GetListOfLinestyles(&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc&nbsp;)\n{\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Category</span>&nbsp;c&nbsp;=&nbsp;doc.Settings.Categories.get_Item(\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInCategory</span>.OST_Lines&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">CategoryNameMap</span>&nbsp;subcats&nbsp;=&nbsp;c.SubCategories;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">Category</span>&nbsp;lineStyle&nbsp;<span style=\"color:blue;\">in</span>&nbsp;subcats&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(&nbsp;<span style=\"color:#a31515;\">&quot;Line&nbsp;style&quot;</span>,&nbsp;<span style=\"color:blue;\">string</span>.Format(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;Linestyle&nbsp;{0}&nbsp;id&nbsp;{1}&quot;</span>,&nbsp;lineStyle.Name,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lineStyle.Id.ToString()&nbsp;)&nbsp;);\n&nbsp;&nbsp;}\n}\n</pre>\n\n> Note that some line styles like 'Room Boundary' cannot actually be assigned to arbitrary lines in the UI, but this should be good enough to find a usable one.\n\n> Once you have a collection of the line style subcategories of interest, you can create a filtered element collector retrieving all ElementType elements belonging to any one of them.\n\n\n**Answer:** For example, changing `OST_Lines` to `OST_LightFixtures` will find all the line subcategories of the light fixtures.\n\nAs you type in `BuiltInCategory`, you should get a list of all the subcategories you can use.\n\nFor instance, given the following object styles:\n\n<center>\n<img src=\"img/filter_detail_lines_object_styles.png\" alt=\"Object styles\" title=\"Object styles\" width=\"600\"/> <!-- 783 -->\n</center>\n\nUsing `OST_LightFixtures` will return \"Hidden Lines\", \"light Source\", \"test_lightfixturelines\", and \"testlightfixturelines2\".\n\n**Response:** Thanks for your reply. I don't quite understand your meaning.\n\nI should clarify; I'm looking for the right way to use a Line Style subcategory in a FilteredElementCollector to grab all the detail lines in the project that are of that style. I don't actually use C#, that code is just from The Building Coder website, but I have gotten to the point in my code that I have the Line Style I want to filter with and now I would like to create a filtered element collector retrieving all ElementType elements belonging to that Line Style, using the Revit API.\n\n**Answer:** If you aren't using C#, then what are you using?  Python?  Dynamo?  \n\n**Response:** I can translate from anything to anything. Maybe what I'm asking to do isn't possible, I'm not sure.\n\nActually, I may have found something.\n\nI looked up this older forum post\non [FilteredElementCollector -> get all instances except of category X](https://forums.autodesk.com/t5/revit-api-forum/filteredelementcollector-gt-get-all-instances-except-of-category/m-p/8571199):\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>&nbsp;collector&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementCategoryFilter</span>&nbsp;fi&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementCategoryFilter</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInCategory</span>.OST_TitleBlocks,&nbsp;<span style=\"color:blue;\">true</span>&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ICollection</span>&lt;<span style=\"color:#2b91af;\">Element</span>&gt;&nbsp;collection\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;collector.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">FamilyInstance</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WherePasses(&nbsp;fi&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ToElements();\n</pre>\n\nI used the ElementCategoryFilter but replaced the built-in category with my category (not built-in) and removed the .OfClass filter... although, it is collecting 23,000+ lines which doesn't seem right either, so maybe I need to apply another filter...\n\n**Answer:** I believe it's a 3 step process.\nYou find all lines, then narrow those down to the Detail Lines, and then narrow those down to get the line style you want.\n\nAdd a new line style called \"MyNewLineStyle\" (match the caps exactly) and try something like this:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>&nbsp;collector\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementCategoryFilter</span>&nbsp;fi&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementCategoryFilter</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInCategory</span>.OST_GenericLines,&nbsp;<span style=\"color:blue;\">true</span>&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ICollection</span>&lt;<span style=\"color:#2b91af;\">Element</span>&gt;&nbsp;collection&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;collector.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">CurveElement</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WherePasses(&nbsp;fi&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ToElements();\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(&nbsp;<span style=\"color:#a31515;\">&quot;Number&nbsp;of&nbsp;curves&quot;</span>,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;collection.Count.ToString()&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">Element</span>&gt;&nbsp;detail_lines&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">Element</span>&gt;();\n \n&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">Element</span>&nbsp;e&nbsp;<span style=\"color:blue;\">in</span>&nbsp;collection&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;e&nbsp;<span style=\"color:blue;\">is</span>&nbsp;<span style=\"color:#2b91af;\">DetailLine</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;detail_lines.Add(&nbsp;e&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(&nbsp;<span style=\"color:#a31515;\">&quot;Number&nbsp;of&nbsp;Detail&nbsp;Lines&quot;</span>,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;detail_lines.Count.ToString()&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">Element</span>&gt;&nbsp;some_detail_lines&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">Element</span>&gt;();\n&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">DetailLine</span>&nbsp;dl&nbsp;<span style=\"color:blue;\">in</span>&nbsp;detail_lines&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;dl.LineStyle.Name&nbsp;==&nbsp;<span style=\"color:#a31515;\">&quot;MyNewLineStyle&quot;</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;some_detail_lines.Add(&nbsp;dl&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;Number&nbsp;of&nbsp;Detail&nbsp;Lines&nbsp;of&nbsp;MyNewLineStyle&quot;</span>,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;some_detail_lines.Count.ToString()&nbsp;);\n</pre>\n\n**Answer:** Usually, it is easier to filter for objects of `GraphicsStyle` using `ElementClassFilter`, rather than subcategories of `OST_Lines`.\n\nGraphicsStyle has a property GraphicsStyle.GraphicsStyleCategory.\nWhen this is a subcategory of `OST_Lines`, then it relates to either ModelCurves or DetailCurves (note that GraphicsStyle.Category is null).\n\nYou can't use a class filter for DetailCurves and ModelCurves (which inherit from CurveElement).\nThis base class has the property LineStyle which will be one of the GraphicsStyle elements found above.\n\nWhen you have items of `CurveElement`, you can distinguish between ModelCurves and DetailCurves as follows:\n\n- DetailCurves have OwnerViewId <> ElementId.InvalidElementId\n- ModelCurves have OwnerViewId = ElementId.InvalidElementId\n\nSo, you see one potential route is to filter for GraphicsStyles.\n\nFilter again to find GraphicsStyle.GraphicsStyleCategory that is equal to your subcategory of lines.\n\nThen, use this to find CurveElements that have such a CurveElement.LineStyle.\n\nFinally, use CurveElement.OwnerViewId to list either ModelCurves or DetailCurves.\n\nOne simple way of getting valid GraphicsStyles for DetailCurves/ModelCurves is via CurveElement.GetLineStyleIds (there are many graphics styles that don't relate to lines).\nOtherwise, check that GraphicsStyle.GraphicsStyleCategory is a subcategory of OST_Lines.\n\nExample extension methods for getting CurveElements of a given subcategory of lines or matching a GraphicsStyle:\n\n<pre class=\"code\">\n&lt;Extension()&gt;\n  Public Function GetLinesOfCategory(Doc As Document, GraphicsStyle As GraphicsStyle, DetailLines As Boolean, Optional FromView As View = Nothing) As List(Of CurveElement)\n    Dim FEC As FilteredElementCollector = Nothing\n    If FromView Is Nothing Then\n      FEC = New FilteredElementCollector(Doc)\n    Else\n      FEC = New FilteredElementCollector(Doc, FromView)\n    End If\n\n    Dim ECF As New ElementCategoryFilter(BuiltInCategory.OST_Lines)\n    Dim Els As List(Of CurveElement) = FEC.WherePasses(ECF).WhereElementIsNotElementType.ToElements _\n      .Cast(Of CurveElement).Where(Function(x) x.LineStyle.Id = GraphicsStyle.Id _\n      AndAlso (x.OwnerViewId <> ElementId.InvalidElementId) = DetailLines).ToList\n\n    Return Els\n  End Function\n\n&lt;Extension()&gt;\n  Public Function GetLinesOfCategory(Doc As Document, Category As Category, DetailLines As Boolean, Optional FromView As View = Nothing) As List(Of CurveElement)\n\n    Dim FECgs As New FilteredElementCollector(Doc)\n    Dim ECFgs As New ElementClassFilter(GetType(GraphicsStyle))\n    Dim Gs As List(Of GraphicsStyle) = FECgs.WherePasses(ECFgs).ToElements _\n      .Cast(Of GraphicsStyle).Where(Function(x) x.GraphicsStyleCategory.Id = Category.Id).ToList\n\n    If Gs.Count = 0 Then Return New List(Of CurveElement) Else\n\n    Return GetLinesOfCategory(Doc, Gs(0), DetailLines, FromView)\n  End Function\n</pre>\n\nI should also say you could probably use:\n\n- FilteredElementCollector.WhereElementIsViewIndependent\n\nIn combination with `.Excluding` to find ModelCurves and exclude them from your DetailCurves.\n\nI.e., filtering this way first will be quicker, since it happens at lower level prior to Linq, but you don't have millions of these elements to sort through anyway.\n\nAlso, there is a standard filter for detail/model lines: the `CurveElementFilter`:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Category</span>&nbsp;targetLineStyle;\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">IEnumerable</span>&lt;<span style=\"color:#2b91af;\">GraphicsStyle</span>&gt;&nbsp;gstyles&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">GraphicsStyle</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;<span style=\"color:#2b91af;\">GraphicsStyle</span>&gt;()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Where(&nbsp;gs&nbsp;=&gt;&nbsp;gs.GraphicsStyleCategory.Id.IntegerValue&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;targetLineStyle.Id.IntegerValue&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementId</span>&nbsp;targetGraphicsStyleId&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gstyles.FirstOrDefault().Id;\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">CurveElementFilter</span>&nbsp;filter_detail&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">CurveElementFilter</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">CurveElementType</span>.DetailCurve&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilterRule</span>&nbsp;frule_typeId&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:#2b91af;\">ParameterFilterRuleFactory</span>.CreateEqualsRule(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementId</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.BUILDING_CURVE_GSTYLE&nbsp;),&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetGraphicsStyleId&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementParameterFilter</span>&nbsp;filter_type&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementParameterFilter</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">FilterRule</span>&gt;()&nbsp;{&nbsp;frule_typeId&nbsp;}&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">IEnumerable</span>&lt;<span style=\"color:#2b91af;\">Element</span>&gt;&nbsp;lines&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WhereElementIsNotElementType()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WhereElementIsCurveDriven()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WherePasses(&nbsp;filter_detail&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WherePasses(&nbsp;filter_type&nbsp;);\n</pre>\n\n**Response:** Great solutions here, thank you so much!"
  },
  {
    "original_filename": "1882_track_nw_api",
    "header_text": "Revit Project Modification Tracking",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Revit Project Modification Tracking\n\nJacob Small shared a powerful collection of nodes\nfor [Modification Tracking with Dynamo](https://data-shapes.io/2016/12/31/modification-tracking-with-dynamo-and-data-shapes) that\nmight come in useful for you too."
  },
  {
    "original_filename": "1882_track_nw_api",
    "header_text": "Retrieving all NavisWorks Model Properties",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Retrieving all NavisWorks Model Properties\n\nI handled my first NavisWorks .NET API programming ticket, *17292711 &ndash; Most optimized way of getting a complete set of property categories and properties in a model*, and discussed the best approach in depth with the NW development team.\n\n**Question:** When loading an NWD into Navisworks it appears that the categories and properties for all of the items are loaded almost right away when looking at the selection tree. When obtaining this information programmatically it appears it can take much longer. Currently the approach I am using is something like the following:\n\n<pre class=\"code\">\n  // iterate over each item in model\n  foreach (var item in model.RootItem.DescendantsAndSelf)\n  {\n    // iterate over each category per item\n    foreach (var category in item.PropertyCategories)\n    {\n      // iterate over each property per category\n      foreach (var property in category.Properties)\n      {\n        // get value/name etc.\n        var propName = prop.DisplayName;\n        var value = prop.Value;\n      }\n    }\n  }\n</pre>\n\nIs there a way that the properties and categories can be programmatically loaded faster?\n\nIs this information cached somewhere? If so, is there a way to access it instead of loading it myself?\n\nWould it be better to use the COM API for performance?\n\n**Answer:** Sadly, there isn't any faster way of reading all the properties using the .NET API.\nMy little Properties+ tool has to spend a long time searching for properties, but at least it does pop up a progress bar, so that is something the customer could consider doing as well.\n\nWe did think about overhauling how we handle properties for NW 2022, but that didn't make the cut. It's possible we might do something for 2023, but no firm plans as of right now.\n\nThe code does basically what they are doing, and then just caches the results locally.\n\nOnly difference is, it reports progress as well.\n\nThere isn’t anything special or confidential about this code, so, as far as I’m concerned, you’re welcome to share it with the customer:\n\n<pre class=\"code\">\n<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">void</span>&nbsp;Update()\n{\n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;Nw.<span style=\"color:#2b91af;\">Application</span>.MainDocument&nbsp;!=&nbsp;<span style=\"color:blue;\">null</span>&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;Nw.<span style=\"color:#2b91af;\">Search</span>&nbsp;s&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;Nw.<span style=\"color:#2b91af;\">Search</span>();\n \n&nbsp;&nbsp;&nbsp;&nbsp;s.SearchConditions.Add(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nw.<span style=\"color:#2b91af;\">SearchCondition</span>.HasCategoryByName(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nw.<span style=\"color:#2b91af;\">PropertyCategoryNames</span>.Item&nbsp;)&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;s.Selection.SelectAll();\n&nbsp;&nbsp;&nbsp;&nbsp;s.Locations&nbsp;=&nbsp;Nw.<span style=\"color:#2b91af;\">SearchLocations</span>.DescendantsAndSelf;\n&nbsp;&nbsp;&nbsp;&nbsp;s.PruneBelowMatch&nbsp;=&nbsp;<span style=\"color:blue;\">false</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;Nw.<span style=\"color:#2b91af;\">ModelItemCollection</span>&nbsp;allItems&nbsp;=&nbsp;s.FindAll(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nw.<span style=\"color:#2b91af;\">Application</span>.MainDocument,&nbsp;<span style=\"color:blue;\">true</span>&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;Nw.<span style=\"color:#2b91af;\">Progress</span>&nbsp;prog&nbsp;=&nbsp;Nw.<span style=\"color:#2b91af;\">Application</span>.BeginProgress(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;Building&nbsp;Property&nbsp;Cache&quot;</span>&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">int</span>&nbsp;done&nbsp;=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">int</span>&nbsp;total&nbsp;=&nbsp;allItems.Count;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;Nw.<span style=\"color:#2b91af;\">ModelItem</span>&nbsp;item&nbsp;<span style=\"color:blue;\">in</span>&nbsp;allItems&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;Nw.<span style=\"color:#2b91af;\">PropertyCategory</span>&nbsp;cat&nbsp;<span style=\"color:blue;\">in</span>&nbsp;item.PropertyCategories&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;Nw.<span style=\"color:#2b91af;\">DataProperty</span>&nbsp;data&nbsp;<span style=\"color:blue;\">in</span>&nbsp;cat.Properties&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_props.Add(&nbsp;<span style=\"color:blue;\">new</span>&nbsp;PropertyDefinition(&nbsp;cat.Name,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data.Name,&nbsp;cat.DisplayName,&nbsp;data.DisplayName&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++done;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">double</span>&nbsp;percent&nbsp;=&nbsp;(<span style=\"color:blue;\">double</span>)&nbsp;done&nbsp;/&nbsp;(<span style=\"color:blue;\">double</span>)&nbsp;total;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;prog.Update(&nbsp;percent&nbsp;)&nbsp;==&nbsp;<span style=\"color:blue;\">false</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">break</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;Nw.<span style=\"color:#2b91af;\">Application</span>.EndProgress();\n&nbsp;&nbsp;}\n&nbsp;&nbsp;m_cacheValid&nbsp;=&nbsp;<span style=\"color:blue;\">true</span>;\n}\n</pre>\n\n**Question:** I see that it stores a `PropertyDefinition` for each property encountered, encapsulating the `Name` and `DisplayName` of the category and data items. So, it does not care about the data value.\n\nIn a different vein, don’t some objects in the model duplicate others, and their properties as well? Wouldn’t it make sense to identify such objects and reuse the existing data for those? Or is that hard, or impossible?\n\n**Answer:** That code only wants a list of properties, so it doesn't care about the actual values.\nAnd, yes, some objects are duplicates of others, but optimising for that probably won't make much difference.\n\nSummary:\n\n- Use the progress bar\n- Cache the results"
  },
  {
    "original_filename": "1882_track_nw_api",
    "header_text": "Node.js Best Practices",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Node.js Best Practices\n\nTalking about new non-Revit programming environments, one of the most important topics nowadays is of course [node.js](https://nodejs.org).\n\nFor that, I happened upon a really great collection of [Node.js Best Practices](https://github.com/goldbergyoni/nodebestpractices).\n\nThis constitutes an invaluable collection of information, and also shows an exemplary solution to present it optimally."
  },
  {
    "original_filename": "1882_track_nw_api",
    "header_text": "Early History of Programming and C",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Early History of Programming and C\n\nTalking about the other and the new, let's not ignore the old, either;\nfor instance, by taking a look\nat [the early history of programming and the C language](https://arstechnica.com/features/2020/12/a-damn-stupid-thing-to-do-the-origins-of-c)."
  }
]