[
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "Revit Family Creation API Labs",
    "local_header_href": "#revit-family-creation-api-labs",
    "chunk_text": "<h3>Revit Family Creation API Labs</h3><p>The handouts and presentation for my\n\n<a href=\"http://au.autodesk.com\">\nAutodesk University</a>\n<a href=\"https://au.autodesk.com/?nd=class&amp;session_id=5265&amp;jid=323682\">\nfamily API session</a>\n\nare finally done, as well they should be, since they are due to be submitted by today.\nThe last part I worked on was to add more documentation on the family API labs to the handout document.\nI think this overview will be of interest here as well.\nThe family API labs were originally created and documented by Mikako Harada, the ADN AEC workgroup lead, so all of the material presented here is due to her.\nTalking about that prompts me to mention the webcasts where this material was first used:\n\n<h4>ADN webcast registration statistics</h4>\n<p>Most of the material that I am presenting at AU was originally prepared for webcasts on the Revit\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nFamily API</a> and\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/09/the-revit-mep-api.html\">\nMEP API</a> and then posted to this blog as well.\n\nMikako just sent around some statistics on the numbers of registrations for the various webcasts held by the Autodesk Developer Network this year.\nThe overview of all webcasts and other training classes is available online from the Autodesk Developer Network\n\n<a href=\"http://www.adskconsulting.com/adn/cs/api_course_sched.php\">\nAPI training schedule</a>.\n\nAll in all, we presented on 25 different topics and had a total of 1576 attendees registered.\nThe absolute leader in the number of registrations was the Revit API webcast with 250, followed by the Inventor API with 100.\nThe Revit family and MEP API webcasts were also pretty popular with 75 and 64 respectively, so the three Revit webcasts together attracted 389 out of 1576 registrations or about 25%.\nThis just goes to show that the Revit API is an important and popular topic.\n\n<h4>Family API Labs: Creating an Example Family</h4>\n<p>Returning to the Revit Family API Labs, they are a collection of exercises which introduce you step by step to the creation of a column family.\nThe objective is to learn the basics of the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nfamily API</a>.\n\nThe labs start at zero and proceed through the absolute beginning steps up to slightly more advanced aspects.\nHere are the four steps of increasing complexity covered:</p>\n<ol>\n<li><a href=\"#1\">Define a rectangular profile column family</a>.</li>\n<li><a href=\"#2\">Define an L-shaped profile column family</a>.</li>\n<li><a href=\"#3\">Add formulae and materials</a>.</li>\n<li><a href=\"#4\">Add visibility control</a>.</li>\n</ol>\n<p>The full Visual Studio solution and projects, source code, detailed documentation and instructions for each step are included separately for both C# and VB.\nHere is an overview of the main files and directories:</p>\n<ul>\n<li>rfa_labs.sln – common C# and VB Visual Studio solution file\n<li>cs – C# source code directory\n<ul>\n<li>LabsCs.csproj\n<li>1_ColumnRectangle.cs\n<li>2_ColumnLshape.cs\n<li>3_ColumnFormulaMaterial.cs\n<li>4_ColumnVisibility.cs\n<li>Util.cs\n</li></li></li></li></li></li></ul>\n<li>csdoc – C# documentation and detailed step-by-step instructions directory\n<ul>\n<li>Family Lab1 - Create Rectangular Column_CS.rtf\n<li>Family Lab2 - Create L-Shape Column_CS.rtf\n<li>Family Lab3 - Add Formula and Material_CS.rtf\n<li>Family Lab4 - Add Visibility Control_CS.rtf\n</li></li></li></li></ul>\n<li>vb – VB source code directory\n<ul>\n<li>LabsVb.vbproj\n<li>1_ColumnRectangle.vb\n<li>2_ColumnLshape.vb\n<li>3_ColumnFormulaMaterial.vb\n<li>4_ColumnVisibility.vb\n</li></li></li></li></li></ul>\n<li>vbdoc – VB documentation and detailed step-by-step instructions directory\n<ul>\n<li>Family Lab1 - Create Rectangular Column.rtf\n<li>Family Lab2 - Create L-Shape Column.rtf\n<li>Family Lab3 - Add Formula and Material.rtf\n<li>Family Lab4 - Add Visibility Control.rtf\n</li></li></li></li></ul>\n</li></li></li></li></li></ul>\n<p>The source code and instruction documents are part of the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nFamily API</a> webcast materials.\n\nFor your convenience, I am including them\n\n<a href=\"zip/rfa_labs_20091028.zip\">\nhere</a> as well.\n\n<p>The following summary provides a high-level overview of the implementation. \nDetailed information and step-by-step instructions are provided in the source code comments and the dedicated csdoc and vbdoc documents.\n\n<a name=\"1\"></a>\n<h4>Lab 1 – Create Rectangular Column</h4>\n<p>The first lab demonstrates how to implement the following four essential basic steps for creating a new family:\n\n<ol>\n<li>Check the family context and category.\n<li>Create a simple solid using extrusion.\n<li>Set alignments.\n<li>Add types.\n</li></li></li></li></ol>\n<p>It makes use of the following classes and methods:\n\n<pre>\ndoc.IsFamilyDocument\ndoc.OwnerFamily.FamilyCategory.Name\ndoc.FamilyCreate.NewExtrusion()\ndoc.FamilyCreate.NewAlignment()\nfamilyMgr = doc.FamilyManager\nfamilyMgr.NewType()\nfamilyMgr.Parameter(); familyMgr.Set()\n</pre>\n<p>Here is an overview of the four steps listed above in slightly greater detail:\n\n<ol>\n<li>In the first lab, we create a simple rectangular column family defining three column types with different dimensions. Before proceeding with the definition of the geometry and types, we need to ensure that we are working in a family template file and the correct family category. \nThe document provides a property IsFamilyDocument to check the former, and the owner family category gives us the category of the template file.\n<li>Creating the geometry is easily achieved by defining a rectangular profile in the XY plane and extruding it using the NewExtrusion method. When creating the geometry, we need to account for the Revit database units and convert all our length measurements to feet.\n<li>One method to drive the geometry parametrically is to specify alignments between certain parts of the geometry and reference planes. In this very simple case, the template file already provides six reference planes for the upper and lower levels and the right, left, front and back faces, and we have six corresponding faces on the column. We need to specify alignments between these reference planes and the corresponding faces of our solid extrusion.  This is done by identifying the matching pairs of solid face and reference plane and calling NewAlignment for each. In this simple case, the solid faces can be identified by their normal vectors and the reference planes by their names. In a more complex case, such as the next example in lab 2, we may have to create the reference planes ourselves, and use more complex algorithms to identify the reference planes and the solid geometry faces to associate with each other.\n<li>Finally, we create a few sample types for the family. In this simple case again, the template file already defines the parameters that we require for this, namely Width and Depth. Lab 2 will demonstrate how to define our own new parameters. Since the parameters are given, all we need to do is access the FamilyManager object and use its AddType and get_Parameter methods to specify the types to create and their dimensions.\n</li></li></li></li></ol>\n<p>Further in-depth details on the process and source code snippets to achieve each of these four steps is given in the separate documents 'Family Lab1 - Create Rectangular Column.rtf' in the csdoc and vbdoc subdirectories for C# and VB, respectively.</p>\n<a name=\"2\"></a>\n<h4>Lab 2 – Create L-Shaped Column</h4>\n<p>The second lab builds on the first to define a column with a slightly more complex L-shaped cross section profile. \nDue to this, the predefined reference planes and parameters provided by the template file are not sufficient to drive all aspects of the geometry, so we have to create our own additional ones. \nTo be precise, we need reference planes, parameters and dimensions to determine and measure the thickness of the two 'legs' of the L shape.</p>\n<p>Also, in the L-shaped column solid, the normal vector alone is not enough to identify all of the individual solid faces, so that algorithm needs to be refined as well. \nIn our case, we use the reference plane associated with each solid face to identify it. </p>\n<p>Finally, the lab also demonstrates adding new dimensioning to the family definition. \nThe following steps are added to the existing ones:</p>\n<ul>\n<li>Add reference planes.\n<li>Add parameters.\n<li>Add dimensions.\n</li></li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewReferencePlane()\nfamilyMgr.AddParameter()\ndoc.FamilyCreate.NewDimension()\n</pre>\n<p>Separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab2 - Create L-Shape Column_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"3\"></a>\n<h4>Lab 3 – Add Formulae and Materials</h4>\n<p>In the third step, we further enhance the column family defined in the previous step by defining formulae for the L shape leg width parameters and by assigning a material to one of the family types.</p>\n<ul>\n<li>Add formulae.\n<li>Add materials.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\nfamilyMgr.SetFormula()\npSolid.Parameter(\"Material\")\nfamilyMgr.AddParameter()\nfamilyMgr.AssociateElementParameterToFamilyParameter()\n</pre>\n<p>The two parameters are defined as formulae so that the L shape leg width equals a quarter of the column width, and similarly for the depth. \nThe key here is the family manager SetFormula method. </p>\n<p>For the material, an instance parameter for the material group is added to the family and associated with the material parameter of the solid. \nHere, the key is the AssociateElementParameterToFamilyParameter method.</p>\n<p>Again, separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab3 - Add Formula and Material_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"4\"></a>\n<h4>Lab 4 – Add Visibility Control</h4>\n<p>Performance is a critical aspect of building family content, and significant performance improvements can be achieved by making use of the visibility settings accessible for each element in a family through the FamilyElementVisibility class, which can define which levels of detail and which types of views it appears in. \nThat is the focus of this final lab, which implements the following:</p>\n<ul>\n<li>Implement a single line representation for the column in coarse view:\n<ul>\n<li>Single symbolic line representation in plan view.\n<li>Single model line representation in model view.\n</li></li></ul>\n<li>Set the visibility control so that the single line representation is used in coarse view.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewSymbolicCurve()\ndoc.FamilyCreate.NewModelCurve()\nFamilyElementVisibility(FamilyElementVisibilityType.ViewSpecific/Model)\nFamilyElementVisibility.IsShownInFine, etc.\npLine.SetVisibility(pFamilyElementVisibility)\n</pre>\n<p>The detailed documentation and C# and VB code snippets for this lab are provided by the document 'Family Lab4 - Add Visibility Control_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n</p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "ADN webcast registration statistics",
    "local_header_href": "#adn-webcast-registration-statistics",
    "chunk_text": "<h4>ADN webcast registration statistics</h4><p>Most of the material that I am presenting at AU was originally prepared for webcasts on the Revit\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nFamily API</a> and\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/09/the-revit-mep-api.html\">\nMEP API</a> and then posted to this blog as well.\n\nMikako just sent around some statistics on the numbers of registrations for the various webcasts held by the Autodesk Developer Network this year.\nThe overview of all webcasts and other training classes is available online from the Autodesk Developer Network\n\n<a href=\"http://www.adskconsulting.com/adn/cs/api_course_sched.php\">\nAPI training schedule</a>.\n\nAll in all, we presented on 25 different topics and had a total of 1576 attendees registered.\nThe absolute leader in the number of registrations was the Revit API webcast with 250, followed by the Inventor API with 100.\nThe Revit family and MEP API webcasts were also pretty popular with 75 and 64 respectively, so the three Revit webcasts together attracted 389 out of 1576 registrations or about 25%.\nThis just goes to show that the Revit API is an important and popular topic.\n\n<h4>Family API Labs: Creating an Example Family</h4>\n<p>Returning to the Revit Family API Labs, they are a collection of exercises which introduce you step by step to the creation of a column family.\nThe objective is to learn the basics of the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nfamily API</a>.\n\nThe labs start at zero and proceed through the absolute beginning steps up to slightly more advanced aspects.\nHere are the four steps of increasing complexity covered:</p>\n<ol>\n<li><a href=\"#1\">Define a rectangular profile column family</a>.</li>\n<li><a href=\"#2\">Define an L-shaped profile column family</a>.</li>\n<li><a href=\"#3\">Add formulae and materials</a>.</li>\n<li><a href=\"#4\">Add visibility control</a>.</li>\n</ol>\n<p>The full Visual Studio solution and projects, source code, detailed documentation and instructions for each step are included separately for both C# and VB.\nHere is an overview of the main files and directories:</p>\n<ul>\n<li>rfa_labs.sln – common C# and VB Visual Studio solution file\n<li>cs – C# source code directory\n<ul>\n<li>LabsCs.csproj\n<li>1_ColumnRectangle.cs\n<li>2_ColumnLshape.cs\n<li>3_ColumnFormulaMaterial.cs\n<li>4_ColumnVisibility.cs\n<li>Util.cs\n</li></li></li></li></li></li></ul>\n<li>csdoc – C# documentation and detailed step-by-step instructions directory\n<ul>\n<li>Family Lab1 - Create Rectangular Column_CS.rtf\n<li>Family Lab2 - Create L-Shape Column_CS.rtf\n<li>Family Lab3 - Add Formula and Material_CS.rtf\n<li>Family Lab4 - Add Visibility Control_CS.rtf\n</li></li></li></li></ul>\n<li>vb – VB source code directory\n<ul>\n<li>LabsVb.vbproj\n<li>1_ColumnRectangle.vb\n<li>2_ColumnLshape.vb\n<li>3_ColumnFormulaMaterial.vb\n<li>4_ColumnVisibility.vb\n</li></li></li></li></li></ul>\n<li>vbdoc – VB documentation and detailed step-by-step instructions directory\n<ul>\n<li>Family Lab1 - Create Rectangular Column.rtf\n<li>Family Lab2 - Create L-Shape Column.rtf\n<li>Family Lab3 - Add Formula and Material.rtf\n<li>Family Lab4 - Add Visibility Control.rtf\n</li></li></li></li></ul>\n</li></li></li></li></li></ul>\n<p>The source code and instruction documents are part of the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nFamily API</a> webcast materials.\n\nFor your convenience, I am including them\n\n<a href=\"zip/rfa_labs_20091028.zip\">\nhere</a> as well.\n\n<p>The following summary provides a high-level overview of the implementation. \nDetailed information and step-by-step instructions are provided in the source code comments and the dedicated csdoc and vbdoc documents.\n\n<a name=\"1\"></a>\n<h4>Lab 1 – Create Rectangular Column</h4>\n<p>The first lab demonstrates how to implement the following four essential basic steps for creating a new family:\n\n<ol>\n<li>Check the family context and category.\n<li>Create a simple solid using extrusion.\n<li>Set alignments.\n<li>Add types.\n</li></li></li></li></ol>\n<p>It makes use of the following classes and methods:\n\n<pre>\ndoc.IsFamilyDocument\ndoc.OwnerFamily.FamilyCategory.Name\ndoc.FamilyCreate.NewExtrusion()\ndoc.FamilyCreate.NewAlignment()\nfamilyMgr = doc.FamilyManager\nfamilyMgr.NewType()\nfamilyMgr.Parameter(); familyMgr.Set()\n</pre>\n<p>Here is an overview of the four steps listed above in slightly greater detail:\n\n<ol>\n<li>In the first lab, we create a simple rectangular column family defining three column types with different dimensions. Before proceeding with the definition of the geometry and types, we need to ensure that we are working in a family template file and the correct family category. \nThe document provides a property IsFamilyDocument to check the former, and the owner family category gives us the category of the template file.\n<li>Creating the geometry is easily achieved by defining a rectangular profile in the XY plane and extruding it using the NewExtrusion method. When creating the geometry, we need to account for the Revit database units and convert all our length measurements to feet.\n<li>One method to drive the geometry parametrically is to specify alignments between certain parts of the geometry and reference planes. In this very simple case, the template file already provides six reference planes for the upper and lower levels and the right, left, front and back faces, and we have six corresponding faces on the column. We need to specify alignments between these reference planes and the corresponding faces of our solid extrusion.  This is done by identifying the matching pairs of solid face and reference plane and calling NewAlignment for each. In this simple case, the solid faces can be identified by their normal vectors and the reference planes by their names. In a more complex case, such as the next example in lab 2, we may have to create the reference planes ourselves, and use more complex algorithms to identify the reference planes and the solid geometry faces to associate with each other.\n<li>Finally, we create a few sample types for the family. In this simple case again, the template file already defines the parameters that we require for this, namely Width and Depth. Lab 2 will demonstrate how to define our own new parameters. Since the parameters are given, all we need to do is access the FamilyManager object and use its AddType and get_Parameter methods to specify the types to create and their dimensions.\n</li></li></li></li></ol>\n<p>Further in-depth details on the process and source code snippets to achieve each of these four steps is given in the separate documents 'Family Lab1 - Create Rectangular Column.rtf' in the csdoc and vbdoc subdirectories for C# and VB, respectively.</p>\n<a name=\"2\"></a>\n<h4>Lab 2 – Create L-Shaped Column</h4>\n<p>The second lab builds on the first to define a column with a slightly more complex L-shaped cross section profile. \nDue to this, the predefined reference planes and parameters provided by the template file are not sufficient to drive all aspects of the geometry, so we have to create our own additional ones. \nTo be precise, we need reference planes, parameters and dimensions to determine and measure the thickness of the two 'legs' of the L shape.</p>\n<p>Also, in the L-shaped column solid, the normal vector alone is not enough to identify all of the individual solid faces, so that algorithm needs to be refined as well. \nIn our case, we use the reference plane associated with each solid face to identify it. </p>\n<p>Finally, the lab also demonstrates adding new dimensioning to the family definition. \nThe following steps are added to the existing ones:</p>\n<ul>\n<li>Add reference planes.\n<li>Add parameters.\n<li>Add dimensions.\n</li></li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewReferencePlane()\nfamilyMgr.AddParameter()\ndoc.FamilyCreate.NewDimension()\n</pre>\n<p>Separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab2 - Create L-Shape Column_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"3\"></a>\n<h4>Lab 3 – Add Formulae and Materials</h4>\n<p>In the third step, we further enhance the column family defined in the previous step by defining formulae for the L shape leg width parameters and by assigning a material to one of the family types.</p>\n<ul>\n<li>Add formulae.\n<li>Add materials.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\nfamilyMgr.SetFormula()\npSolid.Parameter(\"Material\")\nfamilyMgr.AddParameter()\nfamilyMgr.AssociateElementParameterToFamilyParameter()\n</pre>\n<p>The two parameters are defined as formulae so that the L shape leg width equals a quarter of the column width, and similarly for the depth. \nThe key here is the family manager SetFormula method. </p>\n<p>For the material, an instance parameter for the material group is added to the family and associated with the material parameter of the solid. \nHere, the key is the AssociateElementParameterToFamilyParameter method.</p>\n<p>Again, separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab3 - Add Formula and Material_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"4\"></a>\n<h4>Lab 4 – Add Visibility Control</h4>\n<p>Performance is a critical aspect of building family content, and significant performance improvements can be achieved by making use of the visibility settings accessible for each element in a family through the FamilyElementVisibility class, which can define which levels of detail and which types of views it appears in. \nThat is the focus of this final lab, which implements the following:</p>\n<ul>\n<li>Implement a single line representation for the column in coarse view:\n<ul>\n<li>Single symbolic line representation in plan view.\n<li>Single model line representation in model view.\n</li></li></ul>\n<li>Set the visibility control so that the single line representation is used in coarse view.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewSymbolicCurve()\ndoc.FamilyCreate.NewModelCurve()\nFamilyElementVisibility(FamilyElementVisibilityType.ViewSpecific/Model)\nFamilyElementVisibility.IsShownInFine, etc.\npLine.SetVisibility(pFamilyElementVisibility)\n</pre>\n<p>The detailed documentation and C# and VB code snippets for this lab are provided by the document 'Family Lab4 - Add Visibility Control_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n</p></p></p></p></p></p>"
  },
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "Family API Labs: Creating an Example Family",
    "local_header_href": "#family-api-labs-creating-an-example-family",
    "chunk_text": "<h4>Family API Labs: Creating an Example Family</h4><p>Returning to the Revit Family API Labs, they are a collection of exercises which introduce you step by step to the creation of a column family.\nThe objective is to learn the basics of the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nfamily API</a>.\n\nThe labs start at zero and proceed through the absolute beginning steps up to slightly more advanced aspects.\nHere are the four steps of increasing complexity covered:</p><ol>\n<li><a href=\"#1\">Define a rectangular profile column family</a>.</li>\n<li><a href=\"#2\">Define an L-shaped profile column family</a>.</li>\n<li><a href=\"#3\">Add formulae and materials</a>.</li>\n<li><a href=\"#4\">Add visibility control</a>.</li>\n</ol><p>The full Visual Studio solution and projects, source code, detailed documentation and instructions for each step are included separately for both C# and VB.\nHere is an overview of the main files and directories:</p><ul>\n<li>rfa_labs.sln – common C# and VB Visual Studio solution file\n<li>cs – C# source code directory\n<ul>\n<li>LabsCs.csproj\n<li>1_ColumnRectangle.cs\n<li>2_ColumnLshape.cs\n<li>3_ColumnFormulaMaterial.cs\n<li>4_ColumnVisibility.cs\n<li>Util.cs\n</li></li></li></li></li></li></ul>\n<li>csdoc – C# documentation and detailed step-by-step instructions directory\n<ul>\n<li>Family Lab1 - Create Rectangular Column_CS.rtf\n<li>Family Lab2 - Create L-Shape Column_CS.rtf\n<li>Family Lab3 - Add Formula and Material_CS.rtf\n<li>Family Lab4 - Add Visibility Control_CS.rtf\n</li></li></li></li></ul>\n<li>vb – VB source code directory\n<ul>\n<li>LabsVb.vbproj\n<li>1_ColumnRectangle.vb\n<li>2_ColumnLshape.vb\n<li>3_ColumnFormulaMaterial.vb\n<li>4_ColumnVisibility.vb\n</li></li></li></li></li></ul>\n<li>vbdoc – VB documentation and detailed step-by-step instructions directory\n<ul>\n<li>Family Lab1 - Create Rectangular Column.rtf\n<li>Family Lab2 - Create L-Shape Column.rtf\n<li>Family Lab3 - Add Formula and Material.rtf\n<li>Family Lab4 - Add Visibility Control.rtf\n</li></li></li></li></ul>\n</li></li></li></li></li></ul><p>The source code and instruction documents are part of the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nFamily API</a> webcast materials.\n\nFor your convenience, I am including them\n\n<a href=\"zip/rfa_labs_20091028.zip\">\nhere</a> as well.\n\n<p>The following summary provides a high-level overview of the implementation. \nDetailed information and step-by-step instructions are provided in the source code comments and the dedicated csdoc and vbdoc documents.\n\n<a name=\"1\"></a>\n<h4>Lab 1 – Create Rectangular Column</h4>\n<p>The first lab demonstrates how to implement the following four essential basic steps for creating a new family:\n\n<ol>\n<li>Check the family context and category.\n<li>Create a simple solid using extrusion.\n<li>Set alignments.\n<li>Add types.\n</li></li></li></li></ol>\n<p>It makes use of the following classes and methods:\n\n<pre>\ndoc.IsFamilyDocument\ndoc.OwnerFamily.FamilyCategory.Name\ndoc.FamilyCreate.NewExtrusion()\ndoc.FamilyCreate.NewAlignment()\nfamilyMgr = doc.FamilyManager\nfamilyMgr.NewType()\nfamilyMgr.Parameter(); familyMgr.Set()\n</pre>\n<p>Here is an overview of the four steps listed above in slightly greater detail:\n\n<ol>\n<li>In the first lab, we create a simple rectangular column family defining three column types with different dimensions. Before proceeding with the definition of the geometry and types, we need to ensure that we are working in a family template file and the correct family category. \nThe document provides a property IsFamilyDocument to check the former, and the owner family category gives us the category of the template file.\n<li>Creating the geometry is easily achieved by defining a rectangular profile in the XY plane and extruding it using the NewExtrusion method. When creating the geometry, we need to account for the Revit database units and convert all our length measurements to feet.\n<li>One method to drive the geometry parametrically is to specify alignments between certain parts of the geometry and reference planes. In this very simple case, the template file already provides six reference planes for the upper and lower levels and the right, left, front and back faces, and we have six corresponding faces on the column. We need to specify alignments between these reference planes and the corresponding faces of our solid extrusion.  This is done by identifying the matching pairs of solid face and reference plane and calling NewAlignment for each. In this simple case, the solid faces can be identified by their normal vectors and the reference planes by their names. In a more complex case, such as the next example in lab 2, we may have to create the reference planes ourselves, and use more complex algorithms to identify the reference planes and the solid geometry faces to associate with each other.\n<li>Finally, we create a few sample types for the family. In this simple case again, the template file already defines the parameters that we require for this, namely Width and Depth. Lab 2 will demonstrate how to define our own new parameters. Since the parameters are given, all we need to do is access the FamilyManager object and use its AddType and get_Parameter methods to specify the types to create and their dimensions.\n</li></li></li></li></ol>\n<p>Further in-depth details on the process and source code snippets to achieve each of these four steps is given in the separate documents 'Family Lab1 - Create Rectangular Column.rtf' in the csdoc and vbdoc subdirectories for C# and VB, respectively.</p>\n<a name=\"2\"></a>\n<h4>Lab 2 – Create L-Shaped Column</h4>\n<p>The second lab builds on the first to define a column with a slightly more complex L-shaped cross section profile. \nDue to this, the predefined reference planes and parameters provided by the template file are not sufficient to drive all aspects of the geometry, so we have to create our own additional ones. \nTo be precise, we need reference planes, parameters and dimensions to determine and measure the thickness of the two 'legs' of the L shape.</p>\n<p>Also, in the L-shaped column solid, the normal vector alone is not enough to identify all of the individual solid faces, so that algorithm needs to be refined as well. \nIn our case, we use the reference plane associated with each solid face to identify it. </p>\n<p>Finally, the lab also demonstrates adding new dimensioning to the family definition. \nThe following steps are added to the existing ones:</p>\n<ul>\n<li>Add reference planes.\n<li>Add parameters.\n<li>Add dimensions.\n</li></li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewReferencePlane()\nfamilyMgr.AddParameter()\ndoc.FamilyCreate.NewDimension()\n</pre>\n<p>Separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab2 - Create L-Shape Column_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"3\"></a>\n<h4>Lab 3 – Add Formulae and Materials</h4>\n<p>In the third step, we further enhance the column family defined in the previous step by defining formulae for the L shape leg width parameters and by assigning a material to one of the family types.</p>\n<ul>\n<li>Add formulae.\n<li>Add materials.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\nfamilyMgr.SetFormula()\npSolid.Parameter(\"Material\")\nfamilyMgr.AddParameter()\nfamilyMgr.AssociateElementParameterToFamilyParameter()\n</pre>\n<p>The two parameters are defined as formulae so that the L shape leg width equals a quarter of the column width, and similarly for the depth. \nThe key here is the family manager SetFormula method. </p>\n<p>For the material, an instance parameter for the material group is added to the family and associated with the material parameter of the solid. \nHere, the key is the AssociateElementParameterToFamilyParameter method.</p>\n<p>Again, separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab3 - Add Formula and Material_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"4\"></a>\n<h4>Lab 4 – Add Visibility Control</h4>\n<p>Performance is a critical aspect of building family content, and significant performance improvements can be achieved by making use of the visibility settings accessible for each element in a family through the FamilyElementVisibility class, which can define which levels of detail and which types of views it appears in. \nThat is the focus of this final lab, which implements the following:</p>\n<ul>\n<li>Implement a single line representation for the column in coarse view:\n<ul>\n<li>Single symbolic line representation in plan view.\n<li>Single model line representation in model view.\n</li></li></ul>\n<li>Set the visibility control so that the single line representation is used in coarse view.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewSymbolicCurve()\ndoc.FamilyCreate.NewModelCurve()\nFamilyElementVisibility(FamilyElementVisibilityType.ViewSpecific/Model)\nFamilyElementVisibility.IsShownInFine, etc.\npLine.SetVisibility(pFamilyElementVisibility)\n</pre>\n<p>The detailed documentation and C# and VB code snippets for this lab are provided by the document 'Family Lab4 - Add Visibility Control_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n</p></p></p></p></p>"
  },
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "Lab 1 – Create Rectangular Column",
    "local_header_href": "#lab-1-create-rectangular-column",
    "chunk_text": "<h4>Lab 1 – Create Rectangular Column</h4><p>The first lab demonstrates how to implement the following four essential basic steps for creating a new family:\n\n<ol>\n<li>Check the family context and category.\n<li>Create a simple solid using extrusion.\n<li>Set alignments.\n<li>Add types.\n</li></li></li></li></ol>\n<p>It makes use of the following classes and methods:\n\n<pre>\ndoc.IsFamilyDocument\ndoc.OwnerFamily.FamilyCategory.Name\ndoc.FamilyCreate.NewExtrusion()\ndoc.FamilyCreate.NewAlignment()\nfamilyMgr = doc.FamilyManager\nfamilyMgr.NewType()\nfamilyMgr.Parameter(); familyMgr.Set()\n</pre>\n<p>Here is an overview of the four steps listed above in slightly greater detail:\n\n<ol>\n<li>In the first lab, we create a simple rectangular column family defining three column types with different dimensions. Before proceeding with the definition of the geometry and types, we need to ensure that we are working in a family template file and the correct family category. \nThe document provides a property IsFamilyDocument to check the former, and the owner family category gives us the category of the template file.\n<li>Creating the geometry is easily achieved by defining a rectangular profile in the XY plane and extruding it using the NewExtrusion method. When creating the geometry, we need to account for the Revit database units and convert all our length measurements to feet.\n<li>One method to drive the geometry parametrically is to specify alignments between certain parts of the geometry and reference planes. In this very simple case, the template file already provides six reference planes for the upper and lower levels and the right, left, front and back faces, and we have six corresponding faces on the column. We need to specify alignments between these reference planes and the corresponding faces of our solid extrusion.  This is done by identifying the matching pairs of solid face and reference plane and calling NewAlignment for each. In this simple case, the solid faces can be identified by their normal vectors and the reference planes by their names. In a more complex case, such as the next example in lab 2, we may have to create the reference planes ourselves, and use more complex algorithms to identify the reference planes and the solid geometry faces to associate with each other.\n<li>Finally, we create a few sample types for the family. In this simple case again, the template file already defines the parameters that we require for this, namely Width and Depth. Lab 2 will demonstrate how to define our own new parameters. Since the parameters are given, all we need to do is access the FamilyManager object and use its AddType and get_Parameter methods to specify the types to create and their dimensions.\n</li></li></li></li></ol>\n<p>Further in-depth details on the process and source code snippets to achieve each of these four steps is given in the separate documents 'Family Lab1 - Create Rectangular Column.rtf' in the csdoc and vbdoc subdirectories for C# and VB, respectively.</p>\n<a name=\"2\"></a>\n<h4>Lab 2 – Create L-Shaped Column</h4>\n<p>The second lab builds on the first to define a column with a slightly more complex L-shaped cross section profile. \nDue to this, the predefined reference planes and parameters provided by the template file are not sufficient to drive all aspects of the geometry, so we have to create our own additional ones. \nTo be precise, we need reference planes, parameters and dimensions to determine and measure the thickness of the two 'legs' of the L shape.</p>\n<p>Also, in the L-shaped column solid, the normal vector alone is not enough to identify all of the individual solid faces, so that algorithm needs to be refined as well. \nIn our case, we use the reference plane associated with each solid face to identify it. </p>\n<p>Finally, the lab also demonstrates adding new dimensioning to the family definition. \nThe following steps are added to the existing ones:</p>\n<ul>\n<li>Add reference planes.\n<li>Add parameters.\n<li>Add dimensions.\n</li></li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewReferencePlane()\nfamilyMgr.AddParameter()\ndoc.FamilyCreate.NewDimension()\n</pre>\n<p>Separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab2 - Create L-Shape Column_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"3\"></a>\n<h4>Lab 3 – Add Formulae and Materials</h4>\n<p>In the third step, we further enhance the column family defined in the previous step by defining formulae for the L shape leg width parameters and by assigning a material to one of the family types.</p>\n<ul>\n<li>Add formulae.\n<li>Add materials.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\nfamilyMgr.SetFormula()\npSolid.Parameter(\"Material\")\nfamilyMgr.AddParameter()\nfamilyMgr.AssociateElementParameterToFamilyParameter()\n</pre>\n<p>The two parameters are defined as formulae so that the L shape leg width equals a quarter of the column width, and similarly for the depth. \nThe key here is the family manager SetFormula method. </p>\n<p>For the material, an instance parameter for the material group is added to the family and associated with the material parameter of the solid. \nHere, the key is the AssociateElementParameterToFamilyParameter method.</p>\n<p>Again, separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab3 - Add Formula and Material_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n<a name=\"4\"></a>\n<h4>Lab 4 – Add Visibility Control</h4>\n<p>Performance is a critical aspect of building family content, and significant performance improvements can be achieved by making use of the visibility settings accessible for each element in a family through the FamilyElementVisibility class, which can define which levels of detail and which types of views it appears in. \nThat is the focus of this final lab, which implements the following:</p>\n<ul>\n<li>Implement a single line representation for the column in coarse view:\n<ul>\n<li>Single symbolic line representation in plan view.\n<li>Single model line representation in model view.\n</li></li></ul>\n<li>Set the visibility control so that the single line representation is used in coarse view.\n</li></li></ul>\n<p>The classes and methods used include:</p>\n<pre>\ndoc.FamilyCreate.NewSymbolicCurve()\ndoc.FamilyCreate.NewModelCurve()\nFamilyElementVisibility(FamilyElementVisibilityType.ViewSpecific/Model)\nFamilyElementVisibility.IsShownInFine, etc.\npLine.SetVisibility(pFamilyElementVisibility)\n</pre>\n<p>The detailed documentation and C# and VB code snippets for this lab are provided by the document 'Family Lab4 - Add Visibility Control_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>\n</p></p></p>"
  },
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "Lab 2 – Create L-Shaped Column",
    "local_header_href": "#lab-2-create-l-shaped-column",
    "chunk_text": "<h4>Lab 2 – Create L-Shaped Column</h4><p>The second lab builds on the first to define a column with a slightly more complex L-shaped cross section profile. \nDue to this, the predefined reference planes and parameters provided by the template file are not sufficient to drive all aspects of the geometry, so we have to create our own additional ones. \nTo be precise, we need reference planes, parameters and dimensions to determine and measure the thickness of the two 'legs' of the L shape.</p><p>Also, in the L-shaped column solid, the normal vector alone is not enough to identify all of the individual solid faces, so that algorithm needs to be refined as well. \nIn our case, we use the reference plane associated with each solid face to identify it. </p><p>Finally, the lab also demonstrates adding new dimensioning to the family definition. \nThe following steps are added to the existing ones:</p><ul>\n<li>Add reference planes.\n<li>Add parameters.\n<li>Add dimensions.\n</li></li></li></ul><p>The classes and methods used include:</p><pre>\ndoc.FamilyCreate.NewReferencePlane()\nfamilyMgr.AddParameter()\ndoc.FamilyCreate.NewDimension()\n</pre><p>Separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab2 - Create L-Shape Column_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p><a name=\"3\"></a>"
  },
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "Lab 3 – Add Formulae and Materials",
    "local_header_href": "#lab-3-add-formulae-and-materials",
    "chunk_text": "<h4>Lab 3 – Add Formulae and Materials</h4><p>In the third step, we further enhance the column family defined in the previous step by defining formulae for the L shape leg width parameters and by assigning a material to one of the family types.</p><ul>\n<li>Add formulae.\n<li>Add materials.\n</li></li></ul><p>The classes and methods used include:</p><pre>\nfamilyMgr.SetFormula()\npSolid.Parameter(\"Material\")\nfamilyMgr.AddParameter()\nfamilyMgr.AssociateElementParameterToFamilyParameter()\n</pre><p>The two parameters are defined as formulae so that the L shape leg width equals a quarter of the column width, and similarly for the depth. \nThe key here is the family manager SetFormula method. </p><p>For the material, an instance parameter for the material group is added to the family and associated with the material parameter of the solid. \nHere, the key is the AssociateElementParameterToFamilyParameter method.</p><p>Again, separate C# and VB versions of the detailed instructions, explanations, and source code snippets for this lab are provided by the document 'Family Lab3 - Add Formula and Material_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p><a name=\"4\"></a>"
  },
  {
    "original_filename": "0237_rfa_labs",
    "header_text": "Lab 4 – Add Visibility Control",
    "local_header_href": "#lab-4-add-visibility-control",
    "chunk_text": "<h4>Lab 4 – Add Visibility Control</h4><p>Performance is a critical aspect of building family content, and significant performance improvements can be achieved by making use of the visibility settings accessible for each element in a family through the FamilyElementVisibility class, which can define which levels of detail and which types of views it appears in. \nThat is the focus of this final lab, which implements the following:</p><ul>\n<li>Implement a single line representation for the column in coarse view:\n<ul>\n<li>Single symbolic line representation in plan view.\n<li>Single model line representation in model view.\n</li></li></ul>\n<li>Set the visibility control so that the single line representation is used in coarse view.\n</li></li></ul><p>The classes and methods used include:</p><pre>\ndoc.FamilyCreate.NewSymbolicCurve()\ndoc.FamilyCreate.NewModelCurve()\nFamilyElementVisibility(FamilyElementVisibilityType.ViewSpecific/Model)\nFamilyElementVisibility.IsShownInFine, etc.\npLine.SetVisibility(pFamilyElementVisibility)\n</pre><p>The detailed documentation and C# and VB code snippets for this lab are provided by the document 'Family Lab4 - Add Visibility Control_CS.rtf' in the csdoc and vbdoc subdirectories of the sample material.</p>"
  }
]