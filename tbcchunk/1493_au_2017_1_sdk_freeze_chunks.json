[
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<title>The Building Coder</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<link rel=\"stylesheet\" type=\"text/css\" href=\"3dwc.css\"/>\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true\" defer=\"defer\"></script>\n</head>\n\n<!---\n\nRevit 2017.1 SDK posting -- email Mikako Harada\n\nPawel Madej RE: New version of Revit SDK 2017.1 with new REX SDK sample - FreezeDrawing\n\n<code></code>\n\nAU, Revit 2017.1 SDK and REX FreezeDrawing @AutodeskForge #revitapi @AutodeskRevit #aec #bim @RevitStructure\n\nI returned from the Munich Forge accelerator, travelling back to Switzerland by train. For ecological reasons, I prefer to avoid flying whenever I possibly can. Last Friday was the deadline for submitting my Autodesk University handout, so that kept me busy. I still need to improve it a bit, and I hope a post-deadline update is feasible. I am presenting two classes, and I have a special discount to offer you. Lots of other things are happening as well\n&ndash; My classes at Autodesk University\n&ndash; $400 AU registration discount\n&ndash; Revit 2017.1 SDK\n&ndash; REX SDK FreezeDrawing sample\n&ndash; Determining the height of a column...\n\n-->"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "AU, Revit 2017.1 SDK and REX FreezeDrawing",
    "local_header_href": "#au-revit-20171-sdk-and-rex-freezedrawing",
    "chunk_text": "### AU, Revit 2017.1 SDK and REX FreezeDrawing\n\nI returned from \nthe [Munich Forge accelerator](http://autodeskcloudaccelerator.com),\ntravelling back to Switzerland by train.\nFor ecological reasons, I prefer to avoid flying whenever I possibly can.\n\nLast Friday was the deadline for submitting my Autodesk University handout, so that kept me busy.\n\nI still need to improve it a bit, and I hope a post-deadline update is feasible.\n\nI am presenting two classes, and I have a special discount to offer you.\n\nLots of other things are happening as well.\n\nHere is the list of topics for today:\n\n- [My classes at Autodesk University](#2)\n- [$400 AU registration discount](#3)\n- [Revit 2017.1 SDK](#4)\n- [REX SDK FreezeDrawing sample](#5)\n- [Determining the height of a column](#6)"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"2\"></a>My Classes at Autodesk University",
    "local_header_href": "#a-name2amy-classes-at-autodesk-university",
    "chunk_text": "#### <a name=\"2\"></a>My Classes at Autodesk University\n\nThis year, I am presenting two classes at [Autodesk University](http://au.autodesk.com/las-vegas/overview):\n\n- SD20891 &ndash; Revit API Expert Roundtable &ndash; Open House on the Factory Floor\n- SD20908 &ndash; Connect Desktop and Cloud &ndash; Free Your BIM Data!\n\nOne way to access them and check out their details is\nto [search the AU catalogue for 'tammik'](https://events.au.autodesk.com/connect/dashboard.ww#loadSearch-searchPhrase=tammik&searchType=session).\n\nI really hope you can make it to my live sessions, of course.\n\nIn case not, I'll share my handouts for both as soon as I have cleaned them up a little bit more.\n\nMeanwhile, I have another AU goodie to share, in case you have not already discovered it elsewhere:"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"3\"></a>$400 Autodesk University Registration Discount",
    "local_header_href": "#a-name3a400-autodesk-university-registration-discount",
    "chunk_text": "#### <a name=\"3\"></a>$400 Autodesk University Registration Discount\n\nI have a special offer to share with you:\n\nYou can get $400 off the regular AU conference price of $2,175 on any new registration.\n\nSimply use the discount code `400AU16REFSP`.\n\nHere is [the AU registration link](https://events.au.autodesk.com/portal/login.ww)."
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"4\"></a>Revit 2017.1 SDK",
    "local_header_href": "#a-name4arevit-20171-sdk",
    "chunk_text": "#### <a name=\"4\"></a>Revit 2017.1 SDK\n\nAs you probably know by now, Revit 2017.1 has been released, with an [impressive list of enhancements](https://knowledge.autodesk.com/support/revit-products/learn-explore/caas/CloudHelp/cloudhelp/2017/ENU/Revit-WhatsNew/files/GUID-E287E537-7122-4ED8-8845-B8E24F287B62-htm.html).\n\nAn updated Revit SDK for Revit 2017.1 has been posted to\nthe [Revit Developer Centre](http://www.autodesk.com/developrevit):\n\n- <a href=\"http://images.autodesk.com/adsk/files/Revit_2017.1_SDK_(Update_Oct_19__2016).msi\">Revit 2017.1 SDK Update Oct 19, 2016.msi</a> (msi &ndash; 301220Kb)\n\nThe new version sports quite a large list of exciting API improvements, as you can see by looking at the extensive documentation of them included with the SDK, both in the stand-alone document *Revit Platform API Changes and Additions.docx* and the section on *What's New* in the Revit API help file `RevitAPI.chm`.\n\nIt also includes a new REX SDK sample:"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"5\"></a>REX SDK FreezeDrawing Sample",
    "local_header_href": "#a-name5arex-sdk-freezedrawing-sample",
    "chunk_text": "#### <a name=\"5\"></a>REX SDK FreezeDrawing Sample\n\nOne important structural part of the Revit SDK is the [REX SDK](http://thebuildingcoder.typepad.com/blog/2015/12/rex-app-development-and-migration.html).\n\nThe 2017.1 version of the REX SDK contains new sample project `DRevitFreezeDrawing` that was created from a discontinued REX module.\n  \nMany thanks to Paweł Madej, Senior Software Engineer in Krakow, Poland, for pointing it out and supplying the following detailed description:\n \n<u>Subject</u>\n\nSeparate a drawing or view from model so that the state of the drawing or view stays unchanged (frozen).\n\n<u>Summary</u>\n\nThis sample contains the discontinued Revit Extensions module Freeze Drawing.\n\nIt enables you to separate a drawing or view from an object model so that its state remains unchanged (frozen) or export it to a DWG file.\n \n<u>REXSDK Values</u>\n\n- Real module with complete UI and help.\n- Fully functional REX module.\n- Presents sample source code for view exporting and importing.\n \n<u>Description</u>\n\nThe extension is based on the Revit DWG Import and DWG Export functionality.\nAll frozen drawings or views are placed in newly created views.\nSelected views are imported to DWG files with user-defined parameters.\nFreezing of drawings does not include 3D views or sheets.\nThe extension also offers options for saving frozen drawings and views on the disk.\n  \n<u>Instructions</u>\n\n- Copy the module to the `...Modules/Category` directory.\n- Open Revit.\n- Define model. \n- Run the extension.\n- Choose the view to be exported or frozen.\n- Press OK to see result and new Drafting View (Detail).\n- From now on, the frozen view will remain  even if the model is changed.\n \n<u>Screen Shots</u>\n\nAfter compilation of the sample modules, the new command is visible at the bottom of the samples list:\n \n<center>\n<img src=\"img/freeze_drawing_1.png\" alt=\"Freeze Drawing command\" width=\"272\">\n</center>\n\nThe main dialogue prompts whether to freeze the current view or selected ones:\n\n<center>\n<img src=\"img/freeze_drawing_2.png\" alt=\"Freeze Drawing main dialogue\" width=\"488\">\n</center>\n\nThe view selection form looks like this:\n \n<center>\n<img src=\"img/freeze_drawing_3.png\" alt=\"Freeze Drawing view selection form\" width=\"484\">\n</center>\n\nThanks again to Paweł for pointing it out!\n\n<!----"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"4\"></a>Forge Accelerator Topics",
    "local_header_href": "#a-name4aforge-accelerator-topics",
    "chunk_text": "#### <a name=\"4\"></a>Forge Accelerator Topics\n\n"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"5\"></a>House Configurator Approaches",
    "local_header_href": "#a-name5ahouse-configurator-approaches",
    "chunk_text": "#### <a name=\"5\"></a>House Configurator Approaches\n\nTwo completely different approaches toward the implementation of a web or Forge based house configurator, a la IKEA for a house:\n    \nestonia - rhino &rarr; threejs &rarr; revit\n\nbelgium - aggregation sample https://forge.autodesk.io"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"6\"></a>Neo4j",
    "local_header_href": "#a-name6aneo4j",
    "chunk_text": "#### <a name=\"6\"></a>Neo4j\n\n[Neo4j](https://neo4j.com/)\n\n[document-based or graph database, MongoDB vs Neo4j](http://stackoverflow.com/questions/14793335/should-i-go-for-document-based-or-graph-database-mongodb-vs-neo4j)\n\nRevit centric TBI Voorbij pre-cast factory design to fabrication process: part 4 of this video, Jos Mulkens and Jeroen Pat from TBI \n\nhttp://au.autodesk.com/au-online/classes-on-demand/class-catalog/2015/class-detail/11913#chapter=0\n\nLeo van Ruijven thought leader - http://www.iso.org/iso/catalogue_detail.htm?csnumber=57859\n\n<center>\n</center>\n---->"
  },
  {
    "original_filename": "1493_au_2017_1_sdk_freeze",
    "header_text": "<a name=\"6\"></a>Determining the Height of a Column",
    "local_header_href": "#a-name6adetermining-the-height-of-a-column",
    "chunk_text": "#### <a name=\"6\"></a>Determining the Height of a Column\n\nThere is no API query or property to retrieve the length of a column directly, because it depends on the column type and its relationships with other objects.\n\nHere are two alternative approaches suggested by Jim Jia.\n\nThis method uses the bottom and top level parameters to calculate the length of a vertical column:\n\n<pre class=\"code\">\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;Determine&nbsp;the&nbsp;height&nbsp;of&nbsp;a&nbsp;vertical&nbsp;column&nbsp;from&nbsp;</span>\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;its&nbsp;top&nbsp;and&nbsp;bottom&nbsp;level.</span>\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;/</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:#2b91af;\">Double</span>&nbsp;GetColumHeightFromLevels(&nbsp;\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Element</span>&nbsp;e&nbsp;)&nbsp;\n{\n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;!IsColumn(&nbsp;e&nbsp;)&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">throw</span>&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ArgumentException</span>(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;Expected&nbsp;a&nbsp;column&nbsp;argument.&quot;</span>&nbsp;);\n&nbsp;&nbsp;}\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc&nbsp;=&nbsp;e.Document;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">double</span>&nbsp;height&nbsp;=&nbsp;0;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;e&nbsp;!=&nbsp;<span style=\"color:blue;\">null</span>&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Get&nbsp;top&nbsp;level&nbsp;of&nbsp;the&nbsp;column</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;topLevel&nbsp;=&nbsp;e.get_Parameter(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.FAMILY_TOP_LEVEL_PARAM&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementId</span>&nbsp;ip&nbsp;=&nbsp;topLevel.AsElementId();\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Level</span>&nbsp;top&nbsp;=&nbsp;doc.GetElement(&nbsp;ip&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">Level</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">double</span>&nbsp;t_value&nbsp;=&nbsp;top.ProjectElevation;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Get&nbsp;base&nbsp;level&nbsp;of&nbsp;the&nbsp;column&nbsp;</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;BotLevel&nbsp;=&nbsp;e.get_Parameter(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.FAMILY_BASE_LEVEL_PARAM&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementId</span>&nbsp;bip&nbsp;=&nbsp;BotLevel.AsElementId();\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Level</span>&nbsp;bot&nbsp;=&nbsp;doc.GetElement(&nbsp;bip&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">Level</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">double</span>&nbsp;b_value&nbsp;=&nbsp;bot.ProjectElevation;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;At&nbsp;this&nbsp;point,&nbsp;there&nbsp;are&nbsp;a&nbsp;number&nbsp;of&nbsp;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;additional&nbsp;Z&nbsp;offsets&nbsp;that&nbsp;may&nbsp;also&nbsp;affect</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;the&nbsp;result.</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;=&nbsp;(&nbsp;t_value&nbsp;-&nbsp;b_value&nbsp;);\n&nbsp;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;height;\n}\n</pre>\n\nIn this approach, a number of Z offset parameters on the column instance may affect the final result.\n\nThe second method retrieves the column bounding box and uses its maximum and minimum coordinates to determine its height:\n\n<pre class=\"code\">\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;Determine&nbsp;the&nbsp;height&nbsp;of&nbsp;any&nbsp;given&nbsp;element&nbsp;</span>\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;from&nbsp;its&nbsp;bounding&nbsp;box.</span>\n<span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;/</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:#2b91af;\">Double</span>&nbsp;GetElementHeightFromBoundingBox(&nbsp;\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Element</span>&nbsp;e&nbsp;)\n{\n&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;No&nbsp;need&nbsp;to&nbsp;retrieve&nbsp;the&nbsp;full&nbsp;element&nbsp;geometry.</span>\n&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Even&nbsp;if&nbsp;there&nbsp;were,&nbsp;there&nbsp;would&nbsp;be&nbsp;no&nbsp;need&nbsp;to&nbsp;</span>\n&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;compute&nbsp;references,&nbsp;because&nbsp;they&nbsp;will&nbsp;not&nbsp;be</span>\n&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;used&nbsp;anyway!</span>\n \n&nbsp;&nbsp;<span style=\"color:green;\">//GeometryElement&nbsp;ge&nbsp;=&nbsp;e.get_Geometry(&nbsp;</span>\n&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;&nbsp;new&nbsp;Options()&nbsp;{&nbsp;</span>\n&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;&nbsp;&nbsp;&nbsp;ComputeReferences&nbsp;=&nbsp;true&nbsp;}&nbsp;);</span>\n&nbsp;&nbsp;<span style=\"color:green;\">//</span>\n&nbsp;&nbsp;<span style=\"color:green;\">//BoundingBoxXYZ&nbsp;boundingBox&nbsp;=&nbsp;ge.GetBoundingBox();</span>\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">BoundingBoxXYZ</span>&nbsp;bb&nbsp;=&nbsp;e.get_BoundingBox(&nbsp;<span style=\"color:blue;\">null</span>&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;<span style=\"color:blue;\">null</span>&nbsp;==&nbsp;bb&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">throw</span>&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ArgumentException</span>(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;Expected&nbsp;Element&nbsp;&#39;e&#39;&nbsp;to&nbsp;have&nbsp;a&nbsp;valid&nbsp;bounding&nbsp;box.&quot;</span>&nbsp;);\n&nbsp;&nbsp;}\n \n&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;bb.Max.Z&nbsp;-&nbsp;bb.Min.Z;\n}\n</pre>\n\nThis approach is more generic and can be used for any geometric BIM element.\n\nFurthermore, the result obtained from the bounding box already takes the column Z offset parameters into account.\n\nMore approaches are possible, e.g., some columns have a location curve, from which its start and end points can be determined.\n\nYou can also query the start and end points of the column's analytical line. Be aware that this may not be in the same location as the physical element.\n\nThanks to Jim for sharing these snippets!\n\nI also added them \nto [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples)\n[release 2017.0.131.1](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2017.0.131.1) in the module  [CmdColumnRound.cs](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/BuildingCoder/CmdColumnRound.cs#L30-L104), cf. the [diff from the previous release](https://github.com/jeremytammik/the_building_coder_samples/compare/2017.0.131.0...2017.0.131.1)."
  }
]