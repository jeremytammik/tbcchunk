[
  {
    "original_filename": "0719_read_csv_add_marker",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0719_read_csv_add_marker",
    "header_text": "Add Reference Points Read From CSV File",
    "local_header_href": "#add-reference-points-read-from-csv-file",
    "chunk_text": "<h3>Add Reference Points Read From CSV File</h3><p>For your convenience and my own future reference, here is a summary of a recent \n\n<a href=\"http://forums.autodesk.com/t5/Autodesk-Revit-API/reading-a-csv-file-code-evolved/td-p/3303833\">\nconversation</a> with \n\nDermott Mcmeel and a pointer to his\n\n<a href=\"http://vimeo.com/36167862\">\nvideo of the resulting add-in in action</a>.\n\n<p><strong>Question:</strong> I'm using this\n\n<a href=\"http://nmillerarch.blogspot.com/2010/01/streaming-grasshopper-points-into-revit.html\">\nwicked tutorial</a>\n\nas a basis for a plug-in that will read info out of a CSV file. \nHowever, it's a few years old and from what I gather some of the definitions have been redefined our outdated. \nI've done the 'First Revit API plug-in tutorial' and am stoked about my success. \nBut I'm new to VB and C#, so I was wondering if anyone has updated info? \nOr could point out changes and where updated info might be found?\n\n<p><strong>Answer:</strong> I converted the \n\n<a href=\"http://nmillerarch.blogspot.com/2010/01/streaming-grasshopper-points-into-revit.html\">\nVB code to read a CSV file and generate Revit reference points</a> to\n\nC# for you:\n\n<pre class=\"code\">\n  <span class=\"blue\">string</span> filepath = <span class=\"maroon\">\"insert file path here\"</span>;\n \n  <span class=\"blue\">if</span>( <span class=\"teal\">File</span>.Exists( filepath ) )\n  {\n    <span class=\"teal\">StreamReader</span> s = <span class=\"blue\">new</span> <span class=\"teal\">StreamReader</span>( \n      filepath );\n \n    <span class=\"blue\">while</span>( -1 != s.Peek() )\n    {\n      <span class=\"blue\">string</span> line = s.ReadLine();\n \n      <span class=\"blue\">string</span>[] data = line.Split( \n        <span class=\"blue\">new</span> <span class=\"blue\">char</span>[] { <span class=\"maroon\">','</span> } );\n \n      <span class=\"teal\">XYZ</span> p = app.Create.NewXYZ( \n        <span class=\"blue\">double</span>.Parse( data[0] ), \n        <span class=\"blue\">double</span>.Parse( data[1] ), \n        <span class=\"blue\">double</span>.Parse( data[2] ) );\n \n      <span class=\"teal\">ReferencePoint</span> rp = doc.FamilyCreate\n        .NewReferencePoint( p );\n    }\n  }\n</pre>\n<p><strong>Response:</strong> The code is very much appreciated. \nI am however having some trouble pasting it into the right context... \n\n<p>I've tried some remedial trouble shooting, but as I fix one error it creates another one. \n\n<p>I pasted the code straight into a blank C# class library template (as per Revit API tutorial 1) but get lots of errors – I assume I'm making a stupid mistake in the syntax but can't figure it out. \nAny help appreciated... and again thanks for the helping hand.\n\n<p><strong>Answer:</strong> Please work through one of the getting started tutorials first, before even thinking about CSV:\n\n<ul>\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/10/getting-started-with-the-revit-2012-api.html\">\nGetting started with the Revit API</a>\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/01/preparing-for-a-hands-on-revit-api-training.html\">\nPreparing for a hands on Revit API training</a>\n</li></li></ul>\n<p>Then you will have a reliable working skeleton in place and almost certainly gotten a better hang of it.\n\n<p><strong>Response:</strong> Thanks for all your help!\n\n<p>See the results:</p>\n<iframe allowfullscreen=\"\" frameborder=\"0\" height=\"253\" mozallowfullscreen=\"\" src=\"http://player.vimeo.com/video/36167862?title=0&amp;byline=0&amp;portrait=0\" webkitallowfullscreen=\"\" width=\"400\"></iframe>\n<p><a href=\"http://vimeo.com/36167862\">Revit API for CSV reading</a> from <a href=\"http://vimeo.com/user2916257\">Dermott Mcmeel</a> on <a href=\"http://vimeo.com\">Vimeo</a>.</p>\n<p><strong>Answer:</strong> For the sake of completeness, here is \n\n<a href=\"zip/ReadCsvPoints.zip\">\nReadCsvPoints.zip</a> containing\n\nJeremy's C# version (and complete Visual Studio solution with add-in manifest) of an add-in to read point data from a CSV file and generate Revit reference points from it, and a snapshot of Dermott's\n\n<a href=\"zip/ReadCsvPointsDm.cs\">\nWIP C# code</a> (work in progress).\n\n<p>Many thanks to Dermott for the interesting topic, his research, and sharing the code!\n\n</p></p></p></p></p></p></p></p></p></p></p>"
  }
]