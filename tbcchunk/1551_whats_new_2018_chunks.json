[
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- <script src=\"run_prettify.js\" type=\"text/javascript\"></script> --> \n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\nWhat's New in the Revit 2018 API #RevitAPI @AutodeskRevit #aec #bim #dynamobim @AutodeskForge http://bit.ly/rvt2018apinews\nPython Automatic HTML Heading Numbering Script #RevitAPI @AutodeskRevit #aec #bim #dynamobim @AutodeskForge @python_devv @html5doctor http://bit.ly/py_html_heading_numbering\n\nThe Revit 2018 includes numerous exciting enhancements for add-in developers.\nThe What's New section always provides very important information, both for discovering and exploring the newly added API functionality and for later reference.\nIf you encounter any issues migrating your existing add-ins between different versions, this is one of the first places to look...\n\n-->"
  },
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "What's New in the Revit 2018 API",
    "local_header_href": "#whats-new-in-the-revit-2018-api",
    "chunk_text": "### What's New in the Revit 2018 API\n\nThe Revit 2018 API includes numerous exciting enhancements for add-in developers.\n\nThe highlights were pointed out in\nthe [DevDays Online API news](http://thebuildingcoder.typepad.com/blog/2017/03/revitlookup-enhancements-future-revit-and-other-api-news.html) presentation\nand video recording.\n\nThat information is based on the contents of the *Revit Platform API Changes and Additions.docx* document included with\nthe [Revit 2018 software developers kit](http://thebuildingcoder.typepad.com/blog/2017/04/revitlookup-2018-and-forge-devcon-cfp.html#2) or \nSDK available from \nthe [Revit Developer Centre](http://www.autodesk.com/developrevit).\n\nIt is also provided in the section on *What's New* in the Revit 2018 API help file `RevitAPI.chm` included with the SDK:\n\n<center>\n<img src=\"img/revit_2018_api_help.png\" alt=\"Revit 2018 API help on What's New\" width=\"512\"/>\n</center>\n\nFor convenient, easy and effective web searching, this blog post provides an online version of that information.\n\nThe *What's New* section always provides very important information, both for discovering and exploring the newly added API functionality and for later reference.\n\nIf you encounter any issues migrating your existing add-ins between different versions, this is one of the first places to look.\n\nFor detailed information on all other aspects of the Revit API, please refer to the rest of the API documentation and samples provided in the SDK.\n\nThe most important things to install and always keep at hand are:\n\n- The Revit API help file `RevitAPI.chm`\n- The Visual Studio solution containing all the SDK samples, `Samples\\SDKSamples.sln`\n\nYou will need both of these constantly for research on how to solve specific Revit API programming tasks.\n\nMore in-depth official explanations and background information is provided by the\nonline [Revit API Developers Guide](http://help.autodesk.com/view/RVT/2018/ENU/?guid=GUID-F0A122E0-E556-4D0D-9D0F-7E72A9315A42) included \nin the [Revit 2018 Help](http://help.autodesk.com/view/RVT/2018/ENU)."
  },
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "<a name=\"0\"></a>What's New in Previous Versions",
    "local_header_href": "#a-name0awhats-new-in-previous-versions",
    "chunk_text": "#### <a name=\"0\"></a>What's New in Previous Versions\n\nHere are links to discussions of *What's New in the Revit API* for previous versions:\n\n- [What's New in the Revit 2010 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2010-api.html)\n- [What's New in the Revit 2011 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2011-api.html)\n- [What's New in the Revit 2012 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2012-api.html)\n- [What's New in the Revit 2013 API](http://thebuildingcoder.typepad.com/blog/2013/03/whats-new-in-the-revit-2013-api.html)\n- [What's New in the Revit 2014 API](http://thebuildingcoder.typepad.com/blog/2013/04/whats-new-in-the-revit-2014-api.html)\n- [What's New in the Revit 2015 API](http://thebuildingcoder.typepad.com/blog/2014/04/whats-new-in-the-revit-2015-api.html)\n- [What's New in the Revit 2016 API](http://thebuildingcoder.typepad.com/blog/2015/04/whats-new-in-the-revit-2016-api.html)\n- [What's New in the Revit 2017 API](http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html)\n- [What's New in the Revit 2017.1 API](http://thebuildingcoder.typepad.com/blog/2016/11/whats-new-in-the-revit-20171-api.html)"
  },
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "<a name=\"1\"></a>Table of Contents",
    "local_header_href": "#a-name1atable-of-contents",
    "chunk_text": "### <a name=\"1\"></a>Table of Contents\n\nI implemented\nthe [Python script `number_html_headings.py` described below](#4) to\ngenerate the HTML heading numbering for this table of contents:\n\n- [API changes](#2)\n    - [API enabled in perspective views](#2.1)\n        - [Element modifications and contextual commands](#2.1.1)\n        - [External commands and applications](#2.1.2)\n    - [Subelements](#2.2)\n        - [References and selection of subelements](#2.2.3)\n    - [Changes to APIs for accessing version](#2.3)\n    - [Asset API Changes](#2.4)\n    - [Dynamic Updaters on Reload Latest](#2.5)\n    - [Export to DWG/DXF API change](#2.6)\n    - [UIDocument.PromptForFamilyInstancePlacement() behavioral change](#2.7)\n    - [IndependentTag API changes](#2.8)\n    - [Shared Coordinates API changes](#2.9)\n    - [New DirectShape behaviors](#2.10)\n    - [Rebar API Changes](#2.11)\n    - [FabricSheet API Changes](#2.12)\n    - [Structural Section API Changes](#2.13)\n    - [ElectricalSystem API changes](#2.14)\n    - [Pipe Pressure Loss Calculation change](#2.15)\n    - [Corrected names of AutoRouteFailures values](#2.16)\n    - [Obsolete API removal](#2.17)\n        - [Classes](#2.17.4)\n        - [Methods](#2.17.5)\n        - [Properties](#2.17.6)\n        - [Enumerated types](#2.17.7)\n- [API additions](#3)\n    - [API to get list of reviewable warnings from a Document](#3.18)\n    - [API access to FamilyInstance references](#3.19)\n    - [Multistory Stairs API](#3.20)\n        - [Railings API additions related to MultistoryStairs](#3.20.8)\n    - [Dimension API additions](#3.21)\n        - [DimensionEqualityLabelFormating API](#3.21.9)\n        - [UnitsFormatOptions in DimensionType](#3.21.10)\n        - [OrdinateDimensionSetting](#3.21.11)\n    - [SpatialElementTag API additions](#3.22)\n    - [Geometry API additions](#3.23)\n        - [Surface and Face API](#3.23.12)\n        - [RevolvedSurface API](#3.23.13)\n        - [RuledSurface API](#3.23.14)\n    - [Level API addition](#3.24)\n    - [Dockable Frame API Additions](#3.25)\n    - [DirectContext3D for display of externally managed 3D graphics in Revit](#3.26)\n        - [View update for DirectContext3D](#3.26.15)\n    - [Coordination Model elements](#3.27)\n    - [Shared Coordinates API additions](#3.28)\n        - [Acquire and Publish coordinates API additions](#3.28.16)\n        - [SiteLocation API additions](#3.28.17)\n        - [ProjectLocation API additions](#3.28.18)\n        - [Revit Link API additions](#3.28.19)\n    - [Link API additions](#3.29)\n        - [External Resource framework additions](#3.29.20)\n        - [CADLinkType additions](#3.29.21)\n        - [ImportInstance additions](#3.29.22)\n        - [IFC Link API additions](#3.29.23)\n    - [Workshared operation progress changed events](#3.30)\n        - [WorksharedOperationProgressChangedEventArgs](#3.30.24)\n        - [DocumentSaveToLocalProgressChangedEventArgs](#3.30.25)\n        - [DataTransferProgressChangedEventArgs](#3.30.26)\n        - [DocumentReloadLatestProgressChangedEventArgs](#3.30.27)\n        - [DocumentSaveToCentralProgressChangedEventArgs](#3.30.28)\n        - [CreateRelatedFileProgressChangedEventArgs](#3.30.29)\n    - [Events related to linked resources](#3.31)\n        - [LinkedResourceOpeningEventArgs](#3.31.30)\n        - [LinkedResourceOpenedEventArgs](#3.31.31)\n    - [Events related to parallel View Export](#3.32)\n    - [DWG export API additions](#3.33)\n        - [ExportDWGSettings API additions](#3.33.32)\n    - [Part API additions](#3.34)\n    - [Freeform Rebar API additions](#3.35)\n    - [Custom Service for Freeform Rebar Definition](#3.36)\n    - [HVACSpaceType and Space air ventilation API](#3.37)\n    - [Energy Analysis API additions](#3.38)\n    - [Electrical API additions](#3.39)\n        - [Electrical Circuit Path API](#3.39.33)\n        - [PanelScheduleView API](#3.39.34)\n    - [MEPAnalyticalConnection API additions](#3.40)\n    - [Fabrication API additions](#3.41)\n        - [Hanger Rod additions](#3.41.35)\n        - [Placing and splitting fabrication parts](#3.41.36)\n        - [Fabrication Part export additions](#3.41.37)\n        - [Fabrication Part status additions](#3.41.38)\n        - [Fabrication part comparison](#3.41.39)\n        - [Fabrication Part ancillary usage additions](#3.41.40)\n        - [Fabrication Part custom data additions](#3.41.41)\n        - [FabricationConfiguration additions](#3.41.42)\n        - [Routing exclusions additions](#3.41.43)\n        - [FabricationServiceButton addition](#3.41.44)\n\n\n<center>\n<div style=\"border-style:solid; border-width:2px 0px 2px 0px\">\n<a name=\"2\"></a><h3 style=\"font-weight: bold\">API Changes</h3>\n</div>\n</center>\n\n<a name=\"2.1\"></a><h2>API enabled in perspective views</h2>\n\n<a name=\"2.1.1\"></a><h3>Element modifications and contextual commands</h3>\n\n<p>Modification of many different object types is now allowed in perspective views. Most commands allowed in 3D orthographic views are now also allowed in perspective views. This includes contextual commands. Annotations are an exception and cannot be created in perspective views. </p>\n\n<a name=\"2.1.2\"></a><h3>External commands and applications</h3>\n<p>External API commands and applications are now enabled by default in perspective views. The following behavior applies:</p>\n<ul>\n<li>Any external command that was automatically disabled by Revit when a perspective view is active will now be active.  No code changes are necessary to make this happen.</li>\n<li>Any external command that was explicitly disabled in perspective views will remain disabled. For example, if your command has an accessibility function limiting it to use in certain view types, the command will not be accessible in perspective views unless that function accepts ViewType.ThreeD as a view type that is allowed.</li>\n<li>Macros, the Macro Manager tools, Dynamo scripts and the Dynamo editor are also newly enabled when a perspective view is active.</li>\n</ul>\n\n\n<a name=\"2.2\"></a><h2>Subelements</h2>\n\n\n<p>Several Revit elements can now contain a subdivision known as a Subelement.   Subelements provide a way for parts of an element to behave as though they were real elements without incurring the overhead of adding more full elements to the model.</p>\n<p>Many Revit features &ndash; for example parameters, schedules, and tags &ndash; were designed to operate on Elements. As a result, the Revit code needs to represent objects as Elements for them to participate in those features. This can lead to scalability problems, because every Element adds overhead and adding many Elements may decrease the performance of the model.  </p>\n<p>An alternative is to use Subelements. An element can expose a set of \"Subelements\" that it contains, specifying characteristics like their category and parameters, and certain Revit capabilities will treat those Subelements the same as ordinary Elements.  For example, a Subelement may contribute geometry to the main element and may be able to be selected independently of its parent Element.  It will possibly have its own (settable) type as well as an assigned category which can be different from its parent Element.</p>\n<p>In the API, the new Subelement class is used to refer to either an Element or a specific subelement of a given Element.   It is typically directly related to a Reference to either the Element or the specific subelement.</p>\n<p>Note that creation of new Subelements for a given element is not done generically.  Instead, the given Element may provide the ability to modify its definition, resulting in the creation of new Subelements.</p>\n<p>Examples of Elements which may incorporate Subelements in practice include:</p>\n<ul>\n<li>Rebar</li>\n<li>RebarContainer</li>\n<li>FabricSheet</li>\n<li>Stairs elements which make up MultistoryStairs elements</li>\n<li>Railing</li>\n<li>ContinuousRail</li>\n</ul>\n<p>To get access to a particular Subelement, you may use any of the following:</p>\n<ul>\n<li>Subelement.Create()</li>\n<li>Subelement.IsValidSubelementReference()</li>\n<li>Document.GetSubelement(Reference) &ndash; Gets the subelement referenced by the input reference.</li>\n<li>Document.GetSubelement(String uniqueId) &ndash; Gets the subelement referenced by a unique id string.</li>\n<li>Element.GetSubelements() &ndash; Returns the collection of the Element's Subelements.</li>\n</ul>\n<p>To access the basic Subelement properties, including its category and geometry, use:</p>\n<ul>\n<li>Subelement.GetBoundingBox()</li>\n<li>Subelement.GetGeometryObject()</li>\n<li>Subelement.IsModifiable()</li>\n<li>Subelement.Document</li>\n<li>Subelement.Element</li>\n<li>Subelement.Category</li>\n<li>Subelement.GetReference()</li>\n<li>Subelement.UniqueId</li>\n<li>ExportUtils.GetExportId(Subelement)</li>\n</ul>\n<p>To access the Subelement's type, use:</p>\n<ul>\n<li>Subelement.TypeId</li>\n<li>Subelement.ChangeTypeId()</li>\n<li>Subelement.GetValidTypes()</li>\n<li>Subelement.IsValidType()</li>\n<li>Subelement.CanHaveTypeAssigned()</li>\n</ul>\n<p>To access the Subelement's parameters, use:</p>\n<ul>\n<li>Subelement.GetAllParameters()</li>\n<li>Subelement.GetParameterValue()</li>\n<li>Subelement.SetParameterValue()</li>\n<li>Subelement.IsParameterModifiable()</li>\n<li>Subelement.HasParameter()</li>\n</ul>\n<p>For Elements which allow deletion of individual Subelements, use:</p>\n<ul>\n<li>Element.DeleteSubelement()</li>\n<li>Element.DeleteSubelements()</li>\n<li>Element.CanDeleteSubelement()</li>\n</ul>\n\n\n<a name=\"2.2.3\"></a><h3>References and selection of subelements</h3>\n\n\n<p>The new enumerated value:</p>\n<ul>\n<li>ObjectType.Subelement</li>\n</ul>\n<p>provides the ability to prompt a user to select subelements interactively using Selection.PickObject() or Selection.PickObjects().</p>\n<p>The new enumerated value:</p>\n<ul>\n<li>ElementReferenceType.REFERENCE_TYPE_SUBELEMENT</li>\n</ul>\n<p>identify a reference as a reference to a specific subelement.</p>\n<p>The new methods:</p>\n<ul>\n<li>Reference.EqualTo()</li>\n<li>Reference.Contains()</li>\n</ul>\n<p>provide useful checks related to the contents of a given Reference object, applicable to subelement references as well as other types of references.</p>\n\n\n<a name=\"2.3\"></a><h2>Changes to APIs for accessing version</h2>\n\n\n<p>The property:</p>\n<ul>\n<li>Application.IsSubscriptionUpdate</li>\n</ul>\n<p>has been deprecated and replaced by:</p>\n<ul>\n<li>Application.SubVersionNumber</li>\n</ul>\n<p>The new property returns a string representing the major-minor version number for the Revit application. For example, \"2018.0.0\".  This number is updated for major and minor updates. </p>\n<p>In RevitAddinUtility, the similar property:</p>\n<ul>\n<li>RevitProduct.IsSubscriptionUpdate</li>\n</ul>\n<p>has been deprecated and replaced by:</p>\n<ul>\n<li>RevitProduct.ReleaseSubVersion</li>\n</ul>\n<p>This new string property returns a similar major-minor version number for installed Revit versions.</p>\n\n\n<a name=\"2.4\"></a><h2>Asset API Changes</h2>\n\n\n<p>The following API classes moved from the Autodesk.Revit.Utility namespace to a new namespace Autodesk.Revit.DB.Visual:</p>\n<ul>\n<li>AssetProperty</li>\n<li>AssetProperties</li>\n<li>Asset</li>\n<li>AssetSet</li>\n<li>AssetType</li>\n<li>AssetPropertyType</li>\n<li>AssetPropertyDouble</li>\n<li>AssetPropertyDoubleArray2d</li>\n<li>AssetPropertyDoubleArray3d</li>\n<li>AssetPropertyDoubleArray4d</li>\n<li>AssetPropertyDoubleMatrix44</li>\n<li>AssetPropertyFloat</li>\n<li>AssetPropertyFloatArray</li>\n<li>AssetPropertyInt64</li>\n<li>AssetPropertyUInt64</li>\n<li>AssetPropertyBoolean</li>\n<li>AssetPropertyDistance</li>\n<li>AssetPropertyEnum</li>\n<li>AssetPropertyReference</li>\n<li>AssetPropertyString</li>\n<li>AssetPropertyTime</li>\n<li>AssetPropertyList</li>\n</ul>\n\n<p>Two AssetProperty properties were deprecated and replaced:</p>\n\n<ul>\n<li>Deprecated &rarr; Replacement (new methods)</li>\n<li>AssetPropertyDouble3.Value &rarr; IList&lt;double&gt; APropertyDouble3::GetValueAsDoubles() and XYZ APropertyDouble3::GetValueAsXYZ()</li>\n<li>AssetPropertyDouble4.Value &rarr; IList&lt;double&gt; APropertyDouble4::GetValueAsDoubles()</li>\n</ul>\n\n<p>Values for the enumerated type AssetPropertyType were renamed to better adhere to the API standards. Note that corresponding integer values are the same:</p>\n\n<ol start=\"0\">\n<li>APT_Unknown &rarr; Unknown</li>\n<li>APT_Properties &rarr; Properties</li>\n<li>APT_Boolean &rarr; Boolean</li>\n<li>APT_Enum &rarr; Enumeration</li>\n<li>APT_Integer &rarr; Integer</li>\n<li>APT_Float &rarr; Float</li>\n<li>APT_Double &rarr; Double1</li>\n<li>APT_DoubleArray2d &rarr; Double2</li>\n<li>APT_DoubleArray3d &rarr; Double3</li>\n<li>APT_DoubleArray4d &rarr; Double4</li>\n<li>APT_Double44 &rarr; Double44</li>\n<li>APT_String &rarr; String</li>\n<li>APT_Time &rarr; Time</li>\n<li>N/A</li>\n<li>APT_Distance &rarr; Distance</li>\n<li>APT_Asset &rarr; Asset</li>\n<li>APT_Reference &rarr; Reference</li>\n<li>APT_Int64 &rarr; Longlong</li>\n<li>APT_UInt64 &rarr; ULonglong</li>\n<li>APT_List &rarr; List</li>\n<li>APT_FloatArray &rarr; Float3</li>\n</ol>\n\n\n<a name=\"2.5\"></a><h2>Dynamic Updaters on Reload Latest</h2>\n\n\n<p>Dynamic updaters are now triggered on Reload Latest for the elements added or changed in the central file.</p>\n\n\n<a name=\"2.6\"></a><h2>Export to DWG/DXF API change</h2>\n\n\n<p>The new AutoCAD version (R2018) has been added to the ACADVersion enumerated type.  This is now the default version used when exporting to DWG and DXF.  </p>\n\n\n<a name=\"2.7\"></a><h2>UIDocument.PromptForFamilyInstancePlacement() behavioral change</h2>\n\n\n<p>The behavior for UIDocument.PromptForFamilyInstancePlacement() was changed to be same as that of PickObject() methods &ndash; the placement operation will be cancelled when the \"x\" button of Revit is clicked during the placement operation instead of closing Revit directly.</p>\n\n\n<a name=\"2.8\"></a><h2>IndependentTag API changes</h2>\n\n\n<p>The new method:</p>\n<ul>\n<li>IndependentTag.Create()</li>\n</ul>\n<p>replaces Autodesk.Revit.Creation.Document.NewTag(), which has been marked obsolete.  The new version supports tagging of either elements or subelements.</p>\n<p>The new method:</p>\n<ul>\n<li>IndependentTag.GetTaggedReference()</li>\n</ul>\n<p>returns a reference to the item which has been tagged.  This reference may be to a Subelement, which can also be identified by:</p>\n<ul>\n<li> IndependentTag.IsTaggedOnSubelement()</li>\n</ul>\n<p>The following properties and their methods now throw more informative exceptions:</p>\n<ul>\n<li>IndependentTag.LeaderElbow:</li>\n<ul>\n<li>IndependentTag.GetLeaderElbow() &ndash; \"The tag does not have a leader or its leader is straight.\"</li>\n<li>IndependentTag.SetLeaderElbow() &ndash; \"The tag does not have a leader.\"</li>\n</ul>\n<li>IndependentTag.LeaderEnd:</li>\n<ul>\n<li>IndependentTag.GetLeaderEnd() &ndash; \"There is no leader end because the tag does not use a free end leader.\"</li>\n<li>IndependentTag.SetLeaderEnd() &ndash; \"There is no leader end because the tag does not use a free end leader.\"</li>\n</ul>\n</ul>\n<p>The new property:</p>\n<ul>\n<li>IndependentTag.HasElbow</li>\n</ul>\n<p>indicates if the leader of the tag has an elbow point or not.</p>\n\n\n<a name=\"2.9\"></a><h2>Shared Coordinates API changes</h2>\n\n\n<p>The following properties have been deprecated and replaced:</p>\n\n<ul>\n<li>Deprecated member &rarr; New/replacement member</li>\n<li>ProjectLocation.ProjectPosition &rarr; ProjectLocation.GetProjectPosition() and ProjectLocation.SetProjectPosition()</li>\n<li>ProjectLocation.SiteLocation &rarr; ProjectLocation.GetSiteLocation()</li>\n</ul>\n\n\n<a name=\"2.10\"></a><h2>New DirectShape behaviors</h2>\n\n\n<p>DirectShape elements now support new behaviors.  Other than the limitations listed below, no code changes are required to enable these new behaviors for DirectShape elements.</p>\n<ul>\n<li>Tagging &ndash; if the element's assigned category supports tagging and a tag type exists, the DirectShape can be tagged with Revit tagging tools. </li>\n<li>Edge dimensions &ndash; if the DirectShape is referenceable, it will now support dimensioning to edge references as well as face references.</li>\n<li>Connector elements &ndash; in families, if the DirectShape is referenceable, DirectShape planar faces can be used to host connector elements.</li>\n<li>Rebar hosting &ndash; if the DirectShape is of any of the following categories it can now act as a host for rebar:</li>\n<ul>\n<li>OST_StructuralFraming</li>\n<li>OST_StructuralColumns</li>\n<li>OST_StructuralFoundation</li>\n<li>OST_StructuralConnections</li>\n<li>OST_Walls</li>\n<li>OST_Floors</li>\n<li>OST_EdgeSlab</li>\n<li>OST_Parts</li>\n<li>OST_Stairs</li>\n<li>OST_GenericModels</li>\n</ul>\n</ul>\n\n\n<a name=\"2.11\"></a><h2>Rebar API Changes</h2>\n\n\n<p>Rebar now supports two different layout options: shape-driven and free-form.  Previously, all Rebar elements were shape-driven.  The new methods:</p>\n<ul>\n<li>Rebar.GetShapeDrivenAccessor() &ndash; Returns the Shape Driven interface which exposes specific Shape Driven logic.</li>\n<li>Rebar.GetFreeFormAccessor() &ndash; Returns the Free Form interface which exposes specific Free Form logic.</li>\n<li>Rebar.IsRebarFreeForm &ndash; Returns true if the rebar is free form and false if shape driven.</li>\n<li>Rebar.IsRebarShapeDriven &ndash; Returns true if the rebar is shape driven and false if free form.</li>\n</ul>\n<p>Rebar members which are applicable only for shape-driven rebar have been deprecated and replaced with equivalents in the class RebarShapeDrivenAccessor.  Specifically, the following members are deprecated:</p>\n\n<ul>\n<li>Deprecated member &rarr; Replacement method</li>\n<li>Rebar.GetDistributionPath() &rarr; RebarShapeDrivenAccessor.GetDistributionPath()</li>\n<li>Rebar.ComputeDrivingCurves() &rarr; RebarShapeDrivenAccessor.ComputeDrivingCurves()</li>\n<li>Rebar.GetBarPositionTransform() &rarr; RebarShapeDrivenAccessor.GetBarPositionTransform()</li>\n<li>Rebar.ScaleToBox() &rarr; RebarShapeDrivenAccessor.ScaleToBox()</li>\n<li>Rebar.ScaleToBoxFor3D() &rarr; RebarShapeDrivenAccessor.ScaleToBoxFor3D()</li>\n<li>Rebar.SetLayoutAsSingle() &rarr; RebarShapeDrivenAccessor.SetLayoutAsSingle()</li>\n<li>Rebar.SetLayoutAsFixedNumber() &rarr; RebarShapeDrivenAccessor.SetLayoutAsFixedNumber()</li>\n<li>Rebar.SetLayoutAsMaximumSpacing() &rarr; RebarShapeDrivenAccessor.SetLayoutAsMaximumSpacing()</li>\n<li>Rebar.SetLayoutAsNumberWithSpacing() &rarr; RebarShapeDrivenAccessor.SetLayoutAsNumberWithSpacing ()</li>\n<li>Rebar.SetLayoutAsMinimumClearSpacing() &rarr; RebarShapeDrivenAccessor.SetLayoutAsMinimumClearSpacing()</li>\n<li>Rebar.Normal &rarr; RebarShapeDrivenAccessor.Normal</li>\n<li>Rebar.BarsOnNormalSide &rarr; RebarShapeDrivenAccessor.BarsOnNormalSide</li>\n<li>Rebar.Height &rarr; RebarShapeDrivenAccessor.Height</li>\n<li>Rebar.ArrayLength &rarr; RebarShapeDrivenAccessor.ArrayLength</li>\n<li>Rebar.BaseFinishingTurns &rarr; RebarShapeDrivenAccessor.BaseFinishingTurns</li>\n<li>Rebar.MultiplanarDepth &rarr; RebarShapeDrivenAccessor.MultiplanarDepth</li>\n<li>Rebar.TopFinishingTurns &rarr; RebarShapeDrivenAccessor.TopFinishingTurns</li>\n<li>Rebar.Pitch &rarr; RebarShapeDrivenAccessor.Pitch</li>\n<li>Rebar.RebarShapeId &rarr; getter &ndash; Rebar.GetShapeId() and setter &ndash; RebarShapeDrivenAccessor.SetRebarShapeId()</li>\n</ul>\n\n<a name=\"2.12\"></a><h2>FabricSheet API Changes</h2>\n\n\n<p>The following methods have been deprecated and replaced:</p>\n\n<ul>\n<li>Deprecated method &rarr; Replacement method &ndash; Notes</li>\n<li>FabricSheetType.SetLayoutAsCustomPattern(double, double , double , double , IList&lt;FabricWireItem&gt; , IList&lt;FabricWireItem&gt;) &rarr; FabricSheetType.SetLayoutAsCustomPattern(double, double , IList&lt;FabricWireItem&gt; , IList&lt;FabricWireItem&gt;) &ndash; Both end overhangs will now be read only and computed internally.</li>\n<li>FabricWireItem.Create(double distance, double wireLength, ElementId wireType) &rarr; FabricWireItem.Create(double distance, double wireLength, ElementId wireType, double wireOffset) &ndash; Older calls can use the new method with wireOffset set to 0.0.</li>\n</ul>\n\n<a name=\"2.13\"></a><h2>Structural Section API Changes</h2>\n\n<p>Several section properties were moved from subclasses to the base class StructuralSection:</p>\n<ul>\n<li>StructuralSection.ElasticModulusStrongAxis</li>\n<li>StructuralSection.ElasticModulusWeakAxis</li>\n<li>StructuralSection.MomentOfInertiaStrongAxis</li>\n<li>StructuralSection.MomentOfInertiaWeakAxis</li>\n<li>StructuralSection.NominalWeight</li>\n<li>StructuralSection.Perimeter</li>\n<li>StructuralSection.PlasticModulusStrongAxis</li>\n<li>StructuralSection.PlasticModulusWeakAxis</li>\n<li>StructuralSection.PrincipalAxesAngle</li>\n<li>StructuralSection.SectionArea</li>\n<li>StructuralSection.ShearAreaStrongAxis</li>\n<li>StructuralSection.ShearAreaWeakAxis</li>\n<li>StructuralSection.TorsionalModulus</li>\n<li>StructuralSection.TorsionalMomentOfInertia</li>\n<li>StructuralSection.WarpingConstant</li>\n</ul>\n<p>Several specific structural sections offer new constructors with additional input parameters.  Their original constructors have been deprecated.</p>\n<ul>\n<li>StructuralSectionCSlopedFlange</li>\n<li>StructuralSectionISlopedFlange</li>\n<li>StructuralSectionISplitSlopedFlange</li>\n<li>StructuralSectionLAngle</li>\n<li>StructuralSectionStructuralTees</li>\n</ul>\n<p>Several new specific structural section classes have been introduced:</p>\n<ul>\n<li>StructuralSectionGeneralC &ndash; Defines parameters for Channel Cold Formed shape.</li>\n<li>StructuralSectionGeneralCEx &ndash; Defines parameters for Channel with Fold Cold Formed shape.</li>\n<li>StructuralSectionGeneralF &ndash; Defines parameters for Flat Bar.</li>\n<li>StructuralSectionGeneralH &ndash; Defines parameters for Rectangular Pipe structural section.</li>\n<li>StructuralSectionGeneralI &ndash; Defines parameters for general Double T shape.</li>\n<li>StructuralSectionGeneralLA &ndash; Defines parameters for Angle Cold Formed structural section.</li>\n<li>StructuralSectionGeneralLZ &ndash; Defines parameters for Z Cold Formed shape.</li>\n<li>StructuralSectionGeneralR &ndash; Defines parameters for pipes.</li>\n<li>StructuralSectionGeneralS &ndash; Defines parameters for Round Bar structural section.</li>\n<li>StructuralSectionGeneralT &ndash; Defines parameters for Tees shape.</li>\n<li>StructuralSectionGeneralU &ndash; Defines parameters for general Channel shape.</li>\n<li>StructuralSectionGeneralW &ndash; Defines parameters for Angle structural section.</li>\n</ul>\n<p>In addition, the API for structural sections offers a few other new capabilities:</p>\n<ul>\n<li>StructuralSection.GetBoundarySize() &ndash; returns the size of the section boundary.</li>\n<li>StructuralSection.AnalysisParams &ndash; accesses a common set of parameters for structural analysis which can be associated to a section.</li>\n<li>StructuralSection.StructuralSectionGeneralShape &ndash; returns an enumerated value identifying the general shape for the structural section representing geometry only.</li>\n<li>StructuralSectionHotRolled.FlangeThicknessLocation &ndash; this new property has been introduced for this class and the specific sections that derive from it.</li>\n<li>StructuralSectionHotRolled.WebThicknessLocation &ndash; this new property has been introduced for this class and the specific sections that derive from it.</li>\n<li>StructuralSectionUtils.GetStructuralElementDefinitionData() &ndash; returns data defining the section and the position of the structural element.</li>\n</ul>\n\n\n<a name=\"2.14\"></a><h2>ElectricalSystem API changes</h2>\n\n\n<p>The following functions have been deprecated and replaced:</p>\n\n<ul>\n<li>Deprecated member &rarr; New/replacement member</li>\n<li>Autodesk.Revit.Creation.Document.NewElectricalSystem(Connector, ElectricalSystemType) &rarr; ElectricalSystem.Create(Connector, ElectricalSystemType)</li>\n<li>Autodesk.Revit.Creation.Document.NewElectricalSystem(ICollection &lt; ElementId &gt; , ElectricalSystemType) &rarr; ElectricalSystem.Create(Document, IList&lt;ElementId&gt;, ElectricalSystemType)</li>\n</ul>\n\n<a name=\"2.15\"></a><h2>Pipe Pressure Loss Calculation change</h2>\n\n<p>The methods:</p>\n<ul>\n<li>Autodesk.Revit.DB.Plumbing.PipeSettings.GetPressLossCalculationServerInfo()</li>\n<li>Autodesk.Revit.DB.Plumbing.PipeSettings.SetPressLossCalculationServerInfo()</li>\n</ul>\n<p>have been deprecated in Revit 2018 and will be removed in the next version of Revit. Custom pipe pressure loss calculations will no longer be supported. Similar functionality can be accessed by setting Autodesk.Revit.DB.Plumbing.PipeSettings.AnalysisForClosedLoopHydronicPipingNetworks.</p>\n\n\n<a name=\"2.16\"></a><h2>Corrected names of AutoRouteFailures values</h2>\n\n\n<p>The following BuiltInFailures.AutoRouteFailures values were renamed due to spelling errors:</p>\n<ul>\n<li>AttemptToConnectNonSlopingElementToSlopedPipeWarning (renamed from AttemptToComnnectNonSlopingElementToSlopedPipeWarning)</li>\n<li>AttemptToConnectNonSlopingElementToSlopedPipeError (renamed from AttemptToComnnectNonSlopingElementToSlopedPipeError)</li>\n</ul>\n\n\n<a name=\"2.17\"></a><h2>Obsolete API removal</h2>\n\n\n<p>The following API members and classes which had previously been marked Obsolete have been removed in this release.  Consult the API documentation from prior releases for information on the replacements to use:</p>\n\n\n<a name=\"2.17.4\"></a><h3>Classes</h3>\n\n\n<ul>\n<li>Autodesk.Revit.DB.Plumbing.PipeType</li>\n<li>Autodesk.Revit.DB.Structure.FabricSheet.BentFabricWiresOrientation</li>\n<li>Autodesk.Revit.DB.Structure.BentFabricWiresOrientation</li>\n<li>Autodesk.Revit.DB.FormattedTextRun</li>\n<li>Autodesk.Revit.DB.FormatUtils</li>\n<li>Autodesk.Revit.DB.PropertySetLibrary</li>\n</ul>\n\n\n<a name=\"2.17.5\"></a><h3>Methods</h3>\n\n\n<ul>\n<li>Autodesk.Revit.DB.NurbSpline.Create(IList&lt;XYZ&gt;, IList&lt;Double&gt;) : NurbSpline</li>\n<li>Autodesk.Revit.DB.NurbSpline.Create(IList&lt;XYZ&gt;, IList&lt;Double&gt;, IList&lt;Double&gt;, Int32, Boolean, Boolean) : NurbSpline</li>\n<li>Autodesk.Revit.Creation.Application.NewPlane(CurveArray) : Plane</li>\n<li>Autodesk.Revit.Creation.Application.NewPlane(XYZ, XYZ) : Plane</li>\n<li>Autodesk.Revit.Creation.Application.NewPlane(XYZ, XYZ, XYZ) : Plane</li>\n<li>Autodesk.Revit.CurveAPIUtils.CreateNurbSpline(IList&lt;XYZ&gt;, IList&lt;Double&gt;) : NurbSpline</li>\n<li>Autodesk.Revit.CurveAPIUtils.CreateNurbSpline(IList&lt;XYZ&gt;, IList&lt;Double&gt;, IList&lt;Double&gt;, Int32, Boolean, Boolean) : NurbSpline</li>\n<li>Autodesk.Revit.Creation.Document.NewDuct(Connector, Connector, DuctType) : Duct</li>\n<li>Autodesk.Revit.Creation.Document.NewDuct(XYZ, Connector, DuctType) : Duct</li>\n<li>Autodesk.Revit.Creation.Document.NewDuct(XYZ, XYZ, DuctType) : Duct</li>\n<li>Autodesk.Revit.DB.Structure.LoadCase.Create(Document, String, ElementId, LoadNatureCategory) : LoadCase</li>\n<li>Autodesk.Revit.DB.WallFoundation.GetFoundationType() : WallFoundationType</li>\n<li>Autodesk.Revit.DB.WallFoundation.SetFoundationType(WallFoundationType) : Void</li>\n<li>Autodesk.Revit.DB.ViewSchedule.GroupHeaders(Int32, Int32, Int32, Int32) : Void</li>\n<li>Autodesk.Revit.DB.PointClouds.PointCloudOverrides.GetPointCloudOverrideSettings(ElementId, String, Document) : PointCloudOverrideSettings</li>\n<li>Autodesk.Revit.DB.PointClouds.PointCloudOverrides.GetPointCloudOverrideSettings(ElementId) : PointCloudOverrideSettings</li>\n<li>Autodesk.Revit.DB.PointClouds.PointCloudOverrides.SetPointCloudOverrideSettings(ElementId, PointCloudOverrideSettings, String, Document) : Void</li>\n<li>Autodesk.Revit.DB.PointClouds.PointCloudOverrides.SetPointCloudOverrideSettings(ElementId, PointCloudOverrideSettings) : Void</li>\n<li>Autodesk.Revit.DB.DirectShape.CreateElement(Document, ElementId, String, String) : DirectShape</li>\n<li>Autodesk.Revit.DB.DirectShape.CreateElementInstance(Document, ElementId, ElementId, String, Transform, String, String) : DirectShape</li>\n<li>Autodesk.Revit.DB.DirectShape.SetGUIDs(String, String) : Void</li>\n<li>Autodesk.Revit.DB.TextNode.GetFormattedTextRuns() : IList&lt;FormattedTextRun&gt;</li>\n<li>Autodesk.Revit.DB.View.GetVisibility(Category) : Boolean</li>\n<li>Autodesk.Revit.DB.View.SetVisibility(Category, Boolean) : Void</li>\n<li>Autodesk.Revit.Creation.Document.NewFoundationWall(WallFoundationType, Wall) : WallFoundation</li>\n<li>Autodesk.Revit.DB.Ellipse.Create(XYZ, double, double, XYZ, XYZ, double, double) : Ellipse</li>\n</ul>\n\n\n<a name=\"2.17.6\"></a><h3>Properties</h3>\n\n\n<ul>\n<li>Autodesk.Revit.DB.Structure.LoadCase.NatureCategory : LoadNatureCategory</li>\n<li>Autodesk.Revit.DB.Mechanical.MechanicalSystem.Flow : Double</li>\n<li>Autodesk.Revit.DB.Mechanical.MechanicalSystem.StaticPressure : Double</li>\n<li>Autodesk.Revit.DB.Plumbing.PipingSystem.FixtureUnits : Double</li>\n<li>Autodesk.Revit.DB.Plumbing.PipingSystem.Flow : Double</li>\n<li>Autodesk.Revit.DB.Plumbing.PipingSystem.StaticPressure : Double</li>\n<li>Autodesk.Revit.DB.ScheduleField.HasTotals : Boolean</li>\n<li>Autodesk.Revit.DB.Events.DocumentPrintingEventArgs.Settings : IPrintSetting</li>\n<li>Autodesk.Revit.DB.Events.ViewPrintingEventArgs.Settings : IPrintSetting</li>\n<li>Autodesk.Revit.DB.Mechanical.DuctFittingAndAccessoryConnectorData.Coordination : Transform</li>\n<li>Autodesk.Revit.DB.Plumbing.PipeFittingAndAccessoryConnectorData.Coordination : Transform</li>\n<li>Autodesk.Revit.UI.Events.DialogBoxShowingEventArgs.HelpId : Int32</li>\n</ul>\n\n\n<a name=\"2.17.7\"></a><h3>Enumerated types</h3>\n\n\n<ul>\n<li>Autodesk.Revit.DB.Structure.LoadNatureCategory</li>\n<li>Autodesk.Revit.Attributes.TransactionMode.Automatic</li>\n</ul>\n\n\n\n<center>\n<div style=\"border-style:solid; border-width:2px 0px 2px 0px\">\n<a name=\"3\"></a><h3 style=\"font-weight: bold\">API Additions</h3>\n</div>\n</center>\n\n<a name=\"3.18\"></a><h2>API to get list of reviewable warnings from a Document</h2>\n\n\n<p>The new method:</p>\n<ul>\n<li>Document.GetWarnings()</li>\n</ul>\n<p>returns a list of failure messages generated from persistent (reviewable) warnings accumulated in the document.</p>\n\n\n<a name=\"3.19\"></a><h2>API access to FamilyInstance references</h2>\n\n\n<p>The following new methods have been added to enable easy access to FamilyInstance references that correspond to reference planes and reference lines in the family.  Some use the options in the new enumeration FamilyInstanceReferenceType as input to identify \"Strong\" or \"Weak\" references or specific positional references in each of the 3 coordinate directions (as determined by the possible values of parameter \"Is Reference\" of reference planes and parameter \"Reference\" of reference lines in families).</p>\n<ul>\n<li>FamilyInstance.GetReferences()</li>\n<li>FamilyInstance.GetReferenceByName()</li>\n<li>FamilyInstance.GetReferenceType()</li>\n<li>FamilyInstance.GetReferenceName()</li>\n</ul>\n\n\n<a name=\"3.20\"></a><h2>Multistory Stairs API</h2>\n\n\n<p>The new class:</p>\n<ul>\n<li>MultistoryStairs</li>\n</ul>\n<p>allows users to create stairs that span multiple levels.  A multistory stairs element may contain multiple stairs whose extents are governed by base and top levels.</p>\n<p>This element will contain one or more Stairs elements. Stairs elements are either a reference instance which is copied to each level covered by groups of identical stairs instances which share the same level height, or individual Stairs instances which are not connected to a group with the same level height. By default, when adding new levels to the multistory stair, new stairs will be added to the group.</p>\n<p>For groups of duplicate stairs at different levels, the instances can be found as Subelements of the Stairs element.</p>\n<p>Stairs in a connected group can be edited together by modifying the associated Stairs instance. For specific floors that need special designs, stairs can be separated from a group by unpinning the element, changes made to this Stairs will not affect other any other instance in the element, or add the stairs back into the group if needed. However, any changes made to the stair will be lost since the stair's properties will be overridden by the group specifications.</p>\n<p>The class has the following methods:</p>\n<ul>\n<li>MultistoryStairs.AddStairsByLevelIds() &ndash; Adds stairs to the given levels.</li>\n<li>MultistoryStairs.RemoveStairsByLevelIds() &ndash; Removes stairs from the given levels. This will regenerate the multistory stairs from the remaining levels.</li>\n<li>MultistoryStairs.CanAddStair() &ndash; Checks if the input level id can be used to add stairs into multistory stairs.</li>\n<li>MultistoryStairs.CanRemoveStair() &ndash; Checks if the input level id can be used to remove stairs from the multistory stairs.</li>\n<li>MultistoryStairs.GetAllConnectedLevels() &ndash; Gets the ids of all levels connected to the multistory stairs.</li>\n<li>MultistoryStairs.GetAllStairsIds() &ndash; Gets the ids of all of the stairs in the multistory stairs.</li>\n<li>MultistoryStairs.Create() &ndash; Creates a multistory stairs object.</li>\n<li>MultistoryStairs.GetStairsConnectedBaseLevelIds() &ndash; Gets the base level ids for the stairs contained in this multi-story stairs element.</li>\n<li>MultistoryStairs.IsPinned() &ndash; Checks if a stair is pinned as a propagation group.</li>\n<li>MultistoryStairs.Unpin() &ndash; Unpins a story of stairs by giving its base level id.</li>\n<li>MultistoryStairs.Pin() &ndash; Pins a unpinned stairs back into a story of a stairs.</li>\n</ul>\n<p>The new property:</p>\n<ul><li>Stairs.MultistoryStairsId</li></ul>\n<p>indicates the id of the MultistoryStairs element to which the Stairs belong to.</p>\n<p>Related to StairsPath functionality for multistory stairs, the new functions:</p>\n<ul>\n<li>StairsPath.CanCreateOnMultistoryStairs()</li>\n<li>StairsPath.CreateOnMultistoryStairs()</li>\n</ul>\n<p>support creation of new stairs paths in a plan view for stairs instances in a multistory stairs element.</p>\n\n\n<a name=\"3.20.8\"></a><h3>Railings API additions related to MultistoryStairs</h3>\n\n\n<p>The new methods:</p>\n<ul>\n<li>Railing.GetMultistoryStairsPlacementLevels()</li>\n<li>Railing.SetMultistoryStairsPlacementLevels()</li>\n<li>Railing.GetSubelementOnLevel()</li>\n</ul>\n<p>provide access to Railing elements which are hosted on members of Multistory stairs.  </p>\n<p>The method:</p>\n<ul>\n<li>Railing.Create(Document document, ElementId multistoryStairsId, ElementId levelId,  ElementId railingTypeId,  RailingPlacementPosition placePosition)</li>\n</ul>\n<p>Creates new railings on a given level of given multistory stairs &ndash; the created railing will be hosted on stairs included in MultistoryStairs element on given level.  </p>\n<p>The existing method:</p>\n<ul>\n<li>Railing.Create(Document document, ElementId stairsId,  ElementId railingTypeId,  RailingPlacementPosition placePosition)</li>\n</ul>\n<p>now supports MulitstoryStairs elements as input, where the resulting railing will be added on every level of given stairs in multistory stairs.</p>\n<p>The existing property:</p>\n<ul>\n<li>Railing.HostId</li>\n</ul>\n<p>now supports stairs or stairs components coming from MultistoryStairs elements as well. </p>\n\n\n<a name=\"3.21\"></a><h2>Dimension API additions</h2>\n\n\n\n\n<a name=\"3.21.9\"></a><h3>DimensionEqualityLabelFormating API</h3>\n\n\n<p>The new class:</p>\n<ul>\n<li>DimensionEqualityLabelFormatting</li>\n</ul>\n<p>allows users to set dimension equality formulas for continuous linear or angular dimensions.</p>\n<p>New methods and properties include:</p>\n<ul>\n<li>DimensionEqualityLabelFormatting.LeadingSpaces</li>\n<li>DimensionEqualityLabelFormatting.LabelType</li>\n<li>DimensionEqualityLabelFormatting.Prefix</li>\n<li>DimensionEqualityLabelFormatting.Suffix</li>\n<li>DimensionEqualityLabelFormatting.GetFormatOptions()</li>\n<li>DimensionEqualityLabelFormatting.SetFormatOptions()</li>\n</ul>\n<p>The following new methods in DimensionType allow access to equality formulas:</p>\n<ul>\n<li>DimensionType.GetEqualityFormula()</li>\n<li>DimensionType.SetEqualityFormula()</li>\n</ul>\n\n\n<a name=\"3.21.10\"></a><h3>UnitsFormatOptions in DimensionType</h3>\n\n\n<p>The new functions:</p>\n<ul>\n<li>DimensionType.GetUnitsFormatOptions()</li>\n<li>DimensionType.SetUnitsFormatOptions()</li>\n</ul>\n<p>allow users to get or set the FormatOptions for a DimensionType.</p>\n\n\n<a name=\"3.21.11\"></a><h3>OrdinateDimensionSetting</h3>\n\n\n<p>The new class:</p>\n<ul>\n<li>OrdinateDimensionSetting</li>\n</ul>\n<p>allows users to customize ordinate dimensions.</p>\n<p>The new enum:</p>\n<ul>\n<li>OrdinateDimensionLineStyle</li>\n</ul>\n<p>allows users to choose continuous or segmented line styles for their dimensions.</p>\n<p>The new enums:</p>\n<ul>\n<li>OrdinateTextOrientation</li>\n<li>OrdinateTextPosition</li>\n</ul>\n<p>allows users to orient text in relation to the dimension lines or witness lines.</p>\n<p>The new enum:</p>\n<ul>\n<li>OrdinateOriginVisibility</li>\n</ul>\n<p>allows users to control visibility of their dimensions.</p>\n<p>New properties in OrdinateDimensionSetting include:</p>\n<ul>\n<li>OrdinateDimensionSetting.DimLineLength</li>\n<li>OrdinateDimensionSetting.DimLineStyle</li>\n<li>OrdinateDimensionSetting.TextOrientation</li>\n<li>OrdinateDimensionSetting.TextPosition</li>\n<li>OrdinateDimensionSetting.OriginVisibility</li>\n<li>OrdinateDimensionSetting.OriginTickMarkId</li>\n</ul>\n<p>The following new methods in DimensionType allow access to the OrdinateDimensionSetting:</p>\n<ul>\n<li> DimensionType.GetOrdinateDimensionSetting()</li>\n<li> DimensionType.SetOrdinateDimensionSetting()</li>\n</ul>\n\n\n<a name=\"3.22\"></a><h2>SpatialElementTag API additions</h2>\n\n\n<p>SpatialElementTag is the base element for Room, Area and Space tag classes.</p>\n<p>The following new properties have been added:</p>\n<ul>\n<li>SpatialElementTag.HasElbow &ndash; Identifies if the tag's leader has an elbow point or not.</li>\n<li>SpatialElementTag.TagText &ndash; The text displayed by the tag.</li>\n</ul>\n\n\n<a name=\"3.23\"></a><h2>Geometry API additions</h2>\n\n\n\n\n<a name=\"3.23.12\"></a><h3>Surface and Face API</h3>\n\n\n<p>The new method:</p>\n<ul>\n<li>Face.GetSurface()</li>\n</ul>\n<p>returns a copy of the Face's surface.</p>\n<p>In order to correctly leverage this information, the following properties:</p>\n<ul>\n<li>Face.OrientationMatchesSurfaceOrientation</li>\n<li>Surace.OrientationMatchesParametricOrientation</li>\n</ul>\n<p>identify whether the face's orientation matches the surface orientation, and whether the surface orientation is the same as or opposite to its parametric orientation.</p>\n\n\n<a name=\"3.23.13\"></a><h3>RevolvedSurface API</h3>\n\n\n<p>The new method:</p>\n<ul>\n<li>RevolvedSurface.GetProfileCurveInWorldCoordinates()</li>\n</ul>\n<p>returns a copy of the profile curve expressed in the world coordinate system.</p>\n\n\n<a name=\"3.23.14\"></a><h3>RuledSurface API</h3>\n\n\n<p>The newly added methods:</p>\n<ul>\n<li>RuledSurface.HasFirstProfilePoint()</li>\n<li>RuledSurface.HasSecondProfilePoint()</li>\n</ul>\n<p>check if a point was used to define one of the surface profiles. </p>\n\n\n<a name=\"3.24\"></a><h2>Level API addition</h2>\n\n\n<p>The new method:</p>\n<ul>\n<li>Level.FindAssociatedPlanViewId()</li>\n</ul>\n<p>finds the id of the first available associated floor or structural plan view associated with this level. If there are multiple associated views, Revit will return the first one it finds. </p>\n\n\n<a name=\"3.25\"></a><h2>Dockable Frame API Additions</h2>\n\n\n<p>Custom Dockable Panes now support the ability for display of dynamic UI elements, such as web browser controls.  This capability should be used in cases where the UI for the pane (layout, buttons etc.) changes dynamically during the lifetime of the Revit session. To use this, implement the new interface:</p>\n<ul>\n<li>IFrameworkElementCreator</li>\n</ul>\n<p>with a method:</p>\n<ul>\n<li>IFrameworkElementCreator.CreateFrameworkElement()</li>\n</ul>\n<p>that constructs and returns the WPF Framework element to embedded in the Revit dockable pane.</p>\n<p>The new members:</p>\n<ul>\n<li>DockablePaneProviderData.GetFrameworkElement()</li>\n<li>DockablePaneProviderData.FrameworkElementCreator</li>\n</ul>\n<p>provide the ability for the application to deliver a dynamic framework element to the dockable pane.  </p>\n<p>The property:</p>\n<ul>\n<li>DockablePaneProviderData.FrameworkElement</li>\n</ul>\n<p>is now allowed to be null, in situations where the FrameworkElement will be dynamically created.</p>\n\n\n<a name=\"3.26\"></a><h2>DirectContext3D for display of externally managed 3D graphics in Revit</h2>\n\n\n<p>DirectContext3D is an API for displaying external graphics in the context of a Revit model. The API provides a more connected experience to users who can benefit from the ability to display graphics based on geometry that is either difficult or costly to fully import into Revit.</p>\n<p>An external plugin can use DirectContext3D API to render geometry by encoding it inside pairs of vertex and index buffers. The communication between Revit and the plugin is accomplished with the use of the External Service Framework (ESF). Revit's rendering pipeline asks registered servers of the DirectContext3D service to provide the geometry for rendering. Revit informs the plugin about certain rendering state, such as the display style and whether the current rendering pass is for transparent objects. The plugin also communicates certain information to Revit, such as the bounding box of the geometry to be rendered.</p>\n<p>The following list contains the major added classes and their descriptions:</p>\n<ul>\n<li>DirectContext3D.IDirectContext3DServer &ndash; The interface to be implemented by a server of the DirectContext3D external service.</li>\n<li>DirectContext3D.DrawContext &ndash; A class that provides drawing functionality for use by DirectContext3D servers.</li>\n<li>DirectContext3D.Vertex &ndash; The base class for DirectContext3D vertices.</li>\n<li>DirectContext3D.VertexStream &ndash; The base class for DirectContext3D vertex streams, which are used to write vertex data into buffers.</li>\n<li>DirectContext3D.VertexBuffer &ndash; A buffer that stores vertex data for rendering.</li>\n<li>DirectContext3D.VertexFormat &ndash; A specification of the format of vertex data contained in a piece of geometry.</li>\n<li>DirectContext3D.VertexFormatBits &ndash; Vertex format (i.e., the type of data associated with a vertex) represented as a number.</li>\n<li>DirectContext3D.IndexPrimitive &ndash; The base class for index buffer primitives.</li>\n<li>DirectContext3D.IndexStream &ndash; The base class for DirectContext3D index streams, which are used to write vertex indices into buffers.</li>\n<li>DirectContext3D.IndexBuffer &ndash; A buffer that stores vertex indices for rendering.</li>\n<li>DirectContext3D.EffectInstance &ndash; An effect instance that controls the appearance of geometry.</li>\n<li>DirectContext3D.PrimitiveType &ndash; Type of geometry primitive represented as a number.</li>\n<li>DirectContext3D.ClipPlane &ndash; A set of parameters representing a clip plane in DirectContext3D.</li>\n<li>DirectContext3D.ProjectionMethod &ndash; The projection method used by a DirectContext3D camera.</li>\n<li>DirectContext3D.Camera &ndash; A collection of camera settings for DirectContext3D.</li>\n</ul>\n\n\n<a name=\"3.26.15\"></a><h3>View update for DirectContext3D</h3>\n\n\n<p>The new method:</p>\n<ul>\n<li>UIDocument.UpdateAllOpenViews()</li>\n</ul>\n<p>updates all open views in this document after elements have been changed, deleted, selected or de-selected. Graphics in the views are fully redrawn regardless of which elements have changed.  This function should only rarely be needed, but might be required when working with graphics drawn from outside of Revit's transactions and elements, for example, when using DirectContext3D.</p>\n<p>This function is potentially expensive as many views may be updated at once, including regeneration of view's geometry and redisplay of graphics.  Thus for most situations it is recommended that API applications rely on the Revit application framework to update views more deliberately.</p>\n\n\n<a name=\"3.27\"></a><h2>Coordination Model elements</h2>\n\n\n<p>Coordination Model elements current can link the graphical contents of Navisworks files and display them in context in the Revit session.  These elements leverage the DirectContext3D framework to handle the display of the external graphics, and are the first example of an element which is designated to contain a link to externally managed DirectContext3D graphics (a \"DirectContext3D handle\" element).</p>\n<p>There is no current way to create new Coordination Model or DirectContext3D handle elements via the API.  However, you can use the capabilities of the related classes to identify and manipulate these elements. These elements can be accessed from the following new API classes:</p>\n<ul>\n<li>DirectContext3DHandleUtils &ndash; provides utilities related to the identification of types and instances which are storing externalized graphics via DirectContext3D</li>\n<li>DirectContext3DHandleSettings &ndash; provides access to override settings applied to DirectContext3D handles through the Visibility/Graphics dialog.</li>\n<li>DirectContext3DHandleOverrides &ndash; provides access to DirectContext3DHandleSettings that are stored by a given view.</li>\n</ul>\n\n\n<a name=\"3.28\"></a><h2>Shared Coordinates API additions</h2>\n\n\n\n\n<a name=\"3.28.16\"></a><h3>Acquire and Publish coordinates API additions</h3>\n\n\n<p>Two new methods allow users to acquire and publish shared coordinates:</p>\n<ul>\n<li>Document.AcquireCoordinates() &ndash; Acquires project coordinates from the specified link instance. This method accepts both Revit links (RevitLinkInstance) and DWG links (ImportInstance).</li>\n<li>Document.PublishCoordinates() &ndash; Publishes shared coordinates to the specified ProjectLocation. This method works only on Revit links.</li>\n</ul>\n\n<a name=\"3.28.17\"></a><h3>SiteLocation API additions</h3>\n\n<p>Two new read-only properties have been added to provide information on the geographic coordinate system of a SiteLocation. The geographic coordinate system is imported from a DWG file from AutoCAD or Civil 3D. If the SiteLocation has geographic coordinate system information, the latitude and longitude of the SiteLocation will be updated automatically</p>\n<p>when the model's Survey Point is moved.</p>\n<ul>\n<li>SiteLocation.GeoCoordinateSystemId &ndash; Gets a string corresponding to geographic coordinate system ID, such as \"AMG-50\" or \"Beijing1954/a.GK3d-40\" for the SiteLocation. The value will be the empty string if there is no coordinate system specified for the SiteLocation. This property is read-only.</li>\n<li>SiteLocation.GeoCoordinateSystemDefinition &ndash; Gets an XML string describing the geographic coordinate system. The value will be the empty string if there is no coordinate system specified for the SiteLocation. This property is read-only.</li>\n</ul>\n<p>The new method:</p>\n<ul>\n<li>SiteLocation.IsCompatibleWith() &ndash; Checks whether the geographic coordinate system of this site is compatible with the given site.</li>\n</ul>\n\n<a name=\"3.28.18\"></a><h3>ProjectLocation API additions</h3>\n\n<p>The new method:</p>\n<ul>\n<li>ProjectLocation.Create()</li>\n</ul>\n<p>creates a new ProjectLocation in the document from the given SiteLocation and with the given name.</p>\n\n<a name=\"3.28.19\"></a><h3>Revit Link API additions</h3>\n\n<p>The new method:</p>\n<ul>\n<li>static RevitLinkInstance.Create(ImportPlacement placement)</li>\n</ul>\n<p>creates a new instance of a linked Revit project (RevitLinkType). Instances will be placed origin-to-origin or by shared coordinates according to the input placement type.</p>\n\n<a name=\"3.29\"></a><h2><h2>Link API additions</h2>\n\n\n<a name=\"3.29.20\"></a><h3>External Resource framework additions</h3>\n\n<p>IExternalResourceServer can now provide CAD format links, DWF markups, and IFC links. The following new values have been added to ExternalResourceType.BuiltInExternalResourceTypes:</p>\n<ul>\n<li>CADLink</li>\n<li>DWFMarkup</li>\n<li>IFCLink</li>\n</ul>\n\n<a name=\"3.29.21\"></a><h3>CADLinkType additions</h3>\n\n<p>Several new methods have been added to CADLinkType as part of external resource framework enhancements:</p>\n<ul>\n<li>CADLinkType.Reload() &ndash; Reloads a CADLinkType from its current location.</li>\n<li>CADLinkType.Reload(CADLinkOptions options) &ndash; Reloads a CADLinkType from its current location, including options to control graphic overrides.</li>\n<li>CADLinkType.LoadFrom(String fileName) &ndash; Reloads a CADLinkType from a file on disk.</li>\n<li>CADLinkType.LoadFrom(ExternalResourceReference reference) &ndash; Reloads a CADLinkType from an external resource server.</li>\n</ul>\n\n<a name=\"3.29.22\"></a><h3>ImportInstance additions</h3>\n\n<p>Several new methods have been added to create ImportInstance elements, either from an existing link type or a new link type:</p>\n<ul>\n<li>ImportInstance.Create(DWGImportOptions options, String fileName) &ndash; Creates a new DWG or DXF type and instance from a file on disk.</li>\n<li>ImportInstance.Create(DWGImportOptions options, ExternalResourceReference reference) &ndash; Creates a new DWG or DXF type and instance from an external resource location.</li>\n<li>ImportInstance.Create(ElementId typeId) &ndash; Creates a new DWG or DXF instance from an existing CADLinkType.</li>\n</ul>\n<p>Methods have also been added to create DGN, SAT, and SKP links from external resource locations.</p>\n\n<a name=\"3.29.23\"></a><h3>IFC Link API additions</h3>\n\n<p>The method:</p>\n<ul>\n<li>RevitLinkType.UpdateFromIFC()</li>\n</ul>\n<p>now has a new version that allows for an ExternalResourceReference to specify the IFC file name, instead of a string.</p>\n\n<a name=\"3.30\"></a><h2><h2>Workshared operation progress changed events</h2>\n\n<p>Subscribe to the Autodesk.Revit.ApplicationServices.Application.WorksharedOperationProgressChanged event to be notified when progress has changed during Collaboration for Revit's synchronizing.</p>\n<p>This event consists of several phases. Different event arguments are used during each phase.</p>\n\n<a name=\"3.30.24\"></a><h3>WorksharedOperationProgressChangedEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.WorksharedOperationProgressChangedEventArgs</li>\n</ul>\n<p>provides a base class for event arguments for worksharing-based progress events.</p>\n\n<a name=\"3.30.25\"></a><h3>DocumentSaveToLocalProgressChangedEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.DocumentSaveToLocalProgressChangedEventArgs provides information during the save to local phase of the DocumentSynchronizingWithCentralProgressChanged event.</li>\n</ul>\n<p>It has the following properties:</p>\n<ul>\n<li>DocumentSaveToLocalProgressChangedEventArgs.Location &ndash; Full path of the central model which is to be synchronized.</li>\n<li>DocumentSaveToLocalProgressChangedEventArgs.Status &ndash; Gets the API event status, which reflects the current operation execution status.</li>\n<li>DocumentSaveToLocalProgressChangedEventArgs.BeforeSaveToCentral &ndash; True if the \"save to local\" operation is occurring before \"save to central\"; false if after.</li>\n<li>DocumentSaveToLocalProgressChangedEventArgs.FinishedStreams &ndash; The number of streams finished since the last time this event was raised.</li>\n<li>DocumentSaveToLocalProgressChangedEventArgs.TotalStreams &ndash; The total expected number of streams to save to local.</li>\n<li>DocumentSaveToLocalProgressChangedEventArgs.SaveToLocalFinished &ndash; Indicates if the current \"save to local\" operation has finished.</li>\n</ul>\n\n<a name=\"3.30.26\"></a><h3>DataTransferProgressChangedEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.DataTransferProgressChangedEventArgs provides information during the data transferring phase of the WorksharedOperationProgressChanged event. Generally, it is not used directly because It is the base class of Autodesk.Revit.DB.Events.DocumentReloadLatestProgressChangedEventArgs, Autodesk.Revit.DB.Events.DocumentSaveToCentralProgressChangedEventArgs and Autodesk.Revit.DB.Events.CreateRelatedFileProgressChangedEventArgs</li>\n</ul>\n<p>It has the following properties:</p>\n<ul>\n<li>DataTransferProgressChangedEventArgs.Location &ndash; Full path of the central model which is to be synchronized.</li>\n<li>DataTransferProgressChangedEventArgs.Status &ndash; Gets the API event status, which reflects the current operation execution status.</li>\n<li>DataTransferProgressChangedEventArgs.TransferMode &ndash; Gets the transfer mode of this data transfer progress. It is Undefined or Download or Upload;</li>\n<li>DataTransferProgressChangedEventArgs.Speed &ndash; Gets data transfer speed(bytes/second).</li>\n<li>DataTransferProgressChangedEventArgs.FinishedSize &ndash; Gets downloaded or uploaded data size, in bytes, since the last time this event was raised.</li>\n<li>DataTransferProgressChangedEventArgs.TotalSize &ndash; Total expected data size to download, in bytes.</li>\n</ul>\n\n<a name=\"3.30.27\"></a><h3>DocumentReloadLatestProgressChangedEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.DocumentReloadLatestProgressChangedEventArgs provides information during the reload latest phase of the DocumentSynchronizingWithCentralProgressChanged event.</li>\n</ul>\n<p>It has the following properties:</p>\n<ul>\n<li>DocumentReloadLatestProgressChangedEventArgs.Location &ndash; The full path of the central model which is to be synchronized.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.Status &ndash; Gets API event status, reflecting the current operation execution status.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.TransferMode &ndash; Returns DataTransferMode.Download.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.RetryTimes &ndash; The number of times Revit has tried to Reload Latest. Its value is '0' at the first time.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.Speed &ndash; Download speed(bytes/second) in this event.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.FinishedSize &ndash; The downloaded data size, in bytes, since the last time this event was raised.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.TotalSize &ndash; Total expected data size to download, in bytes.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.IsMerging &ndash; Indicates if Revit is merging downloaded data.</li>\n<li>DocumentReloadLatestProgressChangedEventArgs.ReloadLatestFinished &ndash; Indicates if current 'reload latest' progress is finished or not.</li>\n</ul>\n\n\n<a name=\"3.30.28\"></a><h3>DocumentSaveToCentralProgressChangedEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.DocumentSaveToCentralProgressChangedEventArgs</li>\n</ul>\n<p>provides information during the save to central phase of the DocumentSynchronizingWithCentralProgressChanged event.</p>\n<p>It has the following properties:</p>\n<ul>\n<li>DocumentSaveToCentralProgressChangedEventArgs.Location &ndash; Full path of the central model which is to be synchronized.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.Status &ndash; Gets API event status, reflecting the current operation execution status.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.TransferMode &ndash; Returns DataTransferMode.Upload.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.RetryTimes &ndash; The number of times Revit has tried to Save to Central.\" Its value is '0' at the first time.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.Speed &ndash; Upload speed(bytes/second) of saving to central.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.FinishedSize &ndash; The uploaded data size, in bytes, since the last time this event was raised.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.TotalSize &ndash; Total expected uploaded data size to save to central, in bytes.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.SaveToCentralFinished &ndash; Indicates if current 'save to central' is finished or not.</li>\n<li>DocumentSaveToCentralProgressChangedEventArgs.FailureDueToConflicts &ndash; Indicates the 'save to central' failure is caused by submission, that is because another user finished saving to central first.</li>\n</ul>\n\n\n<a name=\"3.30.29\"></a><h3>CreateRelatedFileProgressChangedEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.CreateRelatedFileProgressChangedEventArgs</li>\n</ul>\n<p>provides information about the creation of related files when Collaboration for Revit models are being opened.</p>\n<p>It has the following properties:</p>\n<ul>\n<li>CreateRelatedFileProgressChangedEventArgs.Location &ndash; Full path of the model which is to be created related file.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.Status &ndash; Gets API event status, reflecting the current operation execution status.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.TransferMode &ndash; Returns DataTransferMode.Download.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.CreatingCloudSharedLocal &ndash; Indicates if it is creating cloud shared local model.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.DownloadFinished &ndash; Indicates if all data downloads are finished or not.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.Speed &ndash; Download speed(bytes/second) in this event.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.FinishedSize &ndash; The downloaded data size, in bytes, since the last time this event was raised.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.TotalSize &ndash; Total expected data size to download, in bytes.</li>\n<li>CreateRelatedFileProgressChangedEventArgs.FullDownload &ndash; Indicates if download the full data of the document, which will take longer than subsequent downloads.</li>\n</ul>\n\n<a name=\"3.31\"></a><h2><h2>Events related to linked resources</h2>\n\n<p>Subscribe to the events:</p>\n<ul>\n<li>Autodesk.Revit.ApplicationServices.Application.LinkedResourceOpening</li>\n<li>Autodesk.Revit.ApplicationServices.ControlledApplication.LinkedResourceOpening</li>\n<li>Autodesk.Revit.ApplicationServices.Application.LinkedResourceOpened</li>\n<li>Autodesk.Revit.ApplicationServices.ControlledApplication.LinkedResourceOpened</li>\n</ul>\n<p>to be notified when Revit is just about to open, or has just opened, a linked resource.  This event supports linked resources of the following types: Revit; IFC; CAD (DWG, DXF, DGN, SAT).</p>\n<p>This event will not be raised if there are no updates for linked CAD or IFC resources.  The linked resource cannot be modified during these events.</p>\n\n\n<a name=\"3.31.30\"></a><h3>LinkedResourceOpeningEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.LinkedResourceOpeningEventArgs</li>\n</ul>\n<p>provides information when Revit is just about to open a linked resource.</p>\n<p>It has the following properties:</p>\n<ul>\n<li>LinkedResourceOpeningEventArgs.ResourceType &ndash; Linked resource type.</li>\n<li>LinkedResourceOpeningEventArgs.LinkedResourcePathName &ndash; The linked resource name to open.</li>\n</ul>\n\n\n<a name=\"3.31.31\"></a><h3>LinkedResourceOpenedEventArgs</h3>\n\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Events.LinkedResourceOpenedEventArgs</li>\n</ul>\n<p>provides information when Revit finishes opening a linked resource.</p>\n<p>It has the following properties:</p>\n<ul>\n<li>LinkedResourceOpenedEventArgs.ResourceType &ndash; Linked resource type.</li>\n<li>LinkedResourceOpenedEventArgs.LinkedResourcePathName &ndash; Opened linked resource name.</li>\n</ul>\n\n<a name=\"3.32\"></a><h2><h2>Events related to parallel View Export</h2>\n\n<p>When exporting multiple views to DWF or DWFx format, Revit uses background processes to compute the exported output of several views in parallel. Two events are now available on the Application class to receive progress updates during a parallel export operation:</p>\n<ul>\n<li>Application.ViewExporting &ndash; This event is raised when Revit is just about to export a view of the document.</li>\n<li>Application.ViewExported &ndash; This event is raised immediately after Revit has finished exporting a view of the document.</li>\n</ul>\n<p>These two events are raised only during accelerated export jobs, in which views are exported in parallel using a background process. Accelerated export only occurs when exporting to DWF formats and not combining views into a single file. </p>\n\n<a name=\"3.33\"></a><h2>DWG export API additions</h2>\n\n<p>The new enumerated value:</p>\n<ul>\n<li>ExportColorMode.TrueColorPerView</li>\n</ul>\n<p>specified an export where all colors from the Revit project will be exported as 24-bit RGB values as specified in view (where ExportColorMode.TrueColor indicates that all colors from the Revit project will be exported as 24-bit RGB values as specified in object styles)</p>\n<p>The new properties:</p>\n<ul>\n<li>ACADExportOptions.UseHatchBackgroundColor</li>\n<li>ACADExportOptions.HatchBackgroundColor</li>\n</ul>\n<p>allow assignment of a color that will be set as hatch background color on the exported hatch. </p>\n\n\n<a name=\"3.33.32\"></a><h3><h3>ExportDWGSettings API additions</h3>\n\n<p>Two new methods have been added to ExportDWGSettings:</p>\n<ul>\n<li>ExportDWGSettings.FindByName() &ndash; Returns the pre-defined DWG export settings in the given document with the specified name.</li>\n<li>ExportDWGSettings.GetActivePredefinedSettings() &ndash; Returns the active DWG export settings in the given document.</li>\n</ul>\n<p>Note that these functions cannot return in-session settings. To access the in-session settings, save them with a name.</p>\n\n<a name=\"3.34\"></a><h2>Part API additions</h2>\n\n<p>The new methods:</p>\n<ul>\n<li>Part.ResetFaceOffset()</li>\n<li>Part.GetFaceOffset()</li>\n</ul>\n<p>provide further capabilities to access and manipulate the offset applied to a given face of a Part element.</p>\n\n<a name=\"3.35\"></a><h2>Freeform Rebar API additions</h2>\n\n<p>The new methods:</p>\n<ul>\n<li>Rebar.CreateFreeForm(Document, RebarBarType, Element, IList&lt;IList&lt;Curve&gt;&gt;, out RebarFreeFormValidationResult)</li>\n<li>Rebar.CreateFreeForm(Document, RebarBarType, Element, IList&lt;CurveLoop&gt;, out RebarFreeFormValidationResult)</li>\n</ul>\n<p>Create a freeform rebar instance where bars are created along the path of the input curves.  Constraints cannot later be added to this rebar.</p>\n<p>Freeform rebar instances have properties accessible from the RebarFreeFormAccessor class, which can be obtained from:</p>\n<ul>\n<li>Rebar.GetFreeFormAccessor()</li>\n</ul>\n<p>The new members of this accessor class allow you to change the bar curves only for unconstrained rebar:</p>\n<ul>\n<li>RebarFreeFormAccessor.SetCurves()</li>\n<li>RebarFreeFormAccessor.IsUnconstrained()</li>\n</ul>\n<p>They also provide access to layout, distribution path and hook properties of the rebar, if applicable:</p>\n<ul>\n<li>RebarFreeFormAccessor.SetLayoutAsSingle()</li>\n<li>RebarFreeFormAccessor.SetLayoutAsNumberWithSpacing()</li>\n<li>RebarFreeFormAccessor.SetLayoutAsFixedNumber()</li>\n<li>RebarFreeFormAccessor.SetLayoutAsMaximumSpacing()</li>\n<li>RebarFreeFormAccessor.SetLayoutAsMinimumClearSpacing()</li>\n<li>RebarFreeFormAccessor.GetCustomDistributionPath()</li>\n<li>RebarFreeFormAccessor.SetHookPlaneNormalForBarIdx()</li>\n<li>RebarFreeFormAccessor.GetHookPlaneNormalForBarIdx()</li>\n<li>RebarFreeFormAccessor.SetHookOrientationAngle()</li>\n<li>RebarFreeFormAccessor.GetHookOrientationAngle()</li>\n</ul>\n\n<a name=\"3.36\"></a><h2>Custom Service for Freeform Rebar Definition</h2>\n\n<p>The new interface class:</p>\n<ul>\n<li>IRebarUpdateServer</li>\n</ul>\n<p>represents an interface that can be overridden to drive the generation and update of freeform rebar geometry.  The interface features several methods:</p>\n<ul>\n<li>IRebarUpdateServer.GetCustomHandles() &ndash; This method should define all handles that the Rebar instance will have. This method is called when the Rebar is created.</li>\n<li>IRebarUpdateServer.GetCustomHandleName() &ndash; This function should return the user-visible name of the handle.  This function is called during an editing operation for the Rebar constraints when the mouse is over a handle</li>\n<li>IRebarUpdateServer.GenerateCurves() &ndash; This function should calculate the bar geometry.</li>\n<li>IRebarUpdateServer.TrimExtendCurves() &ndash; This function should calculate the trim and/or extension of the curves that were obtained from calling GenerateCurves(), as well as to assign new constraints for the start and end handles.</li>\n<li>IRebarUpdateServer.GetHandlesPosition() &ndash; This function is supposed to provide the positions of handles defined in GetCustomHandles(). These positions will be shown on screen when the bar constraints are edited.</li>\n</ul>\n<p>If a position for a handle isn't provided, that handle will not be represented on screen while edit constraints.</p>\n<p>The interfaces methods each provide an input argument which carries data needed for the calculation, as well as the results.  These new argument classes are:</p>\n<ul>\n<li>RebarHandlesData</li>\n<li>RebarHandleNameData</li>\n<li>RebarUpdateCurvesData</li>\n<li>RebarCurvesData</li>\n<li>RebarTrimExtendData</li>\n<li>RebarHandlePositionData</li>\n</ul>\n<p>You can programmatically create a freeform Rebar whose geometry and constraints are governed by the external service using:</p>\n<ul>\n<li>Rebar.Create(Document, GUID, RebarBarType, Element)</li>\n</ul>\n<p>You can convert a FreeForm rebar governed by an external service to an unconstrained element using:</p>\n<ul>\n<li>RebarFreeFormAccessor.DisconnectFromServer()</li>\n</ul>\n<p>In order to access and modify constraints associated to any custom handles associated to the service-driven freeform Rebar, you may use the members of the RebarConstrainedHandle class:</p>\n<ul>\n<li>RebarConstrainedHandle.IsCustomHandle()</li>\n<li>RebarConstrainedHandle.HandleName</li>\n<li>RebarConstrainedHandle.GetCustomHandleTag()</li>\n</ul>\n<p>and use the new members of RebarConstraint and RebarConstraintsManager:</p>\n<ul>\n<li>RebarConstraint.Create(RebarConstrainedHandle, IList&lt;Reference&gt;, bool, double)</li>\n<li>RebarConstraint.ReplaceReferenceTargets()</li>\n<li>RebarConstraint.NumberOfTargets</li>\n<li>RebarConstraint.GetTargetElement()</li>\n<li>RebarConstraint.GetRebarConstraintTargetHostFaceType()</li>\n<li>RebarConstraint.GetTargetHostFaceAndTransform()</li>\n<li>RebarConstraint.GetTargetCoverType()</li>\n<li>RebarConstraint.GetTargetHostFaceReference()</li>\n<li>RebarConstraint.GetCustomHandleTag()</li>\n<li>RebarConstraintsManager.GetAllHandles()</li>\n<li>RebarConstraintsManager.AllowConstraintTargets()</li>\n</ul>\n\n<a name=\"3.37\"></a><h2>HVACSpaceType and Space air ventilation API</h2>\n\n<p>The following new properties have been added to Autodesk.Revit.DB.Space:</p>\n<ul>\n<li>Space.SpaceTypeId &ndash; Gets or sets the Space type element of the Space.</li>\n<li>Space.OutdoorAirPerPerson &ndash; Gets the specified outdoor air per person, in cubic feet per second.</li>\n<li>Space.OutdoorAirPerArea &ndash; Gets the specified outdoor air per area, in feet per second.</li>\n<li>Space.AirChangesPerHour &ndash; Gets the specified air changes per hour of the space.</li>\n<li>Space.OutdoorAirflow &ndash; Gets the outdoor airflow of the Space, in cubic feet per second.</li>\n<li>Space.OutdoorAirFlowStandard &ndash; Gets the outdoor air flow standard of the space.</li>\n</ul>\n\n<a name=\"3.38\"></a><h2>Energy Analysis API additions</h2>\n\n<p>Several new classes have been added to allow better control over spaces when doing energy analysis.</p>\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType</li>\n</ul>\n<p>is the base class for HVACLoadSpaceType and HVACLoadBuildingType.</p>\n<p>It has the following properties:</p>\n<ul>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.AirChangesPerHour &ndash; The air changes per hour.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.AreaPerPerson &ndash; The area per person.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.LatentHeatGainPerPerson &ndash;  The latent heat gain per person.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.LightingLoadDensity &ndash; The lighting load density.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.OutdoorAirPerArea &ndash;  The outdoor air per area.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.OutdoorAirPerPerson &ndash; The outdoor air per person.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.OutdoorAirFlowStandard-The outdoor airflow standard.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.PlenumLighting &ndash; The percentage of plenum lighting contribution.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.PowerLoadDensity &ndash; The power load density.</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadType.SensibleHeatGainPerPerson &ndash; The sensible heat gain per person.</li>\n</ul>\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadSpaceType</li>\n</ul>\n<p>allows users to set the usage type associated with the space, such as 'Dining Area' or 'Lobby'.</p>\n<p>It has the following methods and properties:</p>\n<ul>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.Create()</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.IsNameUnique(String)</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.IsNameUnique(Document, String)</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.IsPlenum</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.SpaceTypeName</li>\n</ul>\n<p>The new class:</p>\n<ul>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType</li>\n</ul>\n<p>allows users to set the energy analysis usage type associated with a building, such as 'Museum' or 'Office'.</p>\n<p>It has the following methods and properties:</p>\n<ul>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.Create()</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.IsNameUnique(String)</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.IsNameUnique(Document, String)</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.BuildingTypeName</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.OpeningTime</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.ClosingTime</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.IsValidTime() &ndash; Checks if the string can be parsed to a valid time for opening time and closing time. A valid string can be \"16:30\" or \"4:30 PM\".</li>\n<li>Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.UnoccupiedCoolingSetPoint &ndash; The unoccupied cooling set point of the building type with unit Kelvin (K).</li>\n</ul>\n<p>The new properties:</p>\n<ul>\n<li>Autodesk.Revit.DB.Analysis.MassZone.SpaceTypeId</li>\n<li>Autodesk.Revit.DB.Mechanical.Space.SpaceTypeId</li>\n</ul>\n<p>allow users to set the energy analysis type associated with a space or mass zone.</p>\n<p>Note that these classes are not ElementTypes. They represent properties of a space or building when doing energy analysis, and do not have instances.</p>\n\n<a name=\"3.39\"></a><h2>Electrical API additions</h2>\n\n\n\n<a name=\"3.39.33\"></a><h3><h3>Electrical Circuit Path API</h3>\n\n<p>The new API members:</p>\n<ul>\n<li>ElectricalSystem.PathOffset</li>\n<li>ElectricalSystem.HasPathOffset</li>\n<li>ElectricalSystem.HasCustomCircuitPath</li>\n<li>ElectricalSystem.CircuitPathMode</li>\n<li>ElectricalSystem.GetCircuitPath()</li>\n<li>ElectricalSystem.SetCircuitPath()</li>\n<li>ElectricalSystem.IsCircuitPathValid()</li>\n</ul>\n<p>support different options and operations related to electrical circuit paths.</p>\n\n\n<a name=\"3.39.34\"></a><h3><h3>PanelScheduleView API</h3>\n\n<p>The following new methods handle space or spare circuit operations:</p>\n<ul>\n<li>PanelScheduleView.AddSpace() &ndash; Add a space at specific cell.</li>\n<li>PanelScheduleView.AddSpare() &ndash; Add a spare at specific cell.</li>\n<li>PanelScheduleView.RemoveSpace() &ndash; Remove a space at specific cell.</li>\n<li>PanelScheduleView.RemoveSpare() &ndash; Remove a spare at specific cell.</li>\n</ul>\n\n<a name=\"3.40\"></a><h2>MEPAnalyticalConnection API additions</h2>\n\n<p>Two new classes have been added to allow API users to create analytical connections between elements. The behavior is the same as in Revit's UI.</p>\n<p>The new class:</p>\n<ul>\n<li>MEPAnalyticalConnection</li>\n</ul>\n<p>represents an analytical element that connected mechanical equipment to a piping network. The analytical connection can be used to create a network even if no real pipes are placed yet. It enables the fast establishment of a piping network to analyze the flow and pressure, especially at the early stage of the design process.</p>\n<p>It has the following methods:</p>\n<ul>\n<li>MEPAnalyticalConnection.Create() &ndash; Creates a new analytical connection between two connectors.</li>\n<li>MEPAnalyticalConnection.CreateMultipleConnections() &ndash; Creates new analytical connections between the equipment connector and the nearest point on the piping network.</li>\n<li>MEPAnalyticalConnection.GetFlow() &ndash; Returns the up-to-date flow value. If the network is asynchronously calculated, this method would wait until the calculation is completed.</li>\n</ul>\n<p>The new class:</p>\n<ul>\n<li>MEPAnalyticalConnectionType</li>\n</ul>\n<p>is the type element of an MEPAnalyticalConnection. Its pressure loss value is included in the network critical path calculation.</p>\n<p>It has the following methods and properties:</p>\n<ul>\n<li>MEPAnalyticalConnectionType.Create() &ndash; Creates a new analytical connection type with the specified name.</li>\n<li>MEPAnalyticalConnectionType.IsNameUnused() &ndash; Checks if the name is already used.</li>\n<li>MEPAnalyticalConnectionType.GetAllTypes() &ndash; Returns all types in the document.</li>\n<li>MEPAnalyticalConnectionType.PressureLoss &ndash; The pressure loss associated with this type. This property is writable.</li>\n</ul>\n<p>The new property:</p>\n<ul>\n<li>Autodesk.Revit.DB.Plumbing.PipeSettings.AnalysisForClosedLoopHydronicPipingNetworks</li>\n</ul>\n<p>indicates whether to enable analysis for closed loop hydronic piping networks in the background.</p>\n\n\n<a name=\"3.41\"></a><h2>Fabrication API additions</h2>\n\n<a name=\"3.41.35\"></a><h3>Hanger Rod additions</h3>\n\n<p>The following new methods and properties allow better control of hanger rod lengths:</p>\n<ul>\n<li>FabricationRodInfo.GetRodStructureExtension()</li>\n<li>FabricationRodInfo.SetRodStructureExtension() &ndash; Sets the extension of the rod into the structure. The rod will remain hosted by structure and have the extension applied on top of any calculated length. This method is only valid for rods which are already hosted by structure.</li>\n<li>FabricationRodInfo.CanRodsBeHosted &ndash; Setting this to false disassociates the hanger from any structure and allows the user to manually set lengths. Setting it to true re-enables rods automatically hosting to structure again.</li>\n<li>FabricationRodInfo.GetRodLength() &ndash; Gets the current rod length for the specified rod index (including any extension), whether it is hosted or not.</li>\n<li>FabricationRodInfo.SetRodLength() &ndash; Sets the current rod length for the specified rod index &ndash; but only if hosting is disabled by setting CanRodsBeHosted = false first.</li>\n</ul>\n<p>The new property:</p>\n<ul>\n<li>FabricationPart.HangerRodKit</li>\n</ul>\n<p>allows users to get or set the support rod kit override. This gives the user better control over hanger rod thicknesses.</p>\n\n\n<a name=\"3.41.36\"></a><h3>Placing and splitting fabrication parts</h3>\n\n<p>The following methods allow placing and splitting fabrication parts:</p>\n<ul>\n<li>FabricationPart.AlignPartByConnectorToConnector() &ndash; Aligns a part by its connector to another connector.</li>\n<li>FabricationPart.AlignPartByInsertionPoint() &ndash; Aligns the part by its insertion point to a point and rotation in free space.</li>\n<li>FabricationPart.AlignPartByConnector() &ndash; Aligns the part by its connector to a point and rotation in free space.</li>\n<li>FabricationPart.AlignPartByInsertionPointAndCutInToStraight() &ndash; Aligns the part by its insertion point to a point and rotation in on a straight.</li>\n<li>FabricationPart.HasNoConnections() &ndash; Checks to see if all the part's connectors are open.</li>\n<li>FabricationPart.CanSplitStraight() &ndash; Checks to see if a straight can be split into two at a given position.</li>\n<li>FabricationPart.SplitStraight() &ndash; Splits a straight at a given position.</li>\n</ul>\n\n\n<a name=\"3.41.37\"></a><h3>Fabrication Part export additions</h3>\n\n<p>The new method:</p>\n<ul>\n<li>Autodesk.Revit.DB.Fabrication.FabricationUtils.ExportToPCF()</li>\n</ul>\n<p>exports Fabrication parts to PCF format.</p>\n<p>The new property:</p>\n<ul>\n<li>FabricationPart.SpoolName</li>\n</ul>\n<p>allows control over Spool names in PCF output.</p>\n\n\n<a name=\"3.41.38\"></a><h3>Fabrication Part status additions</h3>\n\n<p>Two properties were added to FabricationPart to allow the user to query and set the part fabrication status field:</p>\n<ul>\n<li>FabricationPart.PartStatus &ndash; Queries or changes the part fabrication status field current value. Setting the value will track when it was changed.</li>\n<li>FabricationPart.PartGuid &ndash; Queries the part's fabrication globally unique identifier, as used in applications such as Tracker.</li>\n</ul>\n\n\n<a name=\"3.41.39\"></a><h3>Fabrication part comparison</h3>\n\n<p>The new method:</p>\n<ul>\n<li>FabricationPart.IsSameAs()</li>\n</ul>\n<p>compares basic dimensional information of two fabrication parts but also allows the user to specify additional fabrication data to ignore. This allows users to compare parts including fabrication data not exposed in Revit.</p>\n\n\n<a name=\"3.41.40\"></a><h3>Fabrication Part ancillary usage additions</h3>\n\n<p>The new method:</p>\n<ul>\n<li>FabricationPart.GetPartAncillaryUsage()</li>\n</ul>\n<p>gets a list of FabricationAncillaryUsage structures that lists the ancillaries that the fabrication part uses. This method can be used to populate cut lists and procure ancillaries needed to fabricate and install the fabrication part.</p>\n<p>The new class:</p>\n<ul>\n<li>FabricationAncillaryUsage</li>\n</ul>\n<p>contains the ancillary usage data. It has the following read-only properties:</p>\n<ul>\n<li>FabricationAncillaryUsage.Type &ndash; A new enumerated type FabricationAncillaryType which describes what kind of ancillary it is (eg. a fixing, airturn vane or support material).</li>\n<li>FabricationAncillaryUsage.UsageType &ndash; a new enumerated type FabricationAncillaryUsageType describing the usage of the ancillary (eg. in a support, connector or airturn).</li>\n<li>FabricationAncillaryUsage.AncillaryId &ndash; the ancillary database identifier as listed by FabricationConfiguration.GetAncillaries().</li>\n<li>FabricationAncillaryUsage.Length</li>\n<li>FabricationAncillaryUsage.AncillaryWidthOrDiameter &ndash; The width / diameter of the ancillary (eg. rod thickness).</li>\n<li>FabricationAncillaryUsage.AncillaryDepth</li>\n<li>FabricationAncillaryUsage.Quantity</li>\n<li>FabricationAncillaryUsage.ProductCode</li>\n</ul>\n\n\n<a name=\"3.41.41\"></a><h3>Fabrication Part custom data additions</h3>\n\n<p>The following methods allow access to Fabrication Part custom data defined per part. This can be used for querying and changing values:</p>\n<ul>\n<li>FabricationPart.HasCustomData() &ndash; Queries if a part has a certain optional custom data.</li>\n<li>FabricationPart.Get/SetPartCustomDataText/Integer/Real() &ndash; Gets or sets the fabrication part's custom data.</li>\n<li>FabricationPart.Add/RemovePartCustomData() &ndash; Adds or removes optional custom data on fabrication parts.</li>\n</ul>\n\n\n<a name=\"3.41.42\"></a><h3>FabricationConfiguration additions</h3>\n\n<p>New methods have been added to access fabrication data defined by the currently loaded fabrication configuration. These can be used to query what fabrication data is available for fabrication parts to use:</p>\n<ul>\n<li>FabricationConfiguration.GetAllDampers()</li>\n<li>FabricationConfiguration.GetDamperName()</li>\n<li>FabricationConfiguration.GetAncillaries() &ndash; list all ancillary identifiers (by enumerated type)</li>\n<li>FabricationConfiguration.GetAncillaryName()</li>\n<li>FabricationConfiguration.GetAllPartStatuses()</li>\n<li>FabricationConfiguration.GetPartStatusDescription()</li>\n<li>FabricationConfiguration.GetAllPartCustomData()</li>\n<li>FabricationConfiguration.GetPartCustomDataName()</li>\n<li>FabricationConfiguration.GetPartCustomDataType()</li>\n</ul>\n\n\n<a name=\"3.41.43\"></a><h3>Routing exclusions additions</h3>\n\n<p>The following methods allow users to override routing exclusions:</p>\n<ul>\n<li>FabricationService.IsGroupExcluded() &ndash; Gets whether a service group is excluded from routing.</li>\n<li>FabricationService.SetServiceGroupExclusions() &ndash; Sets the service group exclusions.</li>\n<li>FabricationService.ResetServiceExclusionOverrides() &ndash; Resets the overridden service group and button exclusions back to default.</li>\n<li>FabricationService.OverrideServiceButtonExclusion() &ndash; Overrides the default service button exclusions.</li>\n<li>FabricationServiceButton.IsExcluded() &ndash; Gets if the service button is excluded from routing.</li>\n</ul>\n\n\n<a name=\"3.41.44\"></a><h3>FabricationServiceButton addition</h3>\n\n<p>The new property:</p>\n<ul>\n<li>FabricationServiceButton.IsStraight</li>\n</ul>\n<p>returns true if all conditions of the fabrication service button are straight pieces. This indicates the button is suitable for use with multi-point routing, among other uses.</p>"
  },
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "<a name=\"4\"></a>Python Automatic HTML Heading Numbering Script",
    "local_header_href": "#a-name4apython-automatic-html-heading-numbering-script",
    "chunk_text": "### <a name=\"4\"></a>Python Automatic HTML Heading Numbering Script\n\nThe following Python script [number_html_headings.py](zip/number_html_headings.py) automatically\nadds HTML hypertext reference `A` tags to an HTML file sequentially numbering up to ten levels of headings:\n\n<pre class=\"prettyprint\">\n#!/usr/bin/python"
  },
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "# number_html_headings.py - add numbering to HTML headings",
    "local_header_href": "#-number_html_headingspy-add-numbering-to-html-headings",
    "chunk_text": "#\n# number_html_headings.py - add numbering to HTML headings\n\n"
  },
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "# Copyright (C) 2017-04-25 by Jeremy Tammik, Autodesk Inc.",
    "local_header_href": "#-copyright-c-2017-04-25-by-jeremy-tammik-autodesk-inc",
    "chunk_text": "#\n# Copyright (C) 2017-04-25 by Jeremy Tammik, Autodesk Inc.\n\n"
  },
  {
    "original_filename": "1551_whats_new_2018",
    "header_text": "filename = 'Revit_Platform_API_Changes_and_Additions_2018_03.htm'",
    "local_header_href": "#filename-revit_platform_api_changes_and_additions_2018_03htm",
    "chunk_text": "#\n\nfilename = 'Revit_Platform_API_Changes_and_Additions_2018_03.htm'\n\nfilepath = '/a/doc/revit/tbc/git/a/zip/' + filename\n\nnlevels = 10 # max heading level to number\n\nih = [] # current count for each heading level\n\nfor i in range(nlevels):\n  ih.append(0)\n  \ndef filereadlines( filename ):\n  f = open( filename )\n  data = f.readlines()\n  f.close()\n  return data\n\nif __name__ == '__main__':\n\n  def main():\n    lines = filereadlines( filepath )\n    for line in lines:\n      line = line.strip()\n      a = ''\n      if line.startswith('&lt;h'):\n        level = int(line[2])\n        ih[level-1] = ih[level-1] + 1\n        a = '.'.join( [str(ih[l]) for l in range(level)] )\n        a = '&lt;a name=\"' + a + '\"&gt;&lt;/a&gt;'\n      print a + line\n\nmain()\n</pre>\n\nI used it to generate \nthe [table of contents](#1) above.\n\nIt handles up to ten heading levels `H1`..`H9` and assumes the heading tags are all at the beginning of a line.\n\nI implemented it for and tested it on\nthe [input file `Revit_Platform_API_Changes_and_Additions_2018_03.htm`](zip/Revit_Platform_API_Changes_and_Additions_2018_03.htm), generating\nthe [output file `Revit_Platform_API_Changes_and_Additions_2018_04.htm`](zip/Revit_Platform_API_Changes_and_Additions_2018_04.htm).\n\nIt will gladden me if you can make use of this as well."
  }
]