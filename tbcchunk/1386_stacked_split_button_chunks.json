[
  {
    "original_filename": "1386_stacked_split_button",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<!---\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n</head>\n\n<!---\n\n- implement split button using AdWindows.dll\n  http://forums.autodesk.com/t5/revit-api/ribbonpanel-addstackeditems-and-splitbutton/m-p/5950120\n  intentional user interface restrictions\n  REVIT-71373 [As a Revit add-in developer, I would like to be able to add a split button to a stacked section of buttons, so I can create the UI I need for my application.]\n\n#dotnet #csharp\n#fsharp #python\n#grevit\n#responsivedesign #typepad\n#ah8 #augi #dotnet\n#stingray #rendering\n#3dweb #3dviewapi #html5 #threejs #webgl #3d #apis #mobile #vr #ecommerce\n#Markdown #Fusion360 #Fusion360Hackathon\n#javascript\n#RestSharp #restapi\n#mongoosejs #mongodb #nodejs\n#rtceur\n#geometry #3d\n#xaml\n\nRevit API, Jeremy Tammik, akn_include\n\nAdding a Stacked Split Button to the Ribbon #revitapi #bim #aec #3dwebcoder #adsk\n\nI have been rather busy on the Revit API discussion forum these last few days. One of the issues I got involved with was Michał Helt's thread on RibbonPanel.AddStackedItems and SplitButton, discussing how to add a split button to a ribbon panel using the AddStackedItems method. Question: Currently, Split Buttons cannot be created in the ribbon using the AddStackedItems method. Only PushButtons, PulldownButtons, ComboBoxes and TextBoxes can be added this way. Would it be possible to remove this limitation?...\n\n-->"
  },
  {
    "original_filename": "1386_stacked_split_button",
    "header_text": "Adding a Stacked Split Button to the Ribbon",
    "local_header_href": "#adding-a-stacked-split-button-to-the-ribbon",
    "chunk_text": "### Adding a Stacked Split Button to the Ribbon\n\nI have been rather busy on the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api/bd-p/160) these last few days.\n\nOne of the issues I got involved with was Michał Helt's thread\non [RibbonPanel.AddStackedItems and SplitButton](http://forums.autodesk.com/t5/revit-api/ribbonpanel-addstackeditems-and-splitbutton/m-p/5949953),\ndiscussing how to add a split button to a ribbon panel using the AddStackedItems method.\n\n**Question:** Currently, Split Buttons cannot be created in the ribbon using the AddStackedItems method.\nOnly PushButtons, PulldownButtons, ComboBoxes and TextBoxes can be added this way.\nWould it be possible to remove this limitation?\nI would like to achieve a button similar to this selected one:\n\n<center>\n<img src=\"img/split_button.png\" alt=\"Split button\" width=\"438\">\n</center>\n\nI've already overcome this using the ribbon features from AdWindows.dll, but I am curious whether the lack of it in RevitAPIUI.dll is intentional or not.\n\n**Answer:** Thank you for reporting this!\n\nThis issue has already been logged as REVIT-71373 *As a Revit add-in developer, I would like to be able to add a split button to a stacked section of buttons, so I can create the UI I need for my application* and is currently being addressed, so you will have official access to this functionality in future.\n\n**Response:** Thank you.\n\nHere is my current workaround making use of\nthe [unsupported](http://thebuildingcoder.typepad.com/blog/about-the-author.html#4) `AdWindows.dll` functionality:\n\n<pre class=\"code\">\n&nbsp; <span class=\"blue\">var</span> bd0 = <span class=\"blue\">new</span> <span class=\"teal\">PulldownButtonData</span>( <span class=\"maroon\">&quot;A&quot;</span>, <span class=\"maroon\">&quot;A&quot;</span> );\n&nbsp; <span class=\"blue\">var</span> bd1 = <span class=\"blue\">new</span> <span class=\"teal\">PulldownButtonData</span>( <span class=\"maroon\">&quot;B&quot;</span>, <span class=\"maroon\">&quot;B&quot;</span> );\n&nbsp; <span class=\"blue\">var</span> bd2 = <span class=\"blue\">new</span> <span class=\"teal\">PulldownButtonData</span>( <span class=\"maroon\">&quot;C&quot;</span>, <span class=\"maroon\">&quot;C&quot;</span> );\n&nbsp;\n&nbsp; <span class=\"blue\">var</span> stackedItems = ribbonPanel.AddStackedItems(\n&nbsp; &nbsp; bd0, bd1, bd2 );\n&nbsp;\n&nbsp; <span class=\"blue\">var</span> button0 = (<span class=\"teal\">PulldownButton</span>) stackedItems[0];\n&nbsp;\n&nbsp; <span class=\"blue\">string</span> sid = <span class=\"blue\">string</span>.Join(\n&nbsp; &nbsp; <span class=\"maroon\">&quot;%&quot;</span>,\n&nbsp; &nbsp; <span class=\"maroon\">&quot;CustomCtrl_&quot;</span>,\n&nbsp; &nbsp; <span class=\"maroon\">&quot;CustomCtrl_&quot;</span>,\n&nbsp; &nbsp; ribbonTabName,\n&nbsp; &nbsp; ribbonPanel.Name,\n&nbsp; &nbsp; button0.Name );\n&nbsp;\n&nbsp; <span class=\"blue\">var</span> splitButton = (Autodesk.Windows.<span class=\"teal\">RibbonSplitButton</span>)\n&nbsp; &nbsp; UIFramework.RevitRibbonControl.RibbonControl\n&nbsp; &nbsp; &nbsp; .findRibbonItemById( sid );\n&nbsp;\n&nbsp; splitButton.IsSplit = <span class=\"blue\">true</span>;\n&nbsp; splitButton.IsSynchronizedWithCurrentItem = <span class=\"blue\">true</span>;\n</pre>\n\nThat's the cleanest solution that I have found so far.\n\nThank you, Michał, for raising the issue and sharing this solution.\n\nDon't forget to replace this by the official solution once the new functionality mentioned above becomes available.\n\n<!---\n\nOther threads:\n\nhttp://forums.autodesk.com/t5/Revit-API/How-to-read-Browser-Organization-info-from-the-Revit-API-2013/m-p/5028076\nhttp://forums.autodesk.com/t5/revit-api/3d-sweep-path/m-p/5909779\nhttp://forums.autodesk.com/t5/revit-api/access-opened-files-on-revit-application/m-p/5948657\nhttp://forums.autodesk.com/t5/revit-api/access-rebar-element-through-rebar-container/m-p/5925040\nhttp://forums.autodesk.com/t5/revit-api/api-bug-in-document-regenerate/m-p/5911198\nhttp://forums.autodesk.com/t5/revit-api/boundingboxintersectsfilter-not-working/m-p/5912235\nhttp://forums.autodesk.com/t5/revit-api/c-add-a-type-in-a-family/m-p/5934695\nhttp://forums.autodesk.com/t5/revit-api/c-c/m-p/5949029\nhttp://forums.autodesk.com/t5/revit-api/call-revit-s-api-from-external-thread/m-p/5941308\nhttp://forums.autodesk.com/t5/revit-api/catching-column-faces-problem/m-p/5949315\nhttp://forums.autodesk.com/t5/revit-api/change-parameter-values-from-modaldialog/m-p/5950302\nhttp://forums.autodesk.com/t5/revit-api/change-the-selection-of-a-wall/m-p/5894008\nhttp://forums.autodesk.com/t5/revit-api/circle-radius-alignment-and-dimension/m-p/5905736\nhttp://forums.autodesk.com/t5/revit-api/closing-a-model-without-creating-a-backupfile/m-p/5911656\nhttp://forums.autodesk.com/t5/revit-api/create-non-shared-project-parameters/m-p/5908682\nhttp://forums.autodesk.com/t5/revit-api/create-project-parameter-with-quot-values-can-vary-by-group/m-p/5939455\nhttp://forums.autodesk.com/t5/revit-api/creating-a-new-line-style/m-p/5943347\nhttp://forums.autodesk.com/t5/revit-api/disable-current-view-only-in-link-cad-command/m-p/5918755\nhttp://forums.autodesk.com/t5/revit-api/disable-or-overwrite-quot-editing-request-quot-for-worksharing/m-p/5920035\nhttp://forums.autodesk.com/t5/revit-api/documentation-inquery/m-p/5952369\nhttp://forums.autodesk.com/t5/revit-api/energy-analysis-and-gbs-license-period/m-p/5922082\nhttp://forums.autodesk.com/t5/revit-api/export-family-to-dwg/m-p/5921317\nhttp://forums.autodesk.com/t5/revit-api/filteredelementcollector-or-elementset-order-by-closest-of-same/m-p/5943350\nhttp://forums.autodesk.com/t5/revit-api/get-all-familyinstances-in-a-room/m-p/5943551\nhttp://forums.autodesk.com/t5/revit-api/get-parameter-value-for-a-collection-of-family-instances/m-p/5896191\nhttp://forums.autodesk.com/t5/revit-api/get-wall-openings/m-p/5953513\nhttp://forums.autodesk.com/t5/revit-api/getting-started-with-the-revit-net-api/m-p/1506776\nhttp://forums.autodesk.com/t5/revit-api/how-to-get-all-disciplines/m-p/5951718\nhttp://forums.autodesk.com/t5/revit-api/how-to-loop-through-the-design-option-sets-of-a-document/m-p/5950656\nhttp://forums.autodesk.com/t5/revit-api/how-to-make-a-graphical-view-active/m-p/5891780\nhttp://forums.autodesk.com/t5/revit-api/how-to-read-browser-organization-info-from-the-revit-api-2013/m-p/5894209\nhttp://forums.autodesk.com/t5/revit-api/installation-errors/m-p/5926697\nhttp://forums.autodesk.com/t5/revit-api/instancevoidcututils-during-dynamic-update-event/m-p/5891597\nhttp://forums.autodesk.com/t5/revit-api/invalid-face-references-after-regenerate/m-p/5893667\nhttp://forums.autodesk.com/t5/revit-api/invalidoperation-exception/m-p/5894269\nhttp://forums.autodesk.com/t5/revit-api/loop-through-elements-and-set-parameter/m-p/5919866\nhttp://forums.autodesk.com/t5/revit-api/loop-trough-elements-and-set-parameter/m-p/5919860\nhttp://forums.autodesk.com/t5/revit-api/openings-on-roof-in-window-family-via-api/m-p/5950116\nhttp://forums.autodesk.com/t5/revit-api/path-to-the-dll/m-p/5953600\nhttp://forums.autodesk.com/t5/revit-api/placing-cutouts-generic-families/m-p/5947220\nhttp://forums.autodesk.com/t5/revit-api/reference-plane-on-drafting-view/m-p/5897179\nhttp://forums.autodesk.com/t5/revit-api/revit-color-picker/m-p/5887112\nhttp://forums.autodesk.com/t5/revit-api/revit-to-ifc-unrecoverable-error-during-export/m-p/5946695\nhttp://forums.autodesk.com/t5/revit-api/revit2016-service-pack2-not-active-after-update/m-p/5897691\nhttp://forums.autodesk.com/t5/revit-api/ribbonpanel-addstackeditems-and-splitbutton/m-p/5949953\nhttp://forums.autodesk.com/t5/revit-api/rotate-viewsection/m-p/5921812\nhttp://forums.autodesk.com/t5/revit-api/set-value-of-parameter-editfamily-fails/m-p/5947155\nhttp://forums.autodesk.com/t5/revit-api/shared-coordinate-system-definition/m-p/5928300\nhttp://forums.autodesk.com/t5/revit-api/synchronizing-with-a-centrale-file-revit-located-in-a-database/m-p/5942784\nhttp://forums.autodesk.com/t5/revit-api/trigger-when-adding-new-element/m-p/5952018\nhttp://forums.autodesk.com/t5/revit-api/trying-to-modify-the-family-parameter-quot-work-plane-based-quot/m-p/5900742\nhttp://forums.autodesk.com/t5/revit-api/update-linked-files-path/m-p/5950215\nhttp://forums.autodesk.com/t5/revit-api/visual-studio-2015-sp1/m-p/5933391\nhttp://forums.autodesk.com/t5/revit-api/wall-attach-top-base-no-api/m-p/5929145\nhttp://forums.autodesk.com/t5/revit-api/workshared-element-user-history/m-p/5897153\nhttps://forums.autodesk.com/t5/revit-api/change-the-selection-of-a-wall/m-p/5890510\nhttps://forums.autodesk.com/t5/revit-api/reporting-on-project-parameter-definitions-need-guids/m-p/4706047\n-->"
  }
]