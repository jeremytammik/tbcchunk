[
  {
    "original_filename": "0798_revitrubyshell",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0798_revitrubyshell",
    "header_text": "RevitRubyShell Implementation and Installer",
    "local_header_href": "#revitrubyshell-implementation-and-installer",
    "chunk_text": "<h3>RevitRubyShell Implementation and Installer</h3><p>I had a very impressive train ride on Friday evening on my way up to meet my friends to climb the \n\n<a href=\"http://en.wikipedia.org/wiki/Spitzhorn\">Spitzhorn</a> mountain, \n\nhappening to take the \n\n<a href=\"http://www.myswitzerland.com/en/montreux-chateau-d-oex-gstaad-panoramic-express.html\">\npanoramic express</a> up \n\nfrom Montreux to Gstaad, completely by chance. \nI was just expecting a normal train ride, but it turned out to be extremely beautiful, the most comfortable way I have yet experienced to get an almost overwhelming impression of Swiss mountain beauty without having to do any hiking, just looking out of the train window.\nWe made it to the summit on Saturday\n\n(<a href=\"http://www.facebook.com/media/set/?set=a.4253220338006.2173087.1510729143&amp;type=1\">photos</a>):</p><center>\n<img alt=\"Jeremy on Spitzhorn peak cross\" src=\"file:////j/photo/jeremy/2012/2012-07-07_spitzhorn/jeremy_on_gipfelkreuz.jpg\" width=\"400\"/>\n</center><p>Last week, I provided a\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/07/meetings-football-and-revitrubyshell.html#2\">\nshort description</a> of\n\nthe interactive real-time Revit programming environment \n\n<a href=\"https://github.com/hakonhc/RevitRubyShell\">\nRevitRubyShell</a> provided \n\nby \n\n<a href=\"http://www.hclausen.net\">Håkon Clausen</a> and \n\nmentioned how impressed I was by its minimalistic single-click\n\n<a href=\"http://www.hclausen.net/RevitRubyShell/setup.exe\">\ninstaller</a>.\n\n<p>In the train on the way up to Gstaad, I took a closer look at it.\nHåkon points out that RevitRubyShell is heavily inspired by \n\n<a href=\"http://code.google.com/p/revitpythonshell\">\nRevitPythonShell</a> and \n\nJimmy Schementi's article about \n\n<a href=\"http://blog.jimmy.schementi.com/2009/12/ironruby-rubyconf-2009-part-35.html\">\nembedding IronRuby</a>.\n\n<p>The entire source code is provided on the \n\n<a href=\"http://en.wikipedia.org/wiki/GitHub\">\nGitHub social coding platform</a>.\n\n<a href=\"https://github.com\">\nGitHub</a> is a web-based hosting service for software development projects using the \n\n<a href=\"http://git-scm.com\">\nGit revision control system</a>.\n\n<p>I found the RevitRubyShell source impressive and edifying, sporting a number of aspects well worth looking at in depth for most Revit API programmers, and for that matter most .NET programmers in general as well.\nI probably missed lots of other interesting features, but here are some that sprang to eye:\n\n<ul>\n<li>Optimal use of numerous bits of .NET functionality to achieve a lot with a minimum of code.\n<li>Use of XAML to implement its shell window form, including use of tabs and command buttons.\n<li>A couple of useful extension methods for the .NET KeyEventArgs and RichTextBox classes.\n<li>One-click installer making use of RevitAddInUtility and its RevitProductUtility and AddInManifestUtility classes.\n</li></li></li></li></ul>\n<p>I sat down with the RevitRubyShell console and tried to figure out how to count the number of doors in the Revit basic sample model.\n<p>It took me a bit of fiddling and googling, but this seems to do the trick:\n\n<pre>\nbic = BuiltInCategory.OST_Doors\n\ndoors = FilteredElementCollector.new(doc)\n  .OfCategory( bic ).ToElements();\n\ncount = doors.select {|d| d.is_a?( FamilyInstance )}.size\n\n=&gt; 29\n</pre>\n<p>Only three lines of pretty obvious code, even if you know just a little bit of Ruby and the Revit API:</p>\n<center>\n<img alt=\"Door count in Ruby\" src=\"img/ruby_door_count.png\"/>\n</center>\n<p>I find this pretty impressive, once again.\nThe handling is totally intuitive, and everything simply works.\nBrilliant.\n\n<p>Many thanks again to Håkon for developing and sharing this!\n\n</p></p></p></p></p></p></p></p>"
  }
]