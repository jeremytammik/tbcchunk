[
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<title>The Building Coder</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<link rel=\"stylesheet\" type=\"text/css\" href=\"3dwc.css\"/>\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true\" defer=\"defer\"></script>\n</head>\n\n<!---\n\n- gross spannort fotos\n\n- Autodesk Forge Platform Gets New APIs\n  http://www.engineering.com/DesignSoftware/DesignSoftwareArticles/ArticleID/12640/Autodesk-Forge-Platform-Gets-New-APIs.aspx\n  \n- Autodesk Forge Platform: Little Machines\n  https://www.youtube.com/watch?v=tta-V6wyUKY\n  \n- 11988606 [Ifc Import shows incorrect result]\n\n- IFC open source\n  http://forums.autodesk.com/t5/revit-api/opensource-api-for-reading-ifc-files/m-p/6433280\n  11980002 [Opensource API for reading IFC Files]\n\n- http://forums.autodesk.com/t5/revit-api/open-ifc-through-api/m-p/6451258\n\n- 11996877 [customize IFC Import]\n\n- IFC supports families\n  http://forums.autodesk.com/t5/revit-api/open-ifc-through-api/td-p/6451258/\n  \n#IFC Import and Open Source #revitapi #3dwebcoder @AutodeskRevit @AutodeskForge #aec #bim @openbimstandard\n\nQuite a few issues revolving around IFC came up lately in various ADN cases and in the Revit API discussion forum. Before getting to the technical stuff, some pictures from my latest mountaineering trip to climb Gross Spannort\n&ndash; Autodesk Forge Platform &mdash; Little machines\n&ndash; IFC import scaling issue\n&ndash; IFC open source C# library\n&ndash; Customising IFC import\n&ndash; IFC family support... \n\n-->"
  },
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "IFC Import and Open Source",
    "local_header_href": "#ifc-import-and-open-source",
    "chunk_text": "### IFC Import and Open Source\n\nQuite a few issues revolving around IFC came up lately in various ADN cases and in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api/bd-p/160).\n\nBefore getting to the technical stuff, here are some pictures from my latest mountaineering trip to climb Gross Spannort:\n\n<center>\n<a data-flickr-embed=\"true\"  href=\"https://www.flickr.com/photos/jeremytammik/albums/72157670398939461\" title=\"Gross Spannort\"><img src=\"https://c2.staticflickr.com/9/8614/28245261321_169d513752_n.jpg\" width=\"320\" height=\"240\" alt=\"Gross Spannort\"></a><script async src=\"//embedr.flickr.com/assets/client-code.js\" charset=\"utf-8\"></script>\n</center>\n\nBack to the Forge, Revit and IFC related programming topics:\n\n- [Autodesk Forge Platform &mdash; Little machines](#2)\n- [IFC import scaling issue](#3)\n- [IFC open source C# library](#4)\n- [Customising IFC import](#5)\n- [IFC family support](#6)"
  },
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "<a name=\"2\"></a>Autodesk Forge Platform &mdash; Little Machines",
    "local_header_href": "#a-name2aautodesk-forge-platform-mdash-little-machines",
    "chunk_text": "#### <a name=\"2\"></a>Autodesk Forge Platform &mdash; Little Machines\n\nEngineering.com published a nice article highlighting\nthe [Autodesk Forge Platform New APIs](http://www.engineering.com/DesignSoftware/DesignSoftwareArticles/ArticleID/12640/Autodesk-Forge-Platform-Gets-New-APIs.aspx).\n\nAutodesk itself published an interesting short video envisioning its use in the shape\nof [Little Machines](https://www.youtube.com/watch?v=tta-V6wyUKY) addressing various design, manufacturing and maintenance aspects:\n\n<center>\n<iframe width=\"420\" height=\"236\" src=\"https://www.youtube.com/embed/tta-V6wyUKY?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n</center>\n\nImagine powerful 3D viewing data state of the art reality capture Internet of Things functionality augmented reality workspaces generative design processes with real-world performance simulation building native design applications to deliver innovative customer experiences leveraging powerful 3D print APIs all on one platform: [Autodesk Forge](https://forge.autodesk.com)."
  },
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "<a name=\"3\"></a>IFC Import Scaling Issue",
    "local_header_href": "#a-name3aifc-import-scaling-issue",
    "chunk_text": "#### <a name=\"3\"></a>IFC Import Scaling Issue\n\n**Question:** I created a simple IFC file representing two pipes and an elbow in an external software.\n\nI can view it perfectly well in several common IFC viewers, e.g.:\n\n- FZKViewer Version V4.6 (64Bit)\n- Solibri V.9.6\n- Tekla BimSight V1.9.7\n- Bim Vision 2.10\n\nHowever, I tried to import it into Revit, and it seems that the specified transformation settings have no effect.\n\nWhat could be causing these issues in Revit and how can I modify the IFC sample file so that Revit can read it correctly?\n\nI already searched for a solution and asked some IFC specialists before turning to you.\n\nI also created a pipe_elbow example in Revit to analyse the difference in the IFC structure, but couldn't find any essential issue.\n\nI store `IfcFlowSegment` and `IfcFlowFitting` in the IFC file.\n\nI took a look at the objects that Revit and MEP export.\n\nMy approach to analyse the problem was to create an IFC file with simple elements (1 pipe or 1 elbow) in Revit and MEP to analyse the result in a text editor.\n\nAfterwards I created a similar file with my engine and compared the difference.\n\nAs far as I can tell, Revit also uses `IfcFaces`, `IfcPolyloops` and `IfcMappedItems`, just like I do.\n\nFor me it seems Revit requires some special conditions that I need to be aware of to create proper Revit IFC files.\n\n\n**Answer:** I uploaded your sample file to A360 and confirm that it does indeed display what looks like two pipes and an elbow:\n\n<center>\n<img src=\"img/simple_pipe_elbow_mh_a360.png\" alt=\"IFC pipes and elbow in A360\" width=\"317\">\n</center>\n\nI tried opening the file in Revit and see nothing at all.\n\nI am discussing with our IFC experts.\n\n> I think the issue is that the pipe is DEFINED in meters, and the scaling transform converts it to millimetres.  It is slightly non-standard to have such an extreme transformation (basically, please scale this down by 1/1000th in every direction), and the Revit Transform code may be getting confused thinking that this is too close to zero.  Still, it isn’t that close to zero, we will take a look and have filed an internal task to do so.\n\n\n**Response:** I could figure out following behaviour:\n\nI modified the row #949 from its original value:\n\n<pre>\n#949 = IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM(#950, #951, #952, 5.00000023748726E-4, #953, 5.00000023748726E-4, 5.00000023748726E-4);\n</pre>\n\nI raised the scaling factor from 1E-4 to 1E-3:\n\n<pre>\n#949 = IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM(#950, #951, #952, 5.00000023748726E-3, #953, 5.00000023748726E-3, 5.00000023748726E-3);\n</pre>\n\nWith that modification, it works.\n\nProbably the original value was below an internal limit that invalidates the whole transformation.\n\nCurrently I’m using metres for the data.\n\nProbably it will work better if using millimetres.\n\n\n**Answer:** Yes, using meters probably explains the issue right away.\n\nPlease be aware that all Revit internal length units are considered to\nbe [imperial feet](http://thebuildingcoder.typepad.com/blog/2011/03/internal-imperial-units.html), and\nthat [Revit does not support very small objects](http://thebuildingcoder.typepad.com/blog/2009/07/think-big-in-revit.html).\n\nEverything that is too small will be ignored. The limit is around 1/16th or an inch, which is about 1.2 mm.\n\nI hope that specifying millimetres instead will resolve the problem.\n\nYou might end up with too large objects, though  :-)\n\nOn the other hand, the units or sizing should in no way affect any transformations being performed.\n\nIn theory, all transformations should be completely unit-less.\n\nIn practice, Revit adds some sanity checks that make sense inside of Revit and just happened to get in the way of your dtat structuring approach.\n\n\n**Response:** I confirmed that the scaling value of the `IfcCartesianTransformationOperator3DnonUniform` causes the issue.\n\nIf I use scale values smaller than `1.E-3`, the transformation matrix is ignored.\n\nAfter using millimetres instead of metres it works without issues."
  },
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "<a name=\"4\"></a>IFC Open Source C# Library",
    "local_header_href": "#a-name4aifc-open-source-c-library",
    "chunk_text": "#### <a name=\"4\"></a>IFC Open Source C# Library\n\nAnother IFC issue came up in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api/bd-p/160) thread on\nan [open source API for reading IFC Files](http://forums.autodesk.com/t5/revit-api/opensource-api-for-reading-ifc-files/td-p/6433280).\n\nIn it, Jon Mirtschin points out his open source IFC C# classes:\n\n**Question:** Can anyone suggest an open source API for reading IFC files?\n\n**Answer:** Which language?  .NET (i.e., c# or vb.net)?\n \nI opensourced the core of\nmy [GeometryGymIFC library](https://github.com/jmirtsch/GeometryGymIFC) earlier in the year.\n\nThis will handle IFC2x3 and IFC4 simultaneously, and I'm enabling ifcxml at the moment (and also ifcjson).\n \nHere are some [GeometryGymIFC examples](https://github.com/jmirtsch/GeometryGymIFCExamples).\n \nIt's also available from nuget.  \n \nThere are alternatives, BIMServer.  For c++, I'd suggest trying IfcOpenShell or the CSTB.\n\nRegarding generic tools, the Building Smart organisation page also provides several pointers\nto [IFC open source](http://www.buildingsmart-tech.org/implementation/get-started/ifc-open-source).\n\nAnother popular IFC ENGINE is [IFCEngine from RDF](http://rdf.bg/products.php)."
  },
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "<a name=\"5\"></a>Customising IFC Import",
    "local_header_href": "#a-name5acustomising-ifc-import",
    "chunk_text": "#### <a name=\"5\"></a>Customising IFC Import\n\n**Question:** I would like to enhance the IFC import to enable importing and creating new electrical distribution board configuration families with connectors and all relevant parameters.\n\nI have therefore two questions:\n\n1. Can I use the Revit IFC API to programmatically adapt (hook into) the IFC import process or to enable a separate IFC import?\n2. Another possibility (in the long run) would be to contribute to the Autodesk Revit open source IFC for Revit project.\n\nAre there plans to develop or allow a more specialized IFC import, creating families (instances) that are more parametric (e.g., support connectors, properties, etc.) and can better be used in later Revit workflows?\n\n**Answer:** Thank you for your query.\n\n1. Regarding your first question, afaik, the IFC API is intended to enable to open source IFC import and export, and nothing further.\n\nIt does not provide any functionality to hook into it, only to implement all the aspects required for the complete IFC import and export.\n\n2. Yes, that is basically the way to go for any enhancements that you require, afaik, both in the short and long run.\n\nI am not aware of any plans for any specific enhancements to the open source project.\n\nI believe it lives a life of its own, and you should contact the project owners to learn more.\n\nActually, you could combine your questions one and two by implementing the hooks that you are interested in in the existing open source implementation.\n\nThe development team adds:\n \n> You can actually override the internal Open IFC command with a custom API.  Basically, Open IFC currently goes through the importer and then calls one API function that does pretty much everything.  You should be able to do your own thing instead.  I don’t know that anyone has tried that so of course it may have faults."
  },
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "<a name=\"6\"></a>IFC Family Support",
    "local_header_href": "#a-name6aifc-family-support",
    "chunk_text": "#### <a name=\"6\"></a>IFC Family Support\n\nI was not aware that IFC supports anything like the concept of Revit families, and Jon set me right on that as well, saying:\n\nI disagree with your statements:\n\n*Family is a pure Revit concept... IFC knows nothing about families and never will.*\n\nIFC has classes derived from an `IfcTypeProduct` which are to all practical purposes the same as a Revit Family, and this concept is understand in various BIM software.  Read the [IfcTypeProduct description](http://www.buildingsmart-tech.org/ifc/IFC4/final/html/link/ifctypeproduct.htm). Note this was introduced in IFC2x which as I understand it was released circa 2000, a similar time to early development of Revit?  If a family is a Revit concept, I'm not sure how [Bentley recognizes anything in a .rfa file](http://communities.bentley.com/products/building/building_analysis___design/f/5917/t/87255). I am pretty sure that manufacturers have expressed object libraries in various forms including CAD prior to this.\n \nTypes as a concept in Revit (variations of a master parametric definition) is not typically implemented in IFC developments but hopefully this changes soon.  IFC4 offers this and I am working on some object library projects that wish to utilize this.\n \n*An IFC file can define a project, not a family.*\n\nThis is again incorrect.  IFC4 added a new context, the [`IfcProjectLibrary`](http://www.buildingsmart-tech.org/ifc/IFC4/final/html/link/ifcprojectlibrary.htm). \nThis is appropriate for exchanging data in the form of object libraries and the like as per it's definition.  It would not contain project and instance elements.  I don't believe Revit supports this context in its native importer or exporter.\n \n*Therefore, if you open an IFC file, it will appear in the project view and never as a family.*\n\nThis might be true at this point in time, but I would hope it might change at some point in time if Autodesk wants to support openBIM workflows.\n \nTo reply to the original question, Geometry Gym offers a 3rd party importer that does generate families and create parameters based on types in `IfcProject` and `IfcProjectLibrary`, cf. [Geometry Gym &gt; Revit](http://geometrygym.blogspot.com.au/search/label/Revit). This is primarily from the user interface, however if you require from the API then I can refactor the method slightly and provide it as a public method in the DLL.  An alternative would be to edit the open source importer and make it recognize these IFC concepts.\n \nMany thanks to Jon for his in-depth knowledge and explanation!"
  },
  {
    "original_filename": "1455_ifc_issues",
    "header_text": "<a name=\"7\"></a>IFC Family Support Discussion Links",
    "local_header_href": "#a-name7aifc-family-support-discussion-links",
    "chunk_text": "#### <a name=\"7\"></a>IFC Family Support Discussion Links\n\nRyan Schulz points out a number of additional interesting discussions on the topic in\nhis [comment below](http://thebuildingcoder.typepad.com/blog/2016/07/ifc-import-and-open-source.html#comment-2797771810):\n\n- [IFC for Revit &ndash; Support for Revit Groups?](https://sourceforge.net/p/ifcexporter/discussion/general/thread/fad5b2f8)\n- [BuildingSMART/mvdXML issue #3 &ndash; Possible to outline an MVD exchange requirement to address the concept of groups? ](https://github.com/BuildingSMART/mvdXML/issues/3)\n- [BuildingSMART/IFC4-CV issue #16 &ndash; Support for a One-to-Many (non-type) of Group](https://github.com/BuildingSMART/IFC4-CV/issues/16)\n- [FreeCAD &ndash; Convert IfcGroups into FreeCAD Compounds](http://forum.freecadweb.org/viewtopic.php?f=23&t=12131)\n- [IndustryFoundationClasses/Questions issue #3 &ndash; Suggested IFC Entity to save a Profile Type](https://github.com/IndustryFoundationClasses/Questions/issues/3)"
  }
]