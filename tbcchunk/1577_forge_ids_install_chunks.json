[
  {
    "original_filename": "1577_forge_ids_install",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Forge Viewer: Unique IDs for clickable objects\n  https://stackoverflow.com/questions/45577971/forge-viewer-unique-ids-for-clickable-objects\n  https://github.com/Autodesk-Forge/bim360appstore-model.derivative-nodejs-xls.exporter\n  I mentioned http://thebuildingcoder.typepad.com/blog/2017/02/rvt-properties-to-xls-and-forge-accelerators.html\n  Augusto Goncalves implemented the viewer-javascript-extract.spreadsheet Forge sample to read all the properties on all BIM elements in an RVT file and export them to an XLSX spreadsheet.\n  https://forge.autodesk.com/blog/create-spreadsheet-excel-client-translated-revit-files\n\n- revitlookup installation\n  email [Revit2017 Look UP - How to install?] \n\n- updated wizard installation\n\nRevit versus Forge, Ids and Add-In Installation #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/forgervtidsinstall\n\nForge versus Revit programming\n&ndash; Access Revit BIM data and element ids from BIM360\n&ndash; Unique IDs for Forge viewer elements\n&ndash; Edit and export Revit properties in Forge\n&ndash; Upcoming Forge accelerators\n&ndash; Updated Visual Studio Revit add-in wizard installation\n&ndash; Question on RevitLookup installation\n&ndash; RevitLookup cannot snoop everything...\n\n--->"
  },
  {
    "original_filename": "1577_forge_ids_install",
    "header_text": "Revit versus Forge, Ids and Add-In Installation",
    "local_header_href": "#revit-versus-forge-ids-and-add-in-installation",
    "chunk_text": "### Revit versus Forge, Ids and Add-In Installation\n\nStill getting back into normal work flow after some time off, I have a bunch of stuff to share:\n\n- [Forge versus Revit programming](#2)\n- [Access Revit BIM data and element ids from BIM360](#3)\n- [Unique IDs for Forge viewer elements](#4)\n- [Edit and export Revit properties in Forge](#5)\n- [Upcoming Forge accelerators](#6)\n- [Updated Visual Studio Revit add-in wizard installation](#7)\n- [Question on RevitLookup installation](#8)\n- [RevitLookup cannot snoop everything](#9)\n\n\n####<a name=\"2\"></a>Forge versus Revit Programming\n\nBefore designing or implementing a Revit add-in, it is well worth pondering the status, use and cost of Revit in depth.\n\nWho is supposed to make use of your add-in?\n\nWho is supposed to install &ndash; and pay for &ndash; Revit?\n\nRevit is a very specialised, high-level and costly BIM design tool.\n\nI would expect a limited number of people to be directly involved in creative hard-core BIM work.\n\nMany add-ins can add immense value to the BIM and construction process with no need for such a tight integration with Revit.\n\nMany add specific data items or perform read-only analysis and reporting tasks.\n\nFor all such tasks, it may be well worthwhile thinking of shifting your app development platform to a much more accessible &ndash; and cheaper &ndash; environment, e.g., [Forge](https://autodesk-forge.github.io).\n\nTwo of my recent samples demonstrate the implementation of equivalent functionality using Revit and its API versus Forge and JavaScript:\n\n- [RvtFader](https://github.com/jeremytammik/RvtFader) &ndash; C# .NET Revit add-in to calculate and display signal attenuation using AVF\n- [ForgeFader](https://github.com/jeremytammik/forgefader) &ndash; Forge viewer extension to calculate and display signal attenuation, cf.\nthe [online demo](https://forge-rcdb.autodesk.io/configurator?id=59041f250007f5c0eef482f2)\n\nInterestingly enough, moving your app development out of the specialised .NET Revit API into a much more generic JavaScript based development platform makes development easier, faster, enables much better integration with other components, and provides access to a  larger number of existing libraries for almost any conceivable task.\n\nFurthermore, if you really do require Revit specific functionality, e.g., you wish to modify the BIM and write `RVT` files, and want to provide your app to a large or unlimited number of users in a flexible fashion, not necessarily bound to a full-fledged Revit desktop installation, be aware that we are continuing to work hard on a Forge design automation API\nto [provide all you need online, aka Revit I/O](http://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28b).\n\n\n####<a name=\"3\"></a>Access Revit BIM Data and Element Ids from BIM360\n\nContinuing in this vein, are you interested in easy and ubiquitous access to your Revit model properties?\n\nWell, you can have that right now, even without any Revit installation whatsoever.\n\nThe Forge [Model Derivative API](https://developer.autodesk.com/en/docs/model-derivative/v2/overview/) extracts\na streamlined copy of all geometry, BIM element hierarchy and properties from over fifty file formats, and Revit `RVT` files are just one of them.\n\nAs [mentioned](http://thebuildingcoder.typepad.com/blog/2017/02/rvt-properties-to-xls-and-forge-accelerators.html) a\nwhile ago, [Augusto Goncalves](https://twitter.com/search?q=augusto%20goncalves) implemented\nthe `viewer-javascript-extract.spreadsheet` Forge sample to read all the properties on all BIM elements in an `RVT` file and export them to an `XLSX` spreadsheet.\n\n- [Test run it yourself](https://autodesk-forge.github.io/viewer-javascript-extract.spreadsheet)\n- [Source code on GitHub](https://github.com/Autodesk-Forge/viewer-javascript-extract.spreadsheet)\n- [Blog post announcement](https://forge.autodesk.com/blog/create-spreadsheet-excel-client-translated-revit-files)\n\nMy new colleague\n[Michael](https://forge.autodesk.com/author/michael-beale)\n[Beale](https://twitter.com/micbeale) now\nreleased another sample that adds the functionality to access a Revit BIM stored in BIM360: the\n[BIM360 Revit Export to Excel sample](https://github.com/Autodesk-Forge/bim360appstore-model.derivative-nodejs-xls.exporter)\ndemonstrates how to access and extract Revit data on your BIM360 account using 3-legged `OAuth` to log in, a simple viewer extension and code to read the Revit meta-data and format it into an Excel spreadsheet file:\n\n- [Live demo](https://bim360xls.autodesk.io)\n- [Video](https://youtu.be/800d2xmQl0s)\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/800d2xmQl0s?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n</center>\n\nMany thanks to Augusto and Michael for putting these together!\n\n\n####<a name=\"4\"></a>Unique IDs for Forge Viewer Elements\n\nAugusto uses Michael's sample to answer the StackOverflow question\non [Forge Viewer: unique IDs for clickable objects](https://stackoverflow.com/questions/45577971/forge-viewer-unique-ids-for-clickable-objects):\n\n**Question:** I am experimenting with Revit and the Forge Viewer.\nI noticed that Forge has its own unique IDs for everything you can click on in the Revit model, so I used those instead of the Revit identifiers.\n\nFor example, the door of my building has the id: \"3003\".\n\nMy question is: where is this data stored and how can I change \"3003\" into \"Door 1\"?\n\n**Answer:** The Viewer gives access to three types of IDs when dealing with Revit files:\n\n- `dbId`: this is viewer specific and used to manipulate elements within the viewer, such as for the `.getProperties()` method.\n- Revit `ElementID`: exposed as part of the `Name` property in the viewer. When you select something, the Property panel title is in the form of 'Name [12345]'. You can parse this name string and extract the element id.\n- Revit `UniqueID`: exposed as the `externalId` property in the `.getProperty()` response.\n\nThe\n[BIM360 Revit Export to Excel sample](https://github.com/Autodesk-Forge/bim360appstore-model.derivative-nodejs-xls.exporter)\nmentioned above exports properties into a spreadsheet, which ought to answer your question.\n\n\n####<a name=\"5\"></a>Edit and Export Revit Properties in Forge\n\nPhilippe Leefsma demonstrates similar functionality in his [Configurator &ndash; Meta Properties](https://forge-rcdb.autodesk.io/configurator?id=59780eec17d671029c53420e) sample.\n\n- Look at\nthe [online Forge configurator sample](https://forge-rcdb.autodesk.io/configurator).\n- Scroll down through the models to *Meta Properties*.\n- In the left-hand drop-down menu, select *Office*.\n- Click on the *Meta Properties* box.\n\nThe office model is displayed, and its properties displayed in a panel on the right-hand side.\n\nYou can select any BIM element and see all its properties as well.\n\nThe buttons on the right-hand side of the property panel enable search, export to `CSV` and `JSON`, and adding new properties.\n\nEach property can also be deleted.\n\n\n####<a name=\"6\"></a>Upcoming Forge Accelerators\n\nIf you would like to learn more about Forge, don't miss the chance to\n[join one of the upcoming accelerators](http://autodeskcloudaccelerator.com/prague-2):\n\n- Bangalore, India &ndash; September 4-8\n- Moscow, Russia &ndash; September 25-29\n- Lyon, France &ndash; October 23-27\n- Munich, Germany &ndash; date TBD\n\n<center>\n<img src=\"img/2017-08_upcoming_accelerators.png\" alt=\"Upcoming Forge accelerators\" width=\"500\"/>\n</center>\n\n\n####<a name=\"7\"></a>Updated Visual Studio Revit Add-In Wizard Installation\n\nBack to pure Revit API related topics, \n[Irneb](https://github.com/irneb) raised an issue with the [Visual Studio Revit Add-In Wizards](http://thebuildingcoder.typepad.com/blog/about-the-author.html#5.20) \nin his [issue #6 &ndash; install script alteration suggestion](https://github.com/jeremytammik/VisualStudioRevitAddinWizard/issues/6), and solved it \nwith [pull request #7 &ndash; path to profile folder](https://github.com/jeremytammik/VisualStudioRevitAddinWizard/pull/7).\n\nHe says:\n\nIn the install.bat file you're getting to the documents folder by building up the path using the username. Unfortunately, this isn't always the case. Also, the C drive is not necessarily where the user's home folder resides.\n\nI suggest changing the 6th line from this:\n\n<pre>\nset \"D=C:\\Users\\%USERNAME%\\Documents\\Visual Studio 2015\\Templates\\ProjectTemplates\"\n</pre>\n\nto this:\n\n<pre>\nset \"D=%userprofile%\\Documents\\Visual Studio 2015\\Templates\\ProjectTemplates\"\n</pre>\n\nThat should at least help where the user's home folder isn't in the usual position (or named the same as the username).\n\nWhat is a bit cumbersome though is if the Documents folder under that has been relocated. Unfortunately, the only place this is available is in registry. Else you can get to it using vbscript or PowerShell.\n\nHere's a way to use PowerShell inside a `BAT` file:\n\n<pre>\nset T=\"%TEMP%\\docspath.tmp\" powershell -Command \"[Environment]::GetFolderPath('MyDocuments') | Out-File '%T%' -Encoding ascii\" set /p DOCSPATH=< \"%T%\" del \"%T%\"\n</pre>\n\nThereafter the line above can be changed to this instead:\n\n<pre>\nset \"D=%DOCSPATH%\\Visual Studio 2015\\Templates\\ProjectTemplates\"\n</pre>\n\nThough it just feels way too complicated for my taste.\n\nI fully agree.\n\nI'm definitely not a Windows shell or installation expert, and I am sure there are much more elegant ways to address this.\n\nStill, being as it is, the updated version is captured\nin [release 2018.0.0.1](https://github.com/jeremytammik/VisualStudioRevitAddinWizard/releases/tag/2018.0.0.1).\n\nThe [difference to the previous version](https://github.com/jeremytammik/VisualStudioRevitAddinWizard/compare/2018.0.0.0...2018.0.0.1) consists\nof just two modified lines in `TemplateRevitCs.csproj` and `install.bat`.\n\n\n####<a name=\"8\"></a>Question on RevitLookup Installation\n\n[RevitLookup](https://github.com/jeremytammik/RevitLookup) is *the* main Revit BIM database exploration tool.\n\n**Question:** I am trying to install RevitLookup on Revit 2017, and having a bit of difficulty figuring out how to go about the installation in Revit.\n\nI downloaded it from GitHub and unpacked the `ZIP` file. Now, according to the instructions, I have to do the following:\n \n- Copy the add-in manifest and assembly DLL to the Revit `AddIns` folder.\n \nI located the folder with this path: Local disk (C:) &ndash; Program Data &ndash; Autodesk &ndash; Revit &ndash; Addins &ndash; 2017\n \nNow, I am wondering how to identify the assembly DLL and whether I need to specify a 'key' in order to sign it.\n \nSecondly, I can’t find the add-in manifest anywhere in the repository.\n\n**Answer:** To understand the Revit add-in installation process properly in depth, I suggest that you study the [Revit API getting started material](http://thebuildingcoder.typepad.com/blog/about-the-author.html#2).\n \nIt explains all you need to know about installing a Revit add-in.\n \nSo does the [developer guide](http://help.autodesk.com/view/RVT/2018/ENU/?guid=GUID-F0A122E0-E556-4D0D-9D0F-7E72A9315A42) in\nthe [Revit help](http://help.autodesk.com/view/RVT/2018/ENU),\nspecifically in its more succinct section\non [add-in registration](http://help.autodesk.com/view/RVT/2018/ENU/?guid=GUID-4FFDB03E-6936-417C-9772-8FC258A261F7).\n \nNo, you do not need to sign anything.\n \nNormally, you do not need to make any changes at to the add-in manifest.\n \nIt is provided right there, in the repository\nfolder [`CS`](https://github.com/jeremytammik/RevitLookup/blob/master/CS):\n \n- [RevitLookup.addin](https://github.com/jeremytammik/RevitLookup/blob/master/CS/RevitLookup.addin)\n \nFurthermore, very conveniently, YouTube presents\nseveral [videos on installing RevitLookup](https://www.youtube.com/results?search_query=revitlookup).\n\n\n####<a name=\"9\"></a>RevitLookup Cannot Snoop Everything\n\nAnother little note on RevitLookup.\n\nPrompted by the [issue #35 &ndash; RevitLookup doesn't snoop all members](https://github.com/jeremytammik/RevitLookup/issues/35),\nI enhanced the documentation with the [caveat &ndash; RevitLookup cannot snoop everything](https://github.com/jeremytammik/RevitLookup#caveat--revitlookup-cannot-snoop-everything):\n\n**Question:** I tried snooping a selected Structural Rebar element in the active view and found not all of the Rebar class members showed up in the Snoop Objects window. One of many members that weren't there: `Rebar.GetFullGeometryForView` method.\n\nIs this the expected behaviour? I was thinking I could get all object members just with  RevitLookup and without the Revit API help file `RevitAPI.chm`.\n\n**Answer:** RevitLookup cannot report **all** properties and methods on **all** elements.\n\nFor instance, in the case of GetFullGeometryForView, a view input argument is required. How is RevitLookup supposed to be able to guess what view you are interested in?\n\nFor methods requiring dynamic input that cannot be automatically determined, you will have to [make use of more intimate interactive database exploration tools, e.g. RevitPythonShell](http://thebuildingcoder.typepad.com/blog/2013/11/intimate-revit-database-exploration-with-the-python-shell.html)."
  }
]