[
  {
    "original_filename": "1601_delete_global_param",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- 13580220 [Deletion of Global Parameters]\n\nDeleting a Global Parameter and RevitPythonShell #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/delgloparpy\n\nI have list of all global parameters from the active Revit document. I want to delete a specific global parameter from the list programmatically. Kindly suggest a way to delete a global parameter from the active document...\n\n--->"
  },
  {
    "original_filename": "1601_delete_global_param",
    "header_text": "Deleting a Global Parameter and RevitPythonShell",
    "local_header_href": "#deleting-a-global-parameter-and-revitpythonshell",
    "chunk_text": "### Deleting a Global Parameter and RevitPythonShell\n\nThis is another entry in the list of my attempts at teaching Revit API developers how to fish instead of feeding them.\nMostly, it ends up a mixture between the two, of course:\n\n- [Creating a group and how to fish](http://thebuildingcoder.typepad.com/blog/2009/02/creating-a-group-and-how-to-fish.html)\n- [Teaching a man how to fish and schedule creation](http://thebuildingcoder.typepad.com/blog/2014/07/teaching-a-man-how-to-fish-and-schedule-creation.html)\n- [Trusted signature motivation and fishing](http://thebuildingcoder.typepad.com/blog/2016/09/trusted-signature-motivation-and-fishing.html)\n\nThis time, we address the question on how to:\n\n- [Delete a global parameter](#2) and \n- [Test the result using RevitPythonShell](#3)\n\n####<a name=\"2\"></a>Deleting a Global Parameter\n\n**Question:** I have list of all global parameters from the active Revit document. I want to delete a specific global parameter from the list programmatically. Kindly suggest a way to delete a global parameter from the active document.\n\n**Answer:** Thank you for your query.\n\nYou can easily answer this question yourself, you know.\n\nI did not know either, on first reading your question.\n\nHere is the path I took to search for an answer:\n\nI initially [searched the Internet for 'revit api delete global parameter'](https://duckduckgo.com/?q=revit+api+delete+global+parameter).\n\nThis led to some non-API discussions, such as the one\nby [RevitCat](http://revitcat.blogspot.de) \non [Deleting Global Parameters in Revit](http://revitcat.blogspot.de/2017/04/deleting-global-parameters-in-revit.html).\n\nIt also led to the official [developer guide discussion on managing global parameters](https://knowledge.autodesk.com/support/revit-products/getting-started/caas/CloudHelp/cloudhelp/2017/ENU/Revit-API/files/GUID-9FDC35A5-C054-46CA-B2DC-E20958FD197F-htm.html).\n\nThere, I learned that this is achieved programmatically using\nthe [`GlobalParametersManager` class](http://www.revitapidocs.com/2018.1/f3af05ec-1f0c-fe86-6708-0a211a40bcda.htm).\n\nIt does not provide any method to delete a global parameter.\n\nHowever, the access to global parameters is provided by\nthe [`FindByName` method](http://www.revitapidocs.com/2018.1/7c7a7bd3-18e8-d9be-d9a7-66cd9ecdccc7.htm).\n\nThat method simply returns an element id.\n\nThis means that each global parameter is stored in the document database as a normal Revit element.\n\nThis means that it can be deleted using the `Document.Delete` method taking an `ElementId` or a collection, just like any other Revit element.\n\n####<a name=\"3\"></a>Testing Using RevitPythonShell\n\nI decided to try this out on the fly\nusing [RevitPythonShell](https://github.com/architecture-building-systems/revitpythonshell).\n\nI did not have it installed previously, but that can be achieved in seconds with a single click on\nthe [RevitPythonShell installer](https://github.com/architecture-building-systems/revitpythonshell#installation).\n\nI then launched Revit and created a global parameter manually through the user interface:\n\n<center>\n<img src=\"img/global_parameter_01.png\" alt=\"Global parameter\" width=\"475\"/>\n</center>\n\nNext, I started the interactive Python shell and ran the following code:\n\n<pre class=\"prettyprint\">\nfrom Autodesk.Revit.DB import *\ndoc = __revit__.ActiveUIDocument.Document\nid = GlobalParametersManager.FindByName(doc,'Test')\nt = Transaction(doc)\nt.Start('delete gp')\ndoc.Delete(id)\nt.Commit()\n</pre>\n\nImmediately after running this code, the global parameter is no longer listed in the user interface.\n\nI trust this solves your issue."
  }
]