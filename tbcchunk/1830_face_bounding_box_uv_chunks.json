[
  {
    "original_filename": "1830_face_bounding_box_uv",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n</head>\n\n<!---\n\ntwitter:\n\nUnderstanding the Face UV coordinate space and handling add-in command binding replacement conflicts in the #RevitAPI #DynamoBim @AutodeskForge @AutodeskRevit #bim #ForgeDevCon https://bit.ly/cmdbindfacebb\n\nToday, let's pick up two recent discussions on the <code>UV</code> coordinate space on a face and the replacement of add-in command bindings\n&ndash; Understanding the Face <code>BoundingBoxUV</code>\n&ndash; Handling add-in command binding conflicts...\n\nlinkedin:\n\nUnderstanding the Face UV coordinate space and handling add-in command binding replacement conflicts in the #RevitAPI\n\nhttps://bit.ly/cmdbindfacebb\n\nToday, we pick up two recent discussions on the UV coordinate space on a face and the replacement of add-in command bindings:\n\n- Understanding the Face BoundingBoxUV\n- Handling add-in command binding conflicts...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1830_face_bounding_box_uv",
    "header_text": "Command Binding Conflicts and Face UV Coords",
    "local_header_href": "#command-binding-conflicts-and-face-uv-coords",
    "chunk_text": "### Command Binding Conflicts and Face UV Coords\n\nToday, let's pick up two recent discussions on the `UV` coordinate space on a face and the replacement of add-in command bindings:\n\n- [Understanding the Face `BoundingBoxUV`](#2)\n- [Handling add-in command binding conflicts](#3)"
  },
  {
    "original_filename": "1830_face_bounding_box_uv",
    "header_text": "<a name=\"2\"></a>Understanding the Face BoundingBoxUV",
    "local_header_href": "#a-name2aunderstanding-the-face-boundingboxuv",
    "chunk_text": "#### <a name=\"2\"></a>Understanding the Face BoundingBoxUV\n\nThis question was raised in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [how to understand the `BoundingBoxUV` of face](https://forums.autodesk.com/t5/revit-api-forum/how-to-understand-the-boundingboxuv-of-face/m-p/9374555):\n\n**Question:** I am doing something with AVF, and have some problems with the `BoundingBoxUV` of face.\n\nI use the following code to find the feature points in the bottom-left corner area of the face:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">BoundingBoxUV</span>&nbsp;bb&nbsp;=&nbsp;face.GetBoundingBox();\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">UV</span>&nbsp;pmid&nbsp;=&nbsp;0.5&nbsp;*&nbsp;(bb.Min&nbsp;+&nbsp;bb.Max);\n</pre>\n\nHowever, the result shows that these points refer to the upper-right corner area:\n\n<center>\n<img src=\"img/face_bounding_box_ll.png\" alt=\"Face bounding box lower left\" title=\"Face bounding box lower left\" width=\"500\"/> <!-- 1142 -->\n</center>\n\nI'm confused about this result! Can anyone can help me? Thanks in advance!\n\n**Answer:** You need to know in which `XYZ` direction in 3D space the `UV` vector components `U` and `V` are pointing.\n\nYou can find out by using\nthe [Project method](https://www.revitapidocs.com/2020/802cc09b-d0a4-dfc5-8ca1-e8c5e8cd4ced.htm) to\nproject a `XYZ` point onto the face surface and seeing where it ends up.\n\nThere is probably some more direct way to query either the face or its underlying surface for the U and V directions in 3D space.\n\n**Response:** Forgive me, I don't understand your method, but it inspired me to think of another way.\n\nI use Dynamo to query the U and V directions of the face, and I am glad to share it:\n\n<center>\n<img src=\"img/face_bounding_box_uv_dyn.png\" alt=\"Dynamo query for face U and V\" title=\"Dynamo query for face U and V\" width=\"800\"/> <!-- 1506 -->\n</center>\n\nMany thanks to Bing Yongcao for sharing this solution!"
  },
  {
    "original_filename": "1830_face_bounding_box_uv",
    "header_text": "<a name=\"3\"></a>Handling Add-In Command Binding Conflicts",
    "local_header_href": "#a-name3ahandling-add-in-command-binding-conflicts",
    "chunk_text": "#### <a name=\"3\"></a>Handling Add-In Command Binding Conflicts\n\nAn interesting question was raised by Smcoder and addressed by Autodesk developer Phil Xia in\na [series](https://thebuildingcoder.typepad.com/blog/2012/06/replacing-built-in-commands-and-their-ids.html#comment-4837624436)\n[of](https://thebuildingcoder.typepad.com/blog/2012/06/replacing-built-in-commands-and-their-ids.html#comment-4837714095)\n[comments](https://thebuildingcoder.typepad.com/blog/2012/06/replacing-built-in-commands-and-their-ids.html#comment-4838966941)\non [replacing built-in commands and obtaining their ids](https://thebuildingcoder.typepad.com/blog/2012/06/replacing-built-in-commands-and-their-ids.html):\n\n**Question:** Do you know how it is handled if two different external applications bind to the same Revit Built-In Command?\nI haven't found any documentation, so I'm thinking of testing it myself to see what happens.\nIn the case of a commercial product, you don't want your external application to conflict with any other product that may be running.\nSo, how does Revit handle precedence when multiple add-ins subscribe to the same events or commands?\n\nUpdate: From conducting my own testing, it appears that `AddInCommandBinding` is first come, first served.\nOn Revit startup, the various addins load alphabetically based on the name of the manifest file.\nIt appears to me that when multiple external apps all attempt to bind the same built-in command, only the first app to load gets it.\nThat being the case, one and only one of the applications responds when the desired BuiltInCommand is detected.\nIf this is true, then any reliance on `AddInCommandBinding` would be extremely risky business if you're producing commercial software.\nIf you had the bad fortune of the user installing another addin that ties up the same command and happens to alphabetize before your app, then you could have core features that will not fire.\n\nCan anyone confirm this finding?\n\n**Answer:** I am Phil from development team.\nYes, you are right, and the `AddInCommandBinding` is indeed first come, first served, based on the name of manifest file alphabetically.\n\nI would suggest that use a `try` `catch` handler to wrap the code to create the addincommand binding so it will throw an exception to say \"The command xxx has already been replaced by xxx addin\" in this case.\nYou can build your UI experience based on this exception to help customer to make the decision to choose which addin they want to use or not.\nIt is not an elegant solution because the customer has to unload one addin and restart Revit.\n\n<center>\n<img src=\"img/AddInCommandBinding_already_replaced.png\" alt=\"AddInCommandBinding already replaced\" title=\"AddInCommandBinding already replaced\" width=\"362\"/> <!-- 362 -->\n</center>\n\n**Response:** Thank you for following up on this.\nIt's great to know exactly how the binding works so that I can plan accordingly.\nIn my case, I may opt for an altogether different solution that does not require binding to the built-in command.\n\nOn closer inspection, I now see the mistake that prevented me from highlighting this issue earlier.\nI had over-constrained my external application's `OnStartup` routine with an overall `try` `catch` wrapper that simply returned \"Result.Failed\" on exception.\nSo, the routine was being stopped and the error was being caught, but no actionable information was returned in the form of exception text, etc.\n\nMany thanks to Phil and Smcoder for raising and clarifying this question."
  }
]