[
  {
    "original_filename": "1919_py_cs_template",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- https://github.com/jeremytammik/RevitLookup/pull/91\n  https://github.com/jeremytammik/RevitLookup/releases/tag/2022.0.0.16\n  integrated pull request #91 by @mphelt to add PartUtilsStream\n  https://github.com/mphelt\n  Adds PartUtilsStream that populates highlighted entries:\n  a/img/revitlookup_PartUtilsStream.png\n  Duplicated OriginalCategoryId shows value as f.e. OST_Walls instead of < null >.\n  Duplicated GetSourceElementIds shows a 'flattened' list of elements instead of original list of LinkElementIds.\n  Duplicated GetSourceElementOriginalCategoryIds uses EnumerableAsString to show value as f.e. 'OST_Walls, OST_Walls'.\n\n- C# templates for Revit\n  Роман Карпович <nice3point@gmail.com>\n  Hi Jeremy, I made some really cool templates for creating revit plugins. With a build system, creating installers and bundles for the Autodesk Store. Ready-made files for AzureDevOps, GitHubActions have been written. A minimum of steps for starting and routine work, all GUIDs are generated by themselves when creating a project. Added the ability to merge several DLLs into one, just specify the names of the merged files. For Debug configurations, all files are copied to the addons folder by themselves. It is also possible to add unique configurations, for example, a configuration for AdskStore, where you can check whether a plugin is purchased or not, in the second case, display an informational message and redirect to a page in the store. You can test them here https://github.com/Nice3point/RevitTemplates and share them on your blog. Video with an example in the attached files.\n  FirstSteps.mp4 -- https://drive.google.com/file/d/1Pm0tygJNRcXP_8O8XCsk2C5Jt3FQFCym/view\n  StoreVersion.mp4 -- https://drive.google.com/file/d/1bPveyMoGi0U9MVTT0UxWVPK7gXb2amJu/view\n  https://github.com/Nice3point/RevitTemplates\n\n- C# and IronPython Hosting for Revit addins\n  https://forums.autodesk.com/t5/revit-api-forum/c-and-ironpython-hosting-for-revit-addins/m-p/10629723\n  \n- CPython and Python 3\n  PyRevit and Revit 2022 w/ Dynamo\n  https://forums.autodesk.com/t5/revit-api-forum/pyrevit-and-revit-2022-w-dynamo/m-p/10638367\n\ntwitter:\n\nadd #thebuildingcoder\n\nA neat RevitLookup enhancement for snooping PartUtils, a couple of Python related topics and a powerful new Revit add-in template for the #RevitAPI #DynamoBim @AutodeskForge @AutodeskRevit #bim #ForgeDevCon https://autode.sk/snoopparts\n\nA neat RevitLookup enhancement, powerful new Revit add-in template, and a couple of Python related topics\n&ndash; RevitLookup handles <code>PartUtils</code>\n&ndash; Nice3point Revit add-in C&#35; template\n&ndash; IronPython hosting in C&#35; add-in\n&ndash; Python 3, CPython, pyRevit and Dynamo...\n\nlinkedin:\n\nA neat RevitLookup enhancement for snooping PartUtils, a couple of Python related topics and a powerful new Revit add-in template for the #RevitAPI\n\nhttps://autode.sk/snoopparts\n\n- RevitLookup handles PartUtils\n- Nice3point Revit add-in C# template\n- IronPython hosting in C# add-in\n- Python 3, CPython, pyRevit and Dynamo...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n**Question:** \n\n**Answer:**\n\n**Response:**  \n\nMany thanks to  for this very helpful explanation!\n\n<pre class=\"code\">\n</pre>\n\n-->"
  },
  {
    "original_filename": "1919_py_cs_template",
    "header_text": "Snooping Parts, C&#35; Templates and Python Topics",
    "local_header_href": "#snooping-parts-c35-templates-and-python-topics",
    "chunk_text": "### Snooping Parts, C&#35; Templates and Python Topics\n\nA neat RevitLookup enhancement, powerful new Revit add-in template, and a couple of Python related topics:\n\n- [RevitLookup handles `PartUtils`](#2)\n- [Nice3point Revit add-in C&#35; template](#3)\n- [IronPython hosting in C&#35; add-in](#4)\n- [Python 3, CPython, pyRevit and Dynamo](#5)"
  },
  {
    "original_filename": "1919_py_cs_template",
    "header_text": "RevitLookup Handles PartUtils",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> RevitLookup Handles PartUtils\n\nRevitLookup now displays `PartUtils` information.\n\n[mphelt](https://github.com/mphelt) submitted\n[pull request #91 to add `PartUtilsStream`](https://github.com/jeremytammik/RevitLookup/pull/91),\nintegrated in [RevitLookup release 2022.0.0.16](https://github.com/jeremytammik/RevitLookup/releases/tag/2022.0.0.16).\n\nThe new `PartUtils` stream also populates the following highlighted entries:\n\n<center>\n<img src=\"img/revitlookup_PartUtilsStream.png\" alt=\"Snoop PartUtils\" title=\"Snoop PartUtils\" width=\"354\"/> <!-- 354 -->\n</center>\n\n- Duplicated `OriginalCategoryId` shows value as f.e. `OST_Walls` instead of <code>&lt;null&gt;</code>\n- Duplicated `GetSourceElementIds` shows a flattened list of elements instead of original list of `LinkElementIds`\n- Duplicated `GetSourceElementOriginalCategoryIds` uses `EnumerableAsString` to show value as f.e. 'OST_Walls, OST_Walls'\n\nMany thanks to [mphelt](https://github.com/mphelt) for this important enhancement!"
  },
  {
    "original_filename": "1919_py_cs_template",
    "header_text": "Nice3point Revit Add-In C&#35; Template",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Nice3point Revit Add-In C&#35; Template\n\nWe mentioned several alternatives to\nmy very simple [Visual Studio Revit add-in wizard](https://github.com/jeremytammik/VisualStudioRevitAddinWizard) in\nthe past.\n\nI just added a list of them to the GitHub repo readme and\nthe corresponding [topic group](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.20).\n\nRoman Karpov, aka Роман Карпович, now shares another one, saying:\n\n> I made some really cool templates for creating Revit plugins.\nThey include a build system, creating installers, creating bundles for the Autodesk AppStore, ready-made files for AzureDevOps, and GitHubActions.\nThey require a minimum of steps for starting and routine work.\nAll GUIDs are automatically generated when creating a project.\nAdded the ability to merge several DLLs into one; just specify the names of the merged files.\nFor Debug configurations, all files are copied to the add-ins folder by themselves.\nIt is also possible to add unique configurations; for example, a configuration for AdskStore, where you can check whether a plugin has been purchased or not; if not, display an informational message and redirect to a page in the store.\n\n> You can test them at [Nice3point/RevitTemplates](https://github.com/Nice3point/RevitTemplates).\n\n> Check out the example videos:\n\n- [FirstSteps.mp4](https://drive.google.com/file/d/1Pm0tygJNRcXP_8O8XCsk2C5Jt3FQFCym/view)\n- [StoreVersion.mp4](https://drive.google.com/file/d/1bPveyMoGi0U9MVTT0UxWVPK7gXb2amJu/view)\n- [Nice3point/RevitTemplates](https://github.com/Nice3point/RevitTemplates)\n\nThank you very much for sharing these, Роман!"
  },
  {
    "original_filename": "1919_py_cs_template",
    "header_text": "IronPython Hosting in C&#35; Add-In",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> IronPython Hosting in C&#35; Add-In\n\nDaniel Gerčák shares a solution implementing his\nown [IronPython](https://ironpython.net) hosting in a Revit add-in in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [C&#35; and IronPython hosting for Revit addins](https://forums.autodesk.com/t5/revit-api-forum/c-and-ironpython-hosting-for-revit-addins/m-p/10629723):\n\n\n**Question:** I try to run IronPython scripts via IronPython.Hosting in C#, inspired by Nick Cosentino's\narticle [Python, Visual Studio, and C&#35;, so sweet](https://www.codeproject.com/Articles/657698/Python-Visual-Studio-and-Csharp-So-Sweet).\n\nThe purpose of such effort is to create easy distributable and accessible addins in our company which are developed by a small group of non IT experts on the IronPython platform due to its flexibility and lower demandings for coding skills.\nYes, I've heard about RevitPythonShell, but this is not exactly what would make sufficient result.\n\nI was able to run classes using references to `RevitAPI` and `RevitAPIUI` but receive empty objects trying to use `RevitServices`:\n\n<pre class=\"prettyprint\">\nfrom RevitServices.Persistence import DocumentManager\ndoc = DocumentManager.Instance.CurrentDBDocument\nuiapp = DocumentManager.Instance.CurrentUIApplication\nuidoc = DocumentManager.Instance.CurrentUIApplication.ActiveUIDocument\n</pre>\n\nI wonder if my intention to run such scripts is useless effort due to some restrictions in source code or is there some way to deal with this issue.\n\nHere is a piece of code for better overview of what I am trying to achieve,\n[totalSelectedVolume.zip](zip/dg_totalSelectedVolume.zip),\ncontaining totalSelectedVolumeCommand.cs and totalSelectedVolume.py.\nThe former implements an external command and executes the latter via the `IronPython.Hosting` `ExecuteFile` method, performing the actual computation.\n\n**Answer:** You can take a look at the open source implementations\nof [RevitPythonShell](https://github.com/architecture-building-systems/revitpythonshell)\nand [pyRevit](https://github.com/eirannejad/pyRevit) to\ndiscover how they have addressed this same issue.\n\n**Response:** I did a little research and I was successful.\n\nThe point was to create a new variable within the IronPython engine and assign the `commandData.Application` object to it so that you can access it from the Python environment.\nI named it the same way as it is in RPS, `__revit__`, in order to keep compatibility with scripts developed for RPS.\nSince I've tested it only by using simple Python code, I don't guarantee its functionality with more complex scripts.\nAdditional settings might be required.\n\nThe execute function looks like this.\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;Result&nbsp;Execute(\n&nbsp;&nbsp;&nbsp;&nbsp;ExternalCommandData&nbsp;commandData,\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">ref</span>&nbsp;<span style=\"color:blue;\">string</span>&nbsp;message,\n&nbsp;&nbsp;&nbsp;&nbsp;ElementSet&nbsp;elements&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;UIApplication&nbsp;_revit&nbsp;=&nbsp;commandData.Application;\n&nbsp;&nbsp;&nbsp;&nbsp;UIDocument&nbsp;uidoc&nbsp;=&nbsp;_revit.ActiveUIDocument;\n&nbsp;&nbsp;&nbsp;&nbsp;Document&nbsp;doc&nbsp;=&nbsp;uidoc.Document;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;flags&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;Dictionary&lt;<span style=\"color:blue;\">string</span>,&nbsp;<span style=\"color:blue;\">object</span>&gt;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span style=\"color:#a31515;\">&quot;Frames&quot;</span>,&nbsp;<span style=\"color:blue;\">true</span>&nbsp;},\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span style=\"color:#a31515;\">&quot;FullFrames&quot;</span>,&nbsp;<span style=\"color:blue;\">true</span>&nbsp;}&nbsp;};\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;py&nbsp;=&nbsp;IronPython.Hosting.Python.CreateEngine(&nbsp;flags&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;scope&nbsp;=&nbsp;IronPython.Hosting.Python.CreateModule(&nbsp;py,&nbsp;<span style=\"color:#a31515;\">&quot;__main__&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;scope.SetVariable(&nbsp;<span style=\"color:#a31515;\">&quot;__commandData__&quot;</span>,&nbsp;commandData&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;add&nbsp;special&nbsp;variable:&nbsp;__revit__&nbsp;to&nbsp;be&nbsp;globally&nbsp;visible&nbsp;everywhere:</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;builtin&nbsp;=&nbsp;IronPython.Hosting.Python.GetBuiltinModule(&nbsp;py&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;builtin.SetVariable(&nbsp;<span style=\"color:#a31515;\">&quot;__revit__&quot;</span>,&nbsp;_revit&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;py.Runtime.LoadAssembly(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;Autodesk.Revit.DB.Document&nbsp;).Assembly&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;py.Runtime.LoadAssembly(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;Autodesk.Revit.UI.TaskDialog&nbsp;).Assembly&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">try</span>\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;py.ExecuteFile(&nbsp;<span style=\"color:#a31515;\">&quot;totalSelectedVolume.py&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">catch</span>(&nbsp;Exception&nbsp;ex&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TaskDialog&nbsp;myDialog&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;TaskDialog(&nbsp;<span style=\"color:#a31515;\">&quot;IronPython&nbsp;Error&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myDialog.MainInstruction&nbsp;=&nbsp;<span style=\"color:#a31515;\">&quot;Couldn&#39;t&nbsp;execute&nbsp;IronPython&nbsp;script&nbsp;totalSelectedVolume.py:&nbsp;&quot;</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myDialog.ExpandedContent&nbsp;=&nbsp;ex.Message;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myDialog.Show();\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;Result.Succeeded;\n&nbsp;&nbsp;}\n</pre>\n\nHere is [IronPython_engine.zip](zip/dg_IronPython_engine.zip) containing a complete testing project.\n\nMany thanks to Daniel for his research and useful solution!"
  },
  {
    "original_filename": "1919_py_cs_template",
    "header_text": "Python 3, CPython, pyRevit and Dynamo",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Python 3, CPython, pyRevit and Dynamo\n\nContinuing with Python related issues, here is a quick update on upcoming releases of pyRevit and Dynamo and their support for Python 3, prompted by \nEatRevitPoopCad (love the handle) in their discussion\nof [PyRevit and Revit 2022 w/ Dynamo](https://forums.autodesk.com/t5/revit-api-forum/pyrevit-and-revit-2022-w-dynamo/m-p/10638367):\n\n**Question:** I believe I saw somewhere that IronPython will not be supported with Revit 2022 and/or the Dynamo version it will come with...\nSome of my plugins use IronPython, which isn't a big deal, I can convert them to whatever the \"New python\" Dynamo will use...\nBut what about... let's say PyRevit?\nI know it runs on IronPython.\nDoes that mean it will not work?\nOr can you still install an older version of Dynamo in Revit 2022 that will support IronPython?\n\n**Answer:** The Revit API is based on .NET.\nTherefore, everything and anything that supports .NET can be used to work with the Revit API.\nIronPython is designed to enable usage of Python with .NET.\nI see no reason why it should stop working.\nWhat gave you that idea?\n\nThat said, you might also try to discuss pyRevit related issues directly with its creator Ehsan in\nthe [pyRevit repository](https://github.com/eirannejad/pyRevit) via\nthe appropriate [channels](https://github.com/eirannejad/pyRevit#staying-updated).\n\n**Response:** Thanks for clearing that up, Jeremy.\n\nI saw this on a webinar and misunderstood it, and only used IronPython inside Dynamo.\nBasically, the new Dynamo is transitioning\nfrom [IronPython](https://ironpython.net)\nto [CPython](https://github.com/python/cpython).\nRevit 2021 came with Dynamo and IronPython by default.\nRevit 2022 comes with Dynamo that has IronPython and CPython, and recommends using CPython.\nI am assuming in the future it will drop IronPython.\n\nThis won't affect pyRevit the way I thought it would; Dynamo and pyRevit are independent of each other.\n\nPlease refer to the article\non the [top 5 new features for Dynamo for Revit 2022](https://www.caddmicrosystems.com/blog/top-5-new-features-for-dynamo-for-revit-2022):\n \n> One of the biggest things the Dynamo Core team has been working on is the transition from IronPython which limits Python to version to 2.7 to CPython which allows the use of python 3 syntax. This is HUGE for using python to access addition elements in the Revit API, as well as to handle more complex logic scenarios. As of the initial launch of Revit 2022, both ironpython and Cpython are installed as python engines and the engine used can vary within a single dynamo script (although that is not advised).\nIronPython remains the default Python engine, but can be changed in the settings.\nTo help with the transition, there is a transition tool that will help migrate your python script from ironpython to Cpython.\n\nMany thanks to EatRevitPoopCad for the interesting background information.\nI was unaware of it until now.\nMyself, I just use (normal, standalone) Python for command line scripts and am still in a very slow and much overdue transitioning process from 2.7 to 3+..."
  }
]