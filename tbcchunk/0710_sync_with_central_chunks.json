[
  {
    "original_filename": "0710_sync_with_central",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0710_sync_with_central",
    "header_text": "Synchronize with Central",
    "local_header_href": "#synchronize-with-central",
    "chunk_text": "<h3>Synchronize with Central</h3><p>Developers have often asked how to programmatically synchronise with central, which is currently not supported by the Revit API.\n\n<p>I discussed this issue once again recently with Erik Eriksson of\n\n<a href=\"http://www.white.se\">\nWhite Arkitketer AB</a>,\n\nand he tested and verified that yet another risky workaround can be used to achieve this, as always \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/10/closing-the-active-document-and-why-not-to.html#3\">\nat your own peril</a>.\n\n<p><strong>Question:</strong> I have a worksharing project in which I am trying to open a file, make changes, synchronize the changes to the central file and then close the file. \nI can complete all the tasks needed except synchronization part. \nIs that not possible through the API? \nI haven't found anything regarding this in the API manuals for Revit 2011 and 2012.\n\n<p>Is there a workaround for this? \nOur project is a very complex hospital of 370 000 m2 and we have 17 different project files. \nMaking changes to these through the API would be a really powerful tool for us and we must be able to synchronize the changes to the central file quickly since there are 90 people working in these 17 files.\n\n<p>Any thoughts are welcome. \nI've tried opening the central files, making changes, saving these and closing. \nBut that doesn't relinquish the elements changed.\n\n<p>I looked at your two year old post on auto-confirming a save dialogue by \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/06/autoconfirm-save-using-dialogboxshowing-event.html\">\nsubscribing to the DialogboxShowingEvent</a>. \n\n<p>Could this also be used to auto-confirm the synchronize with central dialog box that I can bring up using the API?\n\n<p><strong>Answer:</strong> There are several different possible ways to suppress unwanted dialogues programmatically in Revit, both using the Revit and the Windows API:\n\n<p>The old method that was already available in Revit 2010 was to \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/06/autoconfirm-save-using-dialogboxshowing-event.html\">\nuse the DialogBoxShowing event</a>, as you discovered, which can be used to dismiss a dialogue programmatically.\n\n<p>The Revit 2011 API also includes a comprehensive \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/failure-api.html\">\nfailure processing API</a> which \n\ncan used to do much more than reacting to the DialogBoxShowing event.\n\n\n<p>If all else fails and you just want to get rid of the dialogue box by any means, you can also use the Windows API to detect when it is displayed and dismiss it using my \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/10/dismiss-dialogue-using-windows-api.html\">\ndialogue clicker application</a>.\n\n<p>In all three cases, you have to invest some research of your own to discover (in the debugger) what exact conditions you can use to reliably determine that the dialogue that is popping up really is the one you are interested in. \nThe approaches for that are described in the blog posts. \n\n<p>To optimise performance and minimise the impact and complexity, you might also want to set up your event handlers so that they are only active for a limited period of time, when you are expecting the unwanted dialogue to be displayed, and then remove them again after dismissing it.\n\n<p><strong>Response:</strong> Success!\n\n<!--\n<p>Tänkte bara uppdatera dig om mitt ärende med att utföra en \"synchronize with central\" via ett externt commando i APIt.\n\n<p>Jag äntligen lyckats! Jag snubblade på lösningen på din blogg. Även om du då beskrev hur man skulle kunna stänga det aktiva dokumenet genom att använda SendKeys-klassen i en separat tråd.\n\n<p>I princip så kör jag detta och lyckas trigga igång en synchronisering:\n\n<p>Frågan är nu bara vad du tror om det? \nEftersom man egentligen bara använder \"UI-funktionalitet\" så borde det väl vara ganska säkert?\n\n<p>Allt är väl mer eller mindre relativt osäkert när man \"lurar\" APIt såhär?\n-->\n\nI used your solution to close the active document by \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/10/closing-the-active-document-and-why-not-to.html\">\nexecuting a SendKeys call</a> in \n\na separate thread.\n\n<p>In principle I am doing the same thing and triggering the synchronisation using\n\n\n<pre class=\"code\">\n  SendKeys.SendWait(\"{F10}\");\n  SendKeys.SendWait(\"3\");\n  SendKeys.SendWait(\"{ENTER}\");\n</pre>\n<p>The question is: what do you think about this?\n\n<p>I am only using the official UI functionality, and it should work irrespectively of whether a user or my SendKeys calls are driving it, shouldn't it?\n\n<p><strong>Answer:</strong> Well, you should definitely pay close attention to the warnings of Arnošt Löbel, voiced in various blog posts, including the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/10/closing-the-active-document-and-why-not-to.html#3\">\ndisclaimer</a> on\n\nthe very post you found, and yet again in all clarity in his class on this topic at Autodesk University 2011,\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1763185\">\n<b>CP5381</b></a>, \n\non asynchronous interactions and managing modeless UI, which would be well worth a blog post all on its own, at least.\n\n<p>Maybe using \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/automation\">\nUI Automation</a> instead \n\nmight possibly be a slightly safer bet, since I heard rumours that the addressee of the SendKeys messages may sometimes get confused.\n\n<p><strong>Response:</strong> Yes, indeed.\nIn order to make this as safe as possible, I execute it during an idling event to make sure that the document really is ready. \nI also subscribe to the DocumentSynchronizedWithCentral to make sure that the document was synchronized. \n\n<p>I attended Arnošt's class during AU so I am very cautious with non-supported API-calls.\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  }
]