[
  {
    "original_filename": "1783_ui_top_form_button_web",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n</head>\n\n<!---\n\n- Modeless dialog - stays on top\n  https://forums.autodesk.com/t5/revit-api-forum/modeless-dialog-stays-on-top/m-p/9042359\n\n- buttons\n  https://forums.autodesk.com/t5/revit-api-forum/how-to-modify-revit-button-picture/m-p/9034300#M41389\n  https://thebuildingcoder.typepad.com/blog/2017/12/pipe-fitting-k-factor-archilab-and-installer.html#7\n  https://archi-lab.net/create-your-own-tab-and-buttons-in-revit/\n  https://thebuildingcoder.typepad.com/blog/2019/07/bim365-getting-started-visual-appearance-and-cpu-voltage.html#2\n  https://www.bim365.tech/blog/programming-buttons-in-revit\n  \n- https://forums.autodesk.com/t5/revit-api-forum/external-application-with-web-ui/m-p/9036614\n\ntwitter:\n\nUI window handles, top-most forms, add-in buttons, web interface, etc. in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/topmostform\n\nSeveral user interface related topics are being discussed in the Revit API discussion forum\n&ndash; Keep my form on top of Revit!\n&ndash; Creating buttons and getting started with an add-in UI\n&ndash; Integrating a web-based UI...\n\nlinkedin:\n\nUI window handles, top-most forms, add-in buttons, web interface, etc. in the #RevitAPI\n\nhttp://bit.ly/topmostform\n\nSeveral user interface related topics are being discussed in the Revit API discussion forum:\n\n- Keep my form on top of Revit!\n- Creating buttons and getting started with an add-in UI\n- Integrating a web-based UI...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<p style=\"font-size: 80%; font-style:italic\"></p>\n\n-->"
  },
  {
    "original_filename": "1783_ui_top_form_button_web",
    "header_text": "UI Top Forms, Buttons, Web, etc.",
    "local_header_href": "#ui-top-forms-buttons-web-etc",
    "chunk_text": "### UI Top Forms, Buttons, Web, etc.\n\nSeveral user interface related topics are being discussed in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160):\n\n- [Keep my form on top of Revit!](#2)\n- [Creating buttons and getting started with an add-in UI](#3)\n- [Integrating a web-based UI](#4)\n\n<center>\n<img src=\"img/window_handle.jpg\" alt=\"Window handle\" width=\"255\">\n</center>"
  },
  {
    "original_filename": "1783_ui_top_form_button_web",
    "header_text": "Keep my Form on Top of Revit!",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Keep my Form on Top of Revit!\n\nThis topic came up twice in the past few days, in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [modeless dialog stays on top](https://forums.autodesk.com/t5/revit-api-forum/modeless-dialog-stays-on-top/m-p/9042359)\nand [dialog / form visibility](https://forums.autodesk.com/t5/revit-api-forum/dialog-form-visiblity/m-p/9043308):\n\n**Question:** I created an addon that runs along with the normal user use of Revit and allows the user to open certain views by displaying a modeless dialog.\n\nThis works well, but I've set the `TopMost` property of the dialog to `True`; otherwise, I keep losing the dialog behind other windows.\n\nThe issue is, that with this set, the dialog then stays on top and annoyingly covers other windows.\n\nI'd like the window to follow Revit's window, minimise with it and stay the level with it, so when a window covers Revit, it covers the dialog too.\n\n**Answer:** This can be easily fixed by making the Revit main window the owner window of your modeless dialogue, and your modeless dialogue a child of the Revit main window.\n\nI implemented the `JtWindowHandle` class to help achieve this in the past, so you\ncan [search The Building Coder for `JtWindowHandle`](https://www.google.com/search?q=JtWindowHandle&as_sitesearch=thebuildingcoder.typepad.com) to\nfind a number of solutions.\n\nPlease note that the Revit API nowadays provides official access to the main Revit window via\nthe [UIApplication class MainWindowHandle property](https://www.revitapidocs.com/2020/e28d23a9-6814-1e70-9943-1ee852887dae.htm).\n\nThe `JtWindowHandle` class is defined like this:\n\n<pre class=\"code\">\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;Wrapper&nbsp;class&nbsp;for&nbsp;converting&nbsp;</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;IntPtr&nbsp;to&nbsp;IWin32Window.</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;/</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n  <span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">class</span>&nbsp;<span style=\"color:#2b91af;\">JtWindowHandle</span>&nbsp;:&nbsp;<span style=\"color:#2b91af;\">IWin32Window</span>\n  {\n  &nbsp;&nbsp;<span style=\"color:#2b91af;\">IntPtr</span>&nbsp;_hwnd;\n   \n  &nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;JtWindowHandle(&nbsp;<span style=\"color:#2b91af;\">IntPtr</span>&nbsp;h&nbsp;)\n  &nbsp;&nbsp;{\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Debug</span>.Assert(&nbsp;<span style=\"color:#2b91af;\">IntPtr</span>.Zero&nbsp;!=&nbsp;h,\n  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;expected&nbsp;non-null&nbsp;window&nbsp;handle&quot;</span>&nbsp;);\n   \n  &nbsp;&nbsp;&nbsp;&nbsp;_hwnd&nbsp;=&nbsp;h;\n  &nbsp;&nbsp;}\n   \n  &nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:#2b91af;\">IntPtr</span>&nbsp;Handle\n  &nbsp;&nbsp;{\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">get</span>\n  &nbsp;&nbsp;&nbsp;&nbsp;{\n  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;_hwnd;\n  &nbsp;&nbsp;&nbsp;&nbsp;}\n  &nbsp;&nbsp;}\n  }\n</pre>\n\nYou instantiate it from the Revit main window handle like this:\n\n<pre class=\"code\">\n  <span style=\"color:#2b91af;\">JtWindowHandle</span>&nbsp;owner_window_handle&nbsp;\n    =&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">JtWindowHandle</span>(&nbsp;\n      uiapp.MainWindowHandle&nbsp;);\n</pre>\n\nThen, you can parent your form with it using either `Show` or `ShowDialog` for a modeless or modal form, respectively:\n\n<pre class=\"code\">\n  <span style=\"color:#2b91af;\">MyForm</span>&nbsp;form&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">MyForm</span>();\n \n  <span style=\"color:#2b91af;\">DialogResult</span>&nbsp;rslt&nbsp;=&nbsp;form.ShowDialog(&nbsp;\n  &nbsp;&nbsp;owner_window_handle&nbsp;);\n</pre>"
  },
  {
    "original_filename": "1783_ui_top_form_button_web",
    "header_text": "Creating Buttons and Getting Started with an Add-In UI",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Creating Buttons and Getting Started with an Add-In UI\n\nAnother thread was misunderstood and brought up a bunch of answers on how to get started creating buttons and a user interface in general, even though it was actually asking something completely different,\n[how to modify Revit button picture?](https://forums.autodesk.com/t5/revit-api-forum/how-to-modify-revit-button-picture/m-p/9034300)\n\nHere are the answers, once again, anyway:\n\n- [BIM365](https://www.bim365.tech)\non [programming buttons in Revit](https://www.bim365.tech/blog/programming-buttons-in-revit)\n- Good explanation by [archi+lab](http://archi-lab.net) on how\nto [create your own tab and buttons in Revit](http://archi-lab.net/create-your-own-tab-and-buttons-in-revit)"
  },
  {
    "original_filename": "1783_ui_top_form_button_web",
    "header_text": "Integrating a Web-Based UI",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Integrating a Web-Based UI\n\nNext, Balint raised a discussion on the implementation of \nan [external application with web UI](https://forums.autodesk.com/t5/revit-api-forum/external-application-with-web-ui/m-p/9036614):\n\n**Question:** I would like to create an external application which opens a dialog and do some stuff after it.\nMy dialog would be a WebView or something like that.\nIs it possible?\nCould someone recommend a good example?\nWhich direction is worth following?\nI searched on the Autodesk AppStore and found BimObject or ProdLib plugins, which have really nice UIs.\nAre they using WPF or some web framework?\n\n**Answer:** We recently discussed [WPF versus Winforms](https://thebuildingcoder.typepad.com/blog/2019/09/scaling-an-add-in-for-a-4k-high-resolution-screen.html#9).\n\nEven though most of the Revit SDK samples demonstrate use of WinForms, this is hardly recommended anymore nowadays.\n\nThe Revit SDK DockableDialogs example is WPF.  It's good in that it shows the various API's necessary to build an external app, but it was not designed to be a great WPF reference.\n\nYou can see some other samples [searching for 'Revit API WPF sample'](https://duckduckgo.com/?q=revit+api+wpf+sample).\n\nThe Building Coder also shares [some WPF related topics](https://thebuildingcoder.typepad.com/blog/wpf).\n\nHave you checked\nout [Ali Asad's Visual Studio WPF MVVM Revit add-in template](https://thebuildingcoder.typepad.com/blog/2019/01/room-boundaries-to-csv-and-wpf-template.html#3)?\n\nThis StackOverflow thread discusses how to [create a WPF Revit add-in starting with the DockableDialogs SDK sample](https://stackoverflow.com/questions/40096793/best-starting-point-for-wpf-revit-add-in).\n\nOh, and finally we must not forget the recent solution using\n[IPC to disentangle and connect with CefSharp](https://thebuildingcoder.typepad.com/blog/2019/04/set-floor-level-and-use-ipc-for-disentanglement.html).\n\n**Response:** I hope I found the solution.\nUsing [DotNetBrowser](https://www.teamdev.com/dotnetbrowser),\nI can integrate a Chromium-based browser into Revit app. I tried it and it works fine.\n\nMany thanks to Balint for sharing this!"
  }
]