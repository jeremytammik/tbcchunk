[
  {
    "original_filename": "1589_copy_model_rs",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- email [Solved: Application.CopyModel error for Revit Server]\n\n- [Manage the point cloud visibility in Revit 3D view](https://www.linkedin.com/pulse/manage-point-cloud-visibility-revit-3d-view-sonas-api-pierre-navarra)\n  https://forums.autodesk.com/t5/revit-api-forum/hidding-scans-in-pointcloudinstance/m-p/7369983\n  solution\n\nRevit Server Download and Hiding Point Cloud Scan #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/downloadrs\n\nToday, I have two important results to share based on hard work by Tim Burnham and Pierre Navarra\n&ndash; Download from Revit Server requires RSN.INI entry\n&ndash; Hiding a point cloud scan RCS in an RCP instance...\n\n--->"
  },
  {
    "original_filename": "1589_copy_model_rs",
    "header_text": "Revit Server Download and Hiding Point Cloud Scan",
    "local_header_href": "#revit-server-download-and-hiding-point-cloud-scan",
    "chunk_text": "### Revit Server Download and Hiding Point Cloud Scan\n\nToday, I have two important results to share based on hard work by Tim Burnham and Pierre Navarra:\n\n- [Download from Revit Server requires RSN.INI entry](#2)\n- [Hiding a point cloud scan RCS in an RCP instance](#3)\n\n####<a name=\"2\"></a>Download from Revit Server Requires RSN.INI Entry\n\nI discussed [copying a model from a Revit Server](http://thebuildingcoder.typepad.com/blog/2011/12/copy-a-model-from-a-revit-server.html) six\nyears ago.\n\nAfter all this time, an important caveat is required, prompted by Tim Burnham and all the blood, sweat and tears he spent on resolving an issue with an `Application.CopyModel` error for Revit Server:\n\n**Question:** I wrote an application that interacts with Revit Server and downloads files for some RVT analytic processing.\nThis always works well for me on my machine, but not for others.\nWe are using a specific server `A`.  When users of `A` run my application, they can ping and iterate through all the server contents using my REST code, no problem.  However, when the app goes to download the file via `Application.CopyModel`, we are getting *The central model is missing* errors.  My Win7 laptop is not receiving these errors and is able to download fine every time.  Nobody else works.\n \nI had several different people try this and reproduce the error at `CopyModel` time.  Two are Win7, two are Win8.  All get the error.  As you can see here, there is nothing out of the ordinary with my sample:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;serverFilePath&nbsp;=&nbsp;<span style=\"color:maroon;\">@&quot;RSN://XX.XX.X.XXX/Project1.rvt&quot;</span>;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;<span style=\"color:#2b91af;\">ModelPathUtils</span>.IsValidUserVisibleFullServerPath(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;serverFilePath&nbsp;)&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ModelPath</span>&nbsp;tempMp&nbsp;=&nbsp;<span style=\"color:#2b91af;\">ModelPathUtils</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ConvertUserVisiblePathToModelPath(&nbsp;serverFilePath&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;app.CopyModel(&nbsp;tempMp,&nbsp;<span style=\"color:maroon;\">@&quot;C:\\Temp\\Project1.rvt&quot;</span>,&nbsp;<span style=\"color:blue;\">true</span>&nbsp;);\n&nbsp;&nbsp;}\n</pre>\n\nWhy am I so lucky?  If I log on to another machine using my credentials, it doesn’t work at download time for me either.\n\nI’m using Revit 2017.\n \n**Answer:** After much head banging and debugging, I discovered that if you use the `Application.CopyModel` .NET API for Revit Server downloads, the associated central server you wish to download from must be listed in the local workstation `RSN.INI` file:\n\n- C:\\ProgramData\\Autodesk\\Revit Server 2017\\Config\\RSN.INI\n\nThis file may not even exist if the client hasn’t done any RS integration work.\n\nRemoving the central server IP from the .INI file will yield either *network communication* or *can’t detach from central* type errors.   \n \nI don’t believe this is documented for API use.\n\nIf your local Revit install is set up with the server already, I assume the API will always work and this hidden behaviour will go undetected.\n\nI would expect the API should interact with RS assuming port 808 is open and you’re within the LAN/WAN confines.\n \nIt might be useful to amend the initial article\non [copying a model from a Revit Server](http://thebuildingcoder.typepad.com/blog/2011/12/copy-a-model-from-a-revit-server.html) to\ninclude this info.\n\nSomeone will thank you!\n\nAbove all, a big thank you to Tim for sharing this important information and all his hard work in detecting and resolving the issue!\n\n\n####<a name=\"3\"></a>Hiding a Point Cloud Scan RCS in an RCP Instance\n\nAnother thank you is due\nto [Pierre Navarra](https://fr.linkedin.com/in/pierre-navarra-62032a107)\nof [SONA Architecture](http://www.sona-architecture.com) for\nhis solution\nfor [managing the point cloud visibility in a Revit 3D view](https://www.linkedin.com/pulse/manage-point-cloud-visibility-revit-3d-view-sonas-api-pierre-navarra) discussed in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [hiding scans in `PointCloudInstance`](https://forums.autodesk.com/t5/revit-api-forum/hidding-scans-in-pointcloudinstance/m-p/7369983):\n\n**Question:** `PointCloudInstance` can return the list of scans by using `GetScans`.\n\nI'd like to make invisible a specific scan of a point cloud instance in my 3D view.\n\nThe Revit API documentation says, \"PointCloudOverrideSettings - Used to get or set the visibility, color mode, and PointCloudColorSettings for a PointCloudInstance or one of its scans.\"\n\nI can't find how to do it, though... Could you help me, please?\n\nManually, in the user interface, I can make invisible an `rcs` from an `rcp` instance:\n\n<center>\n<img src=\"img/rcs_visibility_in_rcp.jpg\" alt=\"RCS visibility in RCP instance\" width=\"793\"/>\n</center>\n\nI can use `GetScans` to obtain the list of all rcs from my rcp instance.\n\nWith RevitLookup, however, I see no way to get the element ids of an individual rcs...\n \nAnd the help says about scans, \"An .rcp file can contain multiple scans. The method PointCloudInstance.GetScans() returns a list of scan names which can be used to set visibility and fixed color overrides independently for each scan in the PointCloudInstance. PointCloudInstance.ContainsScan() indicates whether the given scan name is contained in the point cloud instance while PointCloudInstance.GetScanOrigin() will return the origin of the given scan in model coordinates.\"\n \n\"PointCloudColorSettings - Used to assign specific colors for certain color modes to a PointCloudInstance element, or one of its scans. Does not apply if the PointCloudColorMode is NoOverride or Normals.\"\n\nBut how to access the rcs id ?\n\n**Answer:** I'm done, and it works!\n\nI wrote about it\nin [managing the point cloud visibility in a Revit 3D view](https://www.linkedin.com/pulse/manage-point-cloud-visibility-revit-3d-view-sonas-api-pierre-navarra).\n\nI use these API calls:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">PointCloudOverrideSettings</span>\n&nbsp;&nbsp;&nbsp;&nbsp;ptc_overridesettings_invisible\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">PointCloudOverrideSettings</span>();\n \n&nbsp;&nbsp;ptc_overrides.SetPointCloudScanOverrideSettings(\n&nbsp;&nbsp;&nbsp;&nbsp;pti.Id,&nbsp;ptc_overridesettings_invisible,\n&nbsp;&nbsp;&nbsp;&nbsp;scanname,&nbsp;doc&nbsp;);\n</pre>\n \nThank you for sharing this, Pierre!"
  }
]