[
  {
    "original_filename": "0461_measurepanelarea",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0461_measurepanelarea",
    "header_text": "MeasurePanelArea Update",
    "local_header_href": "#measurepanelarea-update",
    "chunk_text": "<h3>MeasurePanelArea Update</h3><p>Iffat Mai of \n\n<a href=\"http://www.perkinswill.com\">\nPerkins + Will</a> brought \n\nup an issue with the MeasurePanelArea Revit SDK sample, handled by Joe Ye:\n\n<p><strong>Question:</strong> As we reviewed the Massing &gt; MeasurePanelArea SDK Sample, the following error message was displayed while trying to run it:</p>\n<center>\n<img alt=\"MeasurePanelArea error message\" src=\"img/MeasurePanelArea_error.jpg\"/>\n</center>\n<p>It says: \"Input type is of an element type that exists in the API, but not in Revit's native object model. \nTry using Autodesk.Revit.DB.FamilyInstance instead, and then post-processing the results to find the elements of interest.\" \n\n<p><strong>Answer:</strong> This is due to the fact that the Panel class cannot be accepted by the FilteredElementCollector OfClass method, i.e. when calling\n\n<pre class=\"code\">\n  <span class=\"teal\">FilteredElementCollector</span>\n    .OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">Panel</span> ) );\n</pre>\n<p>This call is made in the GetElements template method:\n\n<pre class=\"code\">\n  <span class=\"blue\">protected</span> <span class=\"teal\">List</span>&lt;T&gt; \n    GetElements&lt;T&gt;() <span class=\"blue\">where</span> T : <span class=\"teal\">Element</span>\n</pre>\n<p>GetElements in turn is called by the method BuildPanelTypeList:\n\n<pre class=\"code\">\n  <span class=\"blue\">private</span> <span class=\"blue\">void</span> BuildPanelTypeList()\n  {\n    <span class=\"teal\">List</span>&lt;<span class=\"teal\">Panel</span>&gt; list = GetElements&lt;<span class=\"teal\">Panel</span>&gt;();\n    . . .\n  } \n</pre>\n<p>We already discussed this issue of \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/08/filtering-for-a-nonnative-class.html\">\nfiltering for a non-native class</a> in\n\nsome depth. \nIt applies to AnnotationSymbol, Panel, Room and several other classes.\n\n<p>I changed the sample slightly to add another non-template method to get all panels in current document instead:\n\n<pre class=\"code\">\n<span class=\"blue\">protected</span> <span class=\"teal\">IList</span>&lt;<span class=\"teal\">Element</span>&gt; GetPanels()\n{\n  <span class=\"teal\">FilteredElementCollector</span> collector \n    = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( \n      m_uiDoc.Document );\n \n  <span class=\"teal\">BuiltInCategory</span> bic \n    = <span class=\"teal\">BuiltInCategory</span>.OST_CurtainWallPanels;\n \n  collector.OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">FamilyInstance</span> ) )\n    .OfCategory( bic );\n \n  <span class=\"teal\">IList</span>&lt;<span class=\"teal\">Element</span>&gt; panels = collector.ToElements();\n \n  <span class=\"blue\">return</span> panels;\n}\n</pre>\n<p>Here is my modified version of \n\n<!-- \n\nC:\\a\\lib\\revit\\2011\\SDK\\Samples\\Massing\\MeasurePanelArea\\CS\\FormPanelArea.cs\nC:\\a\\j\\adn\\case\\bsd\\1263334\\FormPanelArea.cs\n\nwindiff C:\\a\\lib\\revit\\2011\\SDK\\Samples\\Massing\\MeasurePanelArea\\CS\\FormPanelArea.cs  FormPanelArea.cs\n\nwindiff C:\\a\\lib\\revit\\2011\\SDK\\Samples\\Massing\\MeasurePanelArea\\CS\\FormPanelArea.cs  C:\\a\\lib\\revit\\2011\\SDK_q3\\Samples\\Massing\\MeasurePanelArea\\CS\\FormPanelArea.cs\n\nwindiff C:\\a\\lib\\revit\\2011\\SDK\\Samples\\DoorSwing\\CS\\ C:\\a\\lib\\revit\\2011\\SDK_q3\\Samples\\DoorSwing\\CS\\\n\n-->\n<a href=\"zip/FormPanelArea.cs\">\nFormPanelArea.cs</a> with these changes.\n\nPlease replace the existing version of the file with it.\n\n<p>Many thanks to Joe for this fix!\n\n<p>The newly released \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/10/subscription-release-and-updated-sdk.html\">\nupdated SDK</a> for the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/09/revit-2011-web-update-2.html\">\nweb update 2</a> and \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/10/subscription-release-and-updated-sdk.html\">\nsubscription releases</a> includes \n\nseveral other \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/10/subscription-release-and-updated-sdk.html#7\">\nSDK sample updates</a>.\n\nUnfortunately the MeasurePanelArea fix was not made in time to be included in the SDK update.\nWe also recently discussed a fix to the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/09/doorswing-fix.html\">\nDoorSwing SDK sample</a> which\n\ndoes not seem to have been included either.\n</p></p></p></p></p></p></p></p></p></p>"
  }
]