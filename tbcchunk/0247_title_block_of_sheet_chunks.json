[
  {
    "original_filename": "0247_title_block_of_sheet",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0247_title_block_of_sheet",
    "header_text": "Title Block of Sheet",
    "local_header_href": "#title-block-of-sheet",
    "chunk_text": "<h3>Title Block of Sheet</h3><p>Here is a question that crops up now and then in different variations, on how to access the title block information of a sheet:\n\n<p><strong>Question:</strong> My drawing list routine exports various sheet view information to a spreadsheet.\nI would like to include the name of the title block family that is associated with the view.\nWhat is the best way to find it?\nDo I need to loop through family instances, and do a reverse lookup?\n\n<p>My snooping tool freaks out whenever I select a title block family from the list of family instances, so I don't know if the host of that family instance will tie it to the specific sheet view?\n\n<p><strong>Answer:</strong> If your version of \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/02/rvtmgddbg.html\">\nRvtMgdDbg</a> fails \n\nto display some information that you are interested in, I suggest you \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/fixing-rvtmgddbg-for-mep-connectors.html\">\ndebug it and fix the problem</a>,\n\ne.g. start it in the debugger and add an exception handler to the offending code.\n\n<p>I am confused by your statement 'name of the title block family that is associated with the view'. \nDo you mean sheet instead of view? \nIn general, each sheet has a title block associated with it, and then hosts multiple views.\n\n<p>To see which title block is added when I add a new sheet to the model, I use a technique to \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/02/locked-dimensioning.html\">\ntrack all new elements added</a>.\n\nThis technique uses the Revit API introduction labs Lab 2-1 element lister.\nI create a file containing a list of all elements in the BIM before and after adding the sheet and then compare them. \nHere is the result, in this case the list of elements created by adding a new sheet to the project:\n\n<pre>\nC:\\tmp\\ &gt;diff RevitElementsBeforeSheet.txt RevitElementsAfterSheet.txt\n2581a2582,2595\n&gt; Id=137766; Class=ViewSheet; Category=Sheets; Name=Unnamed; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a26\n&gt; Id=137767; Class=Element; Category=?; Name=Unnamed; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a27\n&gt; Id=137768; Class=Element; Category=Viewports; Name=Title w Line; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a28\n&gt; Id=137769; Class=Element; Category=?; Name=A101 - Unnamed; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a29\n&gt; Id=137770; Class=Element; Category=Work Plane Grid; Name=Unnamed; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a2a\n&gt; Id=137771; Class=SketchPlane; Category=?; Name=Unnamed; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a2b\n&gt; Id=137772; Class=FamilyInstance; Category=Title Blocks; Name=A0 metric; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a2c\n&gt; Id=137773; Class=View; Category=?; Name=<revision schedule=\"\">; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a2d\n&gt; Id=137774; Class=Element; Category=?; Name=<revision schedule=\"\">; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a2e\n&gt; Id=137775; Class=Element; Category=Viewports; Name=Title w Line; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a2f\n&gt; Id=137776; Class=Element; Category=?; Name=<revision schedule=\"\">; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a30\n&gt; Id=137777; Class=Element; Category=?; Name=<revision schedule=\"\">; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a31\n&gt; Id=137778; Class=Element; Category=?; Name=<revision schedule=\"\">; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a32\n&gt; Id=137779; Class=Element; Category=Schedule Graphics; Name=<revision schedule=\"\">; UniqueId=7e3fda1f-b209-4185-9037-575bba9df262-00021a33\n</revision></revision></revision></revision></revision></revision></pre>\n<p>If these lines are truncated in the browser view, you can copy and paste them to an editor to see the full text.\n\n<p>From this you can see that the new sheet has the element id 137766, and the associated title block is a FamilyInstance with id 137772.\n\n<p>Once the new elements have been identified, the Revit API introduction labs \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/04/deeper-parameter-exploration.html\">\nbuilt-in parameter checker</a> can \n\nbe used to explore their data. \nIn the Revit user interface, I can select the sheet via Modify &gt; Element ID &gt; Select by ID &gt; 137766 &gt; OK and then invoke the built-in parameter checker to explore its parameters.\n\n<p>Looking at the sheet parameters sorted by type and going through all parameters whose value is an element id, I see that there is no reference to 137772, so the sheet does not have a parameter explicitly specifying the title block by its element id, as one might have hoped.\n\n<p>Looking at the title block parameters yields better results, among others the family that you are asking for and the sheet number:\n\n<pre>\nELEM_FAMILY_AND_TYPE_PARAM  \n  Family and Type  \n  ElementId 28295   \n  Title Blocks 'A0 metric'\n\nSHEET_NUMBER                \n  Sheet Number     \n  String            \n  A101\n</pre>\n<p>This means that although we have not found a pointer from the sheet to the title block, we have found information about the inverse relationship from the title block to the sheet. \n\nWe can therefore use the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/10/relationship-in.html\">\nrelationship inverter algorithm</a> to\n\nidentify the title block from the sheet, if needed.\n\n<p>I also had an idea for another, completely different approach: I tried deleting the sheet again after it had been added and checked the resulting list of elements after that operation:\n\n<pre>\nC:\\tmp\\ &gt;diff \n  RevitElementsAfterSheetDelete.txt \n  RevitElementsBeforeSheet.txt\n\nFiles are identical.\n</pre>\n<p>Happily, as it turns out, the new list of elements is exactly the same as it was before the sheet was added. \nThis means that the deletion of the sheet caused the associated title block to be deleted as well. \nThis means that we can probably make use of the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/06/host-reference.html\">\ndoc.Delete method to detect dependent elements</a>.\n\nUsing that approach, you delete the sheet inside a transaction, save the list of element ids returned by the doc.Delete method, and abort the transaction to undo the deletion operation. The list of ids will then include element ids of both the sheet and the associated title block.\n\n<p>I hope this resolves your issue twice over.\n\n<h4>Title Block Modification</h4>\n<p>By the way, \n\n<a href=\"http://autocad-revit-arquitetura.blogspot.com\">\nRicardo Cardial</a>\n\nraised a related \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/shared-parameter-visibility.html#comment-6a00e553e1689788330120a5189ca2970b\">\nquestion</a> on \n\nhow to modify the text labels defined in the title block, which we will partially repeat here in order to ensure that these useful ideas do not get lost:\n\n<p><strong>Question:</strong> How can we change the information of the scale label shown in title blocks? \nWhen we have two different scales on the sheet, the value is 'As indicated'. \nI would like to change that, for instance to translate it to French or Italian.\n\n<p><strong>Answer:</strong> Look at the original comment for the full answer, which consists of two parts.\nThey can be summarised like this:\n\n<ul>\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/shared-parameter-visibility.html#comment-6a00e553e1689788330120a57141eb970c\">\nRead the data through the built-in parameter SHEET_SCALE</a> with \n\nthe display name 'Scale'. \nIt is a string-valued parameter and is unfortunately marked as read-only.\n\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/shared-parameter-visibility.html#comment-6a00e553e1689788330120a5715f8c970c\">\nModify the family file</a> used \n\nto define the title block of the sheet.\n</li></li></ul>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0247_title_block_of_sheet",
    "header_text": "Title Block Modification",
    "local_header_href": "#title-block-modification",
    "chunk_text": "<h4>Title Block Modification</h4><p>By the way, \n\n<a href=\"http://autocad-revit-arquitetura.blogspot.com\">\nRicardo Cardial</a>\n\nraised a related \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/shared-parameter-visibility.html#comment-6a00e553e1689788330120a5189ca2970b\">\nquestion</a> on \n\nhow to modify the text labels defined in the title block, which we will partially repeat here in order to ensure that these useful ideas do not get lost:\n\n<p><strong>Question:</strong> How can we change the information of the scale label shown in title blocks? \nWhen we have two different scales on the sheet, the value is 'As indicated'. \nI would like to change that, for instance to translate it to French or Italian.\n\n<p><strong>Answer:</strong> Look at the original comment for the full answer, which consists of two parts.\nThey can be summarised like this:\n\n<ul>\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/shared-parameter-visibility.html#comment-6a00e553e1689788330120a57141eb970c\">\nRead the data through the built-in parameter SHEET_SCALE</a> with \n\nthe display name 'Scale'. \nIt is a string-valued parameter and is unfortunately marked as read-only.\n\n<li>\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/shared-parameter-visibility.html#comment-6a00e553e1689788330120a5715f8c970c\">\nModify the family file</a> used \n\nto define the title block of the sheet.\n</li></li></ul>\n</p></p></p>"
  }
]