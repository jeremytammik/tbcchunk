[
  {
    "original_filename": "0166_family_category_param",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<style>\n.blue { color: blue; }\n.teal { color: teal; }\n.maroon { color: maroon; }\n.green { color: green; }\n.gray { color: gray; }\n</style>"
  },
  {
    "original_filename": "0166_family_category_param",
    "header_text": "Get and Set Family Category and Parameters",
    "local_header_href": "#get-and-set-family-category-and-parameters",
    "chunk_text": "<h3>Get and Set Family Category and Parameters</h3><p>I am receiving a lot of questions about parameters in family documents, so I will be posting several solutions in this area in the next few days.\nThe first one is short and simple and suited for a rapid Saturday post.\nThere is so much news coming that I do want to cram it in right away.\nThis is a question from Jose Fandos of \n\n<a href=\"http://www.andekan.com\">\nAndekan LLC</a>:</p><p><strong>Question:</strong>\nHow can we get and set the family category and the family parameters seen in the \"Family Category and Parameters\" Revit dialogue box?\nThis dialogue can be displayed by selecting Create &gt; Category and Parameters in the family editor:</p><center>\n<img alt=\"Family Category and Parameters dialogue\" src=\"img/family_category_and_params.png\"/>\n</center><p>The parameters include the OmniClass number, for instance.\nWe are not looking for the type or symbol parameters, and we need this access from the family editor, not from the project editor.</p><p><strong>Answer:</strong>\nI used the RvtMgdDbg tool to explore a family file to answer your query. \nUsing that, I can step into RvtMgdDbg &gt; Snoop Application... &gt; Application &gt; Active Document &gt; Owner Family &gt; Parameters to see the family parameters, including the OmniClass number with the built-in parameter enumeration value OMNICLASS_CODE:</p><img alt=\"Snoop OmniClass number\" src=\"img/snoop_omniclassnumber.png\"/><p>The family category is also available as a property on this owner family object, but it is read-only.</p><p>Here is the external command Execute method that I implemented to demonstrate read access to both of these properties and write access to the OmniClass number:</p><pre class=\"code\">\n<span class=\"teal\">BuiltInParameter</span> _bip = <span class=\"teal\">BuiltInParameter</span>.OMNICLASS_CODE;\n \n<span class=\"blue\">public</span> <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span> Execute( \n  <span class=\"teal\">ExternalCommandData</span> commandData, \n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message, \n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">Application</span> app = commandData.Application;\n  <span class=\"teal\">Document</span> doc = app.ActiveDocument;\n \n  <span class=\"blue\">if</span>( !doc.IsFamilyDocument )\n  {\n    message \n      = <span class=\"maroon\">\"Please run this command in a family document.\"</span>;\n  }\n  <span class=\"blue\">else</span>\n  {\n    <span class=\"teal\">Family</span> f = doc.OwnerFamily;\n    <span class=\"teal\">Category</span> c = f.FamilyCategory;\n    <span class=\"teal\">Parameter</span> p = f.get_Parameter( _bip );\n \n    <span class=\"teal\">Debug</span>.Print( \n      <span class=\"maroon\">\"Category '{0}', OmniClassNumber {1}\"</span>, \n      c.Name, p.AsString() );\n \n    p.Set( <span class=\"maroon\">\"Jeremy\"</span> );\n \n    <span class=\"teal\">Debug</span>.Print( <span class=\"maroon\">\"Modified OmniClassNumber {0}\"</span>, \n      f.get_Parameter( _bip ).AsString() );\n  }\n  <span class=\"blue\">return</span> <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span>.Failed;\n}\n</pre><p>Note that I am returning Failed from the Execute method, so the transaction that Revit is managing for my command will be aborted, so the changes I made will not actually be committed.</p><p>Next week I plan to discuss work-arounds for the challenges surrounding shared parameters in family files, so stay tuned.\nHappy weekend to all!</p>"
  }
]