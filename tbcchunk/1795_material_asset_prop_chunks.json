[
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n</head>\n\n<!---\n\n- create material\n  all material and asset properties are accessible except one -- https://autodesk.slack.com/archives/C0SR6NAP8/p1572546797032200\n  https://stackoverflow.com/questions/58414284/revit-api-material-with-texture-from-filepath\n  https://forums.autodesk.com/t5/revit-api-forum/create-new-material-and-add-new-physical-and-thermal-assets-with/m-p/7311468\n  15089722 [Revit Material Library] implemented CreateMaterialAsset sample add-in, reanswered case\n  1735_editscope_texture.md\n  https://thebuildingcoder.typepad.com/blog/2016/10/list-material-asset-texture-and-forge-webinar-recordings.html#comment-4442686784\n  14254618 [Changing material texture path with editScope] reanswered\n  https://forums.autodesk.com/t5/revit-api-forum/changing-material-texture-path-with-editscope/m-p/8017578\n  15041727 [Unable to get correct texture path from Revit API]\n  14887363 [Obtain Uv-coordinates from texture]\n  14348365 [Render Material Texture Image]\n  https://forums.autodesk.com/t5/revit-api-forum/render-material-texture-image/m-p/8080636\n  https://thebuildingcoder.typepad.com/blog/2016/10/list-material-asset-texture-and-forge-webinar-recordings.html#comment-4442686784\n    [Q] Great tip, but how can we create the fullpath to the unifiedbitmap_Bitmap texture. I've tried using Application:: GetLibraryPaths but the material library is not listed in the dictionnary :(\n    [A] If all else fails, you can try to use the operating system functionality to search globally for the given filename. You should cache the folders in which you find it. If the system is sensibly set up, you will only need to search for it globally once, or a very few times, since there should not be many different locations in which these files are stored.\n    [R] Thank you for this tip, especially for the cache recommandation. Works like a charm. :)\n  https://forums.autodesk.com/t5/revit-api-forum/create-new-material-and-add-new-physical-and-thermal-assets-with/m-p/7311468\n  [Changing material texture path with editScope](https://forums.autodesk.com/t5/revit-api-forum/changing-material-texture-path-with-editscope/m-p/8017578)\n  [Render Material Texture Image](https://forums.autodesk.com/t5/revit-api-forum/render-material-texture-image/m-p/8080636)\n\n  [setting material texture path in `EditScope`](https://thebuildingcoder.typepad.com/blog/2019/04/set-material-texture-path-in-editscope.html)\n  \n- material and asset access\nLiz Fortune Oct 31st at 7:33 PM\n@conoves @t_arunb Balaji and I have been able to access each and every parameter of the material, appearance asset, thermal asset, and physical asset EXCEPT for one....one lonely parameter...I was wondering if you knew how to connect to the keywords parameter which lives on the Identity tab of the Material UI in Revit.  We can connect to the keywords for all of the assets above but would like to also connect to the keywords that live on the material itself.  Any help would be appreciated\n\nScott Conover  5 days ago\nLooks to me that Material.getKeywords() is not exposed (it is not a BuiltInParameter either).  @zhangg can you confirm?\n\nGuofeng Zhang  4 days ago\nYes, Keywords are not exposed to API until now.\n\nJeremy Tammik  4 days ago\n@t_fortl @t_arunb thank you very much for confirming that you can access all the material and asset properties. can you possibly share the code that shows all the different paths you needed to take? many external add-in developers keep running into problems accessing this data, so a generic sample demonstrating how to access al  variations would be extremely helpful. thank you!\n\nBalaji Arunachalam  4 days ago\nThanks for confirming @zhangg. Can you please confirm if there is any parameter to get Environment and Render Settings value too? Their values are common for all the Assets, kindly correct me if I am wrong. (edited) \n\n/a/doc/revit/tbc/git/a/img/assets_environment.png\n\n/a/doc/revit/tbc/git/a/img/assets_render_settings.png\n\nBalaji Arunachalam  4 days ago\n@tammikj We have used the code snippets you have shared on your block, however now @t_fortl is in the process of recreating materials with the values we got. Hope we can share you that once we are successful in recreating it.\n\nLiz Fortune  3 days ago\n/a/doc/revit/tbc/git/a/zip/material_asset_properties.txt\n\nBalaji @t_arunb  has been heads down working with the appearance assets but the code provided will get you everything for the thermal and structural assets and almost everything for the appearance asset.  The pdf on your blog was crucial in figuring out how to touch all the aspects of the appearance asset!  I have also attached a Snagit image I put together that will show mappings for the appearance asset (the google sheet in this image was an output of my code into a csv).  Hope this helps.  \n\n/a/doc/revit/tbc/git/a/img/assets_air_appearance_properties.png\n\nGuofeng Zhang  22 hours ago\n@t_arunb Nope. As you said, they are common for all assets, so they are think as property or parameters, but UI config and saved into MaterialUIConfig.xml.\n\nJeremy Tammik  24 hours ago\n@t_fortl @t_arunb thank you very much for the images and sample code accessing all the material and asset properties. have you made any attempts at modifying them, and creating new materials and assets? a number of external add-in developers are struggling a bit with this...\n\nJeremy Tammik  21 hours ago\n@t_fortl you say, The pdf on your blog was crucial... what PDF is that, please? I would like to highlight it for others to find, and cannot find it myself.\n\ni published what you shared so far; it would be great if you can also confirm that you can create new materials and successfully populate all these properties as well!\n\nhttps://thebuildingcoder.typepad.com/blog/2019/11/material-physical-and-thermal-assets.html\n\nLiz Fortune  10 hours ago\n@tammikj Awesome!  Glad my work helped. :slightly_smiling_face:\nI have successfully modified the values for the parameters. I attempted a handful. The trick I found was that I needed to identify the storage type of each so I could set the parameter accordingly. The pdf I was referring to is: https://thebuildingcoder.typepad.com/files/sd124625_visual_appearance_of_materials_api_boris_shafiro_handout.pdf\n\ntwitter:\n\nAccessing and creating all material, physical and thermal assets, full path to texture bitmap, environment and render settings in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/material_assets\n\nToday, we concentrate fully on material, physical and thermal assets\n&ndash; Issues accessing and creating material assets\n&ndash; Access to all material asset properties\n&ndash; No access to material keywords\n&ndash; Access to environment and render settings\n&ndash; Determine full path to texture bitmap...\n\nlinkedin:\n\nAccessing and creating all material, physical and thermal assets, full path to texture bitmap, environment and render settings in the #RevitAPI\n\nhttp://bit.ly/material_assets\n\nToday, we concentrate fully on material, physical and thermal assets:\n\n- Issues accessing and creating material assets\n- Access to all material asset properties\n- No access to material keywords\n- Access to environment and render settings\n- Determine full path to texture bitmap...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<p style=\"font-size: 80%; font-style:italic\"></p>\n\n-->"
  },
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "Material, Physical and Thermal Assets",
    "local_header_href": "#material-physical-and-thermal-assets",
    "chunk_text": "### Material, Physical and Thermal Assets\n\nToday, we concentrate fully on material, physical and thermal assets:\n\n- [Issues accessing and creating material assets](#2)\n- [Access to all material asset properties](#3)\n- [No access to material keywords](#4)\n- [Access to environment and render settings](#5)\n- [Determine full path to texture bitmap](#6)\n- [Addendum &ndash; Modifying Material Assets](#7)"
  },
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "Issues Accessing and Creating Material Assets",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Issues Accessing and Creating Material Assets\n\nQuite a number of issues were discussed in the past few months involving issues accessing and creating material assets.\n\nAs far as I know, they can all be solved, [cf. below](#3).\n\nSometimes, though, the access is slightly convoluted and confusing.\n\nHere is an overview over some recent issues:\n\n- [Create new material and add texture from file path](https://stackoverflow.com/questions/58414284/revit-api-material-with-texture-from-filepath)\n- [Create new material and add new physical and thermal assets with values](https://forums.autodesk.com/t5/revit-api-forum/create-new-material-and-add-new-physical-and-thermal-assets-with/m-p/7311468)\n- [Setting material texture path in `EditScope`](https://thebuildingcoder.typepad.com/blog/2019/04/set-material-texture-path-in-editscope.html) &ndash; ([discussion forum thread](https://forums.autodesk.com/t5/revit-api-forum/changing-material-texture-path-with-editscope/m-p/8017578), case 14254618)\n\n<!--\n\n15089722 [Revit Material Library] implemented CreateMaterialAsset sample add-in \n15041727 [Unable to get correct texture path from Revit API]\n14887363 [Obtain Uv-coordinates from texture]\n\n- [Units on the elements, that conform the assets of materials](https://forums.autodesk.com/t5/revit-api-forum/units-on-the-elements-that-conform-the-assets-of-materials/m-p/8593252)\n- [Material asset textures](https://thebuildingcoder.typepad.com/blog/2016/10/list-material-asset-texture-and-forge-webinar-recordings.html)\n- [Render material texture image](https://forums.autodesk.com/t5/revit-api-forum/render-material-texture-image/m-p/8080636), case 14348365\n- [AddMaterials GitHub repository](https://github.com/jeremytammik/AddMaterials) &ndash; add materials from a list of properties defined in Excel\n\n-->\n\nOlder discussions are listed in the topic groups\non [material management and libraries](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.5)\nand [texture bitmap and UV coordinate access](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.42)."
  },
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "Access to All Material Asset Properties",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Access to All Material Asset Properties\n\nI am very glad to announce that my colleagues Liz Fortune and Balaji Arunachalam confirm that they can access each and every parameter of the materials, appearance assets, thermal assets, and physical assets (with one single exception, [cf. below](4)):\n\nBalaji and I have been able to access each and every parameter of the material, appearance asset, thermal asset, and physical asset EXCEPT for the keywords parameter that lives on the Identity tab of the Material UI in Revit.  We can connect to the keywords for all of the assets above but would like to also connect to the keywords that live on the material itself. \n\nTo access this data, we used code snippets shared on The Building Coder blog to implement the following:\n\n<pre class=\"code\">\n<span style=\"color:blue;\">void</span>&nbsp;GetElementMaterialInfo(&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc&nbsp;)\n{\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>&nbsp;collector\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WhereElementIsNotElementType()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">Material</span>&nbsp;)&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:blue;\">try</span>\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">Material</span>&nbsp;material&nbsp;<span style=\"color:blue;\">in</span>&nbsp;collector&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;material.Name.Equals(&nbsp;<span style=\"color:#a31515;\">&quot;Air&quot;</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">AppearanceAssetElement</span>&nbsp;appearanceElement\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;doc.GetElement(&nbsp;material.AppearanceAssetId&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">AppearanceAssetElement</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Asset</span>&nbsp;appearanceAsset&nbsp;=&nbsp;appearanceElement\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.GetRenderingAsset();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">AssetProperty</span>&gt;&nbsp;assetProperties\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">AssetProperty</span>&gt;();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">PropertySetElement</span>&nbsp;physicalPropSet\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;doc.GetElement(&nbsp;material.StructuralAssetId&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">PropertySetElement</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">PropertySetElement</span>&nbsp;thermalPropSet\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;doc.GetElement(&nbsp;material.ThermalAssetId&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">PropertySetElement</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ThermalAsset</span>&nbsp;thermalAsset&nbsp;=&nbsp;thermalPropSet\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.GetThermalAsset();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">StructuralAsset</span>&nbsp;physicalAsset&nbsp;=&nbsp;physicalPropSet\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.GetStructuralAsset();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ICollection</span>&lt;<span style=\"color:#2b91af;\">Parameter</span>&gt;&nbsp;physicalParameters\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;physicalPropSet.GetOrderedParameters();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ICollection</span>&lt;<span style=\"color:#2b91af;\">Parameter</span>&gt;&nbsp;thermalParameters\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;thermalPropSet.GetOrderedParameters();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Appearance&nbsp;Asset</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">for</span>(&nbsp;<span style=\"color:blue;\">int</span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;appearanceAsset.Size;&nbsp;i++&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">AssetProperty</span>&nbsp;property&nbsp;=&nbsp;appearanceAsset[&nbsp;i&nbsp;];\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assetProperties.Add(&nbsp;property&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">AssetProperty</span>&nbsp;assetProp&nbsp;<span style=\"color:blue;\">in</span>&nbsp;assetProperties&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Type</span>&nbsp;type&nbsp;=&nbsp;assetProp.GetType();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">object</span>&nbsp;assetPropValue&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;prop&nbsp;=&nbsp;type.GetProperty(&nbsp;<span style=\"color:#a31515;\">&quot;Value&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;prop&nbsp;!=&nbsp;<span style=\"color:blue;\">null</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;prop.GetIndexParameters().Length&nbsp;==&nbsp;0&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assetPropValue&nbsp;=&nbsp;prop.GetValue(&nbsp;assetProp&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Physical&nbsp;(Structural)&nbsp;Asset</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;p&nbsp;<span style=\"color:blue;\">in</span>&nbsp;physicalParameters&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Work&nbsp;with&nbsp;parameters&nbsp;here</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;The&nbsp;only&nbsp;parameter&nbsp;not&nbsp;in&nbsp;the&nbsp;orderedParameters&nbsp;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;that&nbsp;is&nbsp;needed&nbsp;is&nbsp;the&nbsp;Asset&nbsp;name,&nbsp;which&nbsp;you&nbsp;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;can&nbsp;get&nbsp;by&nbsp;&#39;physicalAsset.Name&#39;.</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Thermal&nbsp;Asset</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;p&nbsp;<span style=\"color:blue;\">in</span>&nbsp;thermalParameters&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">// Work&nbsp;with&nbsp;parameters&nbsp;here</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">// The&nbsp;only&nbsp;parameter&nbsp;not&nbsp;in&nbsp;the&nbsp;orderedParameters&nbsp;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;that&nbsp;is&nbsp;needed&nbsp;is&nbsp;the&nbsp;Asset&nbsp;name,&nbsp;shich&nbsp;you&nbsp;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;can&nbsp;get&nbsp;by&nbsp;&#39;thermalAsset.Name&#39;.</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">catch</span>(&nbsp;<span style=\"color:#2b91af;\">Exception</span>&nbsp;e&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Console</span>.WriteLine(&nbsp;e.ToString()&nbsp;);\n&nbsp;&nbsp;}\n}\n</pre>\n\nThis code will get you everything for the thermal and structural assets and almost everything for the appearance asset.\n\n[Boris Shafiro's PDF](zip/sd124625_visual_appearance_of_materials_api_boris_shafiro_handout.pdf) from his AU presentation\non [modifying material visual appearance](https://thebuildingcoder.typepad.com/blog/2017/11/modifying-material-visual-appearance.html)\nwas crucial in figuring out how to touch all the aspects of the appearance asset!\n\nHere is an image I put together [showing mappings for the appearance asset](zip/assets_air_appearance_properties.png):\n\n<center>\n<img src=\"img/assets_air_appearance_properties.png\" alt=\"Air appearance properties\" width=\"800\"> <!--2152-->\n</center>\n\nThe spreadsheet in this image was created from output of my code into a CSV.  Hope this helps.\n\nMany thanks to Liz and Balaji for their research and sharing the results!"
  },
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "No Access to Material Keywords",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> No Access to Material Keywords\n\nAs mentioned above, one single property is apparently still not accessible: the keywords parameter that lives on the Identity tab of the Material UI in Revit.\n\nApparently, the internal property `Material.getKeywords` is not exposed to the official Revit API, and there is no built-in parameter for it either."
  },
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "Access to Environment and Render Settings",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Access to Environment and Render Settings\n\nWe also searched for the Environment and Render Settings values. They are common for all the Assets:\n\n<center>\n<img src=\"img/assets_environment.png\" alt=\"Environment assets\" width=\"559\"> <!--559-->\n<p style=\"font-size: 80%; font-style:italic\">Environment assets</p>\n</center>\n\n<center>\n<img src=\"img/assets_render_settings.png\" alt=\"Render settings\" width=\"296\"> <!---->\n<p style=\"font-size: 80%; font-style:italic\">Render settings</p>\n</center>\n\nThey are common for all assets, so they look like the other properties or parameters, but are in fact part of the UI config and saved into `MaterialUIConfig.xml`."
  },
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "Determine Full Path to Texture Bitmap",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Determine Full Path to Texture Bitmap\n\nFinally, to round off this collection, here is a result from\na [comment](https://thebuildingcoder.typepad.com/blog/2016/10/list-material-asset-texture-and-forge-webinar-recordings.html#comment-4442686784)\non [material asset textures](https://thebuildingcoder.typepad.com/blog/2016/10/list-material-asset-texture-and-forge-webinar-recordings.html):\n\n**Question:** Great tip, but how can we create the full path to the `unifiedbitmap_Bitmap` texture?\nI tried using the `Application` `GetLibraryPaths` method, but the material library is not listed in the dictionary. &nbsp; :(\n\n**Answer:** If all else fails, you can try to use the operating system functionality to search globally for the given filename.\nYou should cache the folders in which you find it.\nIf the system is sensibly set up, you will only need to search for it globally once, or a very few times, since there should not be many different locations in which these files are stored.\n\n**Response:** Thank you for this tip, especially for the cache recommendation.\n\nWorks like a charm. &nbsp; :)"
  },
  {
    "original_filename": "1795_material_asset_prop",
    "header_text": "Addendum &ndash; Modifying Material Assets",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Addendum &ndash; Modifying Material Assets\n\n**Question:** Can you also confirm that you can create new materials and successfully populate all these properties as well?\n\n**Answer:** I have successfully modified the values for the parameters.\n\nI attempted a handful.\n\nThe trick I found was that I needed to identify the storage type of each so I could set the parameter accordingly."
  }
]