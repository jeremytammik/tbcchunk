[
  {
    "original_filename": "1860_ci_graphql",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\ntwitter:\n\nNew RevitLookup CI system using GitLab YAML and a GraphQL interface for Revit and the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon https://bit.ly/revitlookupci\n\nLet's start the week with a look at the new RevitLookup CI system and a GraphQL interface for Revit\n&ndash; RevitLookup CI on GitLab\n&ndash; GitLab CI YAML\n&ndash; GraphQL for Revit\n&ndash; The Tamm Tree...\n\nlinkedin:\n\nNew RevitLookup CI system using GitLab YAML and a GraphQL interface for Revit and the #RevitAPI\n\nhttps://bit.ly/revitlookupci\n\nLet's start the week with a look at the new RevitLookup CI system and a GraphQL interface for Revit:\n\n- RevitLookup CI on GitLab\n- GitLab CI YAML\n- GraphQL for Revit\n- The Tamm Tree...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1860_ci_graphql",
    "header_text": "RevitLookup Continuous Integration and GraphQL",
    "local_header_href": "#revitlookup-continuous-integration-and-graphql",
    "chunk_text": "### RevitLookup Continuous Integration and GraphQL\n\nLet's start the week with a look at the new RevitLookup CI system and a GraphQL interface for Revit:\n\n- [RevitLookup CI on GitLab](#2)\n- [GitLab CI YAML](#3)\n- [GraphQL for Revit](#4)\n- [The Tamm Tree](#5)\n\nBefore that, here is another version of\nthe [Pareto 80-20 principle](https://en.wikipedia.org/wiki/Pareto_principle),\nespecially targeted at coding:\n\n<blockquote>\n<p><i>The first 90% of the code accounts for the first 90% of the development time.\nThe remaining 10% of the code accounts for the other 90% of the development time.</i></p>\n<p style=\"text-align: right; font-style: italic\">&ndash; Cargill's Rule</p>\n</blockquote>"
  },
  {
    "original_filename": "1860_ci_graphql",
    "header_text": "<a name=\"2\"></a>RevitLookup CI on GitLab",
    "local_header_href": "#a-name2arevitlookup-ci-on-gitlab",
    "chunk_text": "#### <a name=\"2\"></a>RevitLookup CI on GitLab\n\nThree years back, Peter Hirn of [Build Informed GmbH](https://www.buildinformed.com) very kindly set up a\npublic [CI system](https://en.wikipedia.org/wiki/Continuous_integration) for RevitLookup automatically\ncreating [RevitLookup builds](https://thebuildingcoder.typepad.com/blog/2017/04/forgefader-ui-lookup-builds-purge-and-room-instances.html#3).\n\nIn April this year, however, Matt [@WspDev](https://github.com/WspDev) Taylor\nraised [issue #59 &ndash; continuous integration no longer working](https://github.com/jeremytammik/RevitLookup/issues/59),\ncaused by Harry Mattison's preceding [pull request #58 &ndash; solution changes for multi-release building](https://github.com/jeremytammik/RevitLookup/pull/58),\ndetailed in the discussion on [support for multi-release building](https://thebuildingcoder.typepad.com/blog/2020/04/revitlookup-2021-with-multi-release-support.html#4).\n\nAfter some attempts to address that issue, not much happened until last week.\n\nNow, Peter solved it cleanly and radically by moving the CI pipeline to a different platform\nin [pull request #61 &ndash; move CI to `gitlab.com`](https://github.com/jeremytammik/RevitLookup/pull/61):\n\n> I moved the CI to [gitlab.com](https://about.gitlab.com).\nThe entire pipeline to build and publish RevitLookup is now defined in `.gitlab-ci.yml`.\n\n> You can check out the progress and output of the CI\nat [gitlab.com/buildinformed-public/revitlookup/-/pipelines](https://gitlab.com/buildinformed-public/revitlookup/-/pipelines)\n\n> Once you accept this merge request, the build should be triggered after max. 30 (?) minutes.\n\n> As you can see in the build stage, I'm still building against Revit 2019 API and force the framework version to v4.7.2.\nIf there is a problem, developers can try to fix it by editing this file or contact us\nvia [email to info@buildinformed.com](mailto:info@buildinformed.com).\n\nThe first release built using the new pipeline\nis [RevitLookup 2021.0.0.3](https://github.com/jeremytammik/RevitLookup/releases/tag/2021.0.0.3).\n\nEver so many thanks to Peter for this great solution!"
  },
  {
    "original_filename": "1860_ci_graphql",
    "header_text": "<a name=\"3\"></a>GitLab CI YAML",
    "local_header_href": "#a-name3agitlab-ci-yaml",
    "chunk_text": "#### <a name=\"3\"></a>GitLab CI YAML\n\nThe GitLab blurb states:\n\n> GitLab is a complete DevOps platform\n\n> With GitLab, you get a complete CI/CD toolchain in a single application. One interface. One conversation. One permission model. Thousands of features...\n\nI find it pretty interesting just taking a look into the file defining the CI pipeline, `.gitlab-ci.yml`:\n\n<pre class=\"code\">\nstages:\n  - download-revit-api\n  - build\n  - sign\n  - publish\n\ndownload-revit-api:\n  stage: download-revit-api\n  image: alpine:3.12\n  variables:\n    REVIT_API_URL: https://bimag.b-cdn.net/revit/2019/RevitAPI.dll\n    REVIT_API_CHECKSUM: da1fbac1e5afb210478cbb508e0677679e994da8c9e13b56c43d5e122dabd6e7\n    REVIT_APIUI_URL: https://bimag.b-cdn.net/revit/2019/RevitAPIUI.dll\n    REVIT_APIUI_CHECKSUM: d29a755922997310a215afa83fa44ea91aafdd6feddce722e5feed98d2ae9f73\n  script:\n    - apk add --update --no-cache curl\n    - mkdir revit-api\n    - |\n        echo \"${REVIT_API_CHECKSUM}  -\" > /tmp/checksum \\\n        && curl -L \"${REVIT_API_URL}\" \\\n        | tee revit-api/RevitAPI.dll \\\n        | sha256sum -c /tmp/checksum\n    - |\n        echo \"${REVIT_APIUI_CHECKSUM}  -\" > /tmp/checksum \\\n        && curl -L \"${REVIT_APIUI_URL}\" \\\n        | tee revit-api/RevitAPIUI.dll \\\n        | sha256sum -c /tmp/checksum\n  artifacts:\n    paths:\n      - revit-api/\n    expire_in: 1 day\n\nbuild:\n  stage: build\n  tags:\n    - shared-windows\n    - windows\n    - windows-1809\n  dependencies:\n    - download-revit-api\n  variables:\n    MSBUILD: 'C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\MSBuild\\Current\\Bin\\MSBuild.exe'\n  script:\n    - '& \"$MSBUILD\" -p:TargetFrameworkVersion=v4.7.2 -p:Configuration=2021 -p:ReferencePath=\"../revit-api\" -p:PostBuildEvent= CS/RevitLookup.sln'\n    - New-Item -Force -ItemType Directory -Path artifacts | Out-Null\n    - Copy-Item \"CS/bin/2021/RevitLookup.dll\" artifacts/\n    - Copy-Item \"CS/RevitLookup.addin\" artifacts/\n  artifacts:\n    paths:\n      - artifacts/\n    expire_in: 1 day\n\nsign:\n  stage: sign\n  image: debian:buster-slim\n  dependencies:\n    - build\n  variables:\n    ASSEMBLY: artifacts/RevitLookup.dll\n    TIMESERVER: http://timestamp.verisign.com/scripts/timstamp.dll\n    DEBIAN_FRONTEND: noninteractive\n  script:\n    - apt-get update && apt-get install -y --no-install-recommends osslsigncode\n    - mkdir -p .secrets && mount -t ramfs -o size=1M ramfs .secrets/\n    - echo \"${CODESIGN_CERTIFICATE}\" | base64 --decode > .secrets/authenticode.spc\n    - echo \"${CODESIGN_KEY}\" | base64 --decode > .secrets/authenticode.key\n    - osslsigncode -h sha1 -spc .secrets/authenticode.spc -key .secrets/authenticode.key -t ${TIMESERVER} -in \"${ASSEMBLY}\" -out \"${ASSEMBLY}-sha1\"\n    - osslsigncode -nest -h sha2 -spc .secrets/authenticode.spc -key .secrets/authenticode.key -t ${TIMESERVER} -in \"${ASSEMBLY}-sha1\" -out \"${ASSEMBLY}\"\n    - rm \"${ASSEMBLY}-sha1\"\n  after_script:\n    - rmdir .secrets\n  artifacts:\n    paths:\n      - artifacts/\n    expire_in: 1 day\n  only:\n    variables:\n      - $CODESIGN_CERTIFICATE != null\n      - $CODESIGN_KEY != null\n\npublish:\n  stage: publish\n  image: alpine:3.12\n  dependencies:\n    - sign\n  before_script:\n    - |\n        if [ -n \"${CI_COMMIT_TAG}\" ]; then\n            export RELEASE_NAME=\"${CI_COMMIT_TAG}\"\n            export S3_FOLDER=\"releases\"\n        else\n            export RELEASE_NAME=\"${CI_COMMIT_BRANCH}-$(date --utc -Iseconds)\"\n            export S3_FOLDER=\"current\"\n        fi\n    - export ZIP=\"${RELEASE_NAME}.7z\"\n\n    - apk add --update --no-cache curl jq py-pip p7zip\n    - pip install awscli\n    - eval $(aws ecr get-login --no-include-email --region $AWS_REGION | sed 's|https://||')\n  script:\n    - 7z a \"${ZIP}\" ./artifacts/*\n    - aws s3 cp \"${ZIP}\" \"s3://${S3_BUCKET_NAME}/${S3_FOLDER}/${ZIP}\"\n  only:\n    variables:\n      - $AWS_ACCESS_KEY_ID != null\n      - $AWS_SECRET_ACCESS_KEY != null\n      - $AWS_REGION != null\n      - $S3_BUCKET_NAME != null\n</pre>\n\n<center>\n<img src=\"img/gitlab_functionality.png\" alt=\"GitLab functionality\" title=\"GitLab functionality\" width=\"800\"/> <!-- 1125 -->\n</center>"
  },
  {
    "original_filename": "1860_ci_graphql",
    "header_text": "GraphQL for Revit",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> GraphQL for Revit\n\n[Gregor Vilkner](https://www.microdesk.com/consulting-team/gregor-vilkner)\nof [Microdesk](https://www.microdesk.com) implemented a\n[GraphQL](https://graphql.org) endpoint\nfor Revit that can also be accessed remotely using azure service bus.\n\n> No middle men, no storing stuff in the cloud.\n\n> Was wondering if you wanted to check this out:\n\n> [Revit2GraphQL GitHub repository](https://github.com/gregorvilkner/Revit2GraphQL)\n\n<center>\n<img src=\"img/BIMrx_marconi.jpg\" alt=\"BIMrx Marconi\" title=\"BIMrx Marconi\" width=\"800\"/> <!-- 1125 -->\n</center>\n\nWe did a quick Q and A on this:\n\nQ: I looked your repo and it looks perfectly OK and straightforward.\n\nA: Thanks.\n \nQ: I and others have done similar things in the past, communicating with Revit, meseems.\n\nA: Great (ancient) word: meseems! I had to look that up.\n \nQ: Not with GraphQL specifically.\n\nA: GraphQL is awesome, and very hot right now. People get hooked on graph stuff: once you start you’ll want to use it everywhere. The 'one endpoint only' thing. The way you can structure single queries that would otherwise be batch-jobs of dozens of calls. Traversal has so many applications in BIM: duct runs, electrical distribution, path finding between spaces (doors as relationships, rooms as nodes), load take downs for columns.\n \nQ: What do you want to share about this beyond what you write in the repo readme?\n\nA: I had done a bunch of work using graph databases and GraphQL at my last job. After recently re-surfacing in the AECO space, BIM feels like a very good candidate for a graph db approach. It’s got mountains of extremely diverse datasets and especially relationships of all sorts play a super important role. Both, GraphQL and graph dbs center around this 'entrance point and traverse' concept. That really hits home for me with BIM: different folks have different entrance points and traversal needs: structural, rooms/spaces, MEP systems… We have a GraphQL endpoint for Autodesk Fabrication as well – and it’s super useful there too for reporting, QA/QC applications, interoperability.\n \nQ: How does your effort compare with something you would do with Forge?\n\nA: Forge rocks – at Microdesk we’re all big fans. But we’re still a bit off with manipulating content in Forge. Excited to see how much momentum and adoption design automation will pick up. In a discussion with some of our FM guys, however, they totally liked the idea of having a GraphQL endpoint for Forge. You can interactively explore a dataset – that’s a big deal, because it takes the need to write code out of the equation. One person would 'discover' and 'arrive' at just the right set of queries to do the trick and someone else could implement it. Btw, this is how GraphQL evolved inside Facebook when it was originally developed back in 2012.\n \nQ: How is the stability if you start processing large jobs?\n\nA: Query execution is basically as fast as the Revit API allows. Queries are executed sequentially – that’s how Revit likes it. Over-fetching is a topic in GraphQL. Since you can build large traversals in a query you could easily overwhelm the resolver and payload size. For instance: all families in a model, with all instances, and all parameters – it’s super easy to build this query, but one should obviously tweak, adjust, test, use name filters, … But returning 100k rows of JSON is no big deal at all.\n \nQ: What is the purpose, and how does it differ from a Forge approach?\n\nA: Using mutations we can write back into the model. The Marconi approach gets you a 'phone-nr' for a unique session – so it’s very immediate, real-time, and hopefully lends itself to collaborative applications. Also, one could put a resolver against Forge – and then the exact same queries could be made either against a Revit model on a desktop, or a Forge model in the cloud. A user in a Marconi client application would not (need to) know if the other end is Revit or Forge.\n\nWe have seen with Dynamo, how much 'algorithmic' and 'generative' stuff gets brought to the game by power users that aren’t familiar with coding and the Revit API in particular. Plus, there’s a ton of little this and that to keep in mind when coding against the Revit API: tasks, sessions, transactions, being in the wrong thread… A GraphQL endpoint takes all that away. You could bring that endpoint with a bunch of Revit models to a hackathon and over 24 hours have kids build mobile apps and dashboards against Revit data – folks that have never operated Revit, or learned to code against the Revit API. And they could use anything they want as long as it can make HTTP requests.\n \nQ: Do you have any demos that specifically highlight the use of the GraphQL in conjunction with the BIM?\n\nA: Yes, we’ll have to shoot some YouTube vids. Hopefully soon.\n \n... did I mention there are `TammTreeNodes` in there?\nTo traverse mechanical systems using some of the building coders fine demo code.\nThat’s waiting for a good round of MEP refactoring.\nBut for now, duct tape will have to do.\n \nMany thanks to Gregor for implementing, sharing and explaining this powerful tool."
  },
  {
    "original_filename": "1860_ci_graphql",
    "header_text": "The Tamm Tree",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> The Tamm Tree\n\nTamm really is a tree, in fact, an oak, in Estonian.\n\n[Tamm is also a common Estonian surname](https://en.wikipedia.org/wiki/Tamm_(surname)).\n\nMy surname Tammik means 'oak grove'.\nIt exists as a German surname as well, Eichenhain, and is also quite common in Sweden, as Eklund.\n\nSo, the TammTree makes perfect sense in another dimension as well."
  }
]