[
  {
    "original_filename": "0162_rfa_thumbnail",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<style>\n.blue { color: blue; }\n.teal { color: teal; }\n.maroon { color: maroon; }\n.green { color: green; }\n.gray { color: gray; }\n</style>"
  },
  {
    "original_filename": "0162_rfa_thumbnail",
    "header_text": "RVT and RFA Thumbnail Image",
    "local_header_href": "#rvt-and-rfa-thumbnail-image",
    "chunk_text": "<h3>RVT and RFA Thumbnail Image</h3><p>Here is a question that reappears pretty regularly.</p><p><strong>Question:</strong>\nHow can I obtain the preview bitmap image or thumbnail from a Revit project or family file using the Revit API?</p><p>This is an example of the kind of image I am interested in:</p><img alt=\"RFA thumbnail preview bitmap image\" src=\"img/rfa_thumbnail.jpg\"/><p><strong>Answer:</strong>\nThe topic of \n\n<a href=\"http://redbolts.com/blog/post/2008/12/01/Getting-your-Revit-thumbnails.aspx\">\ngetting your Revit thumbnails</a>\n\nwas already been discussed by\n\n<a href=\"http://redbolts.com/blog\">\nGuy Robinson</a>\n\nin\n\n<a href=\"http://redbolts.com/blog\">\nBolt out of the Red</a>, \n\nbut for completeness sake I will partially reiterate it here as well, since the query keep reappearing.</p><p>The Revit API does not provide any built-in support for this, but you can make use of generic Windows API functionality instead.\nRevit project files use Windows structured storage to manage resources internally. \nYou can use the DocFile Viewer utility dfview.exe to look at the structured storage file contents. \nHere is an example of a Revit project file with the preview image highlighted:</p><img alt=\"RVT file structured storage and preview image in dfview.exe\" src=\"img/dfview2.png\"/><p>We had a short look at the internal RVT file structure when exploring how to extract the Revit build version from \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/10/rvt-file-version.html\">\nRVT</a> \n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/06/rfa-version-grey-commands-family-context-and-rdb-link.html#1\">\nRFA</a> \n\nfiles.</p><p>The thumbnail is a standard PNG file inserted into the Revit structured storage document.</p><p>To extract the preview thumbnail image, you can use the Windows\n\n<a href=\"http://msdn.microsoft.com/en-us/library/bb761848(VS.85).aspx\">\nIExtractImage interface</a>. \n\nPreview.dll is a shell plug-in, i.e. an object that implements this interface. \nIt is used by the Windows Shell Folders to extract preview images for \"known\" file types.\nThe preview extractor needs to register itself in the registry and implement the two following standard API functions:</p><pre class=\"code\">\n  STDMETHOD(GetLocation)(\n    LPWSTR pszPathBuffer,\n    DWORD cchMax,\n    DWORD *pdwPriority,\n    const SIZE *prgSize,\n    DWORD dwRecClrDepth,\n    DWORD *pdwFlags);\n\n  STDMETHOD(Extract)(HBITMAP*);\n</pre><p>More details and sample code are available from \n\n<a href=\"http://redbolts.com/blog/post/2008/12/01/Getting-your-Revit-thumbnails.aspx\">\nGuy's post</a>.</p>"
  }
]