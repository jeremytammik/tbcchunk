[
  {
    "original_filename": "1627_keynote_rex",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- https://github.com/akseidel/RevitAddinKeyNoteSystem\n  https://github.com/akseidel/WpfRevitUserKeynoteManager\n  http://thebuildingcoder.typepad.com/blog/2017/03/wta-firep-and-3d-aimer-tools.html\n  https://forums.autodesk.com/t5/revit-api-forum/revit-addins/m-p/7767351\n  WpfRevitUserKeynoteManager -- A Revit UserKeynote manager\n  RevitAddinKeyNoteSystem -- A Revit add-in that is the Revit ribbon component to the WpfRevitUserKeynoteManager application.\n\n- [REX extensions vs Revit add-ins](https://stackoverflow.com/questions/48707506/revit-extensions-vs-plugins)\n  What is the difference between extensions and plug-ins? I've been writing many plug-ins, and while diffing througg the SDK folder I came across the REX framework and extensions, but im not really clear on what the benifets of one over the other are.\n  The REX framework and extensions are Revit structure specific and built on top of pure simple Revit API add-ins:\n  - [The REX SDK](http://thebuildingcoder.typepad.com/blog/2011/04/the-rex-sdk.html)\n  - [REX content generator](http://thebuildingcoder.typepad.com/blog/2011/12/rex-content-generator.html)\n  - [Structural Analytical Code Checking and Results Builder](http://thebuildingcoder.typepad.com/blog/2013/06/structural-analytical-code-checking-and-results-builder.html)\n  - [Framing Cross Section Analyser and REX](http://thebuildingcoder.typepad.com/blog/2013/12/security-framing-cross-section-analyser-and-rex.html)\n  - [Framing Cross Section Analyser and REX in Revit 2015](http://thebuildingcoder.typepad.com/blog/2015/03/framing-cross-section-analyser-and-rex-in-revit-2015.html)\n  - [REX Add-In Development and Migration](http://thebuildingcoder.typepad.com/blog/2015/12/rex-app-development-and-migration.html)\n  - [REX SDK FreezeDrawing Sample](http://thebuildingcoder.typepad.com/blog/2016/10/au-revit-20171-and-rex-freezedrawing.html#5)\n\n- 13832283 [Reload Revit Links From...]\n  https://forums.autodesk.com/t5/revit-api-forum/reload-revit-links-from/m-p/7722248\n\n- https://forums.autodesk.com/t5/revit-api-forum/converting-all-parameter-values-from-imperial-units-to-metric/m-p/7707054\n  Thanks for the solution I've used it to write a  UnitConverter  script that converts all imperial units to metric units automatically, here\n  Please feel free to share it with the community.\n  https://gist.github.com/imAliAsad/01893377dedef31b1e059a6241fc9b22#file-unitconvertor-cs\n  https://gist.github.com/imAliAsad/01893377dedef31b1e059a6241fc9b22#file-extractfamilyparameterdata-cs\n\nDevDays online presentations on #RevitAPI updates @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/keynotes_rex https://youtu.be/w1WskGTzX3s\n\nExternal command with ribbon button sample and keynote manager add-in #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/keynotes_rex\n\nREX extensions versus Revit add-ins #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/keynotes_rex\n\nLet's highlight a few recent threads from the Revit API discussion forum.\nBefore getting to those, a quick pointer to the DevDays Online recording from last week\n&ndash; DevDays online presentations on Revit API updates\n&ndash; External command with ribbon button sample\n&ndash; RevitAddinKeyNoteSystem keynote manager\n&ndash; REX extensions versus Revit add-ins\n&ndash; Reloading Revit links from user selected folder\n&ndash; Converting all parameter values to metric...\n\n--->"
  },
  {
    "original_filename": "1627_keynote_rex",
    "header_text": "DevDays, Keynote Manager and REX Extensions",
    "local_header_href": "#devdays-keynote-manager-and-rex-extensions",
    "chunk_text": "### DevDays, Keynote Manager and REX Extensions\n\nLet's highlight a few recent threads from\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160).\n\nBefore getting to those, a quick pointer to the DevDays Online recording from last week:\n\n- [DevDays online presentations on Revit API updates](#2)\n- [External command with ribbon button sample](#3)\n- [RevitAddinKeyNoteSystem keynote manager](#4)\n- [REX extensions versus Revit add-ins](#5)\n- [Reloading Revit links from user selected folder](#6)\n- [Converting all parameter values to metric](#7)\n\n####<a name=\"2\"></a>DevDays Online Presentations on Revit API Updates\n\nHere is the 55-minute YouTube recording of\nthe [Autodesk DevDays Online 2017 presentation on Revit API, Civil 3D and InfraWorks updates](https://youtu.be/w1WskGTzX3s):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/w1WskGTzX3s\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen></iframe>\n</center>\n\nFor ADN members only, a companion recording containing additional confidential information\non [Revit API updates for ADN members](https://adn.autodesk.io/index.php?r=custom_pages%2Fview&id=143) has\nbeen posted to the ADN site.\n\n\n####<a name=\"3\"></a>External Command with Ribbon Button Sample\n\nContinuing with the forum threads, let's begin with this simple one\non [Revit add-ins](https://forums.autodesk.com/t5/revit-api-forum/revit-addins/m-p/7767351):\n\n**Question:** I want to start an external tool from a button in the ribbon.\n\n**Answer:** Read the [Revit API getting started material](http://thebuildingcoder.typepad.com/blog/about-the-author.html#2).\nThat explains all you need.\n\nIf you wish to skip all documentation, you can also just run through\nthe [hello world examples in the developer guide](http://help.autodesk.com/view/RVT/2018/ENU/?guid=Revit_API_Revit_API_Developers_Guide_Introduction_Getting_Started_Walkthroughs_html).\n\nFinally, you can look at a real-world example in\nthe [RevitAddinKeyNoteSystem GitHub repository](https://github.com/akseidel/RevitAddinKeyNoteSystem).\n\nIt contains an add-in that does exactly what you are asking about.\n\nIt installs a ribbon panel where the *KeyNote Editor* button on the panel starts an external tool.\n\nThe file [AppKNS.cs](https://github.com/akseidel/RevitAddinKeyNoteSystem/blob/master/RevitAddinKeyNoteSystem/AppKNS.cs) contains\nthe code that builds the ribbon.\n\n[OpenKeyNoteSystemCommand.cs](https://github.com/akseidel/RevitAddinKeyNoteSystem/blob/master/RevitAddinKeyNoteSystem/OpenKeyNoteSystemCommand.cs) implements\nthe code that starts the external application.\n\n\n####<a name=\"4\"></a>RevitAddinKeyNoteSystem Keynote Manager\n\nThe pointer above from [Allan 'aksaks' 'akseidel' Seidel](https://github.com/akseidel) of [WmTao](http://wmtao.com) answers\na very basic query on getting started with the Revit API.\n\nAllan's [RevitAddinKeyNoteSystem keynote manager](https://github.com/akseidel/RevitAddinKeyNoteSystem) does much more, though.\n\nIt implements the Revit ribbon component for the [WpfRevitUserKeynoteManager](https://github.com/akseidel/WpfRevitUserKeynoteManager) application.\n\n<center>\n<img src=\"img/KNE_ribbon_panel_image1.jpg\" alt=\"RevitAddinKeyNoteSystem\" width=\"111\"/>\n</center>\n\nThe ribbon panel it creates handles four basic user needs in regard to Revit User Keynotes:\n\n- **KeyNote Editor** &ndash; launches the WpfRevitUserKeynoteManager application, a user keynote editor, with the current Revit project's user keynote file loaded up ready for creating and editing user keynotes. This editor provides a few convenient editing features germane to user keynote table files. It allows more than one person to edit the same user keynotes file at the same time, provided they edit different keynote categories.\n- **UpDate** &ndash; reloads the current Revit project's user keynote table file.\n- **KeyNote** &ndash; launches the Revit place keynote command.\n- **Display Help** &ndash; explains how to use the WpfRevitUserKeynoteManager application by launching it in its own documentation mode.\n\nMany thanks to Allan for sharing this!\n\nHere are some other of Allan's contributions here:\n\n- [Stacked Ribbon Button Panel Options](http://thebuildingcoder.typepad.com/blog/2016/09/stacked-ribbon-button-panel-options.html)\n- [WTA Elec, FireP and 3D Aimer Tools](http://thebuildingcoder.typepad.com/blog/2017/03/wta-firep-and-3d-aimer-tools.html)\n- [WTA Mechanical Family Placement Add-in](http://thebuildingcoder.typepad.com/blog/2017/03/wta-mech-and-ttt-for-provision-for-voids.html#3)\n- [AKS Opener](http://thebuildingcoder.typepad.com/blog/2017/04/work-half-aks-opener-rvtfader-and-forgefader.html#3)\n\n\n####<a name=\"5\"></a>REX Extensions versus Revit Add-Ins\n\nThis should really be pretty obvious, but somebody asked\nabout [REX extensions vs Revit add-ins](https://stackoverflow.com/questions/48707506/revit-extensions-vs-plugins):\n\n**Question:** What is the difference between extensions and plug-ins?\n\nI've been writing many plug-ins, and while diffing through the SDK folder I came across the REX framework and extensions.\n\nWhat are the benefits of one over the other?\n\n**Answer:** The REX framework and extensions are Revit structure specific and built on top of pure simple Revit API add-ins.\n\nHere are some previous discussions of various aspects of REX:\n\n- [The REX SDK](http://thebuildingcoder.typepad.com/blog/2011/04/the-rex-sdk.html)\n- [REX content generator](http://thebuildingcoder.typepad.com/blog/2011/12/rex-content-generator.html)\n- [Structural Analytical Code Checking and Results Builder](http://thebuildingcoder.typepad.com/blog/2013/06/structural-analytical-code-checking-and-results-builder.html)\n- [Framing Cross Section Analyser and REX](http://thebuildingcoder.typepad.com/blog/2013/12/security-framing-cross-section-analyser-and-rex.html)\n- [Framing Cross Section Analyser and REX in Revit 2015](http://thebuildingcoder.typepad.com/blog/2015/03/framing-cross-section-analyser-and-rex-in-revit-2015.html)\n- [REX Add-In Development and Migration](http://thebuildingcoder.typepad.com/blog/2015/12/rex-app-development-and-migration.html)\n- [REX SDK FreezeDrawing Sample](http://thebuildingcoder.typepad.com/blog/2016/10/au-revit-20171-and-rex-freezedrawing.html#5)\n\n\n####<a name=\"6\"></a>Reloading Revit Links from User Selected Folder\n\nWe discussed [automatically reloading links after migration](http://thebuildingcoder.typepad.com/blog/2016/08/automatically-reload-links-after-migration.html)\nand [loading and unloading Revit links](http://thebuildingcoder.typepad.com/blog/2014/12/last-western-european-devdays-links-textures-ur4-vs-r2.html#2)\nquite a while ago.\n\nA pretty basic question on how to use this functionality was raised and solved\nby Andrea [@ATassera](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/5528189) Tassera in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [reloading Revit links from...](https://forums.autodesk.com/t5/revit-api-forum/reload-revit-links-from/m-p/7722248).\n\n**Question:** My add-in is currently getting the names of all linked files in the model, reading the file path from each; the user is prompted to choose from a folder depending on whether the name of the link is contained in the file path; now, what I want to do is to actually reload the files from the new file path ... but it's not working.\n\nI actually had a look at the discussion\non [automatically reloading links after migration](http://thebuildingcoder.typepad.com/blog/2016/08/automatically-reload-links-after-migration.html) while developing my script.\n\nLater, after several iterations, Andrea ended up sharing the following solution:\n\n**Solution:** Thanks a lot for your reply and for the suggestions. I actually applied that bit of methodology that you suggested and I ended up finding the solution and making the tool work!\n\nThe error was the `revLinkType` parameter that was pointing to the wrong thing.\n\nI modified the loading part completely pairing `ModelPath` from where to reload (taken by the user selection) and the `RevitLinkType` to actually reload (the files linked in the folder) through the `Zip` and `Tuple.Create` methods.\n\nThe final code is available in the forum thread.\n\nThe purpose of the script is to prompt the use with a file browser to select which files wants to be reloaded, then match file path of the new files where they contain the name of the linked file, create a tuple so you have the same order of `ModelPath` and `RevitLinkOption` and you `LoadFrom` with a for each file.\n\n####<a name=\"7\"></a>Converting All Parameter Values to Metric\n\nAnother solution was shared by [Ali Asad](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/5242763) in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [converting all parameter values from imperial units to metric units](https://forums.autodesk.com/t5/revit-api-forum/converting-all-parameter-values-from-imperial-units-to-metric/m-p/7707054):\n\n**Question:** Following up [Jeremy's solution on converting imperial unit to metric unit](https://forums.autodesk.com/t5/revit-api-forum/reading-wrong-type-parameters-values/m-p/7693187).\n\nIt's hard for me to figure out which enumeration value of `DisplayUnitType` to choose for all parameters, because all parameters may have values in different formats i.e., mm, V, VA.\n\nCurrently, I'm retrieving the properties values in imperial units and I'd like to know, does the Revit API provide any easy way to automatically convert the return value format of any type-parameter to metric units?\n\nI cannot determine which `DisplayUnityType` enum I should use to get the value in the right format.\n\n**Answer:** I do not think there is a generic method to convert all imperial units to metric.\n\nBasically, Revit uses standard metric SI units for everything except length, which is in feet.\n\nThis is (almost) the only non-SI unit used.\n\nYou will probably need to implement a conversion for each unit type you encounter.\n\nIt is probably quite easy once you understand the basic principles.\n\nI looked at [The Building Coder category on units](http://thebuildingcoder.typepad.com/blog/units).\n\nHere are the posts that look most useful to me to help answer your question:\n\n- [Unit abbreviations](http://thebuildingcoder.typepad.com/blog/2017/08/unit-abbreviations.html)\n- [UnitUtils converting units for unit weight](http://thebuildingcoder.typepad.com/blog/2016/08/unitutils-converting-units-for-unit-weight.html)\n- [Localised unit abbreviations](http://thebuildingcoder.typepad.com/blog/2013/11/localised-unit-abbreviations.html)\n- [Mapping display unit type to unit types](http://thebuildingcoder.typepad.com/blog/2013/11/mapping-display-unit-type-to-unit-types.html)\n- [Unit abbreviations](http://thebuildingcoder.typepad.com/blog/2013/11/unit-abbreviations.html)\n- [Revit 2013 unit conversion utility](http://thebuildingcoder.typepad.com/blog/2013/01/revit-2013-unit-conversion-utility.html)\n- [Unit conversion and display string formatting](http://thebuildingcoder.typepad.com/blog/2011/12/unit-conversion-and-display-string-formatting.html)\n\nYou could parse the unit abbreviation string, determine how many inches, feet, mm, metres, etc. it contains, and multiply by a conversion factor from imperial to metric for each imperial unit encountered.\n\n**Response:** Thanks for the solution!\n\nI used it to write\na [UnitConverter](https://gist.github.com/imAliAsad/01893377dedef31b1e059a6241fc9b22#file-unitconvertor-cs) script\nthat converts all imperial units to metric units automatically.\n\nHere is\nthe [ExtractFamilyParameterData.cs module](https://gist.github.com/imAliAsad/01893377dedef31b1e059a6241fc9b22#file-extractfamilyparameterdata-cs) showing how it is used.\n\nPlease feel free to share it with the community."
  }
]