[
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "DevCamp Day Two",
    "local_header_href": "#devcamp-day-two",
    "chunk_text": "<h3>DevCamp Day Two</h3><p>This morning I presented my second session, on some of the Revit 2013 UI API enhancements, in the Revit API beginner track.\nAfter that, I returned back to the Revit API expert one to attend the presentations on modeless interaction and IFC before presenting my final session on the Revit MEP API.\nHere then are my sessions of today, in chronological order:\n\n<ul>\n<li><a href=\"#2\">1-4 Revit 2013 UI API enhancements</a>\n<li><a href=\"#3\">2-3 Asynchronous interactions</a>\n<li><a href=\"#4\">2-2 IFC export open source</a>\n<li><a href=\"#5\">2-7 Revit MEP API</a>\n</li></li></li></li></ul>\n<a name=\"2\"></a>\n<h4>Revit 2013 UI API Enhancements</h4>\n<p><a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/revit-2013-and-its-api.html#2\">\nEnhanced add-in integration</a> is\n\nan important topic in the Revit 2013 API.\nThis session discusses four of the add-in integration topics in more depth, building on a preceding presentation by Saikat Bhattacharya presenting a snapshot of the entire Revit UI API functionality:\n\n<ul>\n<li><a href=\"#21\">Revit progress bar notifications</a>\n<li><a href=\"#22\">Options dialogue WPF custom extensions</a>\n<li><a href=\"#23\">Embed and control a Revit view</a>\n<li><a href=\"#24\">Drag and drop</a>\n</li></li></li></li></ul>\n<p>All four of these are covered by existing SDK samples, the first by \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#2\">ProgressNotifier</a> (Events), \n\nthe others by the comprehensive \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> sample.\n\n<p>For someone like me, feeling a strong affinity to \n\n<a href=\"http://en.wikipedia.org/wiki/Winnie-the-Pooh\">\nWinnie the Pooh</a>, the \n\n\"<a href=\"http://www.winnie-pooh.org/winnie-the-pooh-quotes.htm\">bear of very little brain</a>\",\n\nthe existing SDK samples are way beyond simple comprehension and reuse, so I ended up creating four own extremely simple and minimal ones exercising these features in just a few lines of code each instead, to reduce the code and required audience comprehension power to an absolute minimum.\n\n\n<a name=\"21\"></a>\n<h4>Revit progress bar notifications</h4>\n<p>To receive information about the current Revit progress bar status, you can subscribe to the ProgressChanged event.\n\n<p>The event handler will receive a ProgressChangedEventArgs instance providing the following properties:\n\n<ul>\n<li>Caption – progress bar caption describing operation in progress\n<li>Stage – current stage of the progress bar, one of Started, CaptionChanged, RangeChanged, PositionChanged, UserCancelled, Finished\n<li>LowerRange – lower limit of range, always zero\n<li>UpperRange – upper limit of range, any non-zero number\n<li>Position – Value between zero and UpperRange incremented with \"PositionChanged\" stage\n</li></li></li></li></li></ul>\n<p>The ProgressNotifier SDK sample displays a WPF-based dialogue box.\nIt provides a button to open and load a Revit model.\nLoading the selected file will cause a number of progress bar actions to execute.\nThese actions are monitored and presented in a stack structure, since occasionally more than one progress bar event may be active simultaneously:</p>\n<center>\n<img alt=\"ProgressNotifier SDK sample\" src=\"img/ProgressNotifier.png\"/>\n</center>\n<p>My new ProgressWatcher sample in much simpler and tracks all progress bar events by just printing the event argument data to the Visual Studio debug output window.\nThis can be achieved in a very few lines of code, basically only one each to subscribe to the event and to access and print the progress bar event data:\n\n<pre class=\"code\">\n[<span class=\"teal\">Transaction</span>( <span class=\"teal\">TransactionMode</span>.ReadOnly )]\n<span class=\"blue\">public</span> <span class=\"blue\">class</span> <span class=\"teal\">Command</span> : <span class=\"teal\">IExternalCommand</span>\n{\n  <span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n    <span class=\"teal\">ExternalCommandData</span> commandData,\n    <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n    <span class=\"teal\">ElementSet</span> elements )\n  {\n    <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n    <span class=\"teal\">Application</span> app = uiapp.Application;\n \n    app.ProgressChanged \n      += <span class=\"blue\">new</span> <span class=\"teal\">EventHandler</span>&lt;<span class=\"teal\">ProgressChangedEventArgs</span>&gt;( \n        OnProgressChanged );\n \n    <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n  }\n \n  <span class=\"blue\">void</span> OnProgressChanged( \n    <span class=\"blue\">object</span> sender, \n    <span class=\"teal\">ProgressChangedEventArgs</span> e )\n  {\n    <span class=\"blue\">double</span> percent = 100.0 * e.Position / e.UpperRange;\n \n    <span class=\"teal\">Debug</span>.Print( \n      <span class=\"maroon\">\"'{0}' stage {1} position {2} [{3}, {4}] ({5}%)\"</span>,\n      e.Caption, e.Stage, e.Position, e.LowerRange, \n      e.UpperRange, percent.ToString( <span class=\"maroon\">\"0.##\"</span> ) );\n  }\n}\n</pre>\n<p>Saving the output to a text file will allow you to analyse in detail the progress bar event sequence and nesting.\n\n<a name=\"22\"></a>\n<h4>Options dialogue WPF custom extensions</h4>\n<p>In Revit 2013, an add-in can add its own custom tabs to the standard Revit Options dialogue.\n\n<p>This is achieved by defining a WPF control to display and subscribing to the UIApplication DisplayingOptionsDialog event.\n\n<p>The event handler receives an DisplayingOptionsDialogEventArgs instance.\nIt has a PagesCount property providing the number of Options dialogue tabs including default Revit ones.\nIt also sports the AddTab method that can be used to add a tab, providing a name and a handler for it.\nThe handler information is encapsulated in the TabbedDialogExtension class.\n\n<p>The TabbedDialogExtension class provides a constructor taking two arguments, a WPF user control instance and an OK handler.\nThese cannot be changed later.\nIt provides methods to get and set contextual help, and properties to read the WPF control and OK handler.\nIt also provides properties to both get and set the cancel and 'restore defaults' handlers:\n\n<ul>\n<li>Control – the control\n<li>OnOKAction – the ok handler\n<li>OnCancelAction – the cancel handler\n<li>OnRestoreDefaultsAction – the restore defaults handler\n</li></li></li></li></ul>\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample adds several custom tabs demonstrating most available features.\n\n<p>I created a minimal sample named AddOptionsTab which defines the simplest possible WPF control with one single button to click:</p>\n<center>\n<img alt=\"AddOptionsTab custom Options tab\" src=\"img/AddOptionsTab.png\"/>\n</center>\n<p>If you click the button, the corresponding event handler on the form is called, which simply displays a task dialog:</p>\n<center>\n<img alt=\"AddOptionsTab button clicked\" src=\"img/AddOptionsTab_clicked.png\"/>\n</center>\n<p>If this tab has ever been activated after the Options dialogue was opened, its OK, cancel and 'restore defaults' handlers are called, depending on the user actions.\n\n<p>Here is the entire user control source code defining its handlers:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"blue\">partial</span> <span class=\"blue\">class</span> <span class=\"teal\">UserControl1</span> : <span class=\"teal\">UserControl</span>\n{\n  <span class=\"blue\">string</span> _name;\n \n  <span class=\"blue\">public</span> UserControl1( <span class=\"blue\">string</span> name )\n  {\n    _name = name;\n \n    InitializeComponent();\n  }\n \n  <span class=\"blue\">private</span> <span class=\"blue\">void</span> button1_Click( \n    <span class=\"blue\">object</span> sender, \n    <span class=\"teal\">RoutedEventArgs</span> e )\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"I was clicked...\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnOK()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OK\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnCancel()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnCancel\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnRestoreDefaults()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnRestoreDefaults\"</span> );\n  }\n}\n</pre>\n<p>The event handler code reacting to the Options dialogue displaying simply instantiates the user control, calls the TabbedDialogExtension constructor with it, and feeds that to the event handler arguments AddTab method:\n\n<pre class=\"code\">\n<span class=\"blue\">void</span> OnDisplayingOptionsDialog( \n  <span class=\"blue\">object</span> sender, \n  <span class=\"teal\">DisplayingOptionsDialogEventArgs</span> e )\n{\n  <span class=\"teal\">UserControl1</span> c = <span class=\"blue\">new</span> <span class=\"teal\">UserControl1</span>( \n    <span class=\"maroon\">\"DevCamp User Control\"</span> );\n \n  e.AddTab( <span class=\"maroon\">\"DevCamp Custom Tab\"</span>, \n    <span class=\"blue\">new</span> <span class=\"teal\">TabbedDialogExtension</span>( \n      c, c.OnOK ) );\n}\n</pre>\n<p>The event handler is called each time the Options dialogue is invoked once the event has been subscribed to, which is achieved in a single line of code like this in the AddOptionsTab external command:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n \n  uiapp.DisplayingOptionsDialog \n    += <span class=\"blue\">new</span> <span class=\"teal\">EventHandler</span>&lt;<span class=\"teal\">DisplayingOptionsDialogEventArgs</span>&gt;( \n      OnDisplayingOptionsDialog );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"23\"></a>\n<h4>Embed and control a Revit view</h4>\n<p>Another of the add-in integration enhancements enables you to embed and control a Revit view in your own form, dialogue or window.\n\n<p>The new PreviewControl class presents a preview control to browse the Revit model.\nIt takes two input arguments, a document and a view id.\nThe hosting form or window must be modal.\nThe View can be any graphical view, i.e. must be printable.\nPerspective views are also supported, and all 3D Views can be manipulated by view cube.\nThe visibility and graphical settings of the view are effective and respected by the control.\n<!-- User interaction requires an open transaction (in Quasar RP only?) -->\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample proves a demonstration of this as well, which allows you to interactively select any of the open documents to view, or even open a new one, and secondly presents a list of all the documents views for you to switch between.\nEach time you change any of these two selections, the current preview control is discarded and a new one is instantiated with the updated input arguments.\nThese input arguments are the only way in which the add-in affects the view, all further interaction happens between the control and the user.\n\n<p>To use a Revit preview control, you simply create a standard .NET form and insert a WPF host in it.\nA suitable host is the System.Windows.Forms.Integration.ElementHost.\nYou populate this with a new Revit preview control instance, e.g. like this\n\n<pre class=\"code\">\n  elementHost.Child = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( \n    doc, view.Id );\n</pre>\n<p>The PreviewControl instance needs to be disposed of after use:\n\n<pre class=\"code\">\n  PreviewControl vc = elementHost.Child\n    as PreviewControl;\n\n  if( vc != null ) { vc.Dispose(); }\n</pre>\n<p>Here is a code snippet showing how all the printable views can be retrieved using a filtered element collector:\n\n<pre class=\"code\">\n  <span class=\"teal\">IEnumerable</span>&lt;<span class=\"teal\">View</span>&gt; views\n    = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( doc )\n      .OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">View</span> ) )\n      .Cast&lt;<span class=\"teal\">View</span>&gt;()\n      .Where&lt;<span class=\"teal\">View</span>&gt;( v =&gt; v.CanBePrinted );\n</pre>\n<p>I created a minimal sample application PreviewControlSimple for this DevCamp class with much less code (and functionality than the UIAPI one, since it just displays the current view of a document with no further ado.\n\n<p>It does add one interesting twist, though: to show exactly how the hosting form is set up, I implemented that twice over, first using the Visual Studio designer as usual, and then converting the form to be completely programmatically generated.\nHere is the DisplayRevitView method taking the document and view input arguments for the preview control.\nIt also takes a third argument for the main Revit window, so that the generated control can be hooked up to that as a parent window.\nThis defines an appropriate relationship between the two as far as the Windows OS is concerned, ensuring correct minimisation and restoration behaviour:\n\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _caption_prefix\n  = <span class=\"maroon\">\"Simple Revit Preview - \"</span>;\n \n<span class=\"blue\">void</span> DisplayRevitView( \n  <span class=\"teal\">Document</span> doc,\n  <span class=\"teal\">View</span> view,\n  <span class=\"teal\">IWin32Window</span> owner )\n{\n \n  <span class=\"blue\">using</span>( <span class=\"teal\">PreviewControl</span> pc\n    = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( doc, view.Id ) )\n  {\n \n<span class=\"blue\">#if</span> CREATE_FORM_BY_CODE\n \n    <span class=\"blue\">using</span>( System.Windows.Forms.<span class=\"teal\">Form</span> form\n      = <span class=\"blue\">new</span> System.Windows.Forms.<span class=\"teal\">Form</span>() )\n    {\n      <span class=\"teal\">ElementHost</span> elementHost = <span class=\"blue\">new</span> <span class=\"teal\">ElementHost</span>();\n \n      elementHost.Location\n        = <span class=\"blue\">new</span> System.Drawing.<span class=\"teal\">Point</span>( 0, 0 );\n \n      elementHost.Dock = <span class=\"teal\">DockStyle</span>.Fill;\n      elementHost.TabIndex = 0;\n      elementHost.Parent = form;\n      elementHost.Child = pc;\n \n      form.Text = _caption_prefix + view.Name;\n      form.Controls.Add( elementHost );\n      form.Size = <span class=\"blue\">new</span> <span class=\"teal\">Size</span>( 400, 400 );\n      form.ShowDialog( owner );\n    }\n \n<span class=\"blue\">#else</span> <span class=\"green\">// if not CREATE_FORM_BY_CODE</span>\n \n<span class=\"gray\">    Form1 form = new Form1( pc );</span>\n<span class=\"gray\">    form.ShowDialog( owner );</span>\n \n<span class=\"blue\">#endif</span> <span class=\"green\">// CREATE_FORM_BY_CODE</span>\n \n  }\n}\n</pre>\n<p>Please note that correct disposal of the preview control is ensured by the 'using' statement.\nThis is similar to Arnošt's strong recommendation to always \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/using-using-automagically-disposes-and-rolls-back.html\">\nencapsulate Revit Transactions in a 'using' statement</a>.\n\n<p>Calling this method from the external command mainline with the current document view is trivial.\nI add one line of code to access the Revit main window:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">IWin32Window</span> revit_window\n    = <span class=\"blue\">new</span> <span class=\"teal\">JtWindowHandle</span>(\n      <span class=\"teal\">ComponentManager</span>.ApplicationWindow );\n \n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n  <span class=\"teal\">UIDocument</span> uidoc = uiapp.ActiveUIDocument;\n  <span class=\"teal\">Document</span> doc = uidoc.Document;\n \n  <span class=\"teal\">View</span> view = doc.ActiveView;\n \n  DisplayRevitView( doc, view, revit_window );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"24\"></a>\n<h4>Drag and Drop API</h4>\n<p>I recently discussed the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/drag-and-drop-api.html\">\ndrag and drop functionality</a> and \n\nthe UIAPI sample command demonstrating it.\n\n<p>The UIApplication provides the new static DoDragDrop method, with two overloads:\n\n<ul>\n<li>DoDragDrop( ICollection&lt;string&gt; ) –\ninitiate a standard built-in Revit drag and drop operation taking a collection of file names.\n\n<li>DoDragDrop( object, IDropHandler ) –\ninitiate a drag and drop operation with a custom drop implementation.\n</li></li></ul>\n<p>This method is designed for use in a modeless form.\n\n<p>Please note that this is currently the one and only Revit API method not requiring a valid Revit API context.\n\n<p>This method can be called from your modeless form at any time, even without Revit giving you explicit permission to interact with the API via some form of callback or notification, as required for all other Revit API calls.\n\n<p>The behaviour of drag and drop given a list of filenames depends on the type of files, as I already recently pointed out:\n\n<ul>\n<li>One AutoCAD format or image file dragged onto Revit\n– A new import placement editor is started to import the file.\n\n<li>More than one AutoCAD format or image files dragged\n– A new import placement editor is started for the first file.\n\n<li>One family file dragged onto Revit\n– The family is loaded, and an editor started to place an instance.\n\n<li>More than one family file dragged onto Revit\n– All the families are loaded.\n\n<li>More than one family file including other format files dragged \n– Revit tries to open all the files.\n\n<li>Valid file or list of files is passed\n– Revit does its best to use them appropriately.\n\n<li>Any files are not usable\n– Failure is signalled to user, no exception is thrown, add-in is not notified.\n</li></li></li></li></li></li></li></ul>\n<p>Here again, I implemented a new DevCamp sample add-in DragDropApi to be able to show the necessary steps in a simpler context than the corresponding UIAPI example.\n\n<p>Here are my four new Revit 2013 UI API samples \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.zip\">\nAddOptionsTab, DragDropApi, PreviewControlSimple, ProgressWatcher</a> and \n\nthe \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.pptx\">\nslides</a> I \n\nused.\n\n\n\n<a name=\"3\"></a>\n<h4>Asynchronous Interactions</h4>\n<p>Arnošt Löbel already presented on this topic at Autodesk University 2011 in his class\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1725932\">CP5381</a> 'Asynchronous Interactions and Managing Modeless UI with the Autodesk Revit API', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\n<p>In this class, Arnošt also covered the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/idling-enhancements-and-external-events.html\">\nexternal events</a> and\n\ndemonstrated his \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#1\">\nModelessForm_ExternalEvent, ModelessForm_IdlingEvent</a> (ModelessDialog)\n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#5\">\nWorkThread</a> (MultiThreading)\n\nSDK samples.\n\n<p>The conclusion of the presentation is the following pledge that we are all strongly recommended to take:\n\n<ul>\n<li>I shall not call the API unless invoked by it\n<li>I shall not call the API from anywhere but the main thread\n<li>I shall call the API only, not directly the Revit\u0019s UI\n<li>I shall use the Idling event cautiously and considerably\n</li></li></li></li></ul>\n<p>Here is a snapshot of the \n\n<a href=\"zip/devcamp_2012_2-3_Asynchronous_Interactions.pdf\">\nentire slide deck</a>.\n\nThis is not the final version, which will be posted soon after the end of DevCamp.\n\n\n\n<a name=\"4\"></a>\n<h4>IFC Export Open Source</h4>\n<p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Revit 2013 UI API Enhancements",
    "local_header_href": "#revit-2013-ui-api-enhancements",
    "chunk_text": "<h4>Revit 2013 UI API Enhancements</h4><p><a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/revit-2013-and-its-api.html#2\">\nEnhanced add-in integration</a> is\n\nan important topic in the Revit 2013 API.\nThis session discusses four of the add-in integration topics in more depth, building on a preceding presentation by Saikat Bhattacharya presenting a snapshot of the entire Revit UI API functionality:\n\n<ul>\n<li><a href=\"#21\">Revit progress bar notifications</a>\n<li><a href=\"#22\">Options dialogue WPF custom extensions</a>\n<li><a href=\"#23\">Embed and control a Revit view</a>\n<li><a href=\"#24\">Drag and drop</a>\n</li></li></li></li></ul>\n<p>All four of these are covered by existing SDK samples, the first by \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#2\">ProgressNotifier</a> (Events), \n\nthe others by the comprehensive \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> sample.\n\n<p>For someone like me, feeling a strong affinity to \n\n<a href=\"http://en.wikipedia.org/wiki/Winnie-the-Pooh\">\nWinnie the Pooh</a>, the \n\n\"<a href=\"http://www.winnie-pooh.org/winnie-the-pooh-quotes.htm\">bear of very little brain</a>\",\n\nthe existing SDK samples are way beyond simple comprehension and reuse, so I ended up creating four own extremely simple and minimal ones exercising these features in just a few lines of code each instead, to reduce the code and required audience comprehension power to an absolute minimum.\n\n\n<a name=\"21\"></a>\n<h4>Revit progress bar notifications</h4>\n<p>To receive information about the current Revit progress bar status, you can subscribe to the ProgressChanged event.\n\n<p>The event handler will receive a ProgressChangedEventArgs instance providing the following properties:\n\n<ul>\n<li>Caption – progress bar caption describing operation in progress\n<li>Stage – current stage of the progress bar, one of Started, CaptionChanged, RangeChanged, PositionChanged, UserCancelled, Finished\n<li>LowerRange – lower limit of range, always zero\n<li>UpperRange – upper limit of range, any non-zero number\n<li>Position – Value between zero and UpperRange incremented with \"PositionChanged\" stage\n</li></li></li></li></li></ul>\n<p>The ProgressNotifier SDK sample displays a WPF-based dialogue box.\nIt provides a button to open and load a Revit model.\nLoading the selected file will cause a number of progress bar actions to execute.\nThese actions are monitored and presented in a stack structure, since occasionally more than one progress bar event may be active simultaneously:</p>\n<center>\n<img alt=\"ProgressNotifier SDK sample\" src=\"img/ProgressNotifier.png\"/>\n</center>\n<p>My new ProgressWatcher sample in much simpler and tracks all progress bar events by just printing the event argument data to the Visual Studio debug output window.\nThis can be achieved in a very few lines of code, basically only one each to subscribe to the event and to access and print the progress bar event data:\n\n<pre class=\"code\">\n[<span class=\"teal\">Transaction</span>( <span class=\"teal\">TransactionMode</span>.ReadOnly )]\n<span class=\"blue\">public</span> <span class=\"blue\">class</span> <span class=\"teal\">Command</span> : <span class=\"teal\">IExternalCommand</span>\n{\n  <span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n    <span class=\"teal\">ExternalCommandData</span> commandData,\n    <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n    <span class=\"teal\">ElementSet</span> elements )\n  {\n    <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n    <span class=\"teal\">Application</span> app = uiapp.Application;\n \n    app.ProgressChanged \n      += <span class=\"blue\">new</span> <span class=\"teal\">EventHandler</span>&lt;<span class=\"teal\">ProgressChangedEventArgs</span>&gt;( \n        OnProgressChanged );\n \n    <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n  }\n \n  <span class=\"blue\">void</span> OnProgressChanged( \n    <span class=\"blue\">object</span> sender, \n    <span class=\"teal\">ProgressChangedEventArgs</span> e )\n  {\n    <span class=\"blue\">double</span> percent = 100.0 * e.Position / e.UpperRange;\n \n    <span class=\"teal\">Debug</span>.Print( \n      <span class=\"maroon\">\"'{0}' stage {1} position {2} [{3}, {4}] ({5}%)\"</span>,\n      e.Caption, e.Stage, e.Position, e.LowerRange, \n      e.UpperRange, percent.ToString( <span class=\"maroon\">\"0.##\"</span> ) );\n  }\n}\n</pre>\n<p>Saving the output to a text file will allow you to analyse in detail the progress bar event sequence and nesting.\n\n<a name=\"22\"></a>\n<h4>Options dialogue WPF custom extensions</h4>\n<p>In Revit 2013, an add-in can add its own custom tabs to the standard Revit Options dialogue.\n\n<p>This is achieved by defining a WPF control to display and subscribing to the UIApplication DisplayingOptionsDialog event.\n\n<p>The event handler receives an DisplayingOptionsDialogEventArgs instance.\nIt has a PagesCount property providing the number of Options dialogue tabs including default Revit ones.\nIt also sports the AddTab method that can be used to add a tab, providing a name and a handler for it.\nThe handler information is encapsulated in the TabbedDialogExtension class.\n\n<p>The TabbedDialogExtension class provides a constructor taking two arguments, a WPF user control instance and an OK handler.\nThese cannot be changed later.\nIt provides methods to get and set contextual help, and properties to read the WPF control and OK handler.\nIt also provides properties to both get and set the cancel and 'restore defaults' handlers:\n\n<ul>\n<li>Control – the control\n<li>OnOKAction – the ok handler\n<li>OnCancelAction – the cancel handler\n<li>OnRestoreDefaultsAction – the restore defaults handler\n</li></li></li></li></ul>\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample adds several custom tabs demonstrating most available features.\n\n<p>I created a minimal sample named AddOptionsTab which defines the simplest possible WPF control with one single button to click:</p>\n<center>\n<img alt=\"AddOptionsTab custom Options tab\" src=\"img/AddOptionsTab.png\"/>\n</center>\n<p>If you click the button, the corresponding event handler on the form is called, which simply displays a task dialog:</p>\n<center>\n<img alt=\"AddOptionsTab button clicked\" src=\"img/AddOptionsTab_clicked.png\"/>\n</center>\n<p>If this tab has ever been activated after the Options dialogue was opened, its OK, cancel and 'restore defaults' handlers are called, depending on the user actions.\n\n<p>Here is the entire user control source code defining its handlers:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"blue\">partial</span> <span class=\"blue\">class</span> <span class=\"teal\">UserControl1</span> : <span class=\"teal\">UserControl</span>\n{\n  <span class=\"blue\">string</span> _name;\n \n  <span class=\"blue\">public</span> UserControl1( <span class=\"blue\">string</span> name )\n  {\n    _name = name;\n \n    InitializeComponent();\n  }\n \n  <span class=\"blue\">private</span> <span class=\"blue\">void</span> button1_Click( \n    <span class=\"blue\">object</span> sender, \n    <span class=\"teal\">RoutedEventArgs</span> e )\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"I was clicked...\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnOK()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OK\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnCancel()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnCancel\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnRestoreDefaults()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnRestoreDefaults\"</span> );\n  }\n}\n</pre>\n<p>The event handler code reacting to the Options dialogue displaying simply instantiates the user control, calls the TabbedDialogExtension constructor with it, and feeds that to the event handler arguments AddTab method:\n\n<pre class=\"code\">\n<span class=\"blue\">void</span> OnDisplayingOptionsDialog( \n  <span class=\"blue\">object</span> sender, \n  <span class=\"teal\">DisplayingOptionsDialogEventArgs</span> e )\n{\n  <span class=\"teal\">UserControl1</span> c = <span class=\"blue\">new</span> <span class=\"teal\">UserControl1</span>( \n    <span class=\"maroon\">\"DevCamp User Control\"</span> );\n \n  e.AddTab( <span class=\"maroon\">\"DevCamp Custom Tab\"</span>, \n    <span class=\"blue\">new</span> <span class=\"teal\">TabbedDialogExtension</span>( \n      c, c.OnOK ) );\n}\n</pre>\n<p>The event handler is called each time the Options dialogue is invoked once the event has been subscribed to, which is achieved in a single line of code like this in the AddOptionsTab external command:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n \n  uiapp.DisplayingOptionsDialog \n    += <span class=\"blue\">new</span> <span class=\"teal\">EventHandler</span>&lt;<span class=\"teal\">DisplayingOptionsDialogEventArgs</span>&gt;( \n      OnDisplayingOptionsDialog );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"23\"></a>\n<h4>Embed and control a Revit view</h4>\n<p>Another of the add-in integration enhancements enables you to embed and control a Revit view in your own form, dialogue or window.\n\n<p>The new PreviewControl class presents a preview control to browse the Revit model.\nIt takes two input arguments, a document and a view id.\nThe hosting form or window must be modal.\nThe View can be any graphical view, i.e. must be printable.\nPerspective views are also supported, and all 3D Views can be manipulated by view cube.\nThe visibility and graphical settings of the view are effective and respected by the control.\n<!-- User interaction requires an open transaction (in Quasar RP only?) -->\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample proves a demonstration of this as well, which allows you to interactively select any of the open documents to view, or even open a new one, and secondly presents a list of all the documents views for you to switch between.\nEach time you change any of these two selections, the current preview control is discarded and a new one is instantiated with the updated input arguments.\nThese input arguments are the only way in which the add-in affects the view, all further interaction happens between the control and the user.\n\n<p>To use a Revit preview control, you simply create a standard .NET form and insert a WPF host in it.\nA suitable host is the System.Windows.Forms.Integration.ElementHost.\nYou populate this with a new Revit preview control instance, e.g. like this\n\n<pre class=\"code\">\n  elementHost.Child = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( \n    doc, view.Id );\n</pre>\n<p>The PreviewControl instance needs to be disposed of after use:\n\n<pre class=\"code\">\n  PreviewControl vc = elementHost.Child\n    as PreviewControl;\n\n  if( vc != null ) { vc.Dispose(); }\n</pre>\n<p>Here is a code snippet showing how all the printable views can be retrieved using a filtered element collector:\n\n<pre class=\"code\">\n  <span class=\"teal\">IEnumerable</span>&lt;<span class=\"teal\">View</span>&gt; views\n    = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( doc )\n      .OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">View</span> ) )\n      .Cast&lt;<span class=\"teal\">View</span>&gt;()\n      .Where&lt;<span class=\"teal\">View</span>&gt;( v =&gt; v.CanBePrinted );\n</pre>\n<p>I created a minimal sample application PreviewControlSimple for this DevCamp class with much less code (and functionality than the UIAPI one, since it just displays the current view of a document with no further ado.\n\n<p>It does add one interesting twist, though: to show exactly how the hosting form is set up, I implemented that twice over, first using the Visual Studio designer as usual, and then converting the form to be completely programmatically generated.\nHere is the DisplayRevitView method taking the document and view input arguments for the preview control.\nIt also takes a third argument for the main Revit window, so that the generated control can be hooked up to that as a parent window.\nThis defines an appropriate relationship between the two as far as the Windows OS is concerned, ensuring correct minimisation and restoration behaviour:\n\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _caption_prefix\n  = <span class=\"maroon\">\"Simple Revit Preview - \"</span>;\n \n<span class=\"blue\">void</span> DisplayRevitView( \n  <span class=\"teal\">Document</span> doc,\n  <span class=\"teal\">View</span> view,\n  <span class=\"teal\">IWin32Window</span> owner )\n{\n \n  <span class=\"blue\">using</span>( <span class=\"teal\">PreviewControl</span> pc\n    = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( doc, view.Id ) )\n  {\n \n<span class=\"blue\">#if</span> CREATE_FORM_BY_CODE\n \n    <span class=\"blue\">using</span>( System.Windows.Forms.<span class=\"teal\">Form</span> form\n      = <span class=\"blue\">new</span> System.Windows.Forms.<span class=\"teal\">Form</span>() )\n    {\n      <span class=\"teal\">ElementHost</span> elementHost = <span class=\"blue\">new</span> <span class=\"teal\">ElementHost</span>();\n \n      elementHost.Location\n        = <span class=\"blue\">new</span> System.Drawing.<span class=\"teal\">Point</span>( 0, 0 );\n \n      elementHost.Dock = <span class=\"teal\">DockStyle</span>.Fill;\n      elementHost.TabIndex = 0;\n      elementHost.Parent = form;\n      elementHost.Child = pc;\n \n      form.Text = _caption_prefix + view.Name;\n      form.Controls.Add( elementHost );\n      form.Size = <span class=\"blue\">new</span> <span class=\"teal\">Size</span>( 400, 400 );\n      form.ShowDialog( owner );\n    }\n \n<span class=\"blue\">#else</span> <span class=\"green\">// if not CREATE_FORM_BY_CODE</span>\n \n<span class=\"gray\">    Form1 form = new Form1( pc );</span>\n<span class=\"gray\">    form.ShowDialog( owner );</span>\n \n<span class=\"blue\">#endif</span> <span class=\"green\">// CREATE_FORM_BY_CODE</span>\n \n  }\n}\n</pre>\n<p>Please note that correct disposal of the preview control is ensured by the 'using' statement.\nThis is similar to Arnošt's strong recommendation to always \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/using-using-automagically-disposes-and-rolls-back.html\">\nencapsulate Revit Transactions in a 'using' statement</a>.\n\n<p>Calling this method from the external command mainline with the current document view is trivial.\nI add one line of code to access the Revit main window:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">IWin32Window</span> revit_window\n    = <span class=\"blue\">new</span> <span class=\"teal\">JtWindowHandle</span>(\n      <span class=\"teal\">ComponentManager</span>.ApplicationWindow );\n \n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n  <span class=\"teal\">UIDocument</span> uidoc = uiapp.ActiveUIDocument;\n  <span class=\"teal\">Document</span> doc = uidoc.Document;\n \n  <span class=\"teal\">View</span> view = doc.ActiveView;\n \n  DisplayRevitView( doc, view, revit_window );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"24\"></a>\n<h4>Drag and Drop API</h4>\n<p>I recently discussed the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/drag-and-drop-api.html\">\ndrag and drop functionality</a> and \n\nthe UIAPI sample command demonstrating it.\n\n<p>The UIApplication provides the new static DoDragDrop method, with two overloads:\n\n<ul>\n<li>DoDragDrop( ICollection&lt;string&gt; ) –\ninitiate a standard built-in Revit drag and drop operation taking a collection of file names.\n\n<li>DoDragDrop( object, IDropHandler ) –\ninitiate a drag and drop operation with a custom drop implementation.\n</li></li></ul>\n<p>This method is designed for use in a modeless form.\n\n<p>Please note that this is currently the one and only Revit API method not requiring a valid Revit API context.\n\n<p>This method can be called from your modeless form at any time, even without Revit giving you explicit permission to interact with the API via some form of callback or notification, as required for all other Revit API calls.\n\n<p>The behaviour of drag and drop given a list of filenames depends on the type of files, as I already recently pointed out:\n\n<ul>\n<li>One AutoCAD format or image file dragged onto Revit\n– A new import placement editor is started to import the file.\n\n<li>More than one AutoCAD format or image files dragged\n– A new import placement editor is started for the first file.\n\n<li>One family file dragged onto Revit\n– The family is loaded, and an editor started to place an instance.\n\n<li>More than one family file dragged onto Revit\n– All the families are loaded.\n\n<li>More than one family file including other format files dragged \n– Revit tries to open all the files.\n\n<li>Valid file or list of files is passed\n– Revit does its best to use them appropriately.\n\n<li>Any files are not usable\n– Failure is signalled to user, no exception is thrown, add-in is not notified.\n</li></li></li></li></li></li></li></ul>\n<p>Here again, I implemented a new DevCamp sample add-in DragDropApi to be able to show the necessary steps in a simpler context than the corresponding UIAPI example.\n\n<p>Here are my four new Revit 2013 UI API samples \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.zip\">\nAddOptionsTab, DragDropApi, PreviewControlSimple, ProgressWatcher</a> and \n\nthe \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.pptx\">\nslides</a> I \n\nused.\n\n\n\n<a name=\"3\"></a>\n<h4>Asynchronous Interactions</h4>\n<p>Arnošt Löbel already presented on this topic at Autodesk University 2011 in his class\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1725932\">CP5381</a> 'Asynchronous Interactions and Managing Modeless UI with the Autodesk Revit API', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\n<p>In this class, Arnošt also covered the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/idling-enhancements-and-external-events.html\">\nexternal events</a> and\n\ndemonstrated his \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#1\">\nModelessForm_ExternalEvent, ModelessForm_IdlingEvent</a> (ModelessDialog)\n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#5\">\nWorkThread</a> (MultiThreading)\n\nSDK samples.\n\n<p>The conclusion of the presentation is the following pledge that we are all strongly recommended to take:\n\n<ul>\n<li>I shall not call the API unless invoked by it\n<li>I shall not call the API from anywhere but the main thread\n<li>I shall call the API only, not directly the Revit\u0019s UI\n<li>I shall use the Idling event cautiously and considerably\n</li></li></li></li></ul>\n<p>Here is a snapshot of the \n\n<a href=\"zip/devcamp_2012_2-3_Asynchronous_Interactions.pdf\">\nentire slide deck</a>.\n\nThis is not the final version, which will be posted soon after the end of DevCamp.\n\n\n\n<a name=\"4\"></a>\n<h4>IFC Export Open Source</h4>\n<p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Revit progress bar notifications",
    "local_header_href": "#revit-progress-bar-notifications",
    "chunk_text": "<h4>Revit progress bar notifications</h4><p>To receive information about the current Revit progress bar status, you can subscribe to the ProgressChanged event.\n\n<p>The event handler will receive a ProgressChangedEventArgs instance providing the following properties:\n\n<ul>\n<li>Caption – progress bar caption describing operation in progress\n<li>Stage – current stage of the progress bar, one of Started, CaptionChanged, RangeChanged, PositionChanged, UserCancelled, Finished\n<li>LowerRange – lower limit of range, always zero\n<li>UpperRange – upper limit of range, any non-zero number\n<li>Position – Value between zero and UpperRange incremented with \"PositionChanged\" stage\n</li></li></li></li></li></ul>\n<p>The ProgressNotifier SDK sample displays a WPF-based dialogue box.\nIt provides a button to open and load a Revit model.\nLoading the selected file will cause a number of progress bar actions to execute.\nThese actions are monitored and presented in a stack structure, since occasionally more than one progress bar event may be active simultaneously:</p>\n<center>\n<img alt=\"ProgressNotifier SDK sample\" src=\"img/ProgressNotifier.png\"/>\n</center>\n<p>My new ProgressWatcher sample in much simpler and tracks all progress bar events by just printing the event argument data to the Visual Studio debug output window.\nThis can be achieved in a very few lines of code, basically only one each to subscribe to the event and to access and print the progress bar event data:\n\n<pre class=\"code\">\n[<span class=\"teal\">Transaction</span>( <span class=\"teal\">TransactionMode</span>.ReadOnly )]\n<span class=\"blue\">public</span> <span class=\"blue\">class</span> <span class=\"teal\">Command</span> : <span class=\"teal\">IExternalCommand</span>\n{\n  <span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n    <span class=\"teal\">ExternalCommandData</span> commandData,\n    <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n    <span class=\"teal\">ElementSet</span> elements )\n  {\n    <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n    <span class=\"teal\">Application</span> app = uiapp.Application;\n \n    app.ProgressChanged \n      += <span class=\"blue\">new</span> <span class=\"teal\">EventHandler</span>&lt;<span class=\"teal\">ProgressChangedEventArgs</span>&gt;( \n        OnProgressChanged );\n \n    <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n  }\n \n  <span class=\"blue\">void</span> OnProgressChanged( \n    <span class=\"blue\">object</span> sender, \n    <span class=\"teal\">ProgressChangedEventArgs</span> e )\n  {\n    <span class=\"blue\">double</span> percent = 100.0 * e.Position / e.UpperRange;\n \n    <span class=\"teal\">Debug</span>.Print( \n      <span class=\"maroon\">\"'{0}' stage {1} position {2} [{3}, {4}] ({5}%)\"</span>,\n      e.Caption, e.Stage, e.Position, e.LowerRange, \n      e.UpperRange, percent.ToString( <span class=\"maroon\">\"0.##\"</span> ) );\n  }\n}\n</pre>\n<p>Saving the output to a text file will allow you to analyse in detail the progress bar event sequence and nesting.\n\n<a name=\"22\"></a>\n<h4>Options dialogue WPF custom extensions</h4>\n<p>In Revit 2013, an add-in can add its own custom tabs to the standard Revit Options dialogue.\n\n<p>This is achieved by defining a WPF control to display and subscribing to the UIApplication DisplayingOptionsDialog event.\n\n<p>The event handler receives an DisplayingOptionsDialogEventArgs instance.\nIt has a PagesCount property providing the number of Options dialogue tabs including default Revit ones.\nIt also sports the AddTab method that can be used to add a tab, providing a name and a handler for it.\nThe handler information is encapsulated in the TabbedDialogExtension class.\n\n<p>The TabbedDialogExtension class provides a constructor taking two arguments, a WPF user control instance and an OK handler.\nThese cannot be changed later.\nIt provides methods to get and set contextual help, and properties to read the WPF control and OK handler.\nIt also provides properties to both get and set the cancel and 'restore defaults' handlers:\n\n<ul>\n<li>Control – the control\n<li>OnOKAction – the ok handler\n<li>OnCancelAction – the cancel handler\n<li>OnRestoreDefaultsAction – the restore defaults handler\n</li></li></li></li></ul>\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample adds several custom tabs demonstrating most available features.\n\n<p>I created a minimal sample named AddOptionsTab which defines the simplest possible WPF control with one single button to click:</p>\n<center>\n<img alt=\"AddOptionsTab custom Options tab\" src=\"img/AddOptionsTab.png\"/>\n</center>\n<p>If you click the button, the corresponding event handler on the form is called, which simply displays a task dialog:</p>\n<center>\n<img alt=\"AddOptionsTab button clicked\" src=\"img/AddOptionsTab_clicked.png\"/>\n</center>\n<p>If this tab has ever been activated after the Options dialogue was opened, its OK, cancel and 'restore defaults' handlers are called, depending on the user actions.\n\n<p>Here is the entire user control source code defining its handlers:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"blue\">partial</span> <span class=\"blue\">class</span> <span class=\"teal\">UserControl1</span> : <span class=\"teal\">UserControl</span>\n{\n  <span class=\"blue\">string</span> _name;\n \n  <span class=\"blue\">public</span> UserControl1( <span class=\"blue\">string</span> name )\n  {\n    _name = name;\n \n    InitializeComponent();\n  }\n \n  <span class=\"blue\">private</span> <span class=\"blue\">void</span> button1_Click( \n    <span class=\"blue\">object</span> sender, \n    <span class=\"teal\">RoutedEventArgs</span> e )\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"I was clicked...\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnOK()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OK\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnCancel()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnCancel\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnRestoreDefaults()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnRestoreDefaults\"</span> );\n  }\n}\n</pre>\n<p>The event handler code reacting to the Options dialogue displaying simply instantiates the user control, calls the TabbedDialogExtension constructor with it, and feeds that to the event handler arguments AddTab method:\n\n<pre class=\"code\">\n<span class=\"blue\">void</span> OnDisplayingOptionsDialog( \n  <span class=\"blue\">object</span> sender, \n  <span class=\"teal\">DisplayingOptionsDialogEventArgs</span> e )\n{\n  <span class=\"teal\">UserControl1</span> c = <span class=\"blue\">new</span> <span class=\"teal\">UserControl1</span>( \n    <span class=\"maroon\">\"DevCamp User Control\"</span> );\n \n  e.AddTab( <span class=\"maroon\">\"DevCamp Custom Tab\"</span>, \n    <span class=\"blue\">new</span> <span class=\"teal\">TabbedDialogExtension</span>( \n      c, c.OnOK ) );\n}\n</pre>\n<p>The event handler is called each time the Options dialogue is invoked once the event has been subscribed to, which is achieved in a single line of code like this in the AddOptionsTab external command:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n \n  uiapp.DisplayingOptionsDialog \n    += <span class=\"blue\">new</span> <span class=\"teal\">EventHandler</span>&lt;<span class=\"teal\">DisplayingOptionsDialogEventArgs</span>&gt;( \n      OnDisplayingOptionsDialog );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"23\"></a>\n<h4>Embed and control a Revit view</h4>\n<p>Another of the add-in integration enhancements enables you to embed and control a Revit view in your own form, dialogue or window.\n\n<p>The new PreviewControl class presents a preview control to browse the Revit model.\nIt takes two input arguments, a document and a view id.\nThe hosting form or window must be modal.\nThe View can be any graphical view, i.e. must be printable.\nPerspective views are also supported, and all 3D Views can be manipulated by view cube.\nThe visibility and graphical settings of the view are effective and respected by the control.\n<!-- User interaction requires an open transaction (in Quasar RP only?) -->\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample proves a demonstration of this as well, which allows you to interactively select any of the open documents to view, or even open a new one, and secondly presents a list of all the documents views for you to switch between.\nEach time you change any of these two selections, the current preview control is discarded and a new one is instantiated with the updated input arguments.\nThese input arguments are the only way in which the add-in affects the view, all further interaction happens between the control and the user.\n\n<p>To use a Revit preview control, you simply create a standard .NET form and insert a WPF host in it.\nA suitable host is the System.Windows.Forms.Integration.ElementHost.\nYou populate this with a new Revit preview control instance, e.g. like this\n\n<pre class=\"code\">\n  elementHost.Child = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( \n    doc, view.Id );\n</pre>\n<p>The PreviewControl instance needs to be disposed of after use:\n\n<pre class=\"code\">\n  PreviewControl vc = elementHost.Child\n    as PreviewControl;\n\n  if( vc != null ) { vc.Dispose(); }\n</pre>\n<p>Here is a code snippet showing how all the printable views can be retrieved using a filtered element collector:\n\n<pre class=\"code\">\n  <span class=\"teal\">IEnumerable</span>&lt;<span class=\"teal\">View</span>&gt; views\n    = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( doc )\n      .OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">View</span> ) )\n      .Cast&lt;<span class=\"teal\">View</span>&gt;()\n      .Where&lt;<span class=\"teal\">View</span>&gt;( v =&gt; v.CanBePrinted );\n</pre>\n<p>I created a minimal sample application PreviewControlSimple for this DevCamp class with much less code (and functionality than the UIAPI one, since it just displays the current view of a document with no further ado.\n\n<p>It does add one interesting twist, though: to show exactly how the hosting form is set up, I implemented that twice over, first using the Visual Studio designer as usual, and then converting the form to be completely programmatically generated.\nHere is the DisplayRevitView method taking the document and view input arguments for the preview control.\nIt also takes a third argument for the main Revit window, so that the generated control can be hooked up to that as a parent window.\nThis defines an appropriate relationship between the two as far as the Windows OS is concerned, ensuring correct minimisation and restoration behaviour:\n\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _caption_prefix\n  = <span class=\"maroon\">\"Simple Revit Preview - \"</span>;\n \n<span class=\"blue\">void</span> DisplayRevitView( \n  <span class=\"teal\">Document</span> doc,\n  <span class=\"teal\">View</span> view,\n  <span class=\"teal\">IWin32Window</span> owner )\n{\n \n  <span class=\"blue\">using</span>( <span class=\"teal\">PreviewControl</span> pc\n    = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( doc, view.Id ) )\n  {\n \n<span class=\"blue\">#if</span> CREATE_FORM_BY_CODE\n \n    <span class=\"blue\">using</span>( System.Windows.Forms.<span class=\"teal\">Form</span> form\n      = <span class=\"blue\">new</span> System.Windows.Forms.<span class=\"teal\">Form</span>() )\n    {\n      <span class=\"teal\">ElementHost</span> elementHost = <span class=\"blue\">new</span> <span class=\"teal\">ElementHost</span>();\n \n      elementHost.Location\n        = <span class=\"blue\">new</span> System.Drawing.<span class=\"teal\">Point</span>( 0, 0 );\n \n      elementHost.Dock = <span class=\"teal\">DockStyle</span>.Fill;\n      elementHost.TabIndex = 0;\n      elementHost.Parent = form;\n      elementHost.Child = pc;\n \n      form.Text = _caption_prefix + view.Name;\n      form.Controls.Add( elementHost );\n      form.Size = <span class=\"blue\">new</span> <span class=\"teal\">Size</span>( 400, 400 );\n      form.ShowDialog( owner );\n    }\n \n<span class=\"blue\">#else</span> <span class=\"green\">// if not CREATE_FORM_BY_CODE</span>\n \n<span class=\"gray\">    Form1 form = new Form1( pc );</span>\n<span class=\"gray\">    form.ShowDialog( owner );</span>\n \n<span class=\"blue\">#endif</span> <span class=\"green\">// CREATE_FORM_BY_CODE</span>\n \n  }\n}\n</pre>\n<p>Please note that correct disposal of the preview control is ensured by the 'using' statement.\nThis is similar to Arnošt's strong recommendation to always \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/using-using-automagically-disposes-and-rolls-back.html\">\nencapsulate Revit Transactions in a 'using' statement</a>.\n\n<p>Calling this method from the external command mainline with the current document view is trivial.\nI add one line of code to access the Revit main window:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">IWin32Window</span> revit_window\n    = <span class=\"blue\">new</span> <span class=\"teal\">JtWindowHandle</span>(\n      <span class=\"teal\">ComponentManager</span>.ApplicationWindow );\n \n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n  <span class=\"teal\">UIDocument</span> uidoc = uiapp.ActiveUIDocument;\n  <span class=\"teal\">Document</span> doc = uidoc.Document;\n \n  <span class=\"teal\">View</span> view = doc.ActiveView;\n \n  DisplayRevitView( doc, view, revit_window );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"24\"></a>\n<h4>Drag and Drop API</h4>\n<p>I recently discussed the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/drag-and-drop-api.html\">\ndrag and drop functionality</a> and \n\nthe UIAPI sample command demonstrating it.\n\n<p>The UIApplication provides the new static DoDragDrop method, with two overloads:\n\n<ul>\n<li>DoDragDrop( ICollection&lt;string&gt; ) –\ninitiate a standard built-in Revit drag and drop operation taking a collection of file names.\n\n<li>DoDragDrop( object, IDropHandler ) –\ninitiate a drag and drop operation with a custom drop implementation.\n</li></li></ul>\n<p>This method is designed for use in a modeless form.\n\n<p>Please note that this is currently the one and only Revit API method not requiring a valid Revit API context.\n\n<p>This method can be called from your modeless form at any time, even without Revit giving you explicit permission to interact with the API via some form of callback or notification, as required for all other Revit API calls.\n\n<p>The behaviour of drag and drop given a list of filenames depends on the type of files, as I already recently pointed out:\n\n<ul>\n<li>One AutoCAD format or image file dragged onto Revit\n– A new import placement editor is started to import the file.\n\n<li>More than one AutoCAD format or image files dragged\n– A new import placement editor is started for the first file.\n\n<li>One family file dragged onto Revit\n– The family is loaded, and an editor started to place an instance.\n\n<li>More than one family file dragged onto Revit\n– All the families are loaded.\n\n<li>More than one family file including other format files dragged \n– Revit tries to open all the files.\n\n<li>Valid file or list of files is passed\n– Revit does its best to use them appropriately.\n\n<li>Any files are not usable\n– Failure is signalled to user, no exception is thrown, add-in is not notified.\n</li></li></li></li></li></li></li></ul>\n<p>Here again, I implemented a new DevCamp sample add-in DragDropApi to be able to show the necessary steps in a simpler context than the corresponding UIAPI example.\n\n<p>Here are my four new Revit 2013 UI API samples \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.zip\">\nAddOptionsTab, DragDropApi, PreviewControlSimple, ProgressWatcher</a> and \n\nthe \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.pptx\">\nslides</a> I \n\nused.\n\n\n\n<a name=\"3\"></a>\n<h4>Asynchronous Interactions</h4>\n<p>Arnošt Löbel already presented on this topic at Autodesk University 2011 in his class\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1725932\">CP5381</a> 'Asynchronous Interactions and Managing Modeless UI with the Autodesk Revit API', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\n<p>In this class, Arnošt also covered the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/idling-enhancements-and-external-events.html\">\nexternal events</a> and\n\ndemonstrated his \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#1\">\nModelessForm_ExternalEvent, ModelessForm_IdlingEvent</a> (ModelessDialog)\n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#5\">\nWorkThread</a> (MultiThreading)\n\nSDK samples.\n\n<p>The conclusion of the presentation is the following pledge that we are all strongly recommended to take:\n\n<ul>\n<li>I shall not call the API unless invoked by it\n<li>I shall not call the API from anywhere but the main thread\n<li>I shall call the API only, not directly the Revit\u0019s UI\n<li>I shall use the Idling event cautiously and considerably\n</li></li></li></li></ul>\n<p>Here is a snapshot of the \n\n<a href=\"zip/devcamp_2012_2-3_Asynchronous_Interactions.pdf\">\nentire slide deck</a>.\n\nThis is not the final version, which will be posted soon after the end of DevCamp.\n\n\n\n<a name=\"4\"></a>\n<h4>IFC Export Open Source</h4>\n<p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Options dialogue WPF custom extensions",
    "local_header_href": "#options-dialogue-wpf-custom-extensions",
    "chunk_text": "<h4>Options dialogue WPF custom extensions</h4><p>In Revit 2013, an add-in can add its own custom tabs to the standard Revit Options dialogue.\n\n<p>This is achieved by defining a WPF control to display and subscribing to the UIApplication DisplayingOptionsDialog event.\n\n<p>The event handler receives an DisplayingOptionsDialogEventArgs instance.\nIt has a PagesCount property providing the number of Options dialogue tabs including default Revit ones.\nIt also sports the AddTab method that can be used to add a tab, providing a name and a handler for it.\nThe handler information is encapsulated in the TabbedDialogExtension class.\n\n<p>The TabbedDialogExtension class provides a constructor taking two arguments, a WPF user control instance and an OK handler.\nThese cannot be changed later.\nIt provides methods to get and set contextual help, and properties to read the WPF control and OK handler.\nIt also provides properties to both get and set the cancel and 'restore defaults' handlers:\n\n<ul>\n<li>Control – the control\n<li>OnOKAction – the ok handler\n<li>OnCancelAction – the cancel handler\n<li>OnRestoreDefaultsAction – the restore defaults handler\n</li></li></li></li></ul>\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample adds several custom tabs demonstrating most available features.\n\n<p>I created a minimal sample named AddOptionsTab which defines the simplest possible WPF control with one single button to click:</p>\n<center>\n<img alt=\"AddOptionsTab custom Options tab\" src=\"img/AddOptionsTab.png\"/>\n</center>\n<p>If you click the button, the corresponding event handler on the form is called, which simply displays a task dialog:</p>\n<center>\n<img alt=\"AddOptionsTab button clicked\" src=\"img/AddOptionsTab_clicked.png\"/>\n</center>\n<p>If this tab has ever been activated after the Options dialogue was opened, its OK, cancel and 'restore defaults' handlers are called, depending on the user actions.\n\n<p>Here is the entire user control source code defining its handlers:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"blue\">partial</span> <span class=\"blue\">class</span> <span class=\"teal\">UserControl1</span> : <span class=\"teal\">UserControl</span>\n{\n  <span class=\"blue\">string</span> _name;\n \n  <span class=\"blue\">public</span> UserControl1( <span class=\"blue\">string</span> name )\n  {\n    _name = name;\n \n    InitializeComponent();\n  }\n \n  <span class=\"blue\">private</span> <span class=\"blue\">void</span> button1_Click( \n    <span class=\"blue\">object</span> sender, \n    <span class=\"teal\">RoutedEventArgs</span> e )\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"I was clicked...\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnOK()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OK\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnCancel()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnCancel\"</span> );\n  }\n \n  <span class=\"blue\">public</span> <span class=\"blue\">void</span> OnRestoreDefaults()\n  {\n    <span class=\"teal\">TaskDialog</span>.Show( _name, <span class=\"maroon\">\"OnRestoreDefaults\"</span> );\n  }\n}\n</pre>\n<p>The event handler code reacting to the Options dialogue displaying simply instantiates the user control, calls the TabbedDialogExtension constructor with it, and feeds that to the event handler arguments AddTab method:\n\n<pre class=\"code\">\n<span class=\"blue\">void</span> OnDisplayingOptionsDialog( \n  <span class=\"blue\">object</span> sender, \n  <span class=\"teal\">DisplayingOptionsDialogEventArgs</span> e )\n{\n  <span class=\"teal\">UserControl1</span> c = <span class=\"blue\">new</span> <span class=\"teal\">UserControl1</span>( \n    <span class=\"maroon\">\"DevCamp User Control\"</span> );\n \n  e.AddTab( <span class=\"maroon\">\"DevCamp Custom Tab\"</span>, \n    <span class=\"blue\">new</span> <span class=\"teal\">TabbedDialogExtension</span>( \n      c, c.OnOK ) );\n}\n</pre>\n<p>The event handler is called each time the Options dialogue is invoked once the event has been subscribed to, which is achieved in a single line of code like this in the AddOptionsTab external command:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n \n  uiapp.DisplayingOptionsDialog \n    += <span class=\"blue\">new</span> <span class=\"teal\">EventHandler</span>&lt;<span class=\"teal\">DisplayingOptionsDialogEventArgs</span>&gt;( \n      OnDisplayingOptionsDialog );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"23\"></a>\n<h4>Embed and control a Revit view</h4>\n<p>Another of the add-in integration enhancements enables you to embed and control a Revit view in your own form, dialogue or window.\n\n<p>The new PreviewControl class presents a preview control to browse the Revit model.\nIt takes two input arguments, a document and a view id.\nThe hosting form or window must be modal.\nThe View can be any graphical view, i.e. must be printable.\nPerspective views are also supported, and all 3D Views can be manipulated by view cube.\nThe visibility and graphical settings of the view are effective and respected by the control.\n<!-- User interaction requires an open transaction (in Quasar RP only?) -->\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample proves a demonstration of this as well, which allows you to interactively select any of the open documents to view, or even open a new one, and secondly presents a list of all the documents views for you to switch between.\nEach time you change any of these two selections, the current preview control is discarded and a new one is instantiated with the updated input arguments.\nThese input arguments are the only way in which the add-in affects the view, all further interaction happens between the control and the user.\n\n<p>To use a Revit preview control, you simply create a standard .NET form and insert a WPF host in it.\nA suitable host is the System.Windows.Forms.Integration.ElementHost.\nYou populate this with a new Revit preview control instance, e.g. like this\n\n<pre class=\"code\">\n  elementHost.Child = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( \n    doc, view.Id );\n</pre>\n<p>The PreviewControl instance needs to be disposed of after use:\n\n<pre class=\"code\">\n  PreviewControl vc = elementHost.Child\n    as PreviewControl;\n\n  if( vc != null ) { vc.Dispose(); }\n</pre>\n<p>Here is a code snippet showing how all the printable views can be retrieved using a filtered element collector:\n\n<pre class=\"code\">\n  <span class=\"teal\">IEnumerable</span>&lt;<span class=\"teal\">View</span>&gt; views\n    = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( doc )\n      .OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">View</span> ) )\n      .Cast&lt;<span class=\"teal\">View</span>&gt;()\n      .Where&lt;<span class=\"teal\">View</span>&gt;( v =&gt; v.CanBePrinted );\n</pre>\n<p>I created a minimal sample application PreviewControlSimple for this DevCamp class with much less code (and functionality than the UIAPI one, since it just displays the current view of a document with no further ado.\n\n<p>It does add one interesting twist, though: to show exactly how the hosting form is set up, I implemented that twice over, first using the Visual Studio designer as usual, and then converting the form to be completely programmatically generated.\nHere is the DisplayRevitView method taking the document and view input arguments for the preview control.\nIt also takes a third argument for the main Revit window, so that the generated control can be hooked up to that as a parent window.\nThis defines an appropriate relationship between the two as far as the Windows OS is concerned, ensuring correct minimisation and restoration behaviour:\n\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _caption_prefix\n  = <span class=\"maroon\">\"Simple Revit Preview - \"</span>;\n \n<span class=\"blue\">void</span> DisplayRevitView( \n  <span class=\"teal\">Document</span> doc,\n  <span class=\"teal\">View</span> view,\n  <span class=\"teal\">IWin32Window</span> owner )\n{\n \n  <span class=\"blue\">using</span>( <span class=\"teal\">PreviewControl</span> pc\n    = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( doc, view.Id ) )\n  {\n \n<span class=\"blue\">#if</span> CREATE_FORM_BY_CODE\n \n    <span class=\"blue\">using</span>( System.Windows.Forms.<span class=\"teal\">Form</span> form\n      = <span class=\"blue\">new</span> System.Windows.Forms.<span class=\"teal\">Form</span>() )\n    {\n      <span class=\"teal\">ElementHost</span> elementHost = <span class=\"blue\">new</span> <span class=\"teal\">ElementHost</span>();\n \n      elementHost.Location\n        = <span class=\"blue\">new</span> System.Drawing.<span class=\"teal\">Point</span>( 0, 0 );\n \n      elementHost.Dock = <span class=\"teal\">DockStyle</span>.Fill;\n      elementHost.TabIndex = 0;\n      elementHost.Parent = form;\n      elementHost.Child = pc;\n \n      form.Text = _caption_prefix + view.Name;\n      form.Controls.Add( elementHost );\n      form.Size = <span class=\"blue\">new</span> <span class=\"teal\">Size</span>( 400, 400 );\n      form.ShowDialog( owner );\n    }\n \n<span class=\"blue\">#else</span> <span class=\"green\">// if not CREATE_FORM_BY_CODE</span>\n \n<span class=\"gray\">    Form1 form = new Form1( pc );</span>\n<span class=\"gray\">    form.ShowDialog( owner );</span>\n \n<span class=\"blue\">#endif</span> <span class=\"green\">// CREATE_FORM_BY_CODE</span>\n \n  }\n}\n</pre>\n<p>Please note that correct disposal of the preview control is ensured by the 'using' statement.\nThis is similar to Arnošt's strong recommendation to always \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/using-using-automagically-disposes-and-rolls-back.html\">\nencapsulate Revit Transactions in a 'using' statement</a>.\n\n<p>Calling this method from the external command mainline with the current document view is trivial.\nI add one line of code to access the Revit main window:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">IWin32Window</span> revit_window\n    = <span class=\"blue\">new</span> <span class=\"teal\">JtWindowHandle</span>(\n      <span class=\"teal\">ComponentManager</span>.ApplicationWindow );\n \n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n  <span class=\"teal\">UIDocument</span> uidoc = uiapp.ActiveUIDocument;\n  <span class=\"teal\">Document</span> doc = uidoc.Document;\n \n  <span class=\"teal\">View</span> view = doc.ActiveView;\n \n  DisplayRevitView( doc, view, revit_window );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"24\"></a>\n<h4>Drag and Drop API</h4>\n<p>I recently discussed the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/drag-and-drop-api.html\">\ndrag and drop functionality</a> and \n\nthe UIAPI sample command demonstrating it.\n\n<p>The UIApplication provides the new static DoDragDrop method, with two overloads:\n\n<ul>\n<li>DoDragDrop( ICollection&lt;string&gt; ) –\ninitiate a standard built-in Revit drag and drop operation taking a collection of file names.\n\n<li>DoDragDrop( object, IDropHandler ) –\ninitiate a drag and drop operation with a custom drop implementation.\n</li></li></ul>\n<p>This method is designed for use in a modeless form.\n\n<p>Please note that this is currently the one and only Revit API method not requiring a valid Revit API context.\n\n<p>This method can be called from your modeless form at any time, even without Revit giving you explicit permission to interact with the API via some form of callback or notification, as required for all other Revit API calls.\n\n<p>The behaviour of drag and drop given a list of filenames depends on the type of files, as I already recently pointed out:\n\n<ul>\n<li>One AutoCAD format or image file dragged onto Revit\n– A new import placement editor is started to import the file.\n\n<li>More than one AutoCAD format or image files dragged\n– A new import placement editor is started for the first file.\n\n<li>One family file dragged onto Revit\n– The family is loaded, and an editor started to place an instance.\n\n<li>More than one family file dragged onto Revit\n– All the families are loaded.\n\n<li>More than one family file including other format files dragged \n– Revit tries to open all the files.\n\n<li>Valid file or list of files is passed\n– Revit does its best to use them appropriately.\n\n<li>Any files are not usable\n– Failure is signalled to user, no exception is thrown, add-in is not notified.\n</li></li></li></li></li></li></li></ul>\n<p>Here again, I implemented a new DevCamp sample add-in DragDropApi to be able to show the necessary steps in a simpler context than the corresponding UIAPI example.\n\n<p>Here are my four new Revit 2013 UI API samples \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.zip\">\nAddOptionsTab, DragDropApi, PreviewControlSimple, ProgressWatcher</a> and \n\nthe \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.pptx\">\nslides</a> I \n\nused.\n\n\n\n<a name=\"3\"></a>\n<h4>Asynchronous Interactions</h4>\n<p>Arnošt Löbel already presented on this topic at Autodesk University 2011 in his class\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1725932\">CP5381</a> 'Asynchronous Interactions and Managing Modeless UI with the Autodesk Revit API', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\n<p>In this class, Arnošt also covered the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/idling-enhancements-and-external-events.html\">\nexternal events</a> and\n\ndemonstrated his \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#1\">\nModelessForm_ExternalEvent, ModelessForm_IdlingEvent</a> (ModelessDialog)\n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#5\">\nWorkThread</a> (MultiThreading)\n\nSDK samples.\n\n<p>The conclusion of the presentation is the following pledge that we are all strongly recommended to take:\n\n<ul>\n<li>I shall not call the API unless invoked by it\n<li>I shall not call the API from anywhere but the main thread\n<li>I shall call the API only, not directly the Revit\u0019s UI\n<li>I shall use the Idling event cautiously and considerably\n</li></li></li></li></ul>\n<p>Here is a snapshot of the \n\n<a href=\"zip/devcamp_2012_2-3_Asynchronous_Interactions.pdf\">\nentire slide deck</a>.\n\nThis is not the final version, which will be posted soon after the end of DevCamp.\n\n\n\n<a name=\"4\"></a>\n<h4>IFC Export Open Source</h4>\n<p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Embed and control a Revit view",
    "local_header_href": "#embed-and-control-a-revit-view",
    "chunk_text": "<h4>Embed and control a Revit view</h4><p>Another of the add-in integration enhancements enables you to embed and control a Revit view in your own form, dialogue or window.\n\n<p>The new PreviewControl class presents a preview control to browse the Revit model.\nIt takes two input arguments, a document and a view id.\nThe hosting form or window must be modal.\nThe View can be any graphical view, i.e. must be printable.\nPerspective views are also supported, and all 3D Views can be manipulated by view cube.\nThe visibility and graphical settings of the view are effective and respected by the control.\n<!-- User interaction requires an open transaction (in Quasar RP only?) -->\n<p>The \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#4\">UIAPI</a> SDK \n\nsample proves a demonstration of this as well, which allows you to interactively select any of the open documents to view, or even open a new one, and secondly presents a list of all the documents views for you to switch between.\nEach time you change any of these two selections, the current preview control is discarded and a new one is instantiated with the updated input arguments.\nThese input arguments are the only way in which the add-in affects the view, all further interaction happens between the control and the user.\n\n<p>To use a Revit preview control, you simply create a standard .NET form and insert a WPF host in it.\nA suitable host is the System.Windows.Forms.Integration.ElementHost.\nYou populate this with a new Revit preview control instance, e.g. like this\n\n<pre class=\"code\">\n  elementHost.Child = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( \n    doc, view.Id );\n</pre>\n<p>The PreviewControl instance needs to be disposed of after use:\n\n<pre class=\"code\">\n  PreviewControl vc = elementHost.Child\n    as PreviewControl;\n\n  if( vc != null ) { vc.Dispose(); }\n</pre>\n<p>Here is a code snippet showing how all the printable views can be retrieved using a filtered element collector:\n\n<pre class=\"code\">\n  <span class=\"teal\">IEnumerable</span>&lt;<span class=\"teal\">View</span>&gt; views\n    = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( doc )\n      .OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">View</span> ) )\n      .Cast&lt;<span class=\"teal\">View</span>&gt;()\n      .Where&lt;<span class=\"teal\">View</span>&gt;( v =&gt; v.CanBePrinted );\n</pre>\n<p>I created a minimal sample application PreviewControlSimple for this DevCamp class with much less code (and functionality than the UIAPI one, since it just displays the current view of a document with no further ado.\n\n<p>It does add one interesting twist, though: to show exactly how the hosting form is set up, I implemented that twice over, first using the Visual Studio designer as usual, and then converting the form to be completely programmatically generated.\nHere is the DisplayRevitView method taking the document and view input arguments for the preview control.\nIt also takes a third argument for the main Revit window, so that the generated control can be hooked up to that as a parent window.\nThis defines an appropriate relationship between the two as far as the Windows OS is concerned, ensuring correct minimisation and restoration behaviour:\n\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _caption_prefix\n  = <span class=\"maroon\">\"Simple Revit Preview - \"</span>;\n \n<span class=\"blue\">void</span> DisplayRevitView( \n  <span class=\"teal\">Document</span> doc,\n  <span class=\"teal\">View</span> view,\n  <span class=\"teal\">IWin32Window</span> owner )\n{\n \n  <span class=\"blue\">using</span>( <span class=\"teal\">PreviewControl</span> pc\n    = <span class=\"blue\">new</span> <span class=\"teal\">PreviewControl</span>( doc, view.Id ) )\n  {\n \n<span class=\"blue\">#if</span> CREATE_FORM_BY_CODE\n \n    <span class=\"blue\">using</span>( System.Windows.Forms.<span class=\"teal\">Form</span> form\n      = <span class=\"blue\">new</span> System.Windows.Forms.<span class=\"teal\">Form</span>() )\n    {\n      <span class=\"teal\">ElementHost</span> elementHost = <span class=\"blue\">new</span> <span class=\"teal\">ElementHost</span>();\n \n      elementHost.Location\n        = <span class=\"blue\">new</span> System.Drawing.<span class=\"teal\">Point</span>( 0, 0 );\n \n      elementHost.Dock = <span class=\"teal\">DockStyle</span>.Fill;\n      elementHost.TabIndex = 0;\n      elementHost.Parent = form;\n      elementHost.Child = pc;\n \n      form.Text = _caption_prefix + view.Name;\n      form.Controls.Add( elementHost );\n      form.Size = <span class=\"blue\">new</span> <span class=\"teal\">Size</span>( 400, 400 );\n      form.ShowDialog( owner );\n    }\n \n<span class=\"blue\">#else</span> <span class=\"green\">// if not CREATE_FORM_BY_CODE</span>\n \n<span class=\"gray\">    Form1 form = new Form1( pc );</span>\n<span class=\"gray\">    form.ShowDialog( owner );</span>\n \n<span class=\"blue\">#endif</span> <span class=\"green\">// CREATE_FORM_BY_CODE</span>\n \n  }\n}\n</pre>\n<p>Please note that correct disposal of the preview control is ensured by the 'using' statement.\nThis is similar to Arnošt's strong recommendation to always \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/using-using-automagically-disposes-and-rolls-back.html\">\nencapsulate Revit Transactions in a 'using' statement</a>.\n\n<p>Calling this method from the external command mainline with the current document view is trivial.\nI add one line of code to access the Revit main window:\n\n<pre class=\"code\">\n<span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n  <span class=\"teal\">ExternalCommandData</span> commandData,\n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">IWin32Window</span> revit_window\n    = <span class=\"blue\">new</span> <span class=\"teal\">JtWindowHandle</span>(\n      <span class=\"teal\">ComponentManager</span>.ApplicationWindow );\n \n  <span class=\"teal\">UIApplication</span> uiapp = commandData.Application;\n  <span class=\"teal\">UIDocument</span> uidoc = uiapp.ActiveUIDocument;\n  <span class=\"teal\">Document</span> doc = uidoc.Document;\n \n  <span class=\"teal\">View</span> view = doc.ActiveView;\n \n  DisplayRevitView( doc, view, revit_window );\n \n  <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n}\n</pre>\n<a name=\"24\"></a>\n<h4>Drag and Drop API</h4>\n<p>I recently discussed the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/drag-and-drop-api.html\">\ndrag and drop functionality</a> and \n\nthe UIAPI sample command demonstrating it.\n\n<p>The UIApplication provides the new static DoDragDrop method, with two overloads:\n\n<ul>\n<li>DoDragDrop( ICollection&lt;string&gt; ) –\ninitiate a standard built-in Revit drag and drop operation taking a collection of file names.\n\n<li>DoDragDrop( object, IDropHandler ) –\ninitiate a drag and drop operation with a custom drop implementation.\n</li></li></ul>\n<p>This method is designed for use in a modeless form.\n\n<p>Please note that this is currently the one and only Revit API method not requiring a valid Revit API context.\n\n<p>This method can be called from your modeless form at any time, even without Revit giving you explicit permission to interact with the API via some form of callback or notification, as required for all other Revit API calls.\n\n<p>The behaviour of drag and drop given a list of filenames depends on the type of files, as I already recently pointed out:\n\n<ul>\n<li>One AutoCAD format or image file dragged onto Revit\n– A new import placement editor is started to import the file.\n\n<li>More than one AutoCAD format or image files dragged\n– A new import placement editor is started for the first file.\n\n<li>One family file dragged onto Revit\n– The family is loaded, and an editor started to place an instance.\n\n<li>More than one family file dragged onto Revit\n– All the families are loaded.\n\n<li>More than one family file including other format files dragged \n– Revit tries to open all the files.\n\n<li>Valid file or list of files is passed\n– Revit does its best to use them appropriately.\n\n<li>Any files are not usable\n– Failure is signalled to user, no exception is thrown, add-in is not notified.\n</li></li></li></li></li></li></li></ul>\n<p>Here again, I implemented a new DevCamp sample add-in DragDropApi to be able to show the necessary steps in a simpler context than the corresponding UIAPI example.\n\n<p>Here are my four new Revit 2013 UI API samples \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.zip\">\nAddOptionsTab, DragDropApi, PreviewControlSimple, ProgressWatcher</a> and \n\nthe \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.pptx\">\nslides</a> I \n\nused.\n\n\n\n<a name=\"3\"></a>\n<h4>Asynchronous Interactions</h4>\n<p>Arnošt Löbel already presented on this topic at Autodesk University 2011 in his class\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1725932\">CP5381</a> 'Asynchronous Interactions and Managing Modeless UI with the Autodesk Revit API', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\n<p>In this class, Arnošt also covered the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/idling-enhancements-and-external-events.html\">\nexternal events</a> and\n\ndemonstrated his \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#1\">\nModelessForm_ExternalEvent, ModelessForm_IdlingEvent</a> (ModelessDialog)\n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#5\">\nWorkThread</a> (MultiThreading)\n\nSDK samples.\n\n<p>The conclusion of the presentation is the following pledge that we are all strongly recommended to take:\n\n<ul>\n<li>I shall not call the API unless invoked by it\n<li>I shall not call the API from anywhere but the main thread\n<li>I shall call the API only, not directly the Revit\u0019s UI\n<li>I shall use the Idling event cautiously and considerably\n</li></li></li></li></ul>\n<p>Here is a snapshot of the \n\n<a href=\"zip/devcamp_2012_2-3_Asynchronous_Interactions.pdf\">\nentire slide deck</a>.\n\nThis is not the final version, which will be posted soon after the end of DevCamp.\n\n\n\n<a name=\"4\"></a>\n<h4>IFC Export Open Source</h4>\n<p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Drag and Drop API",
    "local_header_href": "#drag-and-drop-api",
    "chunk_text": "<h4>Drag and Drop API</h4><p>I recently discussed the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/drag-and-drop-api.html\">\ndrag and drop functionality</a> and \n\nthe UIAPI sample command demonstrating it.\n\n<p>The UIApplication provides the new static DoDragDrop method, with two overloads:\n\n<ul>\n<li>DoDragDrop( ICollection&lt;string&gt; ) –\ninitiate a standard built-in Revit drag and drop operation taking a collection of file names.\n\n<li>DoDragDrop( object, IDropHandler ) –\ninitiate a drag and drop operation with a custom drop implementation.\n</li></li></ul>\n<p>This method is designed for use in a modeless form.\n\n<p>Please note that this is currently the one and only Revit API method not requiring a valid Revit API context.\n\n<p>This method can be called from your modeless form at any time, even without Revit giving you explicit permission to interact with the API via some form of callback or notification, as required for all other Revit API calls.\n\n<p>The behaviour of drag and drop given a list of filenames depends on the type of files, as I already recently pointed out:\n\n<ul>\n<li>One AutoCAD format or image file dragged onto Revit\n– A new import placement editor is started to import the file.\n\n<li>More than one AutoCAD format or image files dragged\n– A new import placement editor is started for the first file.\n\n<li>One family file dragged onto Revit\n– The family is loaded, and an editor started to place an instance.\n\n<li>More than one family file dragged onto Revit\n– All the families are loaded.\n\n<li>More than one family file including other format files dragged \n– Revit tries to open all the files.\n\n<li>Valid file or list of files is passed\n– Revit does its best to use them appropriately.\n\n<li>Any files are not usable\n– Failure is signalled to user, no exception is thrown, add-in is not notified.\n</li></li></li></li></li></li></li></ul>\n<p>Here again, I implemented a new DevCamp sample add-in DragDropApi to be able to show the necessary steps in a simpler context than the corresponding UIAPI example.\n\n<p>Here are my four new Revit 2013 UI API samples \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.zip\">\nAddOptionsTab, DragDropApi, PreviewControlSimple, ProgressWatcher</a> and \n\nthe \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/1-4_revit_2013_ui_api.pptx\">\nslides</a> I \n\nused.\n\n\n\n<a name=\"3\"></a>\n<h4>Asynchronous Interactions</h4>\n<p>Arnošt Löbel already presented on this topic at Autodesk University 2011 in his class\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1725932\">CP5381</a> 'Asynchronous Interactions and Managing Modeless UI with the Autodesk Revit API', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\n<p>In this class, Arnošt also covered the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/idling-enhancements-and-external-events.html\">\nexternal events</a> and\n\ndemonstrated his \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#1\">\nModelessForm_ExternalEvent, ModelessForm_IdlingEvent</a> (ModelessDialog)\n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#5\">\nWorkThread</a> (MultiThreading)\n\nSDK samples.\n\n<p>The conclusion of the presentation is the following pledge that we are all strongly recommended to take:\n\n<ul>\n<li>I shall not call the API unless invoked by it\n<li>I shall not call the API from anywhere but the main thread\n<li>I shall call the API only, not directly the Revit\u0019s UI\n<li>I shall use the Idling event cautiously and considerably\n</li></li></li></li></ul>\n<p>Here is a snapshot of the \n\n<a href=\"zip/devcamp_2012_2-3_Asynchronous_Interactions.pdf\">\nentire slide deck</a>.\n\nThis is not the final version, which will be posted soon after the end of DevCamp.\n\n\n\n<a name=\"4\"></a>\n<h4>IFC Export Open Source</h4>\n<p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Asynchronous Interactions",
    "local_header_href": "#asynchronous-interactions",
    "chunk_text": "<h4>Asynchronous Interactions</h4><p>Arnošt Löbel already presented on this topic at Autodesk University 2011 in his class\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9879&amp;jid=1725932\">CP5381</a> 'Asynchronous Interactions and Managing Modeless UI with the Autodesk Revit API', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\n<p>In this class, Arnošt also covered the new \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/04/idling-enhancements-and-external-events.html\">\nexternal events</a> and\n\ndemonstrated his \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#1\">\nModelessForm_ExternalEvent, ModelessForm_IdlingEvent</a> (ModelessDialog)\n\nand \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/new-revit-2013-sdk-samples.html#5\">\nWorkThread</a> (MultiThreading)\n\nSDK samples.\n\n<p>The conclusion of the presentation is the following pledge that we are all strongly recommended to take:\n\n<ul>\n<li>I shall not call the API unless invoked by it\n<li>I shall not call the API from anywhere but the main thread\n<li>I shall call the API only, not directly the Revit\u0019s UI\n<li>I shall use the Idling event cautiously and considerably\n</li></li></li></li></ul>\n<p>Here is a snapshot of the \n\n<a href=\"zip/devcamp_2012_2-3_Asynchronous_Interactions.pdf\">\nentire slide deck</a>.\n\nThis is not the final version, which will be posted soon after the end of DevCamp.\n\n\n\n<a name=\"4\"></a>\n<h4>IFC Export Open Source</h4>\n<p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "IFC Export Open Source",
    "local_header_href": "#ifc-export-open-source",
    "chunk_text": "<h4>IFC Export Open Source</h4><p>Angel Velez is senior principal engineer in the Revit development team and presented on the IFC exporter open source project, covering the following main topics:\n\n<ul>\n<li>Introduction\n<ul>\n<li>History of IFC in Revit\n<li>Why open source?\n</li></li></ul>\n<li>How the code Works\n<ul>\n<li>Overall structure of code\n<li>Key points of interest, e.g. element traversal, property sets\n<li>Look at alternate UI\n</li></li></li></ul>\n</li></li></ul>\n<p>Here is the snapshot of his \n\n<a href=\"zip/devcamp_2012_2-2_IFC_Open_Source.pptx\">\nslides</a>.\n\n\n<a name=\"5\"></a>\n<h4>Revit MEP API</h4>\n<p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Revit MEP API",
    "local_header_href": "#revit-mep-api",
    "chunk_text": "<h4>Revit MEP API</h4><p>The Revit MEP API is a recurring topic of mine at Autodesk University, and I presented on this once again last year in my session\n\n<a href=\"http://au.autodesk.com/?nd=event_class&amp;session_id=9267&amp;jid=1727895\">\nCP4453</a> 'Everything \n\nin Place with Autodesk Revit MEP Programming', as mentioned in the overview of the AU 2011\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/09/revit-and-aec-api-classes-at-autodesk-university.html\">\nRevit and AEC API sessions</a>.\n\nThe AU materials and the sample code that I use there was already \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/08/mep-sample-code-for-revit-2012.html\">\npublished and discussed</a>.\n\n<p>In preparation for the sessions here in Waltham, I also discussed the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-revit-2013-mep-api-and-external-services.html\">\nRevit 2013 MEP API</a> and completed the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/the-adn-mep-sample-adnrme-for-revit-mep-2013.html\">\nmigration of the ADN MEP sample code</a> to Revit 2013.\n\n<p>Here is the \n\n<a href=\"file:///C:/a/j/adn/devcamp/2012/doc/2-8_estorage.pptx\">\nslide deck</a> I\n\nused today, based on the AU one and updated for Revit MEP 2013.\n\n<p>Please note again that all the materials provided above are just snapshots.\nSoon after the conference completes, the complete and final materials will be published.\n\n\n\n<h4>Winding Down and Winding Up Again</h4>\n<p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p></p></p></p></p>"
  },
  {
    "original_filename": "0779_devcamp_day_2",
    "header_text": "Winding Down and Winding Up Again",
    "local_header_href": "#winding-down-and-winding-up-again",
    "chunk_text": "<h4>Winding Down and Winding Up Again</h4><p>In the evening we went out for a DevTech dinner, Japanese and Chinese cuisine.\nIt was great to hang out with the guys for a while and wind down a bit.\n\n<p>Next stop is the DevLab tomorrow with a record number of almost fifty registered participants, so we will be way busy!\nTime to wind up again.\nNo rest for the wicked!\nThese events are always great, and I'm looking forward to it a lot.\n\n<pre class=\"code\">\n</pre>\n</p></p>"
  }
]