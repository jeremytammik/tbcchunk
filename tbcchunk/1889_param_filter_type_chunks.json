[
  {
    "original_filename": "1889_param_filter_type",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- String parameter filtering is retrieving false data\n  https://forums.autodesk.com/t5/revit-api-forum/string-parameter-filtering-is-retrieving-false-data/m-p/10034687\n  REVIT-172990 [Parameter filter with FilterStringContains returns false positive] original ticket\n  REVIT-173253 [Parameter filter with FilterStringContains returns false positive] documentation fix\n\n- https://forums.autodesk.com/t5/revit-api-forum/string-parameter-filtering-is-retrieving-false-data/m-p/10043934/highlight/false#M52973\n  param_by_guid_includes_type.png\n  Addendum by fair59\n\n- OCR\n  http://capture2text.sourceforge.net/\n  open source Windows hotkey app: Windows + Q, mouse rectasgle, resulting text in clipboard\n  Capture2Text is free and licensed under the terms of the GNU General Public License.\n  supports almost a hundred target languages,\n  multiple simultanaeous target languages, \n  immediate translation via Google translate and\n  text-to-speech voice\n  Capture2Text_conceptual_illustration.png 810\n\n- [How to Be Productive, Feel Less Overwhelmed, and Get Things Done](https://www.freecodecamp.org/news/how-to-get-things-done-lessons-in-productivity) by Endy Austin\n\ntwitter:\n\nA handy open source OCR tool, and filtered element collector with parameter filter also checks element type in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://autode.sk/paramfilter_etype\n\nAn important insight in using a filtered element collector with a parameter filter, a handy open source OCR tool and a few productivity tips\n&ndash; Parameter filter also checks element type\n&ndash; Capture2Text, a handy OCR tool\n&ndash; Productivity tips...\n\nlinkedin:\n\nA handy open source OCR tool, and filtered element collector with parameter filter also checks element type in the #RevitAPI\n\nhttp://autode.sk/paramfilter_etype\n\nAn important insight in using a filtered element collector with a parameter filter, a handy open source OCR tool and a few productivity tips:\n\n- Parameter filter also checks element type\n- Capture2Text, a handy OCR tool\n- Productivity tips...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n<p style=\"font-size: 80%; font-style:italic\">\n<a href=\"\"></a>\n</p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1889_param_filter_type",
    "header_text": "Parameter Filter Checking Element Type and OCR",
    "local_header_href": "#parameter-filter-checking-element-type-and-ocr",
    "chunk_text": "### Parameter Filter Checking Element Type and OCR\n\nGetting ready for a rainy weekend, here is an important insight in using a filtered element collector with a parameter filter, a handy open source OCR tool and a few productivity tips:\n\n- [Parameter filter also checks element type](#2)\n- [Parameter property also checks element type](#2.1)\n- [Capture2Text, a handy OCR tool](#3)\n- [Productivity tips](#4)"
  },
  {
    "original_filename": "1889_param_filter_type",
    "header_text": "Parameter Filter Also Checks Element Type",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Parameter Filter Also Checks Element Type\n\nWe made an interesting discovery in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [string parameter filtering retrieving false data](https://forums.autodesk.com/t5/revit-api-forum/string-parameter-filtering-is-retrieving-false-data/m-p/10034687):\n\nIf the internal `ParameterValueProvider` class does not find the requested parameter from the element itself, will also try to read it from the element's type.\n\nThis undocumented behaviour can lead to some confusion and is difficult to fix perfectly in an efficient manner.\n\n**Question:** I am trying to filter walls based on their \"Fire Rating\" parameter using the `FilterStringContains` evaluator.\n\nHowever, this filter retrieves both walls satisfying the rule plus other walls that don't even contain that parameter!\n\nThis seems like an error to me.\n\nHere is a [sample project with a macro](zip/TestFilterStringContains.rvt) providing a reproducible case using the following code:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>&nbsp;bip&nbsp;=&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.FIRE_RATING;\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementId</span>&nbsp;pid&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementId</span>(&nbsp;bip&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ParameterValueProvider</span>&nbsp;provider\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ParameterValueProvider</span>(&nbsp;pid&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilterStringRuleEvaluator</span>&nbsp;evaluator&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilterStringContains</span>();\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilterStringRule</span>&nbsp;rule&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilterStringRule</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;provider,&nbsp;evaluator,&nbsp;<span style=\"color:#a31515;\">&quot;/&quot;</span>,&nbsp;<span style=\"color:blue;\">false</span>&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementParameterFilter</span>&nbsp;filter&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementParameterFilter</span>(&nbsp;rule&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;myWalls&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;.OfCategory(&nbsp;<span style=\"color:#2b91af;\">BuiltInCategory</span>.OST_Walls&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;.WherePasses(&nbsp;filter&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">ElementId</span>&gt;&nbsp;false_positive_ids&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">ElementId</span>&gt;();\n \n&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">Element</span>&nbsp;wall&nbsp;<span style=\"color:blue;\">in</span>&nbsp;myWalls&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param&nbsp;=&nbsp;wall.get_Parameter(&nbsp;bip&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;<span style=\"color:blue;\">null</span>&nbsp;==&nbsp;param&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false_positive_ids.Add(&nbsp;wall.Id&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;s&nbsp;=&nbsp;<span style=\"color:blue;\">string</span>.Join(&nbsp;<span style=\"color:#a31515;\">&quot;,&nbsp;&quot;</span>,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;false_positive_ids.Select&lt;<span style=\"color:#2b91af;\">ElementId</span>,&nbsp;<span style=\"color:blue;\">string</span>&gt;(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&gt;&nbsp;id.IntegerValue.ToString()&nbsp;)&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>&nbsp;dlg&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>(&nbsp;<span style=\"color:#a31515;\">&quot;False&nbsp;Positives&quot;</span>&nbsp;);\n&nbsp;&nbsp;dlg.MainInstruction&nbsp;=&nbsp;<span style=\"color:#a31515;\">&quot;False&nbsp;filtered&nbsp;walls&nbsp;ids:&nbsp;&quot;</span>;\n&nbsp;&nbsp;dlg.MainContent&nbsp;=&nbsp;s;\n&nbsp;&nbsp;dlg.Show();\n</pre>\n\nThis displays a message like this in the sample model, listing walls that are not even equipped with the target parameter, let alone have a value for it:\n\n<center>\n<img src=\"img/TestFilterStringContains_result_message.png\" alt=\"Parameter filter returns false positives\" title=\"Parameter filter returns false positives\" width=\"442\"/> <!-- 884 -->\n</center>\n\nWhat can I do to ignore walls that don't contain the parameter?\n\n**Answer:** This was logged as *REVIT-172990 &ndash; Parameter filter with FilterStringContains returns false positive* for the development team to analyse.\n\nYou might be able to achieve the desired result by combining the FilterStringContains evaluator with other rules and filters.\n\nFor instance, you may be able to add something like 'is not empty' in addition to 'contains'.\n\nThe development team analysed the issue and found the reason for this behaviour.\n\nIf the internal method `ParameterValueProvider::getParameterValue()` cannot get the parameter from the element itself, will also try to get it from the element's type:\n\n<pre class=\"code\">\n  if (m_elemOrSymbol == EOS_Symbol\n    || err != ERR_SUCCESS || !oParameterValue)\n  {\n    ElementId typeId = pElement-&gt;getTypeId();\n    if (validElementId(typeId))\n    {\n      const Element *pTypeElement\n        = pElement-&gt;getDocument()-&gt;getElement(typeId);\n        \n      if (pTypeElement != NULL)\n      {\n        oParameterValue = pTypeElement-&gt;getParameterValue(\n          m_parameter);\n          \n        err = getErrFromParameterValue(oParameterValue);\n        if (err != ERR_SUCCESS)\n        {\n          return nullptr;\n        }\n      }\n    }\n  }\n</pre>\n\nTherefore, yes, you cannot find the parameter in the walls.\n\nHowever, you can find the parameters in their wall type.\n\nThat's why you can still get those walls.\n\nThis behaviour has been in effect for a long time, so the development team is not thinking about changing it.\n\nHowever, this information needs to be made clear in the documentation and knowledge base.\n\nA new issue *REVIT-173253 &ndash; Parameter filter with FilterStringContains returns false positive* has been raised for the documentation team to document this behaviour. \n\n**Response:** I am going to accept your reply as an accepted answer but it is not as expected.\n\n- I think this behaviour is not acceptable logically, even though it was in effect for a long time.\nAt least it should return the wall type itself rather than returning all walls under that type.\n- Can it be modified to have a Boolean to search through the element's type or not?\nOr, like the filtered element collector, e.g., `WhereElementIsElementType` and `WhereElementIsNotElementType`?\n\n**Answer:** I agree that this behaviour defeats part of the purpose of the parameter filter.\n\nIf I were you, I would choose the simple solution of filtering for parameters that are guaranteed not to be present on the type.\n\n**Answer 2:** I always preferred the functionality as it is now. There are various solutions out there for finding elements that rely on not having to separately look through the parameters on the type or know that a parameter is on a type or an instance.\n\nImagine you want to find all instances that have a certain type parameter, you would first have to filter for all types, filter those for the parameter match, then filter again for all instances that are of one of those types. This is already a common approach for a lot of cases where parameter filters can’t be used.\n\nI thought it just saved a lot of work really, I see no need for a change. If you want to know the parameter is on the instance then put the results through a further filter. You can supply a list of ids to a further element filter at any time. If you want to know parameter is on the type, filter first for types. In general, I don’t see much use of Logical AND/OR Filters sometimes I wonder if their existence is known of? People seem to have other methods but again use: LogicalAndFilter with\n\n- ParameterElementFilter and\n<br/>ElementIsElementTypeFilter(Inverted = True)\n\nElementParameterFilter is a slow filter, so you should first use another quick filter before it.\n\nIt works like in the UI when you set up visibility filters, i.e., there is no distinction between type and instance parameters there. I imagine this is the internal system that this filter class leverages.\n\nLater: When I consider further there is a bit of a hole in functionality there.\n\nSince you are forced to get a list of elements and then rule out those that have a type parameter match not an instance parameter match, i.e., there are four cases:\n\nParameter with matching name and value is on: Type, Instance, Both, Neither.\n\nWe can only find with filter that it is on: Either or Neither.\n\nSo, the question is, how would we find Elements with a matching parameter on the Instance only?\n\nAfter filtering with ElementParameterFilter, we would have to manually check via Linq perhaps.\nWe only care that it is or isn't on the instance, so that could simplify things.\n\n**Answer 3:** Exactly what I meant by saying, defeats part of the purpose.\n\nThank you for fleshing it out in more detail.\n\nLinq is super slow compared to the built-in parameter filter, and I see no other option to achieve the in-between distinctions.\n\nMany thanks to Ameer and Richard for this very fruitful and illuminating discussion!\n\n####<a name=\"2.1\"></a> Parameter Property Also Checks Element Type\n\nOur learning is never-ending.\n\nI response to the above,\nFrank [@Fair59](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/2083518) Aarssen added:\n\n> I noticed the same behaviour for the Parameter properties of an Element.\nGetting a parameter on (family) instances by GUID or Definition also returns the type-parameter:\n\n<center>\n<img src=\"img/param_by_guid_includes_type.png\" alt=\"Parameter property by GUID and Definition\" title=\"Parameter property by GUID and Definition\" width=\"368\"/> <!-- 368 -->\n</center>\n\n> Please update the documentation for these properties as well."
  },
  {
    "original_filename": "1889_param_filter_type",
    "header_text": "Capture2Text, a Handy OCR Tool",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Capture2Text, a Handy OCR Tool\n\nI happened upon a very handy OCR tool that looks pretty good:\n\n[Capture2Text](http://capture2text.sourceforge.net) is\na free open source Windows desktop OCR application, licensed under the terms of the GNU General Public License.\n\nIt is implemented as a hotkey app, making it very minimalistic and efficient to use:\n\nClick the Windows button + Q, mouse the source pixel rectangle to capture, and the resulting text is placed in the clipboard.\n\nIt can't get much more minimal or efficient than that, can it?\n\nBesides that, Capture2Text supports:\n\n- Almost a hundred target languages\n- Multiple simultaneous target languages\n- Immediate translation via Google translate\n- Text-to-speech voice\n\n<center>\n<img src=\"img/Capture2Text_conceptual_illustration.png\" alt=\"Capture2Text\" title=\"Capture2Text\" width=\"600\"/> <!-- 810 -->\n</center>"
  },
  {
    "original_filename": "1889_param_filter_type",
    "header_text": "Productivity Tips",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Productivity Tips\n\nFor more efficiency in personal and profession life in general, here are a couple of tips by\nEndy Austin\non [how to be productive, feel less overwhelmed, and get things done](https://www.freecodecamp.org/news/how-to-get-things-done-lessons-in-productivity)."
  }
]