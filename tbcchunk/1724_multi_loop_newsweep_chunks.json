[
  {
    "original_filename": "1724_multi_loop_newsweep",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n\n- 14908176 [How to create a sweep with multiple closed loops in profile]\n  https://forums.autodesk.com/t5/revit-api-forum/how-to-create-a-sweep-with-multiple-closed-loops-in-profile/m-p/8477617\n\n- [Poverty isn't a lack of character; it's a lack of cash](https://youtu.be/ydKcaIE6O1k) TED talk by historian Rutger Bregman on June 13, 2017.\n> \"Ideas can and do change the world,\" he says, sharing his case for a provocative one: guaranteed basic income. Learn more about the idea's 500-year history and a forgotten modern experiment where it actually worked -- and imagine how much energy and talent we would unleash if we got rid of poverty once and for all.\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/ydKcaIE6O1k\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n\ntwitter:\n\nCreating a sweep with multiple closed loops in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon and a TED talk on poverty versus universal basic income http://bit.ly/multiloopsweep\n\nA demonstration of using the <code>NewSweep</code> method was very kindly provided in yet another helpful answer by Frank @Fair59 Aarssen to the Revit API discussion forum thread on how to create a sweep with multiple closed loops in profile.\nLet me also highlight an interesting TED talk on the topic of poverty versus universal basic income\n&ndash; Creating a sweep with multiple closed loops\n&ndash; Poverty versus universal basic income...\n\nlinkedin:\n\nof [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2019.0.145.4).\n\n-->"
  },
  {
    "original_filename": "1724_multi_loop_newsweep",
    "header_text": "Creating a Sweep with Multiple Closed Loops",
    "local_header_href": "#creating-a-sweep-with-multiple-closed-loops",
    "chunk_text": "### Creating a Sweep with Multiple Closed Loops\n\nUntil today, [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples) lacked\na demonstration of using the `NewSweep` method.\n\nThat was very kindly provided in yet another helpful answer by \nFrank [@Fair59](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/2083518) Aarssen to \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [how to create a sweep with multiple closed loops in profile](https://forums.autodesk.com/t5/revit-api-forum/how-to-create-a-sweep-with-multiple-closed-loops-in-profile/m-p/8477617).\n\nLet me also highlight an interesting TED talk on the topic of poverty versus universal basic income:\n\n- [Creating a sweep with multiple closed loops](#2) \n- [Poverty versus universal basic income](#3)"
  },
  {
    "original_filename": "1724_multi_loop_newsweep",
    "header_text": "<a name=\"2\"></a> Creating a Sweep with Multiple Closed Loops",
    "local_header_href": "#a-name2a-creating-a-sweep-with-multiple-closed-loops",
    "chunk_text": "#### <a name=\"2\"></a> Creating a Sweep with Multiple Closed Loops\n\n**Question:** I want to create a sweep with multiple closed loops in profile, like this:\n\n<center>\n<img src=\"img/profile_with_two_holes.png\" alt=\"Profile with multiple loops\" width=\"240\">\n</center>\n\nI can draw the profile on the plane with model lines, but if I use it to create a sweep, it will report errors such as \"cannot create sweep\" without any other tips.\n\nI have created sweeps using profiles with two loops successfully like this:\n\n<center>\n<img src=\"img/extrusion_with_hole_1.png\" alt=\"Profile with one hole\" width=\"300\">\n\n<img src=\"img/extrusion_with_hole_2.png\" alt=\"Profile with the other hole\" width=\"300\">\n</center>\n\nIs there any limitation, for example, the sweep profile can only have two closed loops at most, otherwise it will be wrong?\n\nLater: After further testing, I still cannot create a sweep with three closed loops.\n\nI tried orienting the two inner loops both clockwise and counterclockwise, but nothing helps.\n\n**Answer:** Every loop needs to be a separate `CurveArray`!\n\nI added Frank's correction to the test code provided and integrated it\ninto [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples) \nmodule [CmdNewSweptBlend.cs](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/BuildingCoder/CmdNewSweptBlend.cs):\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:#2b91af;\">Sweep</span>&nbsp;CreateSweepWithMultipleLoops(\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Extrusion&nbsp;path</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">CurveArray</span>&nbsp;path&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">CurveArray</span>();\n \n&nbsp;&nbsp;&nbsp;&nbsp;path.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;<span style=\"color:#2b91af;\">XYZ</span>.Zero,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;0,&nbsp;5,&nbsp;0&nbsp;)&nbsp;)&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Profile&nbsp;vertices:&nbsp;rectangle&nbsp;with&nbsp;two</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;rectangular&nbsp;holes</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;p1&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;0,&nbsp;0,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;p2&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;10,&nbsp;0,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;p3&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;10,&nbsp;15,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;p4&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;0,&nbsp;15,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;a1&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;1,&nbsp;5,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;a2&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;3,&nbsp;5,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;a3&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;3,&nbsp;10,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;a4&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;1,&nbsp;10,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;b1&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;5,&nbsp;5,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;b2&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;7,&nbsp;5,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;b3&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;7,&nbsp;10,&nbsp;0&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;b4&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;5,&nbsp;10,&nbsp;0&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">CurveArrArray</span>&nbsp;arrcurve&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">CurveArrArray</span>();\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">CurveArray</span>&nbsp;curve&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">CurveArray</span>();\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;p1,&nbsp;p2&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;p2,&nbsp;p3&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;p3,&nbsp;p4&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;p4,&nbsp;p1&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;arrcurve.Append(&nbsp;curve&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">CurveArray</span>();\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;a1,&nbsp;a4&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;a4,&nbsp;a3&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;a3,&nbsp;a2&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;a2,&nbsp;a1&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;arrcurve.Append(&nbsp;curve&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">CurveArray</span>();\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;b1,&nbsp;b4&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;b4,&nbsp;b3&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;b3,&nbsp;b2&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;curve.Append(&nbsp;<span style=\"color:#2b91af;\">Line</span>.CreateBound(&nbsp;b2,&nbsp;b1&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;arrcurve.Append(&nbsp;curve&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Application</span>&nbsp;app&nbsp;=&nbsp;doc.Application;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">SweepProfile</span>&nbsp;profile&nbsp;=&nbsp;app.Create\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.NewCurveLoopsProfile(&nbsp;arrcurve&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Plane</span>&nbsp;plane&nbsp;=&nbsp;<span style=\"color:#2b91af;\">Plane</span>.CreateByNormalAndOrigin(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>.BasisZ,&nbsp;<span style=\"color:#2b91af;\">XYZ</span>.Zero&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">SketchPlane</span>&nbsp;sketchPlane&nbsp;=&nbsp;<span style=\"color:#2b91af;\">SketchPlane</span>.Create(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc,&nbsp;plane&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Sweep</span>&nbsp;sweep&nbsp;=&nbsp;doc.FamilyCreate.NewSweep(&nbsp;<span style=\"color:blue;\">true</span>,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path,&nbsp;sketchPlane,&nbsp;profile,&nbsp;0,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ProfilePlaneLocation</span>.Start&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;sweep;\n&nbsp;&nbsp;}\n</pre>\n\nHere is the result of running this code in a new family document:\n\n<center>\n<img src=\"img/sweep_with_multiple_loops.png\" alt=\"Sweep with multiple loops\" width=\"240\">\n</center>\n\nMany thanks to Frank for this solution!"
  },
  {
    "original_filename": "1724_multi_loop_newsweep",
    "header_text": "<a name=\"3\"></a> Poverty versus Universal Basic Income",
    "local_header_href": "#a-name3a-poverty-versus-universal-basic-income",
    "chunk_text": "#### <a name=\"3\"></a> Poverty versus Universal Basic Income\n\nIn case you are interested in the topic of universal basic income, you might find this TED talk quite illuminating:\n[Poverty isn't a lack of character; it's a lack of cash](https://youtu.be/ydKcaIE6O1k), by historian Rutger Bregman, on June 13, 2017.\n\n> \"Ideas can and do change the world,\" he says, sharing his case for a provocative one: guaranteed basic income. Learn more about the idea's 500-year history and a forgotten modern experiment where it actually worked &ndash; and imagine how much energy and talent we would unleash if we got rid of poverty once and for all.\n\n<center>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/ydKcaIE6O1k\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</center>"
  }
]