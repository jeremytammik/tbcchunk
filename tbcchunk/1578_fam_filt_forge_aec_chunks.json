[
  {
    "original_filename": "1578_fam_filt_forge_aec",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- publish /a/doc/forge/ recording for aec jim q\n\n- devcon promo\n  DevCon promo toolbox has slides for presentations or flyers for meet-ups - Please use:\n  https://forge.autodesk.com/devcon-promo-tools\n  https://autodesk.app.box.com/folder/34726869489\n  You're our awesome dev community influencers - please retweet, share and like AutodeskForge Tweets about DevCon (and more;-) (edited)\n  Other resources you might find helpful for Dev evangelism:\n  For info about Forge and what the APIs offer -\n  https://autodesk.box.com/s/khqe1tohno1fzhveegoziynkmpmh4lhu\n  Community Success stories & use cases to see what people are doing with Forge -\n  https://autodesk.box.com/s/wt2nica2rwfst47hkt80szdvyrjk3ptd\n  Forge OTS page for all other Forge info and resources -\n  https://autodesksales.gosavo.com/CustomPage/View.aspx?id=39136343&srlid=51521699&srisprm=False&sritidx=1&srpgidx=0&srpgsz=2\n\n- How to pull the starting view for document using the Revit API\n  https://stackoverflow.com/questions/45696372/how-to-pull-the-starting-view-for-document-using-the-revit-api\n\n- Moving Detail Group only moves its LocationPoint, not detail items inside\n  Moving items inside Detail Group\n  https://forums.autodesk.com/t5/revit-api-forum/moving-detail-group-only-moves-its-locationpoint-not-detail/m-p/7302496\n  \n- 13269724 [Family Instance Filter]\n  https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2018.0.134.2\n  https://forums.autodesk.com/t5/revit-api-forum/family-instance-filter/m-p/7287113\n\nForge for AEC demos & sample code #RevitAPI @AutodeskRevit #bim @AutodeskForge #ForgeDevCon http://bit.ly/fam_filt_forge_aec https://youtu.be/5xVwvBzemkg\nDetermining the @AutodeskRevit starting view #RevitAPI #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/fam_filt_forge_aec\nFiltering for family instances and types by family name #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/fam_filt_forge_aec\n\nA biggish post rather late in the week... still answering too many cases\n&ndash; Forge for AEC demos and sample code\n&ndash; Determining the starting view\n&ndash; Detecting installed Revit version\n&ndash; Detecting installed C3D version\n&ndash; Moving items inside a detail group\n&ndash; Filtering for family instances and types by family name...\n\n--->"
  },
  {
    "original_filename": "1578_fam_filt_forge_aec",
    "header_text": "Forge, Installed Version, Move Group, Name Filter",
    "local_header_href": "#forge-installed-version-move-group-name-filter",
    "chunk_text": "### Forge, Installed Version, Move Group, Name Filter\n\nA biggish post rather late in the week... still answering too many cases:\n\n- [Forge for AEC &ndash; demos and sample code](#2)\n- [Determining the starting view](#3)\n- [Detecting installed Revit version](#4)\n- [Detecting installed C3D version](#5)\n- [Moving items inside a detail group](#6)\n- [Filtering for family instances and types by family name](#7)\n\n\n####<a name=\"2\"></a>Forge for AEC &ndash; Demos and Sample Code\n\nLast week, I briefly discussed some pros and cons\nof [Revit versus Forge for BIM programming](http://thebuildingcoder.typepad.com/blog/2017/08/revit-versus-forge-ids-and-add-in-installation.html#2).\n\nSince then, Jim Quanci, Senior Director Software Partner Development at Autodesk,\npublished [Autodesk Forge &ndash; What is it?](https://youtu.be/5xVwvBzemkg) &ndash;\na 45 minute video recording showing what's possible to do\nwith [Forge](https://forge.autodesk.com) through a set of demos and live code samples:\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/5xVwvBzemkg?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n</center>\n\nIf this spikes your interest, you will certainly benefit from\nthe [Forge developer conference DevCon](https://forge.autodesk.com/devcon-2017) taking place just\nbefore [Autodesk University](http://au.autodesk.com) in Las Vegas November 13-14.\n\nWe are also working at creating some kind of mini DevCon\nfor [AU Germany in Darmstadt](https://www.rayseven.com/r7/runtime/autodesk/au2017/website.php), October 17-18.\n\nI am planning on attending both venues and hope to see you at one of them.\n\n\n####<a name=\"3\"></a>Determining the Starting View\n\n[Skeletank](https://stackoverflow.com/users/180529/skeletank) shared\nan interesting and illuminating solution on StackOverflow \nshowing [how to pull the starting view for document using the Revit API](https://stackoverflow.com/questions/45696372/how-to-pull-the-starting-view-for-document-using-the-revit-api):\n\n**Question:** How can I use the Revit API to get the Starting View for a Document? The equivalent way to access it using the user interface is seen below:\n\n<center>\n<img src=\"img/starting_view_ui.png\" alt=\"Starting view\" width=\"651\"/>\n</center>\n\n**Answer:** I used\nthe [RevitLookup tool](https://github.com/jeremytammik/RevitLookup) and\nbrowsed through the database to find a class called `StartingViewSettings` with the property `ViewId` that returns the `ElementId` of the starting view:\n\n<center>\n<img src=\"img/starting_view_snoop.png\" alt=\"Starting view\" width=\"804\"/>\n</center>\n\nHere is my actual code for getting the view:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>&nbsp;a\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">StartingViewSettings</span>&nbsp;)&nbsp;);\n\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">View</span>&nbsp;startingView&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n\n&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">StartingViewSettings</span>&nbsp;settings&nbsp;<span style=\"color:blue;\">in</span>&nbsp;a&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;startingView&nbsp;=&nbsp;doc.GetElement(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;settings.ViewId&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">View</span>;\n&nbsp;&nbsp;}\n</pre>\n\nMany thanks to skeletank for researching and sharing this, and describing the effective approach to do so!\n\n\n####<a name=\"4\"></a>Detecting Installed Revit Version\n\nAnother issue was raised by my consulting colleague Miro Schonauer:\n\n**Question:** What is the best way to check if any version and, if so, what version of Revit is installed?\n\nI checked Windows registry keys mentioned in the discussion on \nthe [perpetual GUID algorithm and Revit 2014 product GUIDs](http://thebuildingcoder.typepad.com/blog/2013/04/perpetual-guid-algorithm-and-revit-2014-product-guids.html), \nbut that is only up to Revit 2014 and still not sure we can detect 'any version'.\n\n**Answer:** One choice it to use `RevitProductUtility` API provided by the `RevitAddInUtility.dll` assembly:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">IList</span>&lt;RevitProduct&gt;&nbsp;allInstalledRevitProducts\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;RevitProductUtility.GetAllInstalledRevitProducts();\n \n&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;RevitProduct&nbsp;p&nbsp;<span style=\"color:blue;\">in</span>&nbsp;allInstalledRevitProducts&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;p.Version&nbsp;==&nbsp;RevitVersion.Revit2015&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Revit&nbsp;2015&nbsp;installed.</span>\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">else</span>&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;p.Version&nbsp;==&nbsp;RevitVersion.Revit2017&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Revit&nbsp;2017&nbsp;installed.</span>\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n</pre>\n\n\n####<a name=\"5\"></a>Detecting Installed C3D Version\n\nAnother query from Miro, not on Revit, but such a closely related topic, so let's mention it as well:\n\n**Question:** I would like to issue a warning if there is no C3D installed on the machine.\n\nWhat is the best way to verify this?\n\nCan I simply check if a certain registry entry exists?\n\nI thought of using:\n\n- C3D 2015\n    - HKEY_LOCAL_MACHINE\\SOFTWARE\\Autodesk\\AutoCAD\\R20.0\\ACAD-E000:409 &ndash; English\n    - HKEY_LOCAL_MACHINE\\SOFTWARE\\Autodesk\\AutoCAD\\R20.0\\InstalledProducts\\C3D &ndash; any locale\n- C3D 2015\n    - HKEY_LOCAL_MACHINE\\SOFTWARE\\Autodesk\\AutoCAD\\R21.0\\ACAD-0000:409\n    - HKEY_LOCAL_MACHINE\\SOFTWARE\\Autodesk\\AutoCAD\\R21.0\\InstalledProducts\\C3D\n\n**Answer:** Itâ€™s better to use these:\n\n- HKEY_LOCAL_MACHINE\\SOFTWARE\\Autodesk\\AutoCAD\\R20.0\\InstalledProducts\\C3D\n- HKEY_LOCAL_MACHINE\\SOFTWARE\\Autodesk\\AutoCAD\\R21.0\\InstalledProducts\\C3D\n\nMany thanks to Miro for raising and clarifying this!\n\n\n####<a name=\"6\"></a>Moving Items Inside a Detail Group\n\nFair59 solved another issue in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread \non [moving detail group only moves its location point, not detail items inside](https://forums.autodesk.com/t5/revit-api-forum/moving-detail-group-only-moves-its-locationpoint-not-detail/m-p/7302496):\n\n**Question:** I'm trying to move Detail Group element to a point that was picked, but only the Location of the group moves, not the detail items inside.\n\n**Answer:** To move the entire group, you can use:\n \n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;moveVector&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">XYZ</span>(&nbsp;5,&nbsp;0,&nbsp;0&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:blue;\">using</span>(&nbsp;<span style=\"color:#2b91af;\">Transaction</span>&nbsp;t&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">Transaction</span>(&nbsp;doc&nbsp;)&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">List</span>&lt;<span style=\"color:#2b91af;\">ElementId</span>&gt;&nbsp;toMove&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;List&lt;<span style=\"color:#2b91af;\">ElementId</span>&gt;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group.Id&nbsp;};\n \n&nbsp;&nbsp;&nbsp;&nbsp;toMove.AddRange(&nbsp;group.GetMemberIds()&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;t.Start(&nbsp;<span style=\"color:#a31515;\">&quot;MoveGroup&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementTransformUtils</span>.MoveElements(&nbsp;doc,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toMove,&nbsp;moveVector&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;t.Commit();\n&nbsp;&nbsp;}\n</pre>\n\nIn the creation of the (extra) list, I added the `group.Id`.\nSo I move the `group.Id` and the `member.Ids`.\n\nYou can set the translation vector from the old point to the picked point like this:\n \n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;locPoint&nbsp;=&nbsp;(&nbsp;group.Location&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">LocationPoint</span>&nbsp;).Point;\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">XYZ</span>&nbsp;pickedPoint;\n&nbsp;&nbsp;moveVector&nbsp;=&nbsp;pickedPoint.Subtract(&nbsp;locPoint&nbsp;);\n</pre>\n\nThank you, Fair59, for yet another succinct and accurate solution!\n\n\n####<a name=\"7\"></a>Filtering for Family Instances and Types by Family Name\n\nYet another issue in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non implementing\na [family instance filter](https://forums.autodesk.com/t5/revit-api-forum/family-instance-filter/m-p/7287113) led\nto a little update and\nnew [release 2018.0.134.2](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2018.0.134.2)\nof [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples):\n\n**Question:** I want to retrieve a list of all Family Instances by Type name. As the Type name is not unique (i.e. \"Type 1\") and can be used repeatedly by different Families, I need to also specify the family name.\n\nFor instance, there are two title block families: `TB1` and `TB2`; both of them have a type named `60\" x 30\" Student`.\n\nI would like to write a single filter statement that collects only `TB2:60\" x 30\" Student` instances.\n\nIt seems counter intuitive to run a `foreach` over your results to check the family type.\n\n**Answer:** You can achieve the filter you ask for in several ways.\n\nThe easiest and slowest is to use .NET post-processing or LINQ.\n\nThat is equivalent to running a `foreach` loop over the results of the filter.\n\nRevit returns a large collection of instances, which costs time and marshalling effort, and .NET post-processes them.\n\nA much faster alternative, but a little bit more complex, is to implement\na [parameter filter](http://thebuildingcoder.typepad.com/blog/2010/06/element-name-parameter-filter-correction.html).\n\nYou can apply any filters you like in any order you like.\n \nRevit may perform some optimisation by reordering them.\n \nIt is probably useful\nto [apply all quick filters first](http://thebuildingcoder.typepad.com/blog/2015/12/quick-slow-and-linq-element-filtering.html).\n \nUsing `ToList` to convert the enumerable filtered element collector to a .NET `List` is  normally not necessary\nand [may cause a significant inefficiency](http://thebuildingcoder.typepad.com/blog/2012/09/findelement-and-collector-optimisation.html).\n \nCheck out the examples provided\nby [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples) in\nthe [module CmdCollectorPerformance.cs](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/BuildingCoder/CmdCollectorPerformance.cs)\n \nYou could filter for families first, then determine their types, and then the instances referring to those.\n \nIn fact, the CmdCollectorPerformance.cs module includes code demonstrating that approach.\n \nHowever, since the elements you are after in the end are the instances, it makes sense to filter for those right away, and then eliminate the ones that don't match the expected family.\n \nHere are the two functions using LINQ post-processing that I now added to The Building Coder samples to answer this question once and for all:\n\n<pre class=\"code\">\n  <span style=\"color:blue;\">#region</span>&nbsp;Retrieve&nbsp;all&nbsp;family&nbsp;instances&nbsp;of&nbsp;specific&nbsp;named&nbsp;family&nbsp;and&nbsp;type\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;Get&nbsp;instances&nbsp;by&nbsp;family&nbsp;name&nbsp;then&nbsp;type&nbsp;name</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;/</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n  <span style=\"color:blue;\">static</span>&nbsp;<span style=\"color:#2b91af;\">IEnumerable</span>&lt;<span style=\"color:#2b91af;\">FamilyInstance</span>&gt;\n  &nbsp;&nbsp;GetFamilyInstancesByFamilyAndType(\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc,\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;familyName,\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;typeName&nbsp;)\n  {\n  &nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n  &nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">FamilyInstance</span>&nbsp;)&nbsp;)\n  &nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;<span style=\"color:#2b91af;\">FamilyInstance</span>&gt;()\n  &nbsp;&nbsp;&nbsp;&nbsp;.Where(&nbsp;x&nbsp;=&gt;&nbsp;x.Symbol.Family.Name.Equals(&nbsp;familyName&nbsp;)&nbsp;)&nbsp;<span style=\"color:green;\">//&nbsp;family</span>\n  &nbsp;&nbsp;&nbsp;&nbsp;.Where(&nbsp;x&nbsp;=&gt;&nbsp;x.Name.Equals(&nbsp;typeName&nbsp;)&nbsp;);&nbsp;<span style=\"color:green;\">//&nbsp;family&nbsp;type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>\n  }\n  <span style=\"color:blue;\">#endregion</span>&nbsp;<span style=\"color:green;\">//&nbsp;Retrieve&nbsp;all&nbsp;family&nbsp;instances&nbsp;of&nbsp;specific&nbsp;named&nbsp;family&nbsp;and&nbsp;type</span>\n   \n  <span style=\"color:blue;\">#region</span>&nbsp;Return&nbsp;first&nbsp;title&nbsp;block&nbsp;family&nbsp;symbol&nbsp;of&nbsp;specific&nbsp;named&nbsp;family&nbsp;and&nbsp;type\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;Get&nbsp;title&nbsp;block&nbsp;family&nbsp;symbol&nbsp;(=&nbsp;definition)&nbsp;</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;by&nbsp;family&nbsp;name&nbsp;then&nbsp;type&nbsp;name</span>\n  <span style=\"color:gray;\">///</span><span style=\"color:green;\">&nbsp;</span><span style=\"color:gray;\">&lt;/</span><span style=\"color:gray;\">summary</span><span style=\"color:gray;\">&gt;</span>\n  <span style=\"color:blue;\">static</span>&nbsp;<span style=\"color:#2b91af;\">FamilySymbol</span>\n  &nbsp;&nbsp;GetTitleBlockSymbolByFamilyAndType(\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc,\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;familyName,\n  &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;typeName&nbsp;)\n  {\n  &nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n  &nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">FamilySymbol</span>&nbsp;)&nbsp;)\n  &nbsp;&nbsp;&nbsp;&nbsp;.OfCategory(&nbsp;<span style=\"color:#2b91af;\">BuiltInCategory</span>.OST_TitleBlocks&nbsp;)\n  &nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;<span style=\"color:#2b91af;\">FamilySymbol</span>&gt;()\n  &nbsp;&nbsp;&nbsp;&nbsp;.Where(&nbsp;x&nbsp;=&gt;&nbsp;x.FamilyName.Equals(&nbsp;familyName&nbsp;)&nbsp;)&nbsp;<span style=\"color:green;\">//&nbsp;family</span>\n  &nbsp;&nbsp;&nbsp;&nbsp;.FirstOrDefault(&nbsp;x&nbsp;=&gt;&nbsp;x.Name&nbsp;==&nbsp;typeName&nbsp;);&nbsp;<span style=\"color:green;\">//&nbsp;family&nbsp;type</span>\n  }\n  <span style=\"color:blue;\">#endregion</span>&nbsp;<span style=\"color:green;\">//&nbsp;Return&nbsp;first&nbsp;title&nbsp;block&nbsp;family&nbsp;symbol&nbsp;of&nbsp;specific&nbsp;named&nbsp;family&nbsp;and&nbsp;type</span>\n</pre>\n\nImplementing dedicated parameter filters for the family and type name would be much more efficient, and would avoid Revit having to marshal and send across to .NET all the data for the instances or types that do not match the desired criteria.\n\nThe code region to [retrieve named family symbols](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/BuildingCoder/CmdCollectorPerformance.cs#L1039-L1101) demonstrates several different approaches using both LINQ and the more efficient parameter filter.\n \nYou can implement similar code to retrieve family instances instead of symbols."
  }
]