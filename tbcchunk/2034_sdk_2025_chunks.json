[
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- RevitLookup HotFix 2025.0.1\n  https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.1\n  Fixed Search Bar crashing Revit  ([issue 214](https://github.com/jeremytammik/RevitLookup/issues/214))\n  Improvements\n  - Ref parameter type support\n  - Add BasePoint.GetSurveyPoint support by @SergeyNefyodov in #212\n  - Add BasePoint.GetProjectBasePoint support by @SergeyNefyodov in #212\n  - Add InternalOrigin.Get support by @SergeyNefyodov in #212\n  - Add ElevationMarker.GetViewId support by @SergeyNefyodov in #213\n  - Add CurtainGrid.GetCell support by @SergeyNefyodov in #215\n  - Add CurtainGrid.GetPanel support by @SergeyNefyodov in #215\n  - Add Panel.GetRefGridLines support by @SergeyNefyodov in #215\n  Many thanks to [@SergeyNefyodov](https://github.com/SergeyNefyodov) for contributing and to Roman for maintaining RevitLookup!\n  [Full changelog 2025.0.0...2025.0.1](https://github.com/jeremytammik/RevitLookup/compare/2025.0.0...2025.0.1)\n  [RevitLookup versions](https://github.com/jeremytammik/RevitLookup/wiki/Versions)\n\n- https://aps.autodesk.com/developer/overview/revit\n  SDKs and tools\n  Revit .NET SDK\n  View documentation and over 100 code samples to start developing with the Revit API. Version 2025 (updated April 2, 2024).\n\n- sync RevitSdkSamples from 2024 to 2025\n\ntwitter:\n\nRevitLookup hotfix, Revit 2025 API, SDK download, comparison with previous version, integration, compilation and custom add-in context menus in the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/revit2025sdk\n\nRevitLookup HotFix 2025.0.1 has been released, and I continue the exploration of the Revit 2025 API\n&ndash; Revit 2025 SDK download\n&ndash; Comparison with previous SDK\n&ndash; Integration into RevitSdkSamples\n&ndash; Compiling the Revit 2025 SDK samples\n&ndash; Custom add-in context menu...\n\nlinkedin:\n\nRevitLookup hotfix, Revit 2025 API, SDK download, comparison with previous version, integration, compilation and custom add-in context menus in the #RevitAPI\n\nhttps://autode.sk/revit2025sdk\n\n- RevitLookup HotFix 2025.0.1\n- Revit 2025 SDK download\n- Comparison with previous SDK\n- Integration into RevitSdkSamples\n- Compiling the Revit 2025 SDK samples\n- Custom add-in context menu...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "RevitLookup Hotfix and The Revit 2025 SDK",
    "local_header_href": "#revitlookup-hotfix-and-the-revit-2025-sdk",
    "chunk_text": "### RevitLookup Hotfix and The Revit 2025 SDK\n\nRevitLookup HotFix 2025.0.1 has been released, and I continue the exploration of the Revit 2025 API, installing the Revit 2025 SDK and performing the following steps:\n\n- [RevitLookup hotfix 2025.0.1](#2)\n- [Revit 2025 SDK download](#3)\n- [Comparison with previous SDK](#4)\n- [Integration into RevitSdkSamples](#5)\n- [Compiling the Revit 2025 SDK samples](#6)\n- [Custom add-in context menu](#7)"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "RevitLookup Hotfix 2025.0.1",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> RevitLookup Hotfix 2025.0.1\n\n[RevitLookup hotfix 2025.0.1](https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.1) has been released to handle\nthe [fixed search bar crashing Revit (issue 214)](https://github.com/jeremytammik/RevitLookup/issues/214).\n\nThis version includes further improvements:\n\n- Ref parameter type support\n- Add BasePoint.GetSurveyPoint support by @SergeyNefyodov in #212\n- Add BasePoint.GetProjectBasePoint support by @SergeyNefyodov in #212\n- Add InternalOrigin.Get support by @SergeyNefyodov in #212\n- Add ElevationMarker.GetViewId support by @SergeyNefyodov in #213\n- Add CurtainGrid.GetCell support by @SergeyNefyodov in #215\n- Add CurtainGrid.GetPanel support by @SergeyNefyodov in #215\n- Add Panel.GetRefGridLines support by @SergeyNefyodov in #215\n- [Full changelog 2025.0.0...2025.0.1](https://github.com/jeremytammik/RevitLookup/compare/2025.0.0...2025.0.1)\n- [RevitLookup versions](https://github.com/jeremytammik/RevitLookup/wiki/Versions)\n\nMany thanks\nto [@SergeyNefyodov](https://github.com/SergeyNefyodov) for contributing and\nto Roman [@Nice3point](https://t.me/nice3point) Karpovich, aka Роман Карпович, for maintaining RevitLookup!"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Revit 2025 SDK Download",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Revit 2025 SDK Download\n\nThe Revit 2025 SDK has been published to the [Revit Developer Centre](https://aps.autodesk.com/developer/overview/revit):\n\n> SDKs and tools &gt; Revit .NET SDK\n  &gt; View documentation and over 100 code samples to start developing with the Revit API.\n  Version 2025 (updated April 2, 2024)."
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Comparison with Previous SDK",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Comparison with Previous SDK\n\nI downloaded the new SDK and compared the directory structure and individual files with the Revit 2024 version, noting the following changes:\n\nFour new SDK samples:\n\n- ContextMenu &ndash; create a customised add-in context menu, [cf. below](#7)\n- DisallowEndWrapping &ndash; allow or disallow end wrapping at certain wall locations\n- EditSketch &ndash; edit curves in sketches and add dimensions to the sketch using `SketchEditScope`\n- NewMacro &ndash; generate, build end execute a Macro by `MacroManager`\n\nFolders Removed:\n\n- REX SDK\n- Samples/AnalyticalSupportData_Info\n- Samples/CreateTrianglesTopography\n- Samples/Site\n\nModified:\n\n- Macro Samples/GetTimeElapsed &ndash; previously separate samples and directories for CSharp and VBNet\n\nAdded:\n\n- Macro Samples/MacroSamples_MEP\n- Macro Samples/MacroSamples_RFA\n- Macro Samples/MacroSamples_RVT\n- Samples/ContextMenu\n- Samples/DisallowEndWrapping\n- Samples/EditSketch\n- Samples/NewMacro\n\nHere are my exact comparison steps and details:\n\n- [Comparison steps and commands](doc/2025_revit_sdk_sample_comparison.txt)\n- [Directory differences](doc/2025_dir_diff.txt)\n- [File differences](doc/2025_file_diff.txt)"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Integration into RevitSdkSamples",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Integration into RevitSdkSamples\n\nBefore making any changes to my local installation of the SDK samples, I prefer to integrate it into\nthe [RevitSdkSamples GitHub repository](https://github.com/jeremytammik/RevitSdkSamples) to track and share my modifications.\n\nIn order to preserve as much as possible of the Git history from the previous version to the new SDK release, instead of just deleting and overwriting everything, I integrated the new SDK into RevitSdkSamples in two steps, based on the differences detected in the steps described above:\n\n- Delete from RevitSdkSamples all obsolete files that no longer occur in the Revit 2025 SDK\n- Copy the Revit 2025 SDK into RevitSdkSamples, overwriting existing files\n\nThe result is captured\nin [RevitSdkSamples release 2025.0.0](https://github.com/jeremytammik/RevitSdkSamples/releases/tag/2025.0.0)."
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Compiling the Revit 2025 SDK Samples",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Compiling the Revit 2025 SDK Samples\n\nMy first attempt to rebuild the solution [skipped all 201 solutions](doc/sdk_samples_2025_01.txt).\n\nI searched for an explanation and looked\nat [how to determine why Visual Studio might be skipping projects when building a solution](https://stackoverflow.com/questions/1319772/how-to-determine-why-visual-studio-might-be-skipping-projects-when-building-a-so).\n\nI ended up selecting the build target `x64` in the Configuration Manager to match the targets listed for each one of the individual solutions.\n\n<!--\n<center>\n<img src=\"img/sdk_2025_vs_config_mgr.png\" alt=\"Configuration Manager build target\" title=\"Configuration Manager build target\" width=\"300\"/>\n<p style=\"font-size: 80%; font-style:italic\">Configuration Manager build target</p>\n</center>\n-->\n\nWith that setting in place, it reported 'Rebuild started at 9:09 AM...' and did not skip the projects, but it did not seem to do anything else either except endlessly consume more and more memory until\nI [cancelled the build after more than 15 minutes](doc/sdk_samples_2025_02.txt):\n\n<center>\n<img src=\"img/sdk_2025_vs_memory.png\" alt=\"Visual Studio memory consumption growing\" title=\"Visual Studio memory consumption growing\" width=\"600\"/> <!-- Pixel Height: 678 Pixel Width: 848 -->\n<p style=\"font-size: 80%; font-style:italic\">Visual Studio memory consumption growing</p>\n</center>\n\nNext, I removed the `.vs` folder and changed the build output verbosity to detailed in Visual Studio &gt; Tools &gt; Options &gt; Projects and Solutions &gt; Build and Run.\n\nThe increased verbosity still gives no information about what is happening, beyond the message saying 'Rebuild started at 9:46 AM...'\n\nAlthough... the status bar does list one project after another, reporting 'Restored ...csproj in 3.05 s'.\nMultiplying 200 projects by 2 seconds each should still complete in a manageable time, though, but I see no hint of progress.\n\nSwitching the output to 'Package Manager' shows what is going on...\n[Generating MSBuild file, Writing cache file to disk, Persisting dg, Writing assets file to disk etc.](doc/sdk_samples_2025_03.txt)...\nhalf an hour waiting and still going... completed after 34 minutes!\n\nI am probably running a suboptimal setup here...\n\nSo, I continued waiting.\nAfter 1 hour and 46 minutes, the compilation completed, partially,\nwith [177 succeeded, 24 failed, 0 skipped, 30 errors and 5 warnings](doc/sdk_samples_2025_04.txt).\n\nA new record time, slower than all previous versions by a factor of about 25.\n\nLooking at the error list, two errors are caused by code in ExternalResourceDBServer:\n\n- Error CS0246 The type or namespace names `GetLinkPathForOpen` and `LocalLinkSharedCoordinatesSaved` could not be found\n\nI fixed those by commenting out the two offending lines, since the methods referred to are not defined anywhere.\n\nThe remaining errors and warnings have to do with external references, such as:\n\n- Error NU1100  Unable to resolve 'System.Data.DataSetExtensions (>= 4.5.0)' for 'net8.0-windows7.0' in Selections\n- Error BC30002 Type 'MsExcel.Application' is not defined in `ArchSample` and `FireRating`\n- Warning BC40056 Namespace or type specified in the Imports 'Microsoft.Office.Interop.Excel' doesn't contain any public member or cannot be found in `ArchSample` and `FireRating`\n- Error NU1100  Unable to resolve 'Microsoft.CSharp (>= 4.7.0)' for 'net8.0-windows7.0' in `UpdateExternallyTaggedBRep`, `BRepBuilderExample`, `ReadonlySharedParameters`, `ExtensibleStorageUtility`\n- Error NU1100  Unable to resolve 'Newtonsoft.Json (>= 13.0.1)' for 'net8.0-windows7.0' in `CloudAPISample`\n- Error NU1100  Unable to resolve 'System.Data.DataSetExtensions (>= 4.5.0)' for 'net8.0-windows7.0' in `ReadonlySharedParameters`, `ExtensibleStorageUtility`, `ExternalCommandRegistration` and a dozen other projects\n- Error NU1100  Unable to resolve 'HtmlTextWriter (>= 2.1.1)' for 'net8.0-windows7.0' in ScheduleToHTML\n- Error NU1100  Unable to resolve 'System.Net.Http (>= 4.3.4)' for 'net8.0-windows7.0' in ScheduleToHTML\n- Error NU1100  Unable to resolve 'System.Data.OleDb (>= 8.0.0)' for 'net8.0-windows7.0' in RoomSchedule\n- Warning MSB3284 Cannot get the file path for type library \"00020813-0000-0000-c000-000000000046\" version 1.9 in FireRating and ArchSample\n\nPossibly, some of these errors are caused by not installing Microsoft Office in my virtual machine, so I went ahead and installed Microsoft Office.\n\nI noticed this message in the build output window:\n\n- To prevent NuGet from restoring packages during build, open the Visual Studio Options dialog, click on the NuGet Package Manager node and uncheck 'Allow NuGet to download missing packages during build.'\n\nAnother possible culprit\nexplaining [why Visual Studio keeps rebuilding my projects for no good reason](https://michaelscodingspot.com/visual-studio-keeps-rebuilding-projects-no-good-reason/):\n\n> Resource is set to “Copy always”:\nCopy always means just what it says, and there’s never a good reason for that.\nThere is another option to \"Copy if newer\" instead of “Copy always”.\n\nIn the newer SDK-style projects, go to the `.csproj` file and look for\n\n<pre><code class=\"language-xml\">&lt;CopyToOutputDirectory&gt;Always&lt;/CopyToOutputDirectory&gt;\n</code></pre>\n\nChange that to\n\n<pre><code class=\"language-xml\">&lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;\n</code></pre>\n\nI found and fixed that setting in six projects: CloudAPISample, DockableDialogs, FreeFormElement, GetSetDefaultTypes, InCanvasControlAPI and SinePlotter.\n\nRecompiling again from scratch resulted in [181 succeeded, 20 failed, 23 errors, 5 warnings, in 1 hour and 26 minutes](doc/sdk_samples_2025_06.txt).\n\nDefinitely not something I want to repeat on a daily basis.\nMaybe my virtual machine running Windows in Parallels on a Mac is slowing things down?\n\nMy current SDK installation is captured\nin [RevitSdkSamples release 2025.0.1](https://github.com/jeremytammik/RevitSdkSamples/releases/tag/2025.0.1)."
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Custom Add-In Context Menu",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Custom Add-In Context Menu\n\nAs hinted at by the new `ContextMenu` SDK sample mentioned above, the Revit API 2025 enables an add-in to create a custom right-click context menu:\n\n> This sample demonstrates how to create customized context menu for Add-In and how to create different types of menu items: `CommandMenuItem`, `SeparatorItem`, `SubMenuItem`.\n\n[Ricaun](https://ricaun.com/), aka Luiz Henrique Cassettari, shares his take on that functionality in\nhis [ContextMenuExtension gist](https://gist.github.com/ricaun/ffb897b9ba5b152992cfe20ca6bcfa16) and\na nine-minute video\non [Revit API 2025 RegisterContextMenu](https://youtu.be/1hqGWeYjUcU):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/1hqGWeYjUcU?si=92qAe9HEPDd4Kr_X\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n</center>\n\nThank you very much, Luiz!"
  }
]