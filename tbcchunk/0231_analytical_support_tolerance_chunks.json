[
  {
    "original_filename": "0231_analytical_support_tolerance",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0231_analytical_support_tolerance",
    "header_text": "Analytical Support Tolerance",
    "local_header_href": "#analytical-support-tolerance",
    "chunk_text": "<h3>Analytical Support Tolerance</h3><p>Here is an interesting issue dealing with the analytical model in Revit Structure.\nAs we see below, the issue is not really API related, but since one symptom is the missing data obtainable through the API, it is worth an explanation.</p><p><strong>Question:</strong> We have created two columns over a three-pile cap foundation and are trying to retrieve the support data from their analytical models:\n\n<center>\n<img alt=\"Pile cap foundation and columns\" src=\"img/pile_cap_foundation_and_columns.png\"/>\n</center>\n<p>Unfortunately, the support data of the column is available only if its centre line is exactly over the analytical model location of the pile cap foundation.\nElse, it is not available and the property simply returns null.\nThe main purpose of this requirement is actually to find the link between the column and the pile cap.\nHow can we achieve this, please?\n\n<p><strong>Answer:</strong> Happily, this situation is easily resolved by modifying the analytical support tolerance.\nFirst, note that the missing support data is not an API-specific problem.\nIf you select the column through the user interface, the Show Related Warnings button is active and the warning says that the column may not be supported.\n\n<p>The pile cap foundation is actually four foundations â€“ one cap foundation and three pile foundations.\nGeometry for the cap foundation starts at Level 1 and goes down 900.\nThe geometries for the three pile foundations start at -900 and go down 6900.\nIn Revit, the default position for the Isolated Foundation analytical model is at the top of the geometry.\nSince this is at -900, the analytical models for the pile foundations are at that elevation.\n\n<p>Analytical Support is governed by the Analytical Support tolerance, shown on the Analytical Model Settings tab of the Structural Settings dialog.\nIn the attached file, this tolerance is set at 300.\nSo even when the column's analytical model is directly over the pile foundation's analytical model, the thickness of the cap foundation (900) is keeping the column from seeing the pile foundation's analytical model.\n\n<p>To overcome this obstacle, increase the tolerance from 300 to 900.\nThen when you move the column over the top of the pile foundation, it will see the pile foundation, and the column will consider the pile foundation as a valid support.\n\n<p>Although that resolves the current problem, here are two additional general hints for approaches to find the link between two elements located close to each other:</p>\n<ul>\n<li>FindReferencesByDirection.</li>\n<li>Geometric analysis.</li>\n</ul>\n<p>The FindReferencesByDirection method to find the link between the two elements determines that the pile cap foundation is located directly underneath the second column and hence is supporting it.\nThis can be achieved by shooting a ray straight down from a point slightly raised up from the lower endpoint of the column and using FindReferencesByDirection to discover the foundation element directly underneath.\nFindReferencesByDirection returns an array of elements, faces, and references found when moving through the model from a specified point in a specified direction.\nIts use is demonstrated by the RayTraceBounce SDK sample.\n\n<p>You can also determine their relationship by pure geometric analysis, e.g. using a filter to collect all the structural elements on the relevant levels and then comparing the locations of their solids' faces with each other.\nThe AreSolidsCut method defined by the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/09/roomsroofs-sdk.html\">\nRoomsRoofs SDK sample</a> may be helpful in this context.\n\nGeometric analysis may or may not be simpler than using FindReferencesByDirection.\n</p></p></p></p></p></p></p></p>"
  }
]