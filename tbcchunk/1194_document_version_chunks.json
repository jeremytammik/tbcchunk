[
  {
    "original_filename": "1194_document_version",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n</head>"
  },
  {
    "original_filename": "1194_document_version",
    "header_text": "Document Version, GUID and Number of Saves",
    "local_header_href": "#document-version-guid-and-number-of-saves",
    "chunk_text": "<h3>Document Version, GUID and Number of Saves</h3><p>Alexander Buschmann of the\n\n<a href=\"http://www.idat.de\">IDAT</a> Ingenieurbüro für Datenverarbeitung in der Technik GmbH\n\nadded a new\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2014/07/ifc-guid-algorithm-update-and-family-modification.html?cid=6a00e553e16897883301a73e051b6e970d#comment-6a00e553e16897883301a73e051b6e970d\">\ncomment</a> to\n\nthe interesting discussion on\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2014/07/ifc-guid-algorithm-update-and-family-modification.html#3\">\ndetecting family modification</a>:</p><blockquote>\n<p>I'm a little bit late, but still:</p>\n<p>Since Revit2015 there is a class 'DocumentVersion' – it provides a GUID and the number of saves of the document.</p>\n<p>Together, this information should make it possible to identify changes to a document.</p>\n<p>Store the data in a read-only parameter, and you should be set, without the need to implement a custom checksum thing.</p>\n<p>The DocumentVersion can be obtained by calling BasicFileInfo.GetDocumentVersion.</p>\n<p>I have not tried it, but it looks promising.</p>\n</blockquote><p>Please refer to the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2014/07/ifc-guid-algorithm-update-and-family-modification.html#comments\">\noriginal discussion thread</a> to\n\nsee the other interesting suggestions provided to detect family modification.</p><a name=\"2\"></a>"
  },
  {
    "original_filename": "1194_document_version",
    "header_text": "CmdDocumentVersion",
    "local_header_href": "#cmddocumentversion",
    "chunk_text": "<h4>CmdDocumentVersion</h4><p>Based on Alexander's suggestion, I implemented this new short and sweet read-only external command CmdDocumentVersion in The Building Coder samples:</p><pre class=\"code\">\n  [<span class=\"teal\">Transaction</span>( <span class=\"teal\">TransactionMode</span>.ReadOnly )]\n  <span class=\"blue\">class</span> <span class=\"teal\">CmdDocumentVersion</span> : <span class=\"teal\">IExternalCommand</span>\n  {\n    <span class=\"blue\">public</span> <span class=\"teal\">Result</span> Execute(\n      <span class=\"teal\">ExternalCommandData</span> revit,\n      <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message,\n      <span class=\"teal\">ElementSet</span> elements )\n    {\n      <span class=\"teal\">UIApplication</span> uiapp = revit.Application;\n      <span class=\"teal\">UIDocument</span> uidoc = uiapp.ActiveUIDocument;\n      <span class=\"teal\">Document</span> doc = uidoc.Document;\n \n      <span class=\"blue\">string</span> path = doc.PathName;\n \n      <span class=\"teal\">BasicFileInfo</span> info = <span class=\"teal\">BasicFileInfo</span>.Extract(\n        path );\n \n      <span class=\"teal\">DocumentVersion</span> v = info.GetDocumentVersion();\n \n      <span class=\"blue\">int</span> n = v.NumberOfSaves;\n \n      <span class=\"teal\">Util</span>.InfoMsg( <span class=\"blue\">string</span>.Format(\n        <span class=\"maroon\">\"Document '{0}' has GUID {1} and {2} save{3}.\"</span>,\n        path, v.VersionGUID, n,\n        <span class=\"teal\">Util</span>.PluralSuffix( n ) ) );\n \n      <span class=\"blue\">return</span> <span class=\"teal\">Result</span>.Succeeded;\n    }\n  }\n</pre><p>Running it on my trusty old HVAC sample project that I have been maintaining ever since Revit 2008 produces the following result:</p><pre>\n  Document 'Z:\\a\\rvt\\hvac_project_2015.rvt' has GUID\n  6359c822-15f3-44c3-83c5-f9bc258a3f90 and 338 saves.\n</pre><p>This information is presented in a dialogue box like this:</p><center>\n<img alt=\"DocumentVersion GUID and NumberOfSaves\" src=\"img/document_version.png\" width=\"374\"/>\n</center><p>By the way, another noteworthy aspect of this command is that it proves that the basic file info can be read successfully from a currently open document.</p><p>Thank you very much, Alexander, for this important hint!</p><a name=\"3\"></a>"
  },
  {
    "original_filename": "1194_document_version",
    "header_text": "Other Enhancements and Viewing Diffs in GitHub",
    "local_header_href": "#other-enhancements-and-viewing-diffs-in-github",
    "chunk_text": "<h4>Other Enhancements and Viewing Diffs in GitHub</h4><p>I implemented a couple of other minor enhancements in The Building Coder samples that have not been explicitly pointed out here yet, e.g. a small check for the angle to true north\n\n(<a href=\"https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2015.0.110.3\">release 2015.0.110.3</a>)\n\nto answer Frank Halliday's\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/03/rotate-true-north.html?cid=6a00e553e16897883301a73e03c977970d#comment-6a00e553e16897883301a73e03c977970d\">comment</a> and\n\nstarting work on removing all obsolete API usage.</p><p>So far, in\n\n<a href=\"https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2015.0.110.2\">\nrelease 2015.0.110.2</a>, I reduced the warning count from 71 to 67.</p><p>The changes made for that can be seen by navigating to\n\n<a href=\"https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2015.0.110.1\">\nrelease 2015.0.110.1</a> and\n\nclicking on the label saying\n\n<a href=\"https://github.com/jeremytammik/the_building_coder_samples/compare/2015.0.110.1...master\">\nN commits</a>.</p><p>After that, you can edit the exact versions being compared to narrow down the differences to your window of interest, e.g. from 2015.0.110.1 to 2015.0.110.2.</p><a name=\"4\"></a>"
  },
  {
    "original_filename": "1194_document_version",
    "header_text": "Download The Building Coder Samples",
    "local_header_href": "#download-the-building-coder-samples",
    "chunk_text": "<h4>Download The Building Coder Samples</h4><p>The complete source code, Visual Studio solution and RvtSamples include file is provided in\n\n<a href=\"https://github.com/jeremytammik/the_building_coder_samples\">\nThe Building Coder samples GitHub repository</a>.</p><p>The version discussed above is\n\n<a href=\"https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2015.0.111.0\">\nrelease 2015.0.111.0</a>.</p>"
  }
]