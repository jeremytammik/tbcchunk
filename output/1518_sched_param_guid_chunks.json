[
  {
    "original_filename": "1518_sched_param_guid",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<!--\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n</head>\n\n<!---\n\n- Alexander Ignatovich (Александр Игнатович) \n  Elegant solution to get project parameters GUID directly for the building coder\n\n- 12553492 [Getting parameter information from a schedule]\n  http://forums.autodesk.com/t5/revit-api-forum/getting-parameter-information-from-a-schedule/m-p/6802850\n\n#RevitAPI @AutodeskRevit #aec #bim #dynamobim @AutodeskForge\n\nLots of information on, from and about schedule parameters, and a new elegant solution to a long-standing challenge\n&ndash; Direct access to shared parameter GUID\n&ndash; Getting parameter information from a schedule...\n\n#AULondon, #UI, #innovation, #RevitAPI, @AutodeskRevit\n\nDirect access to shared param GUID & param info from a schedule #RevitAPI @AutodeskRevit #aec #bim #dynamobim @AutodeskForge http://bit.ly/paramguid\n\n-->"
  },
  {
    "original_filename": "1518_sched_param_guid",
    "header_text": "Schedule Parameter and Shared Parameter GUID",
    "local_header_href": "#schedule-parameter-and-shared-parameter-guid",
    "chunk_text": "### Schedule Parameter and Shared Parameter GUID\n\nLots of information on, from and about schedule parameters, and a new elegant solution to a long-standing challenge:\n\n- [Direct access to shared parameter GUID](#2)\n- [Getting parameter information from a schedule](#3)\n\n\n####<a name=\"2\"></a>Direct Access to Shared Parameter GUID\n\nAlexander Ignatovich (Александр Игнатович) already shared several exciting solutions with us all in the past.\n\nToday he faced a new problem.\n\nAs usual, he came up with an impressively direct solution to share.\n\nThe problem is rather old and known, and he found an elegant new way to solve it:\n\nI wanted to get shared parameters GUIDs directly from project parameters.\n\nOf course I found the solution demonstrated by \nthe [shared project parameter GUID reporter](http://thebuildingcoder.typepad.com/blog/2015/12/shared-project-parameter-guid-reporter.html), where you need to attach the parameter to the project information (for instance parameters) and wall (for type parameters) categories.\n\nI also found another blog post on [parameter of Revit API 30 &ndash; project parameter information](http://spiderinnet.typepad.com/blog/2011/05/parameter-of-revit-api-30-project-parameter-information.html), but this solution did not work for me, because all definitions in `doc.ParameterBindings` are `InternalDefinition` objects in Revit 2017.\n\nI investigated further and found that `InternalDefinition` has an `Id`. I retrieved the corresponding database element from the document by this `Id`. I saw that `SharedParameterElement` is returned for shared project parameters and `ParameterElement` for non-shared project parameters. `SharedParameterElement` has a `GuidValue` property, which is exactly what I need.\n\nThe code:\n\n<pre class=\"code\">\n&nbsp;&nbsp;[<span style=\"color:#2b91af;\">Transaction</span>(&nbsp;<span style=\"color:#2b91af;\">TransactionMode</span>.ReadOnly&nbsp;)]\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">class</span>&nbsp;<span style=\"color:#2b91af;\">CmdSharedParamGuids</span>&nbsp;:&nbsp;<span style=\"color:#2b91af;\">IExternalCommand</span>\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:#2b91af;\">Result</span>&nbsp;Execute(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ExternalCommandData</span>&nbsp;commandData,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">ref</span>&nbsp;<span style=\"color:blue;\">string</span>&nbsp;message,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementSet</span>&nbsp;elements&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;uiapp&nbsp;=&nbsp;commandData.Application;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;uidoc&nbsp;=&nbsp;uiapp.ActiveUIDocument;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;doc&nbsp;=&nbsp;uidoc.Document;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;bindingMap&nbsp;=&nbsp;doc.ParameterBindings;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;it&nbsp;=&nbsp;bindingMap.ForwardIterator();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it.Reset();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">while</span>(&nbsp;it.MoveNext()&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;definition&nbsp;=&nbsp;(<span style=\"color:#2b91af;\">InternalDefinition</span>)&nbsp;it.Key;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;sharedParameterElement&nbsp;=&nbsp;doc.GetElement(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;definition.Id&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">SharedParameterElement</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;sharedParameterElement&nbsp;==&nbsp;<span style=\"color:blue;\">null</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(&nbsp;<span style=\"color:#a31515;\">&quot;non-shared&nbsp;parameter&quot;</span>,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;definition.Name&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">TaskDialog</span>.Show(&nbsp;<span style=\"color:#a31515;\">&quot;shared&nbsp;parameter&quot;</span>,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">$&quot;</span>{sharedParameterElement.GuidValue}<span style=\"color:#a31515;\">&quot;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;-&nbsp;{definition.Name}&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;<span style=\"color:#2b91af;\">Result</span>.Succeeded;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n</pre>\n\nThank you very much for this elegant solution, Alexander!\n\nSweet and simple!\n\nI am sure it will make many people very happy!\n\nI therefore added it to [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples) \nin [release 2017.0.132.0](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2017.0.132.0).\n\nWe can make use of this right away to enhance the answer to the question below as well.\n\n\n\n####<a name=\"3\"></a>Getting Parameter Information from a Schedule\n\nFrom\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api/bd-p/160) thread\non [getting parameter information from a schedule](http://forums.autodesk.com/t5/revit-api-forum/getting-parameter-information-from-a-schedule/m-p/6802850):\n\n**Question:** The `ScheduleField` class has a property `ParameterId`, which is good.\n\nNow I would like to know more about this parameter:\n\n1. The name of the parameter.\n2. If it is an instance or type parameter.\n3. If it is a shared or built-in parameter.\n4. The parameter Unit.\n5. GUID of the parameter if it is shared.\n\nI think I can get 1 and 2 working, but pretty much clueless about 3, 4 and 5.\n\n**Answer:** Before anything else, I must ask you:\n\nHave you installed [RevitLookup](https://github.com/jeremytammik/RevitLookup) and are you using it on a regular basis in your Revit database exploration?\n\nWith that tool, you can interactively snoop the database.\n\nIn this case, you could grab one of those ParameterId values, use the built-in Revit *Select by Id* command in the *Manage* tab to select the corresponding database element, regardless of whether it has a graphical representation or not, and interactively explore its nature, contents, parameters, relationships with other elements, etc.\n\nThat will probably answer your question.\n\nIt is statically compiled, however, so it mainly displays properties. It does not dynamically evaluate all methods available on all classes.\n\nFor that, you can use other,\neven [more powerful and interactive database exploration tools](http://thebuildingcoder.typepad.com/blog/2013/11/intimate-revit-database-exploration-with-the-python-shell.html).\n\nAlso, my discussion\non [how to research to find a Revit API solution](http://thebuildingcoder.typepad.com/blog/2017/01/virtues-of-reproduction-research-mep-settings-ontology.html#3) might\ncome in handy for you at this point.\n\n**Response:** I have installed RevitLookup for Revit 2015 (the version I'm developing as our development needs to be backward compatible with our current projects).\n\nRevitLookup is a great tool that can save hundreds of hours of time on browsing the \"watch\" in the debug mode, which I have been using.\n\nHowever, I still can't find the field parameter definitions (shared or built-in) for the `ScheduleField` class. I understand the \"viewschedule\" and \"schedulefield\" are different classes. I suspect this may have to do with Revit API's limitation.\n\nBy the way, it seems RevitLookup defines a ribbon panel in the 'Add-ins' tab &ndash; however, I can't see the 'Manage Tab'; am I missing something here?\n\n**Answer:**\n\n1. name of the parameter:\n\n<pre class=\"code\">\n  Name = Field.GetName()\n</pre>\n\n2. Type or Instance?\n\nProbably only a definitive answer for a schedule of 1 System Family Category. Shared Parameters in User Created Families can be both Type and Instance (in different families).\n\n3. Shared or BuiltIn?\n\n- Field.ParameterId < -1 : BuiltInParameter &ndash; Field.ParameterId == BuiltInParameter value\n- Field.ParameterId > 0 : SharedParameter\n- Field.ParameterId = -1 : miscellaneous (calculated value, percentage)\n\nShared Parameter:\n\n<pre class=\"code\">\n  SharedParameterElement shElem = doc.GetElement(\n    Field.ParameterId) as SharedParameterElement;\n</pre>\n\nYou can find the answer to 4 and 5 in `shElem.Definition` .\n\nBuilt-in Parameter:\n\nYou need an element (Elem) to get access to a BuiltInParameter, so you need to have a non-empty schedule.\n\n<pre class=\"code\">\n  Parameter par = Elem.get_Parameter(\n    (BuiltInParameter) Field.ParameterId.IntegerValue );\n</pre>\n\nYou can find the answer to 4 in `par.Definition`.\n\n**Response:** Very nice answers, thanks a lot.\n\nRegarding 2, I guess I have to use the `FamilyManager` to open the families to find out if the shared parameter is a 'Type' or 'Instance' one.\n\n**Answer:** More on *Select by Id*:\n\n[Select element by id](https://knowledge.autodesk.com/support/revit-products/learn-explore/caas/CloudHelp/cloudhelp/2017/ENU/Revit-Troubleshooting/files/GUID-2B1CC22C-CB1F-45DA-B57B-62C36013D9E0-htm.html) is\npart of the standard end user interface:\n\n- Help entry on [Select Elements by ID](http://help.autodesk.com/view/RVT/2017/ENU/?guid=GUID-2B1CC22C-CB1F-45DA-B57B-62C36013D9E0)\n- 101-second YouTube video on [Selecting Elements Using the Element ID](https://www.youtube.com/watch?v=prv8nGrU56o):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/prv8nGrU56o?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n</center>\n \nAs said, it comes in handy for using RevitLookup to snoop element data and properties, since it can be used on invisible elements that cannot be selected in any other way as well.\n \n**Response:** I found the post you mentioned and tried; it works well that I can find the shared parameter visually on the Revit property panel even it is a 'hidden' element; that's quite cool. :)"
  }
]