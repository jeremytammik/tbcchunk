[
  {
    "original_filename": "1905_line_angle_dir_jig",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- /a/doc/revit/tbc/git/a/zip/line_based_detail_item_direction_arrow_jig.mp4\n  How can I draw the Detail Line to let the information of direction and angle emerge before finishing the command?\n  https://forums.autodesk.com/t5/revit-api-forum/how-can-i-draw-the-detail-line-to-let-the-information-of/m-p/10291715\n  jig\n  \n- get file paths in BIM 360 regardless of\n  Thanks for the original code to determine the file in the local cache for cloud models.\n  However, I found it only worked for WorkShared Cloud models.\n  this is the revision to work also with non-workshared cloud models:\n  17787640 [How to determine local path of non-workshared cloud model]\n  Get BIm 360 model's \"absolute\" path\n  https://forums.autodesk.com/t5/revit-api-forum/get-bim-360-model-s-quot-absolute-quot-path/m-p/10292538\n\n- need for regen\n  committing the transaction is the next level up after regeneration\n  Why does GroupType.Groups contain ungrouped groups?\n  https://forums.autodesk.com/t5/revit-api-forum/why-does-grouptype-groups-contain-ungrouped-groups/m-p/10291256/highlight/false#M55705  \n\n- https://github.com/ADN-DevTech/revit-api-chms\n  https://github.com/gtalarico/revit-api-chms/pull/4\n\n- C++/C# Frontend Engineer\n  https://www.comeet.com/jobs/knauf/56.004/cc-frontend-engineer-mfd/9F.D1F\n  /a/doc/revit/tbc/git/a/zip/2021-04-30_knauf_job_frontend_engineer.pdf\n  to develop and deliver solutions for CAD programs (e.g., Revit, ArchiCAD) mixing native SDK technologies in C++ and .NET and web views\n\ntwitter:\n\nAn example of a line angle and direction jig for real-time live graphical user input feedback, cloud model local file path access and the ever important need to regenerate in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://autode.sk/angledirectionjig\n\nAn example of real-time live graphical user input feedback, cloud model functionality, the ever important need to regenerate and other important topics for this holiday day\n&ndash; Line angle and direction jig\n&ndash; Determine cloud model local file path\n&ndash; How to refresh GroupType.Groups\n&ndash; Online access to RevitAPI.chm help files\n&ndash; C++/C&#35; frontend engineer...\n\nlinkedin:\n\nAn example of a line angle and direction jig for real-time live graphical user input feedback, cloud model local file path access and the ever important need to regenerate in the #RevitAPI\n\nhttp://autode.sk/angledirectionjig\n\n- Line angle and direction jig\n- Determine cloud model local file path\n- How to refresh GroupType.Groups\n- Online access to RevitAPI.chm help files\n- C++/C&#35; frontend engineer...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1905_line_angle_dir_jig",
    "header_text": "Refreshment, Cloud Model Path, Angle and Direction",
    "local_header_href": "#refreshment-cloud-model-path-angle-and-direction",
    "chunk_text": "### Refreshment, Cloud Model Path, Angle and Direction\n\nAn example of real-time live graphical user input feedback, cloud model functionality, the ever important need to regenerate and other important topics for this holiday day:\n\n- [Line angle and direction jig](#2)\n- [Determine cloud model local file path](#3)\n- [How to refresh GroupType.Groups](#4)\n- [Online access to RevitAPI.chm help files](#5)\n- [C++/C&#35; frontend engineer](#6)"
  },
  {
    "original_filename": "1905_line_angle_dir_jig",
    "header_text": "Line Angle and Direction Jig",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Line Angle and Direction Jig\n\nThe Revit API does not provide much support for real-time feedback on graphical user input, so this original idea\nby Maarten van der Linden of [Wagemaker](https://www.wagemaker.nl) may\ncome in handy, using `PromptForFamilyInstancePlacement` as a workaround, in answering \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [how to draw the detail line to let the information of direction and angle emerge before finishing the command](https://forums.autodesk.com/t5/revit-api-forum/how-can-i-draw-the-detail-line-to-let-the-information-of/m-p/10291715):\n\n**Question:** How can I draw the Detail Line to let the information of direction and angle emerge before finishing the command?\n\nCurrently, I am using `PickPoint` to prompt the use to select line endpoints and creating a detail curve from that information.\n\nHowever, I see no way to display any useful graphical feedback while picking these points like Revit itself does internally:\n\n<center>\n<img src=\"img/line_based_detail_item_angle_direction_1.png\" alt=\"Feedback on pick point angle and direction\" title=\"Feedback on pick point angle and direction\" width=\"312\"/> <!-- 624 -->\n<img src=\"img/line_based_detail_item_angle_direction_2.png\" alt=\"Feedback on pick point angle and direction\" title=\"Feedback on pick point angle and direction\" width=\"179\"/> <!-- 358 -->\n</center>\n\n**Answer:** You could try to launch the built-in Revit command together with the built-in user interface by using `PostCommand`.\n\nAnother option might be to implement some kind of\nown [jig, e.g., using the `IDirectContext3DServer`](https://thebuildingcoder.typepad.com/blog/2020/10/onbox-directcontext-jig-and-no-cdn.html#3).,\n\nMaybe you could also use some kind of Windows tooltip to display the required real-time information.\n\nUnfortunately, since this functionality is not supported by the Revit API out of the box, I'm afraid it may be hard to implement anything that is both useful and nice to use.\n\nHowever, here Maarten comes to the rescue, saying:\n\n> In my command to rotate the crop region of plan view, I use a line-based detail item in combination with `PromptForFamilyInstancePlacement` to mimic that kind of behaviour.\nHere is a video of the functionality:\n\n<center>\n<video style=\"display:block; width:600px; height:auto;\" autoplay=\"\" muted=\"\" loop=\"loop\">\n<source src=\"img/line_based_detail_item_direction_arrow_jig.mp4\" type=\"video/mp4\"> <!-- 1629 -->\n<!-- https://thebuildingcoder.typepad.com/img/line_based_detail_item_direction_arrow_jig.mp4 -->\n<source src=\"https://thebuildingcoder.typepad.com/2020/banana_small.mp4\" type=\"video/mp4\">\n</video>\n</center>\n\nMany thanks to Maarten for the great suggestion."
  },
  {
    "original_filename": "1905_line_angle_dir_jig",
    "header_text": "Determine Cloud Model Local File Path",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Determine Cloud Model Local File Path\n\nWe recently discussed the question \nof [determining a BIM 360 model's local \"absolute\" path](https://forums.autodesk.com/t5/revit-api-forum/get-bim-360-model-s-quot-absolute-quot-path/m-p/10292538).\nUnfortunately, the initial solution was limited to workshared cloud models.\n\nNow Simon Jones shared a more general method that works with non-workshared cloud models as well, saying:\n\n> Thanks for the original code to determine the file in the local cache for cloud models.\n\n> However, I found it only worked for workshared cloud models.\n\n> This is a revision to work also with non-workshared cloud models:\n\n<pre class=\"code\">\n<span style=\"color:blue;\">string</span>&nbsp;GetCloudModelLocalCacheFilepath(&nbsp;\n&nbsp;&nbsp;Document&nbsp;doc,&nbsp;\n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;version_number&nbsp;)\n{\n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;title&nbsp;=&nbsp;doc.Title;\n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;ext&nbsp;=&nbsp;Path.GetExtension(&nbsp;doc.PathName&nbsp;);\n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;localRevitFile&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;doc.IsModelInCloud&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;ModelPath&nbsp;modelPath&nbsp;=&nbsp;doc.GetCloudModelPath();\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;guid&nbsp;=&nbsp;modelPath.GetModelGUID().ToString();\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;folder&nbsp;=&nbsp;<span style=\"color:#a31515;\">&quot;C:\\\\Users\\\\&quot;</span>&nbsp;+&nbsp;Environment.UserName&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;\\\\AppData\\\\Local\\\\Autodesk\\\\Revit\\\\Autodesk&nbsp;Revit&nbsp;&quot;</span>&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;version_number&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;\\\\CollaborationCache&quot;</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;revitFile&nbsp;=&nbsp;guid&nbsp;+&nbsp;ext;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>[]&nbsp;files&nbsp;=&nbsp;Directory\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.GetFiles(&nbsp;folder,&nbsp;revitFile,&nbsp;SearchOption.AllDirectories&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Where(&nbsp;c&nbsp;=&gt;&nbsp;!c.Contains(&nbsp;<span style=\"color:#a31515;\">&quot;CentralCache&quot;</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ToArray();\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;0&nbsp;&lt;&nbsp;files.Length&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localRevitFile&nbsp;=&nbsp;files[&nbsp;0&nbsp;];\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print(&nbsp;<span style=\"color:#a31515;\">&quot;Unable&nbsp;to&nbsp;find&nbsp;local&nbsp;rvt&nbsp;for:&nbsp;&quot;</span>&nbsp;+&nbsp;doc.PathName&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">else</span>\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;localRevitFile&nbsp;=&nbsp;doc.PathName;\n&nbsp;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;localRevitFile;\n}\n</pre>\n\n> The key is to use `modelPath.GetModelGUID` rather than `doc.WorksharingCentralGUID`\n&ndash; thanks @jeremy.tammik for pointing out this function to me (apparently it has been there since 2019.1)...\n\nMany thanks to Simon for sharing this.\n\nI added it\nto [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples) to\nmake it easy to keep track of, cf.\nthe [diff to the previous release](https://github.com/jeremytammik/the_building_coder_samples/compare/2022.0.150.5...2022.0.150.6)."
  },
  {
    "original_filename": "1905_line_angle_dir_jig",
    "header_text": "How to Refresh GroupType.Groups",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> How to Refresh GroupType.Groups\n\nThe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\nasking [why `GroupType.Groups` contains ungrouped groups](https://forums.autodesk.com/t5/revit-api-forum/why-does-grouptype-groups-contain-ungrouped-groups/m-p/10291256) demonstrates\nanother example of\nthe [need to regenerate](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.33)\nand shows that sometimes more than just regenerating the model is required to avoid accessing stale data.\nCommitting the transaction is the next level up after regeneration:\n\n**Question:** The following code prints the same number twice:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;groupType&nbsp;=&nbsp;group.GroupType;\n&nbsp;&nbsp;Debug.Print(&nbsp;groupType.Groups.Size.ToString()&nbsp;);\n&nbsp;&nbsp;group.UngroupMembers();\n&nbsp;&nbsp;Debug.Print(&nbsp;groupType.Groups.Size.ToString()&nbsp;);\n</pre> \n\nIs this the correct behaviour?\n\nWhat do I need to do to make sure groupType.Groups always returns the correct GroupSet?\n\nI tried calling `Regenerate` and that doesn't help.\n\nIt looks like I need to end and restart the transaction.\n\nThis code shows that GroupType.Groups still reports the ungrouped group after doc.Regenerate() and finally disappears after committing and restarting a new transaction. I tried to get a new reference to the GroupType, hoping that avoiding some caching would help, but it didn't:\n\n<pre class=\"code\">\n&nbsp;&nbsp;tx.Start(&nbsp;<span style=\"color:#a31515;\">&quot;Test&nbsp;1&quot;</span>&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;elementIds&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;List&lt;ElementId&gt;\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;Utils.CreateModelLine(<span style=\"color:blue;\">new</span>&nbsp;XYZ(0,&nbsp;0,&nbsp;0),&nbsp;<span style=\"color:blue;\">new</span>&nbsp;XYZ(1,&nbsp;0,&nbsp;0),&nbsp;doc).Id,\n&nbsp;&nbsp;&nbsp;&nbsp;Utils.CreateModelLine(<span style=\"color:blue;\">new</span>&nbsp;XYZ(0,&nbsp;1,&nbsp;0),&nbsp;<span style=\"color:blue;\">new</span>&nbsp;XYZ(1,&nbsp;1,&nbsp;0),&nbsp;doc).Id,\n&nbsp;&nbsp;&nbsp;&nbsp;Utils.CreateModelLine(<span style=\"color:blue;\">new</span>&nbsp;XYZ(0,&nbsp;2,&nbsp;0),&nbsp;<span style=\"color:blue;\">new</span>&nbsp;XYZ(1,&nbsp;2,&nbsp;0),&nbsp;doc).Id,\n&nbsp;&nbsp;};\n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;group1&nbsp;=&nbsp;doc.Create.NewGroup(&nbsp;elementIds&nbsp;);\n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;group2&nbsp;=&nbsp;doc.Create.PlaceGroup(&nbsp;<span style=\"color:blue;\">new</span>&nbsp;XYZ(&nbsp;0,&nbsp;5,&nbsp;0&nbsp;),&nbsp;group1.GroupType&nbsp;);\n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;group3&nbsp;=&nbsp;doc.Create.PlaceGroup(&nbsp;<span style=\"color:blue;\">new</span>&nbsp;XYZ(&nbsp;0,&nbsp;10,&nbsp;0&nbsp;),&nbsp;group1.GroupType&nbsp;);\n&nbsp;&nbsp;Debug.Print(&nbsp;group1.GroupType.Groups.Size.ToString()&nbsp;);\n \n&nbsp;&nbsp;group2.UngroupMembers();\n&nbsp;&nbsp;Debug.Print(&nbsp;group1.GroupType.Groups.Size.ToString()&nbsp;);\n \n&nbsp;&nbsp;doc.Regenerate();\n&nbsp;&nbsp;Debug.Print(&nbsp;group1.GroupType.Groups.Size.ToString()&nbsp;);\n \n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;groupType&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;FilteredElementCollector(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;GroupType&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;GroupType&gt;()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.FirstOrDefault(&nbsp;gt&nbsp;=&gt;&nbsp;gt.Name&nbsp;==&nbsp;group1.GroupType.Name&nbsp;);\n&nbsp;&nbsp;Debug.Print(&nbsp;groupType.Groups.Size.ToString()&nbsp;);\n \n&nbsp;&nbsp;tx.Commit();\n \n&nbsp;&nbsp;tx.Start(&nbsp;<span style=\"color:#a31515;\">&quot;Test&nbsp;2&quot;</span>&nbsp;);\n \n&nbsp;&nbsp;Debug.Print(&nbsp;groupType.Groups.Size.ToString()&nbsp;);\n&nbsp;&nbsp;groupType&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;FilteredElementCollector(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;GroupType&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;GroupType&gt;()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.FirstOrDefault(&nbsp;gt&nbsp;=&gt;&nbsp;gt.Name&nbsp;==&nbsp;group1.GroupType.Name&nbsp;);\n&nbsp;&nbsp;Debug.Print(&nbsp;groupType.Groups.Size.ToString()&nbsp;);\n \n&nbsp;&nbsp;tx.Commit();\n</pre>\n\nI tried using a subtransaction, but that didn't help.\n\nAt this point I do have a workaround, but I don't like to create transactions only because I can't rely on GroupType.Groups not reporting ungrouped groups.\n\nAny advice?\n\n**Answer:** Just firing off the top of my head here but... instead of transactions and subtransactions, you might try a transaction group with transactions within it... works just a little differently and perhaps that difference will be a little cleaner in the end...\n\n**Response:** Using a transaction group seem to be the best workaround. Here are the steps:\n\n- transactionGroup.Start\n- transaction.Start\n- group.UngroupMemebers\n- group.GroupType.Groups still contains the ungrouped group\n- transaction.Commit\n- group.GroupType.Groups does not contain the ungrouped group\n\nUnfortunately, such a workaround cannot be used in a generic case.\nWrapping the call to `UngroupMembers` inside its own transaction only because any following `groupType.Groups` would return the wrong result is ugly, because it forces the caller to use a transaction group rather than a transaction.\n\n**Answer:** I recently had a somewhat similar problem (working w/ completely different objects though). It seems like in some cases the value returned by a Revit API object's property or method is always the same as when it was first obtained from the API, even after regenerating the model. To resolve this in my case I had to obtain a new copy of the object from the API after regenerating the model (e.g., myElement = myDocument.GetElement(myElementId);). I don't know if this will help in your situation, but I hope it does.\n\n**Response:** Thanks for the advice.\nI just tried and in this stale case the cached info sticks around even after getting a new element.\nAdding these two lines before closing the transaction to my code, still return the wrong value:\n\n<pre class=\"code\">\n&nbsp;&nbsp;group1&nbsp;=&nbsp;doc.GetElement(&nbsp;group1.Id&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;Group;\n&nbsp;&nbsp;Debug.Print(&nbsp;groupType.Groups.Size.ToString()&nbsp;);\n \n&nbsp;&nbsp;groupType&nbsp;=&nbsp;doc.GetElement(&nbsp;group1.GroupType.Id&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;GroupType;\n&nbsp;&nbsp;Debug.Print(&nbsp;groupType.Groups.Size.ToString()&nbsp;);\n</pre>"
  },
  {
    "original_filename": "1905_line_angle_dir_jig",
    "header_text": "Online Access to RevitAPI.chm Help Files",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Online Access to RevitAPI.chm Help Files\n\nGuy Talarico set up a repository sharing the RevitAPI.chm Windows help file provided by the Revit SDK for all Revit API releases reaching back to Revit 2012.\n\nThese files are used to generate the online Revit API documentation\nresources [revitapidocs.com](https://www.revitapidocs.com/)\nand [apidocs.co](https://apidocs.co/) that\nprovide web presentations of the same content.\n\nDue to the growing size of the CHM files, we were forced to turn on\nthe [Git Large File Storage (LFS)](https://git-lfs.github.com/) and move the repository to a new location in the ADN-DevTech organisation\nat [github.com/ADN-DevTech/revit-api-chms](https://github.com/ADN-DevTech/revit-api-chms)."
  },
  {
    "original_filename": "1905_line_angle_dir_jig",
    "header_text": "C++/C&#35; Frontend Engineer",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> C++/C&#35; Frontend Engineer\n\nFriend and colleague Carlo asked me to point out\na [career opportunity for a C++/C&#35; frontend engineer](https://www.comeet.com/jobs/knauf/56.004/cc-frontend-engineer-mfd/9F.D1F) with\nKnauf in Germany to develop and deliver solutions for CAD programs, e.g., Revit and ArchiCAD, mixing native SDK technologies in C++, .NET and web views."
  }
]