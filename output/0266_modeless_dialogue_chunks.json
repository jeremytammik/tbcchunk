[
  {
    "original_filename": "0266_modeless_dialogue",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0266_modeless_dialogue",
    "header_text": "Modeless Dialogues in Revit",
    "local_header_href": "#modeless-dialogues-in-revit",
    "chunk_text": "<h3>Modeless Dialogues in Revit</h3><p>Here is an overview and summary of a number of discussions that we have already presented previously on driving Revit from outside and interacting with modeless dialogues, which hopefully will help to further clarify the issues involved.\n\n<p><strong>Question:</strong> How can I use a modeless dialogue in Revit?\n\n<p>I need to display a modeless dialogue in Revit.\nOn clicking a button in it, an element should be added to the Revit model. \nThe button can be clicked multiple times and elements should keep on being adding to Revit without closing the dialogue.\n\n<p>How can I programmatically move focus to the Revit application?\n\n<p>Finally, can you please provide some trusted sites for Revit programming tips and examples other than the Autodesk discussion groups?\n\n<p><strong>Answer:</strong> In principle, using a modeless dialogue box within Revit is a non-issue. Any external command can launch a modeless dialogue box, and the dialogue box can make use of the Revit API in any way it chooses â€“ as long as the external command that launched it has not yet terminated.\n\n<p>From your description, it sounds as if this is the case in your situation, which is good for you and highly recommended.\n\n<p>An example of a modeless dialogue box that remains active only as long as the external command which launched it and makes full use of the Revit API within this context is provided by Joel Karr's\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/10/modeless-pressure-drop-tool.html\">\nmodeless pressure drop tool</a>.\n\nIt also shows how to obtain the Revit window handle, which you can use to set focus to the Revit application.\n\n<p>You should be able to design the command you describe along the same lines as that tool. \nJust keep the external command running as long as your dialogue is active, and all will be fine.\n\n<p>In some cases, however, one would like to launch a dialogue box which remains active even after the external command that launched it has terminated. \nThis is a completely different issue and may be problematic. \nWhy? Because when Revit invokes an external command, it automatically opens a transaction for it. \nWhen you are not within the context of an external command invoked by Revit, you need to \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/01/transactions.html\">\nmanage your own transaction</a>.\n\n<p>The return code from an external command determines how the automatically generated transaction is terminated, and one effect of this is the setting of the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/12/document-ismodified-property.html\">\nIsModified document dirty flag</a>.\n\n<p>To summarise, if you are working in a modeless dialogue box invoked by an external command which is still active, you have full access to Revit and can use the API to its full extent. \n\n<p>If you are in some other context, i.e. a modeless dialogue that was not invoked by a command, or the command has already terminated, you cannot make full use of the API and there is no guarantee that you can interact with Revit at all. Basically, you are trying to \n\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/12/driving-revit-from-outside.html\">\ndrive Revit from outside</a>.\n\n<p>Our recent discussion on \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/12/au-and-automated-testing.html\">\nautomated testing</a>\n\nlinks to that discussion and additional related posts.\n\n<p>I hope this fully explains the situation.\n\n<p>Regarding the trusted sites, I personally put my trust and effort into \n\n<a href=\"http://thebuildingcoder.typepad.com\">\nThe Building Coder</a>.\n\nWe recently presented an overview of additional \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/10/revit-api-forums.html\">\nforums dealing with the Revit API</a>.\n\nI cannot say that any of these except the \n\n<a href=\"http://www.autodesk.com/joinadn\">\nAutodesk Developer Network</a> ADN \n\nare especially trusted or specifically endorsed in any way. \nThe others are simply sources of information and places to mutually exchange experience, as always, with no guarantees whatsoever given. \n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  }
]