[
  {
    "original_filename": "0302_ifamilyloadoptions",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0302_ifamilyloadoptions",
    "header_text": "IFamilyLoadOptions and GEMini",
    "local_header_href": "#ifamilyloadoptions-and-gemini",
    "chunk_text": "<h3>IFamilyLoadOptions and GEMini</h3><p>First of all, a new lunar year is beginning, and with it the year of the tiger. Happy Chinese New Year to all!</p><center>\n<img alt=\"Year of the tiger\" src=\"img/year_of_the_tiger_3.png\"/>\n</center><p>We discussed the new\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html\">\nRevit Family API</a> in\n\nsome depth and presented\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/10/revit-family-creation-api-labs.html\">\nlabs</a> to\n\nhelp start making efficient use of it.\nOne issue in the context of families and the loading of families remained unresolved, however, and we have some questions on this from\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/10/revit-2010-subscription-pack.html?cid=6a00e553e1689788330120a67a6b82970c#comment-6a00e553e1689788330120a67a6b82970c\">\nPrasad</a> and\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/08/the-revit-family-api.html?cid=6a00e553e16897883301287655e694970c#comment-6a00e553e16897883301287655e694970c\">\nLars RÃ¥dman</a> that\n\nstill remain unanswered, namely on how to use the IFamilyLoadOptions interface.\nSo far nobody was actually able to provide a working example.\n\n<p>Now Gamal Kira of\n\n<a href=\"http://www.team-solutions.de\">\nGEM Team Solutions</a>\n\nsolved this problem and very friendlily provided a sample application illustrating the solution.\n\n<p>The IFamilyLoadOptions interface defines call-back functionality for specific family load situations through the two events OnFamilyFound and OnSharedFamilyFound, called when a family or a shared family being loaded was already present in the target document, respectively.\n\n<p>They both take an output argument in which the event handler has the opportunity to specify whether the existing family's parameter values should be overwritten.\n\n<p>Unfortunately, this does not currently work the way one might expect. Once a family has been loaded into the project, it will not be reloaded later, even if it was modified, and attempting to use this event handler throws an exception.\n\n<p>One would mostly want a family to be reloaded if it has been edited, even if it is already loaded.\n\n<p>The trick to this that Gamal has uncovered is to call the LoadFamily method outside of a command context.\nNormally, the Revit API is only usable within the command context, although read-only access sometimes also works outside of it, e.g. when called from a modeless dialogue.\nThis is the first example that I know of where some functionality actually requires a non-command context.\n\n<p>Here is what Gamal has to say about his example solution:\n\n<p>I isolated the ILoadOptions solution in a separate project\n\n<a href=\"zip/RevitTest.zip\">\nRevitTest</a>.\n\n<h4>Installation and GEMini</h4>\n\nTo test, register the command in Revit.ini in the normal fashion.\nIf you like, you can use our GEMini.exe registration tool, which is included.\nIt works through an XML configuration file.\nSimply adapt the path specified in the batch file Setup-Debug-RevitIni.bat and run it.\nIf you are interested in the source for GEMini, please feel free to ask.\nIt works with all versions of Revit, including 64-bit and 32-bit ones running on a 64-bit system.\n\n<h4>IFamilyLoadOptions and RevitTest</h4>\n<p>The external command GEM RevitTest displays a dialogue box to initiate the LoadFamily call.\nThis dialogue can be displayed either as a modal or modeless form.\nFrom the form, LoadFamily can be called either with or without the IFamilyLoadOptions call-backs installed.\nWhen modal, the LoadFamily operation is executed within the command context, whereas the modeless dialogue executes it outside of the command context.\nThe call to LoadFamily always throws an exception when called within the command context, regardless of whether the IFamilyLoadOptions call-backs are installed or not.\nFrom the modeless version, the IFamilyLoadOptions call-back works.</p>\n<!--\n<p>Modal without ILoadOptions throws an exception:\n\n<center>\n<img src=\"img/iloadoptions_exception_modal_1.png\" alt=\"Modal without ILoadOptions\"/>\n</center>\n\n<p>Modal with ILoadOptions does not.\n\n<p>Gamal also provided a utility name GEMini.exe for registering Revit add-in applications in the Revit.ini file.\nPlease raise our hand if you are interested in the source code of this utility.\n-->\n<p>Very many thanks to Gamal for all his research and for providing this valuable sample!</p>\n<center>\n<img alt=\"Year of the tiger\" src=\"img/year_of_the_tiger_1.png\"/>\n<img alt=\"Year of the tiger\" src=\"img/year_of_the_tiger_2.png\"/>\n</center>\n</p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0302_ifamilyloadoptions",
    "header_text": "Installation and GEMini",
    "local_header_href": "#installation-and-gemini",
    "chunk_text": "<h4>Installation and GEMini</h4>"
  },
  {
    "original_filename": "0302_ifamilyloadoptions",
    "header_text": "IFamilyLoadOptions and RevitTest",
    "local_header_href": "#ifamilyloadoptions-and-revittest",
    "chunk_text": "<h4>IFamilyLoadOptions and RevitTest</h4><p>The external command GEM RevitTest displays a dialogue box to initiate the LoadFamily call.\nThis dialogue can be displayed either as a modal or modeless form.\nFrom the form, LoadFamily can be called either with or without the IFamilyLoadOptions call-backs installed.\nWhen modal, the LoadFamily operation is executed within the command context, whereas the modeless dialogue executes it outside of the command context.\nThe call to LoadFamily always throws an exception when called within the command context, regardless of whether the IFamilyLoadOptions call-backs are installed or not.\nFrom the modeless version, the IFamilyLoadOptions call-back works.</p><p>Very many thanks to Gamal for all his research and for providing this valuable sample!</p><center>\n<img alt=\"Year of the tiger\" src=\"img/year_of_the_tiger_1.png\"/>\n<img alt=\"Year of the tiger\" src=\"img/year_of_the_tiger_2.png\"/>\n</center>"
  }
]