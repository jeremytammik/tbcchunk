[
  {
    "original_filename": "1938_utils_stirrups",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- another utility to keep in mind:\n  Use `ParameterFilterUtilities` to\n  Get all possible FilterRule parameters\n  https://forums.autodesk.com/t5/revit-api-forum/get-all-possible-filterrule-parameters/m-p/10936268\n\n- Constraining Stirrups to the Cover of the Host Element\n  https://forums.autodesk.com/t5/revit-api-forum/problem-with-constraining-stirrups-to-the-cover-of-the-host/td-p/10045899\n\n- zero energy house https://www.edx.org/course/zero-energy-design-an-approach-to-make-your-buildi?hs_analytics_source=referrals&utm_source=mooc.org&utm_medium=referral&utm_campaign=mooc.org-course-list\nTUDelft rowers 220 W continuous power, 330 peak; a match or candle flame provides about 100 W; to a water heater to provide 10 kW, you can see an array of 10 x 10 = 100 gas flames, where 100 x 100 W = 10 kW.\n\n- Zero-Energy Design: an approach to make your building sustainable\n  /j/doc/book/zero_energy_design_sustainable_building/zed.txt\n\ntwitter:\n\nParameterFilterUtilities, constraining rebar stirrup to host cover, power, energy, entropy and information in the #RevitAPI FormulaManager @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon https://autode.sk/parameterfilterutilities\n\nTaking a look at yet another overlooked Revit API utility class, rebar constraints, and learning basics of power, energy, entropy and information\n&ndash; ParameterFilterUtilities\n&ndash; Constrain stirrup to host cover\n&ndash; Rowers illustrate power and building energy\n&ndash; Wordle entropy and information...\n\nlinkedin:\n\nParameterFilterUtilities, constraining rebar stirrup to host cover in the #RevitAPI\n\nhttps://autode.sk/parameterfilterutilities\n\nTaking a look at yet another overlooked Revit API utility class, rebar constraints, and learning basics of power, energy, entropy and information:\n\n- ParameterFilterUtilities\n- Constrain stirrup to host cover\n- Rowers illustrate power and building energy\n- Wordle entropy and information...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1938_utils_stirrups",
    "header_text": "Utility Classes and Constraining Stirrups",
    "local_header_href": "#utility-classes-and-constraining-stirrups",
    "chunk_text": "### Utility Classes and Constraining Stirrups\n\nTaking a look at\nyet another [overlooked Revit API utility class](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5,52),\nrebar constraints, and learning basics of power, energy, entropy and information:\n\n- [ParameterFilterUtilities](#2)\n- [Constrain stirrup to host cover](#3)\n- [Rowers illustrate power and building energy](#4)\n- [Wordle entropy and information](#5)"
  },
  {
    "original_filename": "1938_utils_stirrups",
    "header_text": "ParameterFilterUtilities",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> ParameterFilterUtilities\n\nAnother example of the useful functionality provided by\nthe [Revit API `*Utils` classes that are often overlooked](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.52) was\nhighlighted by Samuel Kreuz' question and answer in the thread on using `ParameterFilterUtilities`\nto [get all possible `FilterRule` parameters](https://forums.autodesk.com/t5/revit-api-forum/get-all-possible-filterrule-parameters/m-p/10936268):\n\n**Question:** I would like to list all possible `ViewFilter` parameters for a given category, e.g., for the category `Walls` the parameters shown in this screenshot:\n\n<center>\n<img src=\"img/filter_rule_valid_params_for_wall.jpg\" alt=\"Valid ViewFilter parameters\" title=\"Valid ViewFilter parameters\" width=\"800\"/> <!-- 1394 -->\n</center>\n\nIt seems like these are combinations of Project Parameters, Type Parameters and Instance Parameters.\nHow to retrieve all parameters allowed for creating a filter rule?\nOr at least a way to check if a parameter is valid for creating a filter rule?\n\n**Answer:** Take a look at the `ParameterFilterUtilities` class, specifically\nthe [GetFilterableParametersInCommon method](https://www.revitapidocs.com/2022/7ea624c7-2c0d-c9bb-3b2c-1ac798cf6606.htm).\n\n**Response:** This is exactly what I am looking for!\nI wasn't aware of the `ParameterFilterUtilities` until now.\nThey seem to have some really useful methods for working with ViewFilters.\nThis is how I checked for valid parameters for the category is `Walls`:\n\n<pre class=\"code\">\n&nbsp;&nbsp;List&lt;<span style=\"color:blue;\">string</span>&gt;&nbsp;<span style=\"color:#1f377f;\">parameterNames</span>&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;List&lt;<span style=\"color:blue;\">string</span>&gt;();\n&nbsp;&nbsp;IList&lt;ElementId&gt;&nbsp;<span style=\"color:#1f377f;\">wallCatList</span>&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;List&lt;ElementId&gt;()&nbsp;\n&nbsp;&nbsp;{&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">new</span>&nbsp;ElementId(BuiltInCategory.OST_Walls)&nbsp;\n&nbsp;&nbsp;};\n \n&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;<span style=\"color:#1f377f;\">paramColl</span>&nbsp;=&nbsp;ParameterFilterUtilities\n&nbsp;&nbsp;&nbsp;&nbsp;.GetFilterableParametersInCommon(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc,&nbsp;wallCatList);\n \n&nbsp;&nbsp;<span style=\"color:#8f08c4;\">foreach</span>&nbsp;(ElementId&nbsp;<span style=\"color:#1f377f;\">param</span>&nbsp;<span style=\"color:#8f08c4;\">in</span>&nbsp;paramColl)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;BuiltInParameter&nbsp;<span style=\"color:#1f377f;\">bip</span>&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(BuiltInParameter)&nbsp;param.IntegerValue;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;<span style=\"color:#1f377f;\">label</span>&nbsp;=&nbsp;LabelUtils.GetLabelFor(bip);\n&nbsp;&nbsp;&nbsp;&nbsp;parameterNames.Add(label);\n&nbsp;&nbsp;}\n \n&nbsp;&nbsp;parameterNames.Sort();\n&nbsp;&nbsp;StringBuilder&nbsp;<span style=\"color:#1f377f;\">sb</span>&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;StringBuilder();\n&nbsp;&nbsp;parameterNames.ForEach(<span style=\"color:#1f377f;\">e</span>&nbsp;=&gt;&nbsp;sb.Append(e&nbsp;+&nbsp;<span style=\"color:#a31515;\">&quot;\\r\\n&quot;</span>));\n&nbsp;&nbsp;TaskDialog.Show(<span style=\"color:#a31515;\">&quot;Filtered&nbsp;Parameters&quot;</span>,&nbsp;sb.ToString());\n</pre>\n\nThe result includes all built-in parameters that can be used for filtering:\n\n<center>\n<img src=\"img/GetFilterableParameters.jpg\" alt=\"GetFilterableParameters\" title=\"GetFilterableParameters\" width=\"600\"/> <!-- 673 -->\n</center>\n\nMany thanks to Samuel for raising this question and confirming the solution!"
  },
  {
    "original_filename": "1938_utils_stirrups",
    "header_text": "Constrain Stirrup to Host Cover",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Constrain Stirrup to Host Cover\n\nI had a fruitful conversation with Kevin Richard Anggrek a year ago\non [implementing valid rebar stirrup constraints](https://thebuildingcoder.typepad.com/blog/2021/03/boundary-elements-and-stirrup-constraints.html#2).\n\nKevin now very kindly summarised some further advice and aspects in this area answering a new request in his thread \non [constraining stirrups to the cover of the host element](https://forums.autodesk.com/t5/revit-api-forum/problem-with-constraining-stirrups-to-the-cover-of-the-host/td-p/10045899).\nIt would be a great shame to let his nice explanation languish unnoticed for all but a select few in the forum thread.\nI hope we can bring it to light to receive the attention it deserves here:\n\n**Question:** I too am stuck constraining stirrups and raised a question\non [rebar location controlling](https://forums.autodesk.com/t5/revit-api-forum/rebar-location-controlling/m-p/10903636);\ncan you compare with `RebarConstraint.GetDistanceToTargetCover`?\n\n**Answer:** I will try to explain how I constrain the stirrups to the concrete cover.\n\nFirst, I use the `CreateFromRebarShape` method to create an initial stirrup by using a template rebar shape that is provided by Revit.\nAs you probably have noticed, the initial stirrup follows the size of the template rebar shape, and we need to constrain it down to the appropriate size that matches the size of our concrete element.\n\nSo, the next thing that we need to do is to call the `RebarConstraintManager` of the particular initial stirrup in order to access and modify the rebar constraints of the initial stirrup.\n\nBy using the RebarConstraintManager, I would first collect all of the handles of the stirrup by using the `GetAllHandles` Method and store them in a list or array. Handles are those interaction points located on the rebar element that one normally uses when trying to modify the shape or size of the rebar through the user interface of Revit.\n\nThe logic here is that I would like to move the handles of the stirrup, especially the handles at the legs of the stirrup, so that they can be placed or constrained to the correct concrete cover of our current beam/column element, thus we can obtain the correct stirrup size.\n\nSo, the next thing we should do is to iterate through all of the handle in the list of handles that we obtained previously.\nFor each handle, find all of the constraint candidates that are of the type `ToCover` using the `GetConstraintCandidatesForHandle` method.\nRebar handles can be constrained to a lot of things, but what we want here are the ToCover constraints, because we want to constraint a particular handle to the concrete cover.\nYou can imagine each ToCover constraint as a representation of the handles' constraint to a concrete cover.\nBy following this method, a single handle will detect several ToCover constraints.\nNow, imagine that you are editing a rebar handle of one stirrup leg; notice that a rectangular column would have eight concrete covers that the leg handle can be constrained to.\nHowever, the leg handle shall only be constrained to the correct concrete cover, which in this case is the cover that is closest to the particular leg handle.\nThis is where the `GetDistanceToTargetCover` plays a role.\n\nBefore we get into that, there is something that you need to be careful of: when trying to find all of the ToCover constraints of a particular handle, Revit API will also detect not only the concrete cover of a particular concrete element, but also all of the ToCover constraints of other concrete elements in the periphery of the stirrup.\nTherefore, it is necessary that you first make sure that the ToCover constraint that you are targeting is the same as the concrete element that you will use as the host of your stirrup.\nIn my case, I first checked for the ElementId of the target element of the ToCover constraint and compared it with the ElementId of my host concrete element.\nIf you are not careful, your handle will end up getting constrained to the cover of some other adjacent concrete element instead of the intended concrete element.\n\nAfter you have cleared that, we can safely move on to find the nearest ToCover constraint that we are going to constrain our handle to.\nI used the GetDistanceToTargetCover() method; this method finds the distance between the current ToCover constraint of the handle to the target cover.\nThen, find the one with absolute minimum distance.\nWhen I say absolute, I mean that you first need to find the absolute value of the distance before comparing it to the other distance to find the actual minimum distance.\nThis was actually my issue before, where the handle won't be constrained to the nearest cover.\nTurns out, my code previously compared non-absolute values.\nAfter I debugged the code, I noticed something like: the distance to the nearest cover was 10, but the distance to the farthest cover was -400; if we compare non-absolute values, -400 is less than 10, but the absolute value is the true indicator of the distance to the cover.\nSo, if we compare the absolute values, it is obvious that 400 is greater than 10.\n\nAfter we find the nearest cover constraint to the handle, we can go ahead and move the constraint of the handle to the cover itself using the `SetDistanceToTargetCover` method and setting the distance as 0.\nAfter the constraint of the handle has been moved to its cover, we can go ahead and set the constraint as the preferred constraint for the handle by using the `SetPreferredConstraintForHandle` method; this will set the constraint that we just moved to the cover as the preferred constraint that the handle will use.\nAt the end, this will move the handle to the cover.\n\nMany thanks to Kevin for this extremely helpful explanation!\nHappy New Year of the Tiger to you!"
  },
  {
    "original_filename": "1938_utils_stirrups",
    "header_text": "Rowers Illustrate Power and Building Energy",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Rowers Illustrate Power and Building Energy\n\nThe [TUDelft](https://www.tudelft.nl) created \na [MOOC](https://en.wikipedia.org/wiki/Massive_open_online_course)\nabout [Zero-Energy Design: an approach to make your building sustainable](https://www.edx.org/course/zero-energy-design-an-approach-to-make-your-buildi),\nteaching how to get to a net zero energy use of an existing building.\n\nI love the eight-minute course introduction video, \n[Energy Slaves. Intro to MOOC: Zero-Energy Design: an approach to make your building sustainable](https://youtu.be/Jo5W6y0_Tkk):\n\n<center>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/Jo5W6y0_Tkk\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</center>\n\nIt illustrates the energy used by a house and their occupants by simulating it being supplied by human rowers.\nAn average rower produces ca. 220 W and continuous power, 330 W peak.\n\nBy the way, another interesting fact about energy and power: a match or candle flame provides about 100 W; so does a human body at rest; that is enough to heat a cup of tea, coffee, or water; for a hot shower, a water heater needs to provide about 10 kW; some have an array of 10 x 10 = 100 gas flames, producing 100 x 100 W = 10 kW of heat."
  },
  {
    "original_filename": "1938_utils_stirrups",
    "header_text": "Wordle Entropy and Information",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Wordle Entropy and Information\n\nOn YouTube, I also stumbled across a very interesting and illuminating half-hour explanation\non how to [solve Wordle using information theory](https://youtu.be/v68zYyaEmEA)..."
  }
]