[
  {
    "original_filename": "1683_zero_doc_ribbon",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<!--\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n</head>\n\n<!---\n\n- loading support DLLs\n  Jim Jia suggested using an assembly resolver by reracting to the `AppDomain.CurrentDomain.AssemblyResolve` event\n  https://forums.autodesk.com/t5/revit-api-forum/missing-system-componentmodel-annotations-v4-2-0-0/m-p/8255546\n  [Revit Add-in Unit Testing](http://thebuildingcoder.typepad.com/blog/2013/07/revit-add-in-unit-testing.html)\n  [Security, Framing Cross Section Analyser and REX](http://thebuildingcoder.typepad.com/blog/2013/12/security-framing-cross-section-analyser-and-rex.html)\n  [RvtVa3c Assembly Resolver](http://thebuildingcoder.typepad.com/blog/2014/05/rvtva3c-assembly-resolver.html)\n  [Framing Cross Section Analyser and REX in Revit 2015](http://thebuildingcoder.typepad.com/blog/2015/03/framing-cross-section-analyser-and-rex-in-revit-2015.html)\n  [REX Add-In Development and Migration](http://thebuildingcoder.typepad.com/blog/2015/12/rex-app-development-and-migration.html)\n  [Add-In Templates Supporting Edit and Continue](http://thebuildingcoder.typepad.com/blog/2017/02/add-in-templates-supporting-edit-and-continue.html)\n\n- Please help tweeting about Boston Accelerator – deadline for proposals Sept. 15th.\n  You may reference https://forums.autodesk.com/t5/bim-360-api-forum/forge-accelerator-boston-ma-october-1-5-2018/td-p/8249266\n  Images attached.\n  Natalia Polikarpova Re: Please tweet about Boston Accelerator\n\nSupport DLL, Zero Doc State and Forge Accelerators #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/zerodoc2019\n\nIf you are interested in Forge programming, don't miss the upcoming deadline for proposals for the Boston Forge accelerator!\nLooking at the Revit API, I migrated my sample demonstrating how\nto enable ribbon items in zero document state to Revit 2019.\nLet's look at that, and another recurring topic, on loading add-in support DLLs\n&ndash; Migrating the ZeroDocPanel to Revit 2019\n&ndash; Loading add-in support DLLs\n&ndash; Rome and Boston Forge accelerators...\n\n-->"
  },
  {
    "original_filename": "1683_zero_doc_ribbon",
    "header_text": "Support DLL, Zero Doc State and Forge Accelerators",
    "local_header_href": "#support-dll-zero-doc-state-and-forge-accelerators",
    "chunk_text": "### Support DLL, Zero Doc State and Forge Accelerators\n\nIf you are interested in diving deep into Forge programming, don't miss the upcoming deadline for proposals for the Boston Forge accelerator!\n\nLooking at the Revit API, I implemented a sample demonstrating how\nto [enable ribbon items in zero document state](http://thebuildingcoder.typepad.com/blog/2011/02/enable-ribbon-items-in-zero-document-state.html) back\nin 2011, for Revit 2011.\n\nHow long would it take to port such an add-in to Revit 2019?\n\nWell, this one took ten or twenty minutes, including some debugging, screen snapshots, and documentation.\n\nAdmittedly, it is an absolutely trivial example  :-)\n\nLet's look at that, and another recurring topic, on loading add-in support DLLs:\n\n- [Migrating the ZeroDocPanel to Revit 2019](#2) \n- [Loading add-in support DLLs](#3) \n- [Rome and Boston Forge accelerators](#4) \n\n<center>\n<img src=\"img/zero_doc_button_2019.png\" alt=\"External command in zero document state\" width=\"468\">\n</center>"
  },
  {
    "original_filename": "1683_zero_doc_ribbon",
    "header_text": "<a name=\"2\"></a> Migrating the ZeroDocPanel to Revit 2019",
    "local_header_href": "#a-name2a-migrating-the-zerodocpanel-to-revit-2019",
    "chunk_text": "#### <a name=\"2\"></a> Migrating the ZeroDocPanel to Revit 2019\n\nJohn raised an issue in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [`IsCommandAvailable` causing a nullref exception](https://forums.autodesk.com/t5/revit-api-forum/iscommandavailable-causes-nullref-exception/m-p/8258750).\n\nThat prompted me to update my original implementation\nto [enable ribbon items in zero document state](http://thebuildingcoder.typepad.com/blog/2011/02/enable-ribbon-items-in-zero-document-state.html) in\nRevit 2011 and test it in Revit 2019.\n\nI performed the flat migration from Revit 2011 to Revit 2019, i.e., updated the Revit API assembly references and set the .NET framework to version 4.7.\n\nNext, I tried to load and debug the add-in.\n\nRevit displayed an error due to a lack of the `VendorId` tag in the add-in manifest:\n\n> External Tools – No VendorId Node for Add-in\n\n> Failed to initialize the add-in “ZeroDocPanel.addin” because the add-in registration is missing the required value of VendorId node. The VendorId node identify the vendor of the add-in application. For Revit to run the add-in, you must register the node defined in manifest “ZeroDocPanel.addin” file.\n\n<center>\n<img src=\"img/no_vendorid_node.png\" alt=\"VendorId node missing in add-in manifest\" width=\"370\">\n</center>\n\nThe `VendorId` node had not yet been invented in 2011 &nbsp; :-)\n\nI added the vendor id, and all was well.\n\nI debugged the add-in and ensured that the `OnStartup` and `IsCommandAvailable` methods are both called just as expected.\n\nThe external command is listed and can be executed in the external tools menu in zero document state, cf. the screen snapshot above.\n\nThe command execution displays its little task dialogue:\n\n<center>\n<img src=\"img/zero_doc_cmd_msg_2019.png\" alt=\"Zero document state external command displaying a task dialogue\" width=\"373\">\n</center>\n\nThe complete add-in sample including Visual Studio project,  source code and add-in manifest now lives in its\nown [ZeroDocPanel GitHub repository](https://github.com/jeremytammik/ZeroDocPanel).\n\nHere are [all the commits I made for the migration](https://github.com/jeremytammik/ZeroDocPanel/commits/master):\n\n- Initial commit from original blog post\n- Added author and license\n- Flat migration to Revit 2019 &ndash; updated Revit API assembly references and .NET framework to version 4.7\n- Removed references to Revit 2011\n- Added `VendorId` node\n- Added assembly description\n- Added link to original blog post and new question thread"
  },
  {
    "original_filename": "1683_zero_doc_ribbon",
    "header_text": "<a name=\"3\"></a> Loading Add-In Support DLLs",
    "local_header_href": "#a-name3a-loading-add-in-support-dlls",
    "chunk_text": "#### <a name=\"3\"></a> Loading Add-In Support DLLs\n\nIn\nanother [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non loading the [missing `System.ComponentModel.Annotations` v4.2.0.0](https://forums.autodesk.com/t5/revit-api-forum/missing-system-componentmodel-annotations-v4-2-0-0/m-p/8255546), \nmy colleague Jim Jia suggested using an assembly resolver reacting to the `AppDomain.CurrentDomain.AssemblyResolve` event:\n\n> You may try to force loading the assembly if it cannot be loaded successfully. The code snippet below should provide a safe solution, per my experience; hope it is helpful:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Result</span>&nbsp;Execute(\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ExternalCommandData</span>&nbsp;commandData,\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">ref</span>&nbsp;<span style=\"color:blue;\">string</span>&nbsp;message,\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ElementSet</span>&nbsp;elements&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Try&nbsp;to&nbsp;load&nbsp;assembly&nbsp;if&nbsp;Revit&nbsp;command&nbsp;fails&nbsp;to&nbsp;load&nbsp;it.</span>\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">AppDomain</span>.CurrentDomain.AssemblyResolve\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ResolveEventHandler</span>(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OnAssemblyResolve&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;your&nbsp;other&nbsp;code...</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//</span>\n&nbsp;&nbsp;}\n \n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Assembly</span>&nbsp;OnAssemblyResolve(&nbsp;<span style=\"color:blue;\">object</span>&nbsp;sender,&nbsp;<span style=\"color:#2b91af;\">ResolveEventArgs</span>&nbsp;args&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Assembly</span>&nbsp;a&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;args.Name.Contains(&nbsp;<span style=\"color:#a31515;\">&quot;ComponentModel.Annotations&quot;</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;assemblyFile&nbsp;=&nbsp;<span style=\"color:#2b91af;\">Path</span>.Combine(&nbsp;addinDir,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#a31515;\">&quot;ComponentModel.Annotations.dll&quot;</span>&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;<span style=\"color:#2b91af;\">File</span>.Exists(&nbsp;assemblyFile&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;<span style=\"color:#2b91af;\">Assembly</span>.LoadFrom(&nbsp;assemblyFile&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">return</span>&nbsp;a;\n&nbsp;&nbsp;}\n</pre>\n\nWe explored some related issues and had success with this approach in the past, e.g., here:\n  \n- [Revit Add-in Unit Testing](http://thebuildingcoder.typepad.com/blog/2013/07/revit-add-in-unit-testing.html)\n- [Security, Framing Cross Section Analyser and REX](http://thebuildingcoder.typepad.com/blog/2013/12/security-framing-cross-section-analyser-and-rex.html)\n- [RvtVa3c Assembly Resolver](http://thebuildingcoder.typepad.com/blog/2014/05/rvtva3c-assembly-resolver.html)\n- [Framing Cross Section Analyser and REX in Revit 2015](http://thebuildingcoder.typepad.com/blog/2015/03/framing-cross-section-analyser-and-rex-in-revit-2015.html)\n- [REX Add-In Development and Migration](http://thebuildingcoder.typepad.com/blog/2015/12/rex-app-development-and-migration.html)\n- [Add-In Templates Supporting Edit and Continue](http://thebuildingcoder.typepad.com/blog/2017/02/add-in-templates-supporting-edit-and-continue.html)"
  },
  {
    "original_filename": "1683_zero_doc_ribbon",
    "header_text": "<a name=\"4\"></a> Rome and  Boston Forge Accelerators",
    "local_header_href": "#a-name4a-rome-and-boston-forge-accelerators",
    "chunk_text": "#### <a name=\"4\"></a> Rome and  Boston Forge Accelerators\n\nI recently mentioned that I am attending\nthe [Forge accelerator in Rome](http://thebuildingcoder.typepad.com/blog/2018/08/revit-20191-cefsharp-forge-accelerator-in-rome.html#5) end\nof this month, September 24-28.\n\nI expect that it is too late to decide to join that one now.\n\nHowever, [you can still submit proposals for the Boston accelerator taking place in October](https://forums.autodesk.com/t5/bim-360-api-forum/forge-accelerator-boston-ma-october-1-5-2018/td-p/8249266)\n&ndash; note that the deadline for submitting one is next Saturday, September 15:\n\nThe Forge team is finishing the review of proposals for the upcoming accelerator taking place in the Autodesk Boston office October 1-5.\n\nNote that the BIM 360 Issue API is now publicly available, cf. the .NET and Node.js\nsamples [introducing BIM 360 Issues API](https://forge.autodesk.com/blog/introducing-bim-360-issues-api) and\naccessing [BIM 360 Issues API with Node.js](https://forge.autodesk.com/blog/bim-360-issues-api-sample-nodejs).\n\nYou can now also simulate the use of the [Design Automation API](https://forge.autodesk.com/en/docs/design-automation/v2/developers_guide/overview) for Revit on your machine (note that it is still in private beta!).\n\nTherefore, the Forge team would love to support you and your software development team in working intensively on a Forge-based project making use of these new technologies with one-on-one support and advice from Autodesk Forge API experts.\n\nIf you have an idea for a new web or mobile application based on Autodesk Forge APIs, or need help getting an existing application working, then come along to the event.\n\nThere is no cost to attend the accelerator, other than your own travel and living expenses.\n\nHowever, we do ask that you submit a proposal as part of your application so that we can verify that the intended use of the Autodesk Forge APIs in your project is feasible.\n\nYou can [apply and submit your proposal here](http://autodeskcloudaccelerator.com/apply).\n\nFor more information, please visit the [Forge Accelerator website](http://autodeskcloudaccelerator.com/forge-accelerator)."
  }
]