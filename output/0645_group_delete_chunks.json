[
  {
    "original_filename": "0645_group_delete",
    "header_text": "Deleting a Group",
    "local_header_href": "#deleting-a-group",
    "chunk_text": "<h3>Deleting a Group</h3><p>I discussed various aspects of programmatically handling Revit element groups in the past, such as how to \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/02/creating-a-group-and-how-to-fish.html\">\ncreate</a>,\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/06/rename-a-group.html\">\nrename</a> and\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/08/editing-elements-inside-groups.html\">\nedit the contents</a> of \n\nan existing group.\n\nHere is another question on the topic of groups that helps clarify the relationship between the group and its type:\n\n<p><strong>Question:</strong> I am deleting a model group using the following code:\n\n<pre class=\"code\">\n  <span class=\"teal\">Transaction</span> trans = <span class=\"blue\">new</span> <span class=\"teal\">Transaction</span>( doc );\n  trans.Start( <span class=\"maroon\">\"test\"</span> );\n \n  <span class=\"teal\">ElementSet</span> sel = uidoc.Selection.Elements;\n \n  <span class=\"blue\">foreach</span>( <span class=\"teal\">Element</span> e <span class=\"blue\">in</span> sel )\n  {\n    <span class=\"teal\">Group</span> group = e <span class=\"blue\">as</span> <span class=\"teal\">Group</span>;\n    <span class=\"blue\">if</span>( <span class=\"blue\">null</span> != group )\n    {\n      doc.Delete( group );\n    }\n  }\n  trans.Commit();\n</pre>\n<p>This seems to delete the model group including the elements contained in it. \nBut still the group remains visible in the project browser:</p>\n<center>\n<img alt=\"Group in browser\" src=\"img/group_in_browser.png\"/>\n</center>\n<p>How can I delete it from the browser, please?\n\n<p>By the way, I see the same behaviour when I delete it using the Delete button in the user interface\n\n\n<p><strong>Answer:</strong> If you want to delete the definition of the group, then the GroupType also needs to be deleted, for example as follows:\n\n<pre class=\"code\">\n  <span class=\"teal\">FilteredElementCollector</span> collector \n    = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( doc )\n      .OfClass( ( <span class=\"blue\">typeof</span>( <span class=\"teal\">GroupType</span> ) ) );\n \n  <span class=\"blue\">var</span> groupTypes \n    = <span class=\"blue\">from</span> element <span class=\"blue\">in</span> collector \n      <span class=\"blue\">where</span> element.Name == <span class=\"maroon\">\"Group 1\"</span> \n      <span class=\"blue\">select</span> element;\n \n  <span class=\"teal\">Element</span> groupType = groupTypes.First();\n \n  doc.Delete( groupType );\n</pre>\n<p>You can also access the group type directly and more easily from the group itself using the Group.GroupType property.\n\n<p><strong>Response:</strong> Thank you, it does indeed remove the group from the browser.\n</p></p></p></p></p></p></p>"
  }
]