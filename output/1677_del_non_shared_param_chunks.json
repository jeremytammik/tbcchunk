[
  {
    "original_filename": "1677_del_non_shared_param",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n</head>\n\n<!---\n\nTwo new colleagues and deleting a non-shared project parameter in the #RevitAPI  @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/delnonsharedparam\n\nSome happy news about two new Revit API supporter colleagues, Naveen Kumar and Zhong Wu.\nThey already reached second and third place in the list of top solution providers.\nHere is also a very relevant recent case handled by Zhong\n&ndash; Top solution authors\n&ndash; Naveen on Naveen\n&ndash; Zhong shifts to AEC\n&ndash; Zhong on Zhong\n&ndash; Deleting a non-shared project parameter...\n\n--->"
  },
  {
    "original_filename": "1677_del_non_shared_param",
    "header_text": "Deleting a Non-Shared Project Parameter",
    "local_header_href": "#deleting-a-non-shared-project-parameter",
    "chunk_text": "### Deleting a Non-Shared Project Parameter\n\nSome happy news about two new Revit API supporter colleagues, Naveen Kumar and Zhong Wu.\n\nThey already reached second and third place in the list of top solution providers.\n\nHere is also a very relevant recent case handled by Zhong:\n\n- [Top solution authors](#2) \n- [Naveen on Naveen](#3) \n- [Zhong shifts to AEC](#4) \n- [Zhong on Zhong](#5) \n- [Deleting a non-shared project parameter](#6)"
  },
  {
    "original_filename": "1677_del_non_shared_param",
    "header_text": "Top Solution Authors",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Top Solution Authors\n\nTwo of my Autodesk colleagues have joined me at the head of the list of top solution authors:\n\n<center>\n<img src=\"img/2018-08-26_top_solution_author.png\" alt=\"Top solution authors\" width=\"233\"/>\n</center>\n\nNaveen joined our team in December last year and published 36 posts and  13 Solutions since May.\n\nZhong joined in May and already reached 88 Posts and 16 Solutions.\n\nWelcome to the team, guys, thank you very much for your hard work, and big congratulations to both of you!"
  },
  {
    "original_filename": "1677_del_non_shared_param",
    "header_text": "Naveen on Naveen",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Naveen on Naveen\n\nI am from Trichy, Tamilnadu and am now living in Bangalore, India.\n\nI have a degree in Mechanical Engineering from Sastra University.\n\nAfter completing my B. Tech graduation, I started to learn the C# programming language and APIs for AutoCAD.\n\nApart from this, I am a mime Artist and love to do pencil sketching.\n\nI enjoy watching movies and am a huge fan of music, only movie songs; my favourite composer is A.R Rahman."
  },
  {
    "original_filename": "1677_del_non_shared_param",
    "header_text": "Zhong shifts to AEC",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Zhong shifts to AEC\n\nZhong started working with the Revit API quite recently.\n\nIn May, he decided to make a career shift within the Forge Platform Development team and join AEC workgroup.\n\nUntil then, Zhong was a member of M&amp;E (multimedia and entertainment) group, leading the Maya API support.\n\nHe decided to move and focus on Forge and AEC.\n\nHe had already been helping a lot with BIM 360 and Forge evangelism at various events in China.\n\nHaving a background in Civil Engineering helps a lot in this area, of course.\n\nHere are some words from Zhong himself reflecting on his career at Autodesk:"
  },
  {
    "original_filename": "1677_del_non_shared_param",
    "header_text": "Zhong on Zhong",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Zhong on Zhong\n\nWhen you asked about the introduction, I started to look back and think over what I wanted and what I did during the past years, time flies so fast, it’s been a lot since I joined in Autodesk, the introduction seems a little too long &nbsp; :-)\n\nI had the clear intention to join Autodesk, but during the journey, sometimes I forgot my original intention, luckily, everything seems is on track, and finally, the new opportunity and challenge comes, I am a little nervous but more excited.\n\nI always remember the time, in the spring of 2005, I had the interview and got the intern offer from Autodesk when I still studied in University for my master’s degree. I was so exciting for the offer, because I got my bachelor’s degree in Civil Engineering, and during that time, computer was so popular and I believe this is something going to change the traditional industry, I am pretty interested in software development and learnt all the compute technology by myself, after graduation, instead of working as a civil engineer, I decided to continued my master degree in computer technology, so when Lang came back from Manchester to build up CADC BSD team(now is renamed to ACRD), I was so excited to be one of the team members that I believe I can finally use all my knowledge to improve the AEC industry.\n\nSummer 2005, the 1st CADC BSD team:\n\n<center>\n<img src=\"img/zhong_image005.jpg\" alt=\"Zhong summer 2005, the 1st CADC BSD team\" width=\"400\"/>\n</center>\n\nOctober 2005, some of Manchester team visited Shanghai ACAD BSD team:\n\n<center>\n<img src=\"img/zhong_image006.jpg\" alt=\"Zhong October 2005, some of Manchester team visited Shanghai ACAD BSD team\" width=\"400\"/>\n</center>\n\nOne year later I joined in Autodesk as a fulltime developer, I started my career on AutoCAD Architecture as a software developer, after several years late, I worked on many different Autodesk product features mainly using C++ and .NET and became the dev lead of API features. During that time, I worked with Kevin for a while in the API team, and also with Mikako to support her for ACA OMF SDK, when Autodesk start to move to cloud, I moved to another team for the new project Spiderman(which is AutoCAD on Web), still working on the API side. When Autodesk internal re-org happened on 2012, the whole team was cancelled, Lang recommend me to try something new, and that comes another wonderful journey in DevTech M&amp;E team.\n\nADN is an amazing family, it’s totally different from engineering team I worked before. For me, I like this more because I can have direct contact with industry guys and can learn/help them directly. And M&amp;E was a very interesting and fantasy industry with lots of cool technology, I feel so lucky to be one member of the small global team, I learnt the API of Maya and then Motionbuilder and work closely with different groups including engineering team and sales team to help partners, then also take the leadership for Maya API support. Everything is going so well that sometimes I forgot about my initial idea to join Autodesk.\n\nMy 1st ADN DevTech team meeting in San Rafael in 2013\n\n<center>\n<img src=\"img/zhong_image007.jpg\" alt=\"Zhong's 1st ADN DevTech team meeting in San Rafael in 2013\" width=\"400\"/>\n</center>\n\nDevTech M&amp;E Team meeting & FITC conference in Toronto in 2018:\n\n<center>\n<img src=\"img/zhong_image009.jpg\" alt=\"Zhong at DevTech M&amp;E Team meeting & FITC conference in Toronto in 2018\" width=\"400\"/>\n</center>\n\nWhen Forge comes to our team, it’s totally a new opportunity to expand our technique stack and also the industry stack, web-based technology is quite different from the desktop software, it gives you some pain at first, but you will enjoy it more when you get involved. I made my decision to embrace and learn the technology, I also connected lots of developers during all kinds of presentation, workshop, conferences .etc. many of them are from AEC industry, this reminds me the initial idea to choose Autodesk as my 1st job, I started to learn BIM360 and try to involve more with AEC industry intended, I strongly believe this is the industry that I can contribute more.\n\nNow you know all my previous story, when latest re-org comes to have more industry focus, also inspired by Stephen’s career development, 1st idea comes to my mind is that I have to make my decision for my own career path, I’d like to focus more on AEC industry, to improve the efficiency of AEC industry by using model technology."
  },
  {
    "original_filename": "1677_del_non_shared_param",
    "header_text": "Deleting a Non-Shared Project Parameter",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Deleting a Non-Shared Project Parameter\n\nOne of Zhong's recent cases answers the question raised in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [`BindingMap.Remove` being ineffective on a non-shared project parameter]( https://forums.autodesk.com/t5/revit-api-forum/deleting-a-non-shared-project-parameter/td-p/5975020):\n\nThe partner is complaining about an issue deleting non-shared project parameter, and there is no information in the SDK help doc to mention this.\n\nThe discussion\non [deleting a shared parameter](http://thebuildingcoder.typepad.com/blog/2009/08/deleting-a-shared-parameter.html) shows\nhow to delete a shared parameter, but I could not find the proper way to delete a non-shared project parameter.\n\nI checked with the Revit engineering team to see if they can fix this or this is by design.\n\nThey responded:\n\n> Yes, that’s a known issue and logged under the number REVIT-136670.\n\n> As a workaround, you can delete a non-shared project parameter by retrieving the associated `ParameterElement`.\n\n> If you delete that element, the non-shared parameter will also be removed.\n\nI verified this with the following sample code:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">void</span>&nbsp;DeleteNonSharedProjectParam(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;parametername&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>&nbsp;ps\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WhereElementIsNotElementType()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">ParameterElement</span>&nbsp;)&nbsp;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">ParameterElement</span>&nbsp;projectparameter&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">ParameterElement</span>&nbsp;pe&nbsp;<span style=\"color:blue;\">in</span>&nbsp;ps&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;pe.GetDefinition().Name.Equals(&nbsp;parametername&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;projectparameter&nbsp;=&nbsp;pe;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">break</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;projectparameter&nbsp;!=&nbsp;<span style=\"color:blue;\">null</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.Delete(&nbsp;projectparameter.Id&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;}\n</pre>\n\nIt works as expected.\n\nI hope this helps.\n\nMany thanks again to Zhong for his clear analysis and nice solution.\n\nThis version is slightly updated from the code posted by Zhong in the forum discussion thread, because there is no need to use `ToElements` if you just want to iterate over the results of a filtered element collector.\n\nYou can iterate directly over the collector itself.\n\nUsing `ToElements` creates a copy of the information and uses time and space for no reason, cf.,\n[`FindElement` and collector optimisation](http://thebuildingcoder.typepad.com/blog/2012/09/findelement-and-collector-optimisation.html).\n\nI added Zhong's solution \nto [The Building Coder Samples](https://github.com/jeremytammik/the_building_coder_samples) \nin [release 2019.0.143.2](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2019.0.143.2).\n\nYou can see the changes I made by looking at\nthe [diff to the preceding release](https://github.com/jeremytammik/the_building_coder_samples/compare/2019.0.143.1...2019.0.143.2).\n\nI later noticed that Zhong's code can be shortened a little bit further like this making use of a LINQ `Where` clause:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">ParameterElement</span>&nbsp;projectparameter\n&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">FilteredElementCollector</span>(&nbsp;doc&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WhereElementIsNotElementType()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OfClass(&nbsp;<span style=\"color:blue;\">typeof</span>(&nbsp;<span style=\"color:#2b91af;\">ParameterElement</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Cast&lt;<span style=\"color:#2b91af;\">ParameterElement</span>&gt;()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Where(&nbsp;e&nbsp;=&gt;&nbsp;e.GetDefinition()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Name.Equals(&nbsp;parametername&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.FirstOrDefault();\n\n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;projectparameter&nbsp;!=&nbsp;<span style=\"color:blue;\">null</span>&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;doc.Delete(&nbsp;projectparameter.Id&nbsp;);\n&nbsp;&nbsp;}\n</pre>\n\nThe latter modification is preserved\nin [The Building Coder samples release 2019.0.143.3](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2019.0.143.3)."
  }
]