[
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<title>The Building Coder</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<link rel=\"stylesheet\" type=\"text/css\" href=\"3dwc.css\"/>\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true\" defer=\"defer\"></script>\n</head>\n\n<!---\n\n\n<code></code>\n\nRoomedit3dv3 Diff from Forge Boilerplate Code @AutodeskForge #revitapi @AutodeskRevit #aec #bim\n\nI am preparing the Forge and BIM presentation and hands-on workshop this coming Friday at Technische Universität Darmstadt, Institut für Numerische Methoden und Informatik im Bauwesen, the institute for numerical methods and computer science in the construction industry at the technical university in Darmstadt. Now I prepared a detailed analysis of the exact changes I made to the forge-boilers.nodejs boilerplate code to implement the roomedit3dv3 sample connecting BIM with the cloud\n&ndash; Comparing the root folder contents\n&ndash; Comparing the Forge node.js boilerplate\n&ndash; Starting fresh from scratch\n&ndash; Copy, install and load the viewer extension\n&ndash; Adding the link to load the viewer extension\n&ndash; Renamed viewer extension base and toolkit <code>js</code> modules\n&ndash; All Viewer Extension Modifications\n&ndash; Successful test and final diff  &ndash; 25 lines of code...\n\n-->"
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "Roomedit3dv3 Diff from Forge Boilerplate Code",
    "local_header_href": "#roomedit3dv3-diff-from-forge-boilerplate-code",
    "chunk_text": "### Roomedit3dv3 Diff from Forge Boilerplate Code\n\nI am still busy preparing\nmy [Autodesk University sessions](http://thebuildingcoder.typepad.com/blog/2016/10/au-revit-20171-and-rex-freezedrawing.html#2),\nand more urgently \nthe [Forge and BIM](http://www.bim.tu-darmstadt.de) presentation\nand hands-on workshop this coming Friday \nat [Technische Universität Darmstadt](http://www.tu-darmstadt.de),\n[Institut für Numerische Methoden und Informatik im Bauwesen](http://www.iib.tu-darmstadt.de),\nthe institute for numerical methods and computer science in the construction industry at the technical university in the very pleasant German\ncity [Darmstadt](https://en.wikipedia.org/wiki/Darmstadt),\nin Hessen, just south of Frankfurt.\n\n<center>\n<img src=\"img/logo_tuda_150x309.png\" alt=\"Technische Universität Darmstadt\" width=\"309\">\n</center>\n\nThe agenda there consists of two parts:\n\n- 10:45-12:15 presentation &ndash; [Connecting desktop and  cloud](http://thebuildingcoder.typepad.com/blog/2016/10/connecting-desktop-and-cloud-at-rtc-material.html)\n- 13:00-17:00 hands-on workshop with two topics:\n    - Revit API &ndash; [creating a Revit add-in with one single click](http://thebuildingcoder.typepad.com/blog/2016/10/revit-api-and-connecting-desktop-and-cloud-tuda.html#4)\n    - Connecting BIM with the cloud &ndash; [connecting Revit and Forge in 55 minutes](http://thebuildingcoder.typepad.com/blog/2016/10/revit-api-and-connecting-desktop-and-cloud-tuda.html#5)\n\nI already prepared the material pointed to by the links above.\n\nNow I would like to add a more detailed analysis of the exact changes I made to\nthe [forge-boilers.nodejs](https://github.com/Autodesk-Forge/forge-boilers.nodejs) boilerplate\ncode to implement \nthe [roomedit3dv3 sample](https://github.com/Autodesk-Forge/forge-boilers.nodejs/tree/roomedit3d) connecting\nBIM with the cloud.\n\n- [Comparing the root folder contents](#2)\n- [Comparing the Forge node.js boilerplate](#3)\n- [Starting fresh from scratch](#4)\n- [Copy, install and load the viewer extension](#5)\n- [Adding the link to load the viewer extension](#6)\n- [Renamed viewer extension base and toolkit `js` modules](#7)\n- [All Viewer Extension Modifications](#8)\n- [Successful test and final diff  &ndash; 25 lines of code](#9)\n\nPlease note that I abandoned my initial comparison attempt after the first two steps listed above, so if you are not interested in the painful beginnings of this exploration, you can skip straight to [starting fresh from scratch](#4).\n\nOr, if you are really in a hurry, just skip straight to the end to the [successful test and final diff](#9) to examine the 25 lines of code that I modified or added all in all."
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"2\"></a>Comparing the Root Folder Contents",
    "local_header_href": "#a-name2acomparing-the-root-folder-contents",
    "chunk_text": "#### <a name=\"2\"></a>Comparing the Root Folder Contents\n\nI cloned the `master` and `roomedit3d` branches of\nthe [forge-boilers.nodejs repo](https://github.com/Autodesk-Forge/forge-boilers.nodejs) in\ntwo separate directories:\n\n- /a/src/web/forge/forge-boilers.nodejs/\n- /a/src/web/forge/roomedit3dv3/\n\nThese are the files and subfolders in the former:\n\n<pre>\n/a/src/web/forge/forge-boilers.nodejs $ ls -1\n1 - viewer-offline\n2 - viewer-barebone\n3 - viewer+server\n4 - viewer+server+oss\n5 - viewer+server+oss+derivatives\n6 - viewer+server+data-mng+derivatives\nLICENSE\nREADME.md\napp.json\npackage.json\nresources\n</pre>\n\nAs a first step to implement roomedit3dv3, I copied the entire contents of the boilerplate step 6 into a new folder 7:\n\n<pre>\n/a/src/web/forge/roomedit3dv3 $ ls -1\n7 - viewer+extension+server+data-mng+derivatives\nLICENSE\nREADME.md\napp.json\npackage.json\nresources\n</pre>\n\nIn the root folder, the following files differ in obvious ways:\n\n- .gitignore\n- README.md\n- app.json\n- package.json\n\nI completely rewrote the readme file.\n\nHere are the differences between the two versions of the other three:\n\n<pre>\n/a/src/web/forge $ diff forge-boilers.nodejs/.gitignore roomedit3dv3/.gitignore\n0a1,4\n&gt; 7 - viewer+extension+server+data-mng+derivatives/node_modules\n&gt; 7 - viewer+extension+server+data-mng+derivatives/dist\n&gt; 7 - viewer+extension+server+data-mng+derivatives/TMP\n\n/a/src/web/forge $ diff forge-boilers.nodejs/app.json roomedit3dv3/app.json\n2,4c2,4\n&lt;   \"name\": \"forge-boiler.nodejs\",\n&lt;   \"description\": \"Forge boiler: viewer + server + oss + derivatives\",\n&lt;   \"repository\": \"https://github.com/Autodesk-Forge/forge-boilers.nodejs\",\n---\n&gt;   \"name\": \"roomedit3dv3\",\n&gt;   \"description\": \"Forge Viewer extension to move building elements and update the Revit BIM in real-time\",\n&gt;   \"repository\": \"https://github.com/Autodesk-Forge/forge-boilers.nodejs/tree/roomedit3d\",\n6c6\n&lt;   \"keywords\": [\"autodesk\", \"forge\", \"node\", \"express\"],\n---\n&gt;   \"keywords\": [\"autodesk\", \"forge\", \"node\", \"express\", \"revit\"],\n16a17,19\n&gt;     },\n&gt;     \"HOST_URL\": {\n&gt;       \"description\": \"Host url: for Heroku App use 'https://myApp.herokuapp.com', where 'myApp' is name of your app. Important: the name of your App needs to match the callback URL you specified on Forge Developer Portal\"\n\n/a/src/web/forge $ diff forge-boilers.nodejs/package.json roomedit3dv3/package.json\n2,4c2,4\n&lt;   \"name\": \"forge-boilers.nodejs\",\n&lt;   \"description\": \"A collection of node.js based boiler projects for the Autodesk Forge Web Services APIs\",\n&lt;   \"version\": \"1.0.0\",\n---\n&gt;   \"name\": \"roomedit3dv3\",\n&gt;   \"description\": \"Forge Viewer extension to move building elements and update the Revit BIM in real-time\",\n&gt;   \"version\": \"0.0.16\",\n9c9,10\n&lt;     \"Philippe Leefsma &lt;philippe.leefsma@autodesk.com&gt;\"\n---\n&gt;     \"Philippe Leefsma &lt;philippe.leefsma@autodesk.com&gt;\",\n&gt;     \"Jeremy Tammik &lt;jeremy.tammik@autodesk.com&gt;\"\n13,18c14,16\n&lt;     \"start\": \"npm start --prefix ./5\\\\ -\\\\ viewer+server+oss+derivatives\",\n&lt;     \"install-boiler3\": \"npm install --prefix ./3\\\\ -\\\\ viewer+server\",\n&lt;     \"install-boiler4\": \"npm install --prefix ./4\\\\ -\\\\ viewer+server+oss\",\n&lt;     \"install-boiler5\": \"npm install --prefix ./5\\\\ -\\\\ viewer+server+oss+derivatives\",\n&lt;     \"install-boiler6\": \"npm install --prefix ./6\\\\ -\\\\ viewer+server+data-mng+derivatives\",\n&lt;     \"postinstall\": \"npm run install-boiler5\"\n---\n&gt;     \"start\": \"npm start --prefix ./7\\\\ -\\\\ viewer+extension+server+data-mng+derivatives\",\n&gt;     \"install-boiler7\": \"npm install --prefix ./7\\\\ -\\\\ viewer+extension+server+data-mng+derivatives\",\n&gt;     \"postinstall\": \"npm run install-boiler7\"\n22c20\n&lt;     \"url\": \"https://github.com/Developer-Autodesk/forge-boilers.nodejs\"\n---\n&gt;     \"url\": \"https://github.com/Autodesk-Forge/forge-boilers.nodejs/tree/roomedit3d\"\n25d22\n</pre>"
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"3\"></a>Comparing the Forge Node.js Boilerplate",
    "local_header_href": "#a-name3acomparing-the-forge-nodejs-boilerplate",
    "chunk_text": "#### <a name=\"3\"></a>Comparing the Forge Node.js Boilerplate\n\nNext, let's look at the differences between the original step 6 boilerplate code and the roomedit3dv3 version.\n\nThe list of files in the two folders is almost identical, except that I added a placeholder `README.md` to the roomedit version to suppress the npm warning message about a lack of one during deployment, `npm WARN package.json Forge-boiler-6@1.0.0 No README data`:\n\n- README.md\n- TMP\n- app.json\n- bin\n- config\n- dist\n- etc\n- heroku.config.sh\n- layout\n- nodemon.json\n- package.json\n- resources\n- src\n- webpack\n\nSome of these folders are generated by or just contain the `webpack` output, so they are of no concern to us.\n\n`app.json` contains some obvious differences similar to the root folder ones:\n\n<pre>\n/a/src/web/forge $ diff forge-boilers.nodejs/6\\ -\\ viewer+server+data-mng+derivatives/app.json roomedit3dv3/7\\ -\\ viewer+extension+server+data-mng+derivatives/app.json\n2,4c2,4\n&lt;   \"name\": \"forge-boiler.nodejs\",\n&lt;   \"description\": \"Forge boiler: viewer + server + data-management + derivatives\",\n&lt;   \"repository\": \"https://github.com/Autodesk-Forge/forge-boilers.nodejs\",\n---\n&gt;   \"name\": \"roomedit3dv3\",\n&gt;   \"description\": \"Forge Viewer extension to move building elements and update the Revit BIM in real-time\",\n&gt;   \"repository\": \"https://github.com/Autodesk-Forge/forge-boilers.nodejs/tree/roomedit3d\",\n6c6\n&lt;   \"keywords\": [\"autodesk\", \"forge\", \"node\", \"express\"],\n---\n&gt;   \"keywords\": [\"autodesk\", \"forge\", \"node\", \"express\", \"revit\"],\n</pre>\n\nThe same applies to `package.json`:\n\n<pre>\n/a/src/web/forge $ diff forge-boilers.nodejs/6\\ -\\ viewer+server+data-mng+derivatives/package.json roomedit3dv3/7\\ -\\ viewer+extension+server+data-mng+derivatives/package.json\n2,4c2,4\n&lt;   \"name\": \"Forge-boiler-6\",\n&lt;   \"description\": \"Forge boiler: viewer + server + data-management + derivatives\",\n&lt;   \"version\": \"1.0.0\",\n---\n&gt;   \"name\": \"roomedit3dv3\",\n&gt;   \"description\": \"Forge Viewer extension to move building elements and update the Revit BIM in real-time\",\n&gt;   \"version\": \"0.0.15\",\n41d40\n&lt;     \"jquery-jsonview\": \"^1.2.3\",\n43d41\n&lt;     \"jsoneditor\": \"^5.5.9\",\n46d43\n&lt;     \"lodash\": \"^4.16.4\",\n50d46\n&lt;     \"node-sass\": \"^3.10.1\",\n54d49\n&lt;     \"sass-loader\": \"^4.0.2\",\n57c52\n&lt;     \"socket.io-client\": \"^1.4.8\",\n---\n&gt;     \"socket.io-client\": \"*\",\n69c64,65\n&lt;     \"Philippe Leefsma &lt;philippe.leefsma@autodesk.com&gt;\"\n---\n&gt;     \"Philippe Leefsma &lt;philippe.leefsma@autodesk.com&gt;\",\n&gt;     \"Jeremy Tammik &lt;jeremy.tammik@autodesk.com&gt;\"\n81c77\n&lt;     \"url\": \"https://github.com/Developer-Autodesk/forge-boilers.nodejs\"\n---\n&gt;     \"url\": \"https://github.com/Autodesk-Forge/forge-boilers.nodejs/tree/roomedit3d\"\n</pre>\n\nNo, this analysis is getting too tough, and the differences are too many at this point.\n\nPhilippe seems to have changed quite a lot  since I initially implemented this branch.\n\nI'll start fresh from scratch."
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"4\"></a>Starting Fresh from Scratch",
    "local_header_href": "#a-name4astarting-fresh-from-scratch",
    "chunk_text": "#### <a name=\"4\"></a>Starting Fresh from Scratch\n\nLet's grab an updated version of his boilerplate code and run it as is in the development environment.\n\nBefore starting with the sample itself, set up environment variables for the boilerplate app to access your Forge credentials:\n\n<pre class=\"prettyprint\">\nexport FORGE_DEV_CLIENT_ID=$ROOMEDIT3DV3_DEV_CONSUMER_KEY\nexport FORGE_DEV_CLIENT_SECRET=$ROOMEDIT3DV3_DEV_CONSUMER_SECRET\nexport FORGE_CALLBACK_URL=$ROOMEDIT3DV3_DEV_CALLBACK_URL\nexport PORT=3000\n</pre>\n\nWith your Forge credential environment variables defined, we can install and test the unmodified boilerplate code:\n\n- Create a fresh clone of the [forge-boilers.nodejs repo](https://github.com/Autodesk-Forge/forge-boilers.nodejs).\n- Navigate to the step 6 sample app: `$ cd forge-boilers.nodejs/6\\ -\\ viewer+server+data-mng+derivatives/`\n- Install the required npm modules: `npm install`\n- Build: `npm run build-dev`\n- Run: `npm run dev`\n- Test: open `http://localhost:3000` in your browser\n\nThat works fine for me."
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"5\"></a>Copy, Install and Load the Viewer Extension",
    "local_header_href": "#a-name5acopy-install-and-load-the-viewer-extension",
    "chunk_text": "#### <a name=\"5\"></a>Copy, Install and Load the Viewer Extension\n\nI copied the working updated code into my own repository hosting the `roomedit3d` branch and started updating it to run my extension.\n\nFirst of all, I install the viewer extension.\n\nIn my case, I can copy it from my previous version:\n\n<pre>\n/a/src/web/forge/roomedit3dv3/7 - viewer+extension+server+data-mng+derivatives/src/client/Components/Viewer $ cp -R extensions /a/src/web/forge/roomedit3dv3/6\\ -\\ viewer+server+data-mng+derivatives/src/client/Components/Viewer\n</pre>\n\nIf you prefer to grab it from the original repository, clone\nPhilippe's [library-javascript-viewer-extensions](https://github.com/Developer-Autodesk/library-javascript-viewer-extensions) and\ncopy the four files from the `library-javascript-viewer-extensions/src/Viewing.Extension.Transform` folder to a new subfolder `src/client/Components/Viewer/extensions`:\n\n- TransformGizmos.js\n- Viewing.Extension.Transform.js\n- Viewing.Tool.Rotate.js\n- Viewing.Tool.Translate.js\n\nImport the viewer extension into the viewer panel by editing `src/client/Components/Viewer/Viewer.Panel.js`:\n\n<pre class=\"prettyprint\">\nimport './extensions/Viewing.Extension.Transform.js'\n</pre>\n\nIn the panel's `initialize` function, add the event listeners to handle the load and unload extension events:\n\n<pre class=\"prettyprint\">\n  // Load and unload extension events\n\n  var loadBtn = document.getElementById('loadBtn');\n\n  loadBtn.addEventListener(\"click\", () =&gt; {\n    this.viewer.loadExtension('Viewing.Extension.Transform', {})\n  });\n\n  var unloadBtn = document.getElementById('unloadBtn');\n\n  unloadBtn.addEventListener(\"click\", () =&gt; {\n    this.viewer.unloadExtension('Viewing.Extension.Transform')\n  });\n</pre>\n\nHere is the [commit diff to install and load the viewer extension](https://github.com/Autodesk-Forge/forge-boilers.nodejs/commit/91bb9209a4ec577759a295ee22247b27b4027aa2) showing the exact changes I made."
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"6\"></a>Adding the Link to Load the Viewer Extension",
    "local_header_href": "#a-name6aadding-the-link-to-load-the-viewer-extension",
    "chunk_text": "#### <a name=\"6\"></a>Adding the Link to Load the Viewer Extension\n\nThe original sample implements a settings menu that is prepared for further configuration by the programmer:\n\n<center>\n<img src=\"img/roomedit3dv3_settings.png\" alt=\"Forge boilerplate settings menu\" width=\"400\">\n</center>\n\nI prefer to implement two simple links to load and unload the transform viewer extension instead.\n\nFor that, I modify `layout/index.ejs` and replace the right navigation bar contents with this:\n\n<pre class=\"prettyprint\">\n  &lt;ul class=\"nav navbar-nav navbar-right\"&gt;\n    &lt;li&gt;&lt;a href=\"https://github.com/Autodesk-Forge/forge-boilers.nodejs/tree/roomedit3d\"&gt;About Roomedit3d...&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a id=\"loadBtn\"&gt;Start&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a id=\"unloadBtn\"&gt;Stop&lt;/a&gt;&lt;/li&gt;\n  &lt;/ul&gt;\n</pre>\n\nHere is the [commit diff to add the roomedit3dv3 about, start and stop links](https://github.com/Autodesk-Forge/forge-boilers.nodejs/commit/9f14a9508275d16ae9664a0cd7d1c606fef03c5c)."
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"7\"></a>Renamed Viewer Extension Base and Toolkit `js` Modules",
    "local_header_href": "#a-name7arenamed-viewer-extension-base-and-toolkit-js-modules",
    "chunk_text": "#### <a name=\"7\"></a>Renamed Viewer Extension Base and Toolkit `js` Modules\n\nPhilippe renamed the JavaScript modules defining the viewer `ExtensionBase` and `Toolkit` classes.\n\nAfter a little bit of searching, I found the solution and updated the module names accordingly in `Viewing.Extension.Transform.js`:\n\n<pre class=\"prettyprint\">\n-import ExtensionBase from 'ExtensionBase'\n-import ViewerToolkit from 'ViewerToolkit'\n+import ExtensionBase from 'Viewer.ExtensionBase'\n+import ViewerToolkit from 'Viewer.Toolkit'\n</pre>\n\nHere is the [commit diff to rename the viewer extension base and toolkit js modules](https://github.com/Autodesk-Forge/forge-boilers.nodejs/commit/381abe7be657085daed066dfc9eea067d15eecd1)."
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"8\"></a>All Viewer Extension Modifications",
    "local_header_href": "#a-name8aall-viewer-extension-modifications",
    "chunk_text": "#### <a name=\"8\"></a>All Viewer Extension Modifications\n\nBesides adding the viewer extension to the boilerplate app, I also need to modify it slightly to ensure that the BIM element translation we are interested in and want to broadcast to be picked up by the Revit add-in is properly retrieved and transmitted.\n\nI copied the original `Viewing.Extension.Transform` viewer extension implementation\nfrom [library-javascript-viewer-extensions](https://github.com/Developer-Autodesk/library-javascript-viewer-extensions),\ntagged it as [release 0.0.21](https://github.com/Autodesk-Forge/forge-boilers.nodejs/releases/tag/0.0.21),\nreapplied the required changes,\nand tagged that as [release 0.0.22](https://github.com/Autodesk-Forge/forge-boilers.nodejs/releases/tag/0.0.22)\nin order to present this nice\nlittle [comparison showing the exact differences](https://github.com/Autodesk-Forge/forge-boilers.nodejs/compare/0.0.21...0.0.22) to you...\n\n15 lines of code modified or added."
  },
  {
    "original_filename": "1494_roomedit3dv3_diff",
    "header_text": "<a name=\"9\"></a>Successful Test and Final Diff &ndash; 25 Lines of Code",
    "local_header_href": "#a-name9asuccessful-test-and-final-diff-ndash-25-lines-of-code",
    "chunk_text": "#### <a name=\"9\"></a>Successful Test and Final Diff &ndash; 25 Lines of Code\n\nAfter those steps and some further clean-up, I had the updated roomedit3dv3 viewer extension successfully up and running\nin [release 0.0.23](https://github.com/Autodesk-Forge/forge-boilers.nodejs/releases/tag/0.0.23) of \nthe [roomedit3d branch](https://github.com/Autodesk-Forge/forge-boilers.nodejs/tree/roomedit3d) of\nthe [forge-boilers.nodejs repo](https://github.com/Autodesk-Forge/forge-boilers.nodejs).\n\n<center>\n<img src=\"img/roomedit3dv3_running_2.png\" alt=\"Roomedit3dv3 in action\" width=\"400\">\n</center>\n\nBy the way, note that the new version of the boilerplate code implements tabs to explore the model derivative information:\n\n<center>\n<img src=\"img/roomedit3dv3_md_tabs.png\" alt=\"Model derivative tabs\" width=\"378\">\n</center>\n\nThe important changes to the app are shown by the diffs\nbetween [0.0.18 and 0.0.20](https://github.com/Autodesk-Forge/forge-boilers.nodejs/compare/0.0.18...0.0.20),\nand the viewer extension ones\nby [0.0.21...0.0.22](https://github.com/Autodesk-Forge/forge-boilers.nodejs/compare/0.0.21...0.0.22).\n\nAll in all, I added and modified about 25 lines of code.\n\nI hope this simplifies your job of creating your own extensions.\n\nHappy [Forge](https://forge.autodesk.com) coding!"
  }
]