[
  {
    "original_filename": "0198_roof_eave_cut",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0198_roof_eave_cut",
    "header_text": "Roof Eave Cut in Revit and ACA",
    "local_header_href": "#roof-eave-cut-in-revit-and-aca",
    "chunk_text": "<h3>Roof Eave Cut in Revit and ACA</h3><p>Here is a case that is interesting in its own right, or rather two separate cases and a comparison between the two.\nThe issue is the programmatic setting of the roof eave cut property in AutoCAD Architecture and Revit, respectively.\nOne interesting aspect is the similarity and differences between the two solutions.\n\n<p>First of all, here is the original question, addressed at ACA:</p>\n<p><strong>Question:</strong>\nI am having difficulty accessing the edges of a RoofSlab entity. \nI am programming in C#.  \nI need to change the EdgeCut to a Plumb Cut and I don't know how to access the edges so that I can change the property from Square Cut to Plumb Cut.</p>\n<h4>Setting the SlabEdge.IsPlumbCut Property in AutoCAD Architecture</h4>\n<p>In ACA, this issue can also be formulated like this:\n\n<p><strong>Question:</strong> How can I define the roof slab edge plumb cut property and set it to plumb or square cut in AutoCAD Architecture?\nThe ACA.NET API SlabEdge.IsPlumbCut property is read-only, so some other method is needed.\n\n<p><strong>Answer:</strong> As said, the required property is represented by the SlabEdge.IsPlumbCut property, which is read-only in the API. \nSo you are searching for write access to this property?\n\n<p>This property can be controlled by the roof slab style. \nOne way to change it is to set up an appropriate edge style. \nYou can define an edge style that uses the plumb orientation by default and then define a slab style using that edge style. \nWhen you convert to slab, use that slab style, and the plumb edge will come with it.\n\n<p>You can also directly access and write to this property on each edge individually, independently of the edge style, by using the SlabEdge.SetCutOption method. \nThe setting of this property is displayed when you select the 'Edges' entry in the roof slab property palette:\n\n<center>\n<img alt=\"ACA Slab Edges\" src=\"img/aca_slab_edges.png\"/>\n</center>\n<p>I implemented a sample ACA.NET application PlumbCut which toggles the state of this setting on each edge of a selected roof slab every time it is called. \nHere is the relevant code snippet from the command method implementation:\n\n<pre class=\"code\">\n  <span class=\"teal\">RoofSlab</span> roofSlab = t.GetObject( \n    entId, <span class=\"teal\">OpenMode</span>.ForWrite ) <span class=\"blue\">as</span> <span class=\"teal\">RoofSlab</span>;\n \n  <span class=\"teal\">SlabFace</span> face = roofSlab.Face;\n \n  <span class=\"blue\">foreach</span>( <span class=\"teal\">SlabLoop</span> loop <span class=\"blue\">in</span> face.Loops )\n  {\n    <span class=\"blue\">foreach</span>( <span class=\"teal\">SlabEdge</span> edge <span class=\"blue\">in</span> loop.Edges )\n    {\n      <span class=\"blue\">bool</span> isPlumb = edge.IsPlumbCut;\n \n      <span class=\"green\">// SlabEdge.IsPlumbCut cannot be assigned </span>\n      <span class=\"green\">// to -- it is read only:</span>\n      <span class=\"green\">//edge.IsPlumbCut = !edge.IsPlumbCut; </span>\n \n      edge.SetCutOption( isPlumb );\n    }\n  }\n</pre>\n<p>Here is the complete \n\n<a href=\"zip/PlumbCut.zip\">\nPlumbCut</a>\n\nACA.NET command source code and the complete Visual Studio solution to build it.\n\n<p>So much for AutoCAD Architecture.\nHere is an answer to the analogue question in the context of Revit:</p>\n<h4>Setting the Roof Eave Cut Property in Revit</h4>\n<p><strong>Question:</strong> How can I define the roof eave cut property and set it to plumb or square cut in Revit?\n\n<p><strong>Answer:</strong> I created a very simple sample model consisting of four walls supporting a footprint roof to explore your query and see the property you are looking for, the roof element Rafter Cut property, which can take the following values:</p>\n<ul>\n<li>Plumb Cut\n<li>Two Cut - Plumb\n<li>Two Cut - Square\n</li></li></li></ul>\n<center>\n<img alt=\"Roof Rafter Cut Property\" src=\"img/roof_rafter_cut.png\"/>\n</center>\n<p>These values correspond to the following EaveCutterType enumeration values in the API:</p>\n<ul>\n<li>PlumbCut\n<li>TwoCutPlumb\n<li>TwoCutSquare\n</li></li></li></ul>\n<p>Exploring the roof element parameters using RvtMgdDbg, I can see that these values are stored in the integer-valued built-in parameter ROOF_EAVE_CUT_PARAM.</p>\n<p>To ensure that this parameter can be accessed and its integer value read and written using the EaveCutterType enumeration values, I implemented an external command and a sample application RoofEaveCut. \nTo run it, you need to pre-select a foot print roof in the model. \nThen, each time you call the external command, the value of the Rafter Cut property is cycled through the three values listed above. \nThis demonstrates that you can both read and write the built-in ROOF_EAVE_CUT_PARAM parameter value as an integer and cast it to the EaveCutterType enumeration values. \nHere is the relevant code snippet:</p>\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _prompt \n  = <span class=\"maroon\">\"Please select a single foot print roof element.\"</span>;\n \n<span class=\"blue\">const</span> <span class=\"teal\">BuiltInParameter</span> _bip \n  = <span class=\"teal\">BuiltInParameter</span>.ROOF_EAVE_CUT_PARAM;\n \n<span class=\"blue\">public</span> <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span> Execute( \n  <span class=\"teal\">ExternalCommandData</span> commandData, \n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message, \n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">Application</span> app = commandData.Application;\n  <span class=\"teal\">Document</span> doc = app.ActiveDocument;\n  <span class=\"teal\">ElementSet</span> els = doc.Selection.Elements;\n\n  <span class=\"blue\">if</span>( 1 != els.Size )\n  {\n    message = _prompt;\n  }\n  <span class=\"blue\">else</span>\n  {\n    <span class=\"teal\">FootPrintRoof</span> roof = <span class=\"blue\">null</span>;\n    <span class=\"blue\">foreach</span>( <span class=\"teal\">Element</span> e <span class=\"blue\">in</span> els )\n    {\n      roof = e <span class=\"blue\">as</span> <span class=\"teal\">FootPrintRoof</span>;\n    }\n    <span class=\"blue\">if</span>( <span class=\"blue\">null</span> == roof )\n    {\n      message = _prompt;\n    }\n    <span class=\"blue\">else</span>\n    {\n      <span class=\"teal\">Parameter</span> p = roof.get_Parameter( _bip );\n      <span class=\"blue\">int</span> i = p.AsInteger();\n      <span class=\"blue\">switch</span>( i )\n      {\n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.PlumbCut: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutPlumb; \n          <span class=\"blue\">break</span>;\n \n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutPlumb: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutSquare; \n          <span class=\"blue\">break</span>;\n \n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutSquare: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.PlumbCut; \n          <span class=\"blue\">break</span>;\n      }\n      p.Set( i );\n    }\n  }\n  <span class=\"blue\">return</span> 0 == message.Length\n    ? <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span>.Succeeded\n    : <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span>.Failed;\n}\n</pre>\n<p>Here is the complete \n\n<a href=\"zip/RoofEaveCut.zip\">\nRoofEaveCut</a>\n\nRevit external command source code and the complete Visual Studio solution to build it.\n</p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0198_roof_eave_cut",
    "header_text": "Setting the SlabEdge.IsPlumbCut Property in AutoCAD Architecture",
    "local_header_href": "#setting-the-slabedgeisplumbcut-property-in-autocad-architecture",
    "chunk_text": "<h4>Setting the SlabEdge.IsPlumbCut Property in AutoCAD Architecture</h4><p>In ACA, this issue can also be formulated like this:\n\n<p><strong>Question:</strong> How can I define the roof slab edge plumb cut property and set it to plumb or square cut in AutoCAD Architecture?\nThe ACA.NET API SlabEdge.IsPlumbCut property is read-only, so some other method is needed.\n\n<p><strong>Answer:</strong> As said, the required property is represented by the SlabEdge.IsPlumbCut property, which is read-only in the API. \nSo you are searching for write access to this property?\n\n<p>This property can be controlled by the roof slab style. \nOne way to change it is to set up an appropriate edge style. \nYou can define an edge style that uses the plumb orientation by default and then define a slab style using that edge style. \nWhen you convert to slab, use that slab style, and the plumb edge will come with it.\n\n<p>You can also directly access and write to this property on each edge individually, independently of the edge style, by using the SlabEdge.SetCutOption method. \nThe setting of this property is displayed when you select the 'Edges' entry in the roof slab property palette:\n\n<center>\n<img alt=\"ACA Slab Edges\" src=\"img/aca_slab_edges.png\"/>\n</center>\n<p>I implemented a sample ACA.NET application PlumbCut which toggles the state of this setting on each edge of a selected roof slab every time it is called. \nHere is the relevant code snippet from the command method implementation:\n\n<pre class=\"code\">\n  <span class=\"teal\">RoofSlab</span> roofSlab = t.GetObject( \n    entId, <span class=\"teal\">OpenMode</span>.ForWrite ) <span class=\"blue\">as</span> <span class=\"teal\">RoofSlab</span>;\n \n  <span class=\"teal\">SlabFace</span> face = roofSlab.Face;\n \n  <span class=\"blue\">foreach</span>( <span class=\"teal\">SlabLoop</span> loop <span class=\"blue\">in</span> face.Loops )\n  {\n    <span class=\"blue\">foreach</span>( <span class=\"teal\">SlabEdge</span> edge <span class=\"blue\">in</span> loop.Edges )\n    {\n      <span class=\"blue\">bool</span> isPlumb = edge.IsPlumbCut;\n \n      <span class=\"green\">// SlabEdge.IsPlumbCut cannot be assigned </span>\n      <span class=\"green\">// to -- it is read only:</span>\n      <span class=\"green\">//edge.IsPlumbCut = !edge.IsPlumbCut; </span>\n \n      edge.SetCutOption( isPlumb );\n    }\n  }\n</pre>\n<p>Here is the complete \n\n<a href=\"zip/PlumbCut.zip\">\nPlumbCut</a>\n\nACA.NET command source code and the complete Visual Studio solution to build it.\n\n<p>So much for AutoCAD Architecture.\nHere is an answer to the analogue question in the context of Revit:</p>\n<h4>Setting the Roof Eave Cut Property in Revit</h4>\n<p><strong>Question:</strong> How can I define the roof eave cut property and set it to plumb or square cut in Revit?\n\n<p><strong>Answer:</strong> I created a very simple sample model consisting of four walls supporting a footprint roof to explore your query and see the property you are looking for, the roof element Rafter Cut property, which can take the following values:</p>\n<ul>\n<li>Plumb Cut\n<li>Two Cut - Plumb\n<li>Two Cut - Square\n</li></li></li></ul>\n<center>\n<img alt=\"Roof Rafter Cut Property\" src=\"img/roof_rafter_cut.png\"/>\n</center>\n<p>These values correspond to the following EaveCutterType enumeration values in the API:</p>\n<ul>\n<li>PlumbCut\n<li>TwoCutPlumb\n<li>TwoCutSquare\n</li></li></li></ul>\n<p>Exploring the roof element parameters using RvtMgdDbg, I can see that these values are stored in the integer-valued built-in parameter ROOF_EAVE_CUT_PARAM.</p>\n<p>To ensure that this parameter can be accessed and its integer value read and written using the EaveCutterType enumeration values, I implemented an external command and a sample application RoofEaveCut. \nTo run it, you need to pre-select a foot print roof in the model. \nThen, each time you call the external command, the value of the Rafter Cut property is cycled through the three values listed above. \nThis demonstrates that you can both read and write the built-in ROOF_EAVE_CUT_PARAM parameter value as an integer and cast it to the EaveCutterType enumeration values. \nHere is the relevant code snippet:</p>\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _prompt \n  = <span class=\"maroon\">\"Please select a single foot print roof element.\"</span>;\n \n<span class=\"blue\">const</span> <span class=\"teal\">BuiltInParameter</span> _bip \n  = <span class=\"teal\">BuiltInParameter</span>.ROOF_EAVE_CUT_PARAM;\n \n<span class=\"blue\">public</span> <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span> Execute( \n  <span class=\"teal\">ExternalCommandData</span> commandData, \n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message, \n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">Application</span> app = commandData.Application;\n  <span class=\"teal\">Document</span> doc = app.ActiveDocument;\n  <span class=\"teal\">ElementSet</span> els = doc.Selection.Elements;\n\n  <span class=\"blue\">if</span>( 1 != els.Size )\n  {\n    message = _prompt;\n  }\n  <span class=\"blue\">else</span>\n  {\n    <span class=\"teal\">FootPrintRoof</span> roof = <span class=\"blue\">null</span>;\n    <span class=\"blue\">foreach</span>( <span class=\"teal\">Element</span> e <span class=\"blue\">in</span> els )\n    {\n      roof = e <span class=\"blue\">as</span> <span class=\"teal\">FootPrintRoof</span>;\n    }\n    <span class=\"blue\">if</span>( <span class=\"blue\">null</span> == roof )\n    {\n      message = _prompt;\n    }\n    <span class=\"blue\">else</span>\n    {\n      <span class=\"teal\">Parameter</span> p = roof.get_Parameter( _bip );\n      <span class=\"blue\">int</span> i = p.AsInteger();\n      <span class=\"blue\">switch</span>( i )\n      {\n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.PlumbCut: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutPlumb; \n          <span class=\"blue\">break</span>;\n \n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutPlumb: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutSquare; \n          <span class=\"blue\">break</span>;\n \n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutSquare: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.PlumbCut; \n          <span class=\"blue\">break</span>;\n      }\n      p.Set( i );\n    }\n  }\n  <span class=\"blue\">return</span> 0 == message.Length\n    ? <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span>.Succeeded\n    : <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span>.Failed;\n}\n</pre>\n<p>Here is the complete \n\n<a href=\"zip/RoofEaveCut.zip\">\nRoofEaveCut</a>\n\nRevit external command source code and the complete Visual Studio solution to build it.\n</p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0198_roof_eave_cut",
    "header_text": "Setting the Roof Eave Cut Property in Revit",
    "local_header_href": "#setting-the-roof-eave-cut-property-in-revit",
    "chunk_text": "<h4>Setting the Roof Eave Cut Property in Revit</h4><p><strong>Question:</strong> How can I define the roof eave cut property and set it to plumb or square cut in Revit?\n\n<p><strong>Answer:</strong> I created a very simple sample model consisting of four walls supporting a footprint roof to explore your query and see the property you are looking for, the roof element Rafter Cut property, which can take the following values:</p>\n<ul>\n<li>Plumb Cut\n<li>Two Cut - Plumb\n<li>Two Cut - Square\n</li></li></li></ul>\n<center>\n<img alt=\"Roof Rafter Cut Property\" src=\"img/roof_rafter_cut.png\"/>\n</center>\n<p>These values correspond to the following EaveCutterType enumeration values in the API:</p>\n<ul>\n<li>PlumbCut\n<li>TwoCutPlumb\n<li>TwoCutSquare\n</li></li></li></ul>\n<p>Exploring the roof element parameters using RvtMgdDbg, I can see that these values are stored in the integer-valued built-in parameter ROOF_EAVE_CUT_PARAM.</p>\n<p>To ensure that this parameter can be accessed and its integer value read and written using the EaveCutterType enumeration values, I implemented an external command and a sample application RoofEaveCut. \nTo run it, you need to pre-select a foot print roof in the model. \nThen, each time you call the external command, the value of the Rafter Cut property is cycled through the three values listed above. \nThis demonstrates that you can both read and write the built-in ROOF_EAVE_CUT_PARAM parameter value as an integer and cast it to the EaveCutterType enumeration values. \nHere is the relevant code snippet:</p>\n<pre class=\"code\">\n<span class=\"blue\">const</span> <span class=\"blue\">string</span> _prompt \n  = <span class=\"maroon\">\"Please select a single foot print roof element.\"</span>;\n \n<span class=\"blue\">const</span> <span class=\"teal\">BuiltInParameter</span> _bip \n  = <span class=\"teal\">BuiltInParameter</span>.ROOF_EAVE_CUT_PARAM;\n \n<span class=\"blue\">public</span> <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span> Execute( \n  <span class=\"teal\">ExternalCommandData</span> commandData, \n  <span class=\"blue\">ref</span> <span class=\"blue\">string</span> message, \n  <span class=\"teal\">ElementSet</span> elements )\n{\n  <span class=\"teal\">Application</span> app = commandData.Application;\n  <span class=\"teal\">Document</span> doc = app.ActiveDocument;\n  <span class=\"teal\">ElementSet</span> els = doc.Selection.Elements;\n\n  <span class=\"blue\">if</span>( 1 != els.Size )\n  {\n    message = _prompt;\n  }\n  <span class=\"blue\">else</span>\n  {\n    <span class=\"teal\">FootPrintRoof</span> roof = <span class=\"blue\">null</span>;\n    <span class=\"blue\">foreach</span>( <span class=\"teal\">Element</span> e <span class=\"blue\">in</span> els )\n    {\n      roof = e <span class=\"blue\">as</span> <span class=\"teal\">FootPrintRoof</span>;\n    }\n    <span class=\"blue\">if</span>( <span class=\"blue\">null</span> == roof )\n    {\n      message = _prompt;\n    }\n    <span class=\"blue\">else</span>\n    {\n      <span class=\"teal\">Parameter</span> p = roof.get_Parameter( _bip );\n      <span class=\"blue\">int</span> i = p.AsInteger();\n      <span class=\"blue\">switch</span>( i )\n      {\n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.PlumbCut: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutPlumb; \n          <span class=\"blue\">break</span>;\n \n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutPlumb: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutSquare; \n          <span class=\"blue\">break</span>;\n \n        <span class=\"blue\">case</span> (<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.TwoCutSquare: \n          i =(<span class=\"blue\">int</span>) <span class=\"teal\">EaveCutterType</span>.PlumbCut; \n          <span class=\"blue\">break</span>;\n      }\n      p.Set( i );\n    }\n  }\n  <span class=\"blue\">return</span> 0 == message.Length\n    ? <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span>.Succeeded\n    : <span class=\"teal\">IExternalCommand</span>.<span class=\"teal\">Result</span>.Failed;\n}\n</pre>\n<p>Here is the complete \n\n<a href=\"zip/RoofEaveCut.zip\">\nRoofEaveCut</a>\n\nRevit external command source code and the complete Visual Studio solution to build it.\n</p></p>"
  }
]