[
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- email\n  promote Autodesk Platform Services Developer Conference Europe - DevCon 2023 Sept 11-12 in Munich\n\n- resx mnanagement language\n  https://forums.autodesk.com/t5/revit-api-forum/revit-add-in-with-multiple-language-forms-based-on-current-ui/m-p/12140874#M73102\n\ntwitter:\n\nAutodesk Platform Services APS @AutodeskAPS Developer Conferences, @AutodeskRevit #RevitAPI add-in localisation and i18n, RESX language management, ribbon panel localisation and creating the localised WinForms #BIM @DynamoBIM  https://autode.sk/resxlanguage\n\nThe Autodesk Platform Services APS Developer Conferences are coming up, and we all need to deal\nwith application localisation and i18n issues\n&ndash; Resx language management\n&ndash; Ribbon panel localisation\n&ndash; Creating the localised WinForms...\n\nlinkedin:\n\nAutodesk Platform Services APS Developer Conferences, #RevitAPI add-in localisation and i18n, RESX language management, ribbon panel localisation and creating the localised WinForms:\n\nhttps://autode.sk/resxlanguage\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "Resx Language Management and APS DevCons",
    "local_header_href": "#resx-language-management-and-aps-devcons",
    "chunk_text": "### Resx Language Management and APS DevCons\n\nThis year's [Autodesk Platform Services APS](https://aps.autodesk.com/) Developer Conferences are\ncoming up soon, and we all (well, many of us) need to deal\nwith [application localisation and i18n](https://en.wikipedia.org/wiki/Internationalization_and_localization) issues:\n\n- [APS Developer Conferences](#2)\n- [Resx language management](#3)\n- [Ribbon panel localisation](#3.1)\n- [Creating localised WinForms](#3.2)"
  },
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "APS Developer Conferences",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> APS Developer Conferences\n\nThe [Autodesk Developer Conferences DevCon](https://aps.autodesk.com/blog/register-autodesk-devcon-2023) are\ncoming up soon.\n\nThese two-day events will be hosted in:\n\n- [San Francisco, California](https://aps.autodesk.com/devcon):\n  The Historic Klamath Ferry on September 6-7, 2023\n- [Munich, Germany](https://cvent.autodesk.com/w9DQ5Q?rt=99uCmbte1U6VS9RyVp0Gnw&RefId=Generic):\n  Holiday Inn Munich - Westpark on September 11-12, 2023\n\nThese events are a great opportunity for software developers and business innovators to learn about leading edge technology from Autodesk experts, network with other developers and business leaders, as well as see how our desktop APIs and cloud-based [Autodesk Platform Services APS](https://aps.autodesk.com/) (formerly Forge) can power their company’s growth and digital transformation. This is also a great opportunity for Autodesk to engage with its 3rd party development community, learn more about their projects and how they are using our APIs.\n\nAll the up to date information as well as both registration links are provided in\nthe [main blog post](https://aps.autodesk.com/blog/register-autodesk-devcon-2023).\n\nThis is a 2-day event which will provide deep technical training as well high-level overview on Autodesk Platform Services and Autodesk APIs. If you want to learn about Autodesk applications to improve workflows, learn from Autodesk engineers and technology decision-makers as well as other industry professionals, this event will provide all the education and networking you need. You’ll bring back very valuable insights to apply to your work.\n\nThe [European DevCon agenda](img/devcon_eu_2023_agenda.pdf) provides\na detailed overview of the sessions planned.\n\nSpace is limited and we expect this event to sell out.\n\nYou still have a chance to save 50% on your EU ticket until this weekend: 180 euro instead of 360.\n\nAs always, please feel free to reach out if you have any questions.\n\nAs [Kean Walmsley points out](https://www.keanw.com/2023/06/register-today-for-autodesk-devcon-2023-in-munich.html),\nit’s also a special time to be in Munich,\nwith [Oktoberfest starting the following weekend](https://www.oktoberfest.de/en/information/when-is-oktoberfest),\non September 16th.\n\n<center>\n<img src=\"img/2023-08-01_eu_aps_devcon.png\" alt=\"EU APS DevCon 2023\" title=\"EU APS DevCon 2023\" width=\"600\"/>\n</center>"
  },
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "Resx Language Management",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Resx Language Management\n\n[Geoff Jennings](https://www.linkedin.com/in/geoffrey-jennings-9984921/) ([@GJennings-BM](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/9888344)) of [BIModular](https://bimodular.com)\nbrought up and with help\nfrom Luiz Henrique [@ricaun](https://ricaun.com/) Cassettari solved\nimportant aspects of Revit add-in localisation in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [Revit Add-in with Multiple Language Forms based on Current UI Culture](https://forums.autodesk.com/t5/revit-api-forum/revit-add-in-with-multiple-language-forms-based-on-current-ui/m-p/12140874):\n\n**Question:** I am struggling to get my C# code correct to convert my user forms into each culture.\nI tried for days, but I cannot get my labels to change languages when opening Revit in different language versions.\nI can get my Ribbon Panel button to change languages using a RibbonResources.resx file in my App.cs, but my FormExport.resx files are not providing language translation values.\n\n<pre class=\"prettyprint\">\npublic FormExport(Autodesk.Revit.DB.Document doc)\n{\n  CultureInfo cultureName = new CultureInfo(Thread.CurrentThread.CurrentUICulture.Name);\n  string cultureRef = cultureName.Name;\n  Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(cultureRef);\n  Thread.CurrentThread.CurrentUICulture = CultureInfo.CreateSpecificCulture(cultureRef);\n\n  InitializeComponent();\n  familyDocument = doc;\n\n  // Get the localized label text from the resource .resx file\n  string localizedLabelText = GetLocalizedTextFromResource(\"lblFamilyName.Text\");\n  string localizedHeaderText = GetLocalizedTextFromResource(\"lblHeader.Text\");\n\n  // Set the label text with the localized value\n  lblFamilyName.Text = localizedLabelText;\n  lblHeader.Text = localizedHeaderText;\n}\n</pre>\n\nI have this function set below my form code:\n\n<pre class=\"prettyprint\">\nprivate string GetLocalizedTextFromResource(string key)\n{\n  try\n  {\n    // Load the appropriate resource file based on the user's selected language\n    ResourceManager resourceManager = new ResourceManager(\"MyApp.FormExport\", typeof(FormExport).Assembly);\n    CultureInfo currentCulture = Thread.CurrentThread.CurrentUICulture;\n    // Fetch the localized text for the given key from the resource\n    string localizedText = resourceManager.GetString(key, currentCulture);\n    // If the resource for the given key is not found in the selected culture,\n    // explicitly load the default resource (English) using CultureInfo.InvariantCulture\n    if (localizedText == null)\n    {\n      localizedText = resourceManager.GetString(key, CultureInfo.InvariantCulture);\n    }\n    // If the resource is still not found, return the key itself as a fallback\n    return localizedText ?? key;\n  }\n  catch (MissingManifestResourceException ex)\n  {\n    // Log the exception\n    Console.WriteLine($\"Resource file not found. Exception: {ex.Message}\");\n    return key; // Return the key itself as a fallback\n  }\n}\n</pre>\n\nMy form `.resx` files are:\n\n- FormExport.resx\n- FormExport.en.resx\n- FormExport.fr.resx\n- ... (continued)\n\nI am testing various options.\nHere is just a small list sites I have researched and tested against:\n\n- [Create the Multilingual .bundle file](https://adndevblog.typepad.com/aec/2013/08/localized-applications-for-the-revit-exchange-store.html)\n- [All Language Revit Versions](https://help.autodesk.com/view/RVT/2020/ENU/?guid=GUID-BD09C1B4-5520-475D-BE7E-773642EEBD6C)\n- [Language Tags](https://forums.autodesk.com/t5/revit-api-forum/localization-of-add-in-multilanguage/td-p/8936144)\n- [Get Revit Language](https://www.revitapidocs.com/2015/2b1d8b80-a11c-2a57-63bd-6c0d67691879.htm)\n- [Family Content Localization](https://thebuildingcoder.typepad.com/blog/2013/02/content-localisation.html)\n- [Another Resource for Creating Resx files and Revit UI Culture](https://thebuildingcoder.typepad.com/blog/2017/02/multiple-language-resx-resource-files.html)\n- [Label Control for BuiltIn Parameter Languages](https://www.revitapidocs.com/2022/c38e7823-31b3-9bcd-5ab0-d353e0d39fa8.htm)\n- [Localize Ribbon](https://help.autodesk.com/view/RVT/2022/ENU/?guid=Revit_API_Revit_API_Developers_Guide_Introduction_...)\n\nIt has become very confusing since everyone seems to have a different method.\nI am simply building a C# .Net app for Revit under the Add-in tab.\nI have five WinForms.\nOne is a primary WinForms and the other WinForms support secondary operations.\nThis is all been built in Visual Studio 2022 for Revit 2021-2024.\nThe app has been submitted to the app store for publishing.\nNow, I just need to prepare the WinForms for a larger international base of users.\n\nIt should be extremely simple.\nAgain, I have my ribbon panel working for any language, but the translations of my WinForms are my challenge.\nBeyond the sites listed below, I spent hours reviewing YouTube videos, ChatGPT, reading manuals, and website blogs.\nIn Visual Studio, I have done the process of setting each form to 'Localizable' = true, then Language = \"France, Spanish,...\", customized the forms for .resx files.  I have tested with separate manual .resx files, and tons of programming methods.  Frustrating for something that is effectively a basic task.\n\nI am hoping someone can provide c# .net guidance showing the code requirements of a single form that references the appropriate .resx based upon the user's Revit language version.\nI currently have a `Forms` folder for all of my WinForms and their associated `.resx` language files.\n\n**Answer:** The `.resx` file should swap automatically when depending on the `CultureInfo`; if the resource is now changed automatically probably your key language is different from the CultureInfo in the application, like `en` is different from `en-US` and `fr` is different from `fr-FR`.\nJust update your resource file name to match the same `CultureInfo` that Revit uses.\nHere is a [table listing all the languages and keys](https://github.com/ricaun/RevitAddin.ResourcesExample).\n\n**Response:** Thank you for your answer and excellent quality video of your .resx management.\nYour methods will be useful on some other apps I plan to create.\n\nI was finally successful at getting my C# Winforms to show in any UICulture languages!\nI want to share this information with others:\n\n####<a name=\"3.1\"></a> Ribbon Panel Localization\n\nI added a language switcher file based on Andrey Bushman's sample file.\nThis has been modified to `RVTLanguages.cs`.\nThe file was placed in my root folder below my C# project name.\nIn the same location, I also created three .resx files:\n\n- RibbonResources.resx (empty &ndash; set to `Internal`)\n- RibbonResources.en-US.resx (my panel data &ndash; see image below)\n- RibbonResources.fr-FR.resx (my French translations)\n\nTo keep my panel button narrow and allow for wrapping of text, I created two lines in the .resx file:\n\n<center>\n<img src=\"img/ribbon_resx_file_en.png\" alt=\"Ribbon panel resource file\" title=\"Ribbon panel resource file\" width=\"800\"/> <!-- Pixel Height: 417 Pixel Width: 1,686 -->\n</center>\n\nIn my `App.cs`:\n\n<pre class=\"prettyprint\">\npublic Result OnStartup(UIControlledApplication application)\n{\n\n#region READ AND SET THE LANGUAGE ENVIRONMENT USING THE RVTLanguages.cs file\n  RVTLanguages.Cultures(application.ControlledApplication.Language);\n  ResourceManager res_mng = new ResourceManager(typeof(RibbonResources));\n#endregion\n\n  RibbonPanel p = application.CreateRibbonPanel(RibbonResources.ResourceManager.GetString(\"PanelName\"));\n\n  string thisAssemblyPath = Assembly.GetExecutingAssembly().Location;\n  string buttonText1 = RibbonResources.ResourceManager.GetString(\"CommandName1\");\n  string buttonText2 = RibbonResources.ResourceManager.GetString(\"CommandName2\");\n\n  PushButtonData btnMyApp = new PushButtonData(\"btnMyApp\", buttonText1 + \"\\n\" + buttonText2, thisAssemblyPath, typeof(Command).FullName)\n  {\n    LargeImage = imgSrc,\n    Image = imgSrcTB,\n    LongDescription = RibbonResources.ResourceManager.GetString(\"CommandDescription\"),\n    ToolTip = RibbonResources.ResourceManager.GetString(\"CommandToolTip\")\n  };\n\n  // set help file to reference .bundle file help.html\n  string helpFolder = Path.Combine(parentFolder, \"help.html\");\n  ContextualHelp contextHelp = new ContextualHelp(\n  ContextualHelpType.ChmFile, helpFolder);\n  btnMyApp.SetContextualHelp(contextHelp);\n\n  p.AddItem(btnMyApp);\n</pre>\n\nThis was all that was required for setting up a localized ribbon button:\n\n<center>\n<img src=\"img/ribbon_resx_en_and_fr.png\" alt=\"Ribbon panel localisation\" title=\"Ribbon panel localisation\" width=\"800\"/> <!-- Pixel Height: 430 Pixel Width: 1,200 -->\n</center>\n\n####<a name=\"3.2\"></a> Creating Localized WinForms\n\nI created a folder called `Forms` and then placed all of my WinForms under this folder.\nAfter my forms were created, I then manually created two new `.resx` files, for example, `MyForm.en-US.resx` and `MyForm.fr-FR.resx`.\nThese files were placed in the Forms folder along with my main WinForm.\n\nIn my Winform code I did the following in `MyForm.cs`:\n\n<pre class=\"prettyprint\">\npublic sealed class UICultureSwitcher : IDisposable\n{\n  CultureInfo previous;\n  public UICultureSwitcher()\n  {\n    CultureInfo culture = new CultureInfo(Thread\n    .CurrentThread.CurrentCulture.Name);\n\n    previous = Thread.CurrentThread.CurrentUICulture;\n    Thread.CurrentThread.CurrentUICulture = culture;\n   }\n   void IDisposable.Dispose()\n   {\n     Thread.CurrentThread.CurrentUICulture = previous;\n   }\n}\n\npublic MyForm( Autodesk.Revit.DB.Document doc)\n{\n    ResourceManager res_mng = new ResourceManager(typeof(MyForm));\n    ResourceSet resourceSet = res_mng.GetResourceSet(Thread.CurrentThread.CurrentUICulture, true, true);\n\n    InitializeComponent();\n    familyDocument = doc;\n\n    label1.Text = GetLocalizedTextFromResource(\"label1Text\");\n    label2.Text = GetLocalizedTextFromResource(\"label2.Text\");\n    label3.Text = GetLocalizedTextFromResource(\"label3.Text\");\n    label4.Text = GetLocalizedTextFromResource(\"label4.Text\");\n\n    // rest of code ...\n}\n</pre>\n\nBelow I have a function that will collect the necessary language information in the .resx file:\n\n<pre class=\"prettyprint\">\nprivate string GetLocalizedTextFromResource(string key)\n{\n  try\n  {\n    // Load the appropriate resource file based on the user's selected language\n    ResourceManager resourceManager = new ResourceManager(\"MyApp.Forms.MyForm\", typeof(MyForm).Assembly);\n    CultureInfo currentCulture = Thread.CurrentThread.CurrentUICulture;\n\n    // Fetch the localized text for the given key from the resource\n    string localizedText = resourceManager.GetString(key, currentCulture);\n\n    // If the resource for the given key is not found in the culture,\n    // explicitly load the default resource (English) using CultureInfo.InvariantCulture\n    if (localizedText == null)\n    {\n      localizedText = resourceManager.GetString(key, CultureInfo.InvariantCulture);\n    }\n\n    // If the resource is still not found, return the key itself as a fallback\n    return localizedText ?? key;\n  }\n  catch (MissingManifestResourceException ex)\n  {\n    // Handle the exception if the resource file is not found\n    // Log the exception\n    Console.WriteLine($\"Resource file not found. Exception: {ex.Message}\");\n    return key; // Return the key itself as a fallback\n   }\n}\n</pre>\n\nI then repeat the same methods for my other forms.\nHere are screenshots of the end results:\n\n<center>\n<img src=\"img/ribbon_resx_familytypeexporter_en.png\" alt=\"FamilyType Exporter EN\" title=\"FamilyType Exporter EN\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">FamilyType Exporter EN</p>\n<br/>\n<img src=\"img/ribbon_resx_familytypeexporter_fr.png\" alt=\"FamilyType Exporter FR\" title=\"FamilyType Exporter FR\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">FamilyType Exporter FR</p>\n</center>\n\nNow, I am updating the datagrid based upon a similar workflow.\n\nI truly hope this helps others.\nThis has been a very confusing journey.\nEverything mentioned was done in Visual Studio 2022 and for Revit 2022-2024:\n\n- [Source code module RVTLanguages.cs](zip/ribbon_resx_rvtlanguages.zip)\n\n**Answer:** Neat!\n\nI believe setting the *Thread.CurrentThread.CurrentUICulture* and *Thread.CurrentThread.CurrentCulture* is not necessary to make multilanguage work, Revit already starts with the `CultureInfo` correctly set; the only reason to change it might be to test whether your Form is working in another `CurrentUICulture` language.\nUsing your class `UICultureSwitcher` does the trick.\n\nAnd why are you using `CommandName1` and `CommandName2` to create the second line? Just one single `CommandName` entry with multiple lines should work, like your `CommandDescription` that has multiple lines.\n\n**Response:** You are correct about the CommandName1 and CommandName2.\nI originally created the two strings before I did the multiline commandDescription.\nPreviously, I had tried the \"\\r\\n\" method in the .resx file and it was making it part of a single full string versus giving me two lines of strings.\nI changed the .resx files for my Ribbon code and generated the Spanish version.\nThe single CommandName with a `shift`+`return` allows for the multiple lines in the ribbon button:\n\n<center>\n<img src=\"img/ribbon_resx_ribbon_es.png\" alt=\"FamilyType Exporter ES\" title=\"FamilyType Exporter ES\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">FamilyType Exporter ES</p>\n<br/>\n</center>\n\nAs for the language switcher, I have plans for expanding functionality for an upcoming Pro version of the app.\n\nThanks again for your video and quick response.\n\nMany thanks to Geoff and Luiz for clarifying the confusion and sharing the solution!"
  }
]