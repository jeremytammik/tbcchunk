[
  {
    "original_filename": "1726_treeview_perfomance",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- naveen second top solution author\n\n- patrick.emin\n  [Use a form in Revit API](https://forums.autodesk.com/t5/revit-api-forum/use-a-form-in-revit-api/m-p/8617102)\n  Bonjour, pour votre information, nous avons un forum en français: https://forums.autodesk.com/t5/revit-et-bim-francais/bd-p/198\n  [Revit et BIM - Français](https://forums.autodesk.com/t5/revit-et-bim-francais/bd-p/198)\n  Bienvenue sur les forums Revit d’Autodesk. Partagez vos connaissances, posez des questions, collaborez sur des idées, et explorez les sujets Revit populaires.\n\n- 15089827 [WPF - Window With TreeView - Slow Load With Virtualization]\n  https://forums.autodesk.com/t5/revit-api-forum/wpf-window-with-treeview-slow-load-with-virtualization/m-p/8609110\n  performance\n\n\ntwitter:\n\nForum Français and treeview performance in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/treeviewperformance\n\nAs usual, I have been much too active in the Revit API discussion forum recently and worked too little for my taste here in the blog.\nHere are some of the recent items that I want to share plus a few pictures from my latest mountain outing\n&ndash; Marat's shapka ushanka and Balmer's Graetli\n&ndash; Naveen is a top solution author now\n&ndash; Revit et BIM en Français\n&ndash; Tree view performance optimisation\n&ndash; Underture...\n\nlinkedin:\n\nForum Français and treeview performance in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/treeviewperformance\n\nAs usual, I have been a bit too active in the Revit API discussion forum recently and worked too little for my taste here in the blog.\nHere are some of the recent items that I want to share plus a few pictures from my latest mountain outing\n- Marat's shapka ushanka and Balmer's Graetli\n- Naveen is a top solution author now\n- Revit et BIM en Français\n- Tree view performance optimisation\n- Underture...\n\nof [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2019.0.145.4).\n\n-->"
  },
  {
    "original_filename": "1726_treeview_perfomance",
    "header_text": "Forum Français and Treeview Performance",
    "local_header_href": "#forum-français-and-treeview-performance",
    "chunk_text": "### Forum Français and Treeview Performance\n\nAs usual, I have been much too active in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) recently\nand worked too little for my taste here in the blog.\n\nHere are some of the recent items that I want to share plus a few pictures from my latest mountain outing:\n\n- [Marat's shapka ushanka and Balmer's Graetli](#2) \n- [Naveen is a top solution author now](#3) \n- [Revit et BIM en Français](#4) \n- [Tree view performance optimisation](#5) \n- [Underture](#6)"
  },
  {
    "original_filename": "1726_treeview_perfomance",
    "header_text": "<a name=\"2\"></a> Marat's Shapka Ushanka and Balmer's Graetli",
    "local_header_href": "#a-name2a-marats-shapka-ushanka-and-balmers-graetli",
    "chunk_text": "#### <a name=\"2\"></a> Marat's Shapka Ushanka and Balmer's Graetli\n\nHere is a picture from a little ski tour to Balmer's Graetli\nin [Muotathal](https://en.wikipedia.org/wiki/Muotathal) last Sunday,\nsporting a nice new warm fur hat with ear flaps,\naka [shapka ushanka](https://en.wikipedia.org/wiki/Ushanka),\nthat my ex-Autodesk-colleague Marat got me:\n\n<center>\n<img src=\"img/677_jeremy_with_shapka_ushanka_800x600.jpg\" alt=\"Jeremy with Marat's nice warm shapka ushanka\" width=\"400\">\n</center>\n\nYou can see more photos from the tour in my [Balmer's Graetli album](https://flic.kr/s/aHsmyTUkrv).\n\nMany thanks to Marat for the hat and to Conny for the nice destination!\n\nMore and longer ski tours are planned for the end of March and April."
  },
  {
    "original_filename": "1726_treeview_perfomance",
    "header_text": "<a name=\"3\"></a> Naveen is a Top Solution Author Now",
    "local_header_href": "#a-name3a-naveen-is-a-top-solution-author-now",
    "chunk_text": "#### <a name=\"3\"></a> Naveen is a Top Solution Author Now\n\nCongratulations to my Indian Colleague Naveen Kumar T. for reaching place two in the list of top solution authors!\n\n<center>\n<img src=\"img/naveen_top_solution_author.png\" alt=\"Naveen listed as top solution author\" width=\"236\">\n</center>\n\nI am really looking forward to the day he overtakes me!\n \nThank you ever so much, Naveen, for all the hard work and great success!"
  },
  {
    "original_filename": "1726_treeview_perfomance",
    "header_text": "<a name=\"4\"></a> Revit et BIM en Français",
    "local_header_href": "#a-name4a-revit-et-bim-en-français",
    "chunk_text": "#### <a name=\"4\"></a> Revit et BIM en Français\n\nAnother discussion forum related news item:\n\nFor your information, Patrick Emin recently pointed out the new French language Revit and BIM discussion forum in the thread\non [using a form in Revit API](https://forums.autodesk.com/t5/revit-api-forum/use-a-form-in-revit-api/m-p/8617102):\n\n> Bonjour, pour votre information, nous avons un forum en français:\n[Revit et BIM &ndash; Français](https://forums.autodesk.com/t5/revit-et-bim-francais/bd-p/198)\n&ndash; [forums.autodesk.com/t5/revit-et-bim-francais/bd-p/198](https://forums.autodesk.com/t5/revit-et-bim-francais/bd-p/198)\n\n> <i>Bienvenue sur les forums Revit d’Autodesk.\nPartagez vos connaissances, posez des questions, collaborez sur des idées, et explorez les sujets Revit populaires.</i>"
  },
  {
    "original_filename": "1726_treeview_perfomance",
    "header_text": "<a name=\"5\"></a> Tree View Performance Optimisation",
    "local_header_href": "#a-name5a-tree-view-performance-optimisation",
    "chunk_text": "#### <a name=\"5\"></a> Tree View Performance Optimisation\n\nLet's return to a more technical Revit API oriented topic in the thread\non a [WPF window with treeview and slow load with virtualization](https://forums.autodesk.com/t5/revit-api-forum/wpf-window-with-treeview-slow-load-with-virtualization/m-p/8622528):\n\n**Question:** \n\nA tool I'm building has a TreeView control that will show all element instances in a Project/Active/Selection.\n\nThe problem is that even with UI virtualization the window load times are far too long.\n\nI'm not sure what to suspect now and am hoping one of the community has run across this.\n\nSome examples of window load times below.\n\n- Project with around 150,000 model Element Instances it takes about 2 minutes to build.\n- Project with around 66,000 model Element Instances it takes about a minute to build\n- Project with less than 400 model Element Instances it takes about 5 seconds to build\n\nHere is some additional pertinent information .\n\n- I'm using WPF / XAML / MVVM / C# to build it.\n- I've timed the Filtered Element Collectors and found they are incredible fast and don't seem to be the issue.\n- I've submitted a support ticket to Telerik which only confirmed that the code should be working and does outside of Revit where I can create 180000 objects into 4 tiers in seconds.\n- There are 4 tiers (See screenshot 1) of data arranged in the following manner:\n    - Tier 1: Category\n    - Tier 2: Family Name\n    - Tier 3: Type\n    - Tier 4: Instance\n- The TreeView is initially fully collapsed with only the first tier showing.\n- I've enabled UI Virtualization to show more as a user expands each node.\n- I've attached a zip file with the code in question\n\nScreenshot #1:\n\n<center>\n<img src=\"img/wpf_treeview_performance_1.png\" alt=\"WPF TreeView\" width=\"424\">\n</center>\n\nScreenshot #2:\n\n<center>\n<img src=\"img/wpf_treeview_performance_2.png\" alt=\"WPF TreeView\" width=\"504\">\n</center>\n\nHere is [TreeViewAllElementInstances.zip containing my sample code](zip/wpf_treeview_all_element_instances.zip).\n\n**Answer:** I would suggest initially populating only the Tier 1, and then populating the other ones and their subnodes on demand when clicked by the user to open them.\n\nIf a specific node is never opened, there is no need to ever load its subnodes.\n\nI am sure such techniques have already been implemented and published in the past.\n\nIn fact, I see a large number of solutions when searching the Internet for [populate tree view on demand](https://duckduckgo.com/?q=populate+tree+view+on+demand).\n\n**Response:** Jeremy, thank you for your suggestions and for continuing to help me and the community!\n\nMuch has happened since last Wednesday and I can report back that I now have a virtualized TreeView which quickly handles projects with 200,000+ model elements!\n\nI will gladly share this solution with any needing it so if you're interested please contact me.\n\nInitially, my inexperience drove me to go the 'safe' route towards populating the TreeView, but on Thursday, I deleted most of what I'd done and fully embraced MVVM and working with Objects, in an object, in an object, in an object! Was a mind melter for me but it really paid off!\n\nThe method below is truly the meat of the solution and along with the XAML in the previously attached ZIP file make it work. Way shorter and simpler than I thought it would be.\n\n<pre class=\"code\"><span style=\"color:blue;\">private</span>&nbsp;<span style=\"color:blue;\">static</span>&nbsp;<span style=\"color:blue;\">void</span>&nbsp;InitializeDataSource()\n{\n&nbsp;&nbsp;Tier1CategoryNames&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;ObservableCollection&lt;Tier1Object&gt;();\n&nbsp;&nbsp;Tier1Object&nbsp;tier1Object&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;Tier2Object&nbsp;tier2Object&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;Tier3Object&nbsp;tier3Object&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;Tier4Object&nbsp;tier4Object&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:blue;\">var</span>&nbsp;revitElementInstance&nbsp;<span style=\"color:blue;\">in</span>&nbsp;_revitElementInstances&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;##########&nbsp;Tier&nbsp;1&nbsp;Start&nbsp;##########</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;currentCategoryName&nbsp;=&nbsp;revitElementInstance.Category.Name;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;Tier1CategoryNames.Count&nbsp;==&nbsp;0&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;Tier1CategoryNames.All(&nbsp;tier1Object1\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;tier1Object1.Tier1CategoryName&nbsp;!=&nbsp;currentCategoryName&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tier1CategoryNames.Add(&nbsp;tier1Object&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;Tier1Object(&nbsp;currentCategoryName&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;##########&nbsp;Tier&nbsp;2&nbsp;Start&nbsp;##########</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;currentFamilyName&nbsp;=&nbsp;revitElementInstance.FamilyName;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;tier1Object.Tier2FamilyNames.Count&nbsp;==&nbsp;0&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;tier1Object.Tier2FamilyNames.All(&nbsp;tier2Object1&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;tier2Object1.Tier2FamilyName&nbsp;!=&nbsp;currentFamilyName&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tier1Object.Tier2FamilyNames.Add(&nbsp;tier2Object&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;Tier2Object(&nbsp;currentFamilyName&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;##########&nbsp;Tier&nbsp;3&nbsp;Start&nbsp;##########</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;currentElementTypeName&nbsp;=&nbsp;revitElementInstance.ElementType.Name;\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;tier2Object.Tier3ElementTypeNames.Count&nbsp;==&nbsp;0&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;tier2Object.Tier3ElementTypeNames.All(&nbsp;tier3Object1&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;tier3Object1.Tier3ElementTypeName&nbsp;!=&nbsp;currentElementTypeName&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tier2Object.Tier3ElementTypeNames.Add(&nbsp;tier3Object&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;Tier3Object(&nbsp;currentElementTypeName&nbsp;)&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;##########&nbsp;Tier&nbsp;4&nbsp;Start&nbsp;##########</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">var</span>&nbsp;currentElementInstanceName&nbsp;=&nbsp;revitElementInstance.ElementInstance.Name;\n \n&nbsp;&nbsp;&nbsp;&nbsp;tier3Object.Tier4ElementInstanceNames.Add(&nbsp;tier4Object&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;Tier4Object(&nbsp;currentElementInstanceName&nbsp;)&nbsp;);\n&nbsp;&nbsp;}\n}\n</pre>\n\nCongratulations on the brilliant result and many thanks to Chris for sharing the solution!"
  },
  {
    "original_filename": "1726_treeview_perfomance",
    "header_text": "<a name=\"6\"></a> Underture",
    "local_header_href": "#a-name6a-underture",
    "chunk_text": "#### <a name=\"6\"></a> Underture\n\nUnrelated to the Revit API and technology, you might be interested\nin [Underture](https://youtu.be/JJvDaBhofyc), \na truly beautiful two-minute underwater video\nby [LaughingEelVideo](https://www.youtube.com/channel/UCdD9nAv0ITzU-fiZr8cEXNw) with\nmasses of fascinating creatures filmed in Indonesia to the music\nof [The Barber of Seville](https://en.wikipedia.org/wiki/The_Barber_of_Seville)\nby [Gioachino Rossini](https://en.wikipedia.org/wiki/Gioachino_Rossini):\n\n> Sometimes, being underwater feels like a window on the world's biggest stage.\nHere's a bouncy 4K introduction to some of its principal characters, shot in Indonesia: Komodo, Ambon, Raja Ampat, and Bali.\n\n<center>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/JJvDaBhofyc\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</center>"
  }
]