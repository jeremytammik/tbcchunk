[
  {
    "original_filename": "0067_viewports_and_sheets",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<style>\n.blue { color: blue; }\n.teal { color: teal; }\n.maroon { color: maroon; }\n.green { color: green; }\n</style>"
  },
  {
    "original_filename": "0067_viewports_and_sheets",
    "header_text": "Viewports and Sheets",
    "local_header_href": "#viewports-and-sheets",
    "chunk_text": "<h3>Viewports and Sheets</h3><p>Jochen Reichert of the University of Stuttgart asks: How can I determine all the view ports of a drawing sheet and vice versa?</p><p>To determine the view ports of a drawing sheet, you can simply use the ViewSheet Views property.\nIt returns the set of all views on the sheet.\nFor the inverse relationship, you can create a mapping of your own as described in the discussion on\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/10/relationship-in.html\">\ninverting the relationship</a>\n\nbetween hosted und hosting elements such as doors, windows and walls.\nHere is some code demonstrating this for the viewport and view sheet relationships.\nIt sets up two mappings, one from each view sheet to all its contained viewports, the other from each viewport to the view sheet containing it, which we expect to be unique:</p><pre class=\"code\">\n<span class=\"teal\">Application</span> app = commandData.Application;\n<span class=\"teal\">Document</span> doc = app.ActiveDocument;\n \n<span class=\"teal\">List</span>&lt;<span class=\"teal\">Element</span>&gt; sheets = <span class=\"blue\">new</span> <span class=\"teal\">List</span>&lt;<span class=\"teal\">Element</span>&gt;();\n \ndoc.get_Elements( <span class=\"blue\">typeof</span>( <span class=\"teal\">ViewSheet</span> ), sheets );\n \n<span class=\"green\">// map with key = sheet element id and</span>\n<span class=\"green\">// value = list of viewport element ids:</span>\n \n<span class=\"teal\">Dictionary</span>&lt;<span class=\"teal\">ElementId</span>, <span class=\"teal\">List</span>&lt;<span class=\"teal\">ElementId</span>&gt;&gt;\n  mapSheetToViewport =\n  <span class=\"blue\">new</span> <span class=\"teal\">Dictionary</span>&lt;<span class=\"teal\">ElementId</span>, <span class=\"teal\">List</span>&lt;<span class=\"teal\">ElementId</span>&gt;&gt;();\n \n<span class=\"green\">// map with key = viewport element id and</span>\n<span class=\"green\">// value = sheet element id:</span>\n \n<span class=\"teal\">Dictionary</span>&lt;<span class=\"teal\">ElementId</span>, <span class=\"teal\">ElementId</span>&gt;\n  mapViewportToSheet =\n  <span class=\"blue\">new</span> <span class=\"teal\">Dictionary</span>&lt;<span class=\"teal\">ElementId</span>, <span class=\"teal\">ElementId</span>&gt;();\n \n<span class=\"blue\">foreach</span>( <span class=\"teal\">ViewSheet</span> sheet <span class=\"blue\">in</span> sheets )\n{\n  <span class=\"blue\">int</span> n = sheet.Views.Size;\n \n  <span class=\"teal\">Debug</span>.WriteLine( <span class=\"blue\">string</span>.Format(\n    <span class=\"maroon\">\"Sheet {0} contains {1} view{2}: \"</span>,\n    <span class=\"teal\">Util</span>.ElementDescription( sheet ),\n    n, <span class=\"teal\">Util</span>.PluralSuffix( n ) ) );\n \n  <span class=\"teal\">ElementId</span> idSheet = sheet.Id;\n \n  <span class=\"blue\">foreach</span>( <span class=\"teal\">View</span> v <span class=\"blue\">in</span> sheet.Views )\n  {\n    <span class=\"teal\">Debug</span>.WriteLine( <span class=\"maroon\">\"  Viewport \"</span>\n      + <span class=\"teal\">Util</span>.ElementDescription( v ) );\n \n    <span class=\"blue\">if</span>( !mapSheetToViewport.ContainsKey( idSheet ) )\n    {\n      mapSheetToViewport.Add( idSheet,\n        <span class=\"blue\">new</span> <span class=\"teal\">List</span>&lt;<span class=\"teal\">ElementId</span>&gt;() );\n    }\n    mapSheetToViewport[idSheet].Add( v.Id );\n \n    <span class=\"teal\">Debug</span>.Assert(\n      !mapViewportToSheet.ContainsKey( v.Id ),\n      <span class=\"maroon\">\"expected viewport to be caontained\"</span>\n      + <span class=\"maroon\">\" in only one single sheet\"</span> );\n \n    mapViewportToSheet.Add( v.Id, idSheet );\n  }\n}\n</pre><p>Here is the output generated for a simple model with three sheets:</p><pre>\nSheet Drawing Sheets &lt;127148 Unnamed&gt; contains 3 views:\n  Viewport Views &lt;29193 East&gt;\n  Viewport Views &lt;29233 South&gt;\n  Viewport Views &lt;29273 Site&gt;\nSheet Drawing Sheets &lt;127162 Unnamed&gt; contains 1 view:\n  Viewport Views &lt;13073 Level 1&gt;\nSheet Drawing Sheets &lt;127176 Unnamed&gt; contains 1 view:\n  Viewport Views &lt;15915 Level 2&gt;\n</pre><p>Here is\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/files/bc10018.zip\">\nversion 1.0.0.18</a>\n\nof the complete Visual Studio solution with the new command CmdListViews discussed here.</p>"
  }
]