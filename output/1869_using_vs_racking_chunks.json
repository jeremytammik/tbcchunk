[
  {
    "original_filename": "1869_using_vs_racking",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- 17047221 [ADN Support]\n\n- VS operation could not be Completed, Unspecified Error\n  https://autodesk.slack.com/archives/C0SJ4U3PE/p1602528759049500\n  Andrew Bushnell \n  A little PSA for revit developers.   I have noticed for a little bit now (and have gotten questions from others) that when building Revit or RevitAdditions within Visual Studio you get strange build failures and the message is along the lines of:\n  21>Error: The operation could not be completed. Unspecified error\n  Based on my investigations, this is an issue where the Visual Studio IDE gets itself into a strange state and the project in question has not been loaded properly for some reason.. I have not really traced down the steps that tend to cause, this.. For me I have found it related to switching project configurations before the build or even switching solutions from say revit to revitadditions.  It could also have to do with do a merge in git outside of the IDE that causes projects to change and reload.. Anyway, as I noted, I am not clear the exact steps, but when I do see the error, I found one of the following clears things up:\n  - Close and reopen the solution in question.\n  - Fully exit and restart Visual Studio.\n  Anyway, FYI... (edited) \n  Jaap van der Weide  11 hours ago\n  Could it have something to do with switching 3rd party header links when switching from debug to release?\n  Andrew Bushnell  11 hours ago\n  it may, but I have seen it just simple closing revit.sln and loading revitadditions, upon building tje newly loaded RevitAdditions.sln I would get the error..\n  Dragos Turmac  2 hours ago\n  Ah. That. Actually, I also got it in Precast,  which is a standalone C# solution with some C++ projects. It usually appears while trying to compile the C++ projects, which are a interop dependency for the C# projects - my theory is that somehow the C# binary locks the C++ one and doesn’t let msbuild query it for… god knows what, since interop is done at runtime afaik ( never seen this error on rebuild, only build ). And yes, only VS restart cures it; fortunately we rarely touch the C++ projects so I just ignored this error so far. Maybe we should look into it more and fill a MS bug if it’s so widespread? (edited) \n  Jeremy Tammik  < 1 minute ago\n  I never touch C++ code, only C# Revit add-ins, and I see this message now and then as well. I just restart VS or even reboot Windows (under Parallels on Mac) and all is well.\n\n\ntwitter:\n\nKeep things simple, or rack your brain. In one case, that can easily be avoided by using a using statement in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/usingusing\n\nYou should always keep things simple (I think).\nThe opposite can lead to racking your brain.\nIn one case at least, that can easily be avoided by using a <code>using</code> statement\n&ndash; Avoid brain racking by using <code>using</code>\n&ndash; On the VS operation unspecified error\n&ndash; Native sons...\n\nlinkedin:\n\nKeep things simple, or rack your brain. In one case, that can easily be avoided by using a using statement in the #RevitAPI\n\nhttp://bit.ly/usingusing\n\nYou should always keep things simple (I think).\nThe opposite can lead to racking your brain.\nIn one case at least, that can easily be avoided by using a using statement:\n\n- Avoid brain racking by using using\n- On the VS operation unspecified error\n- Native sons...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1869_using_vs_racking",
    "header_text": "Avoid Brain Racking by Using Using",
    "local_header_href": "#avoid-brain-racking-by-using-using",
    "chunk_text": "### Avoid Brain Racking by Using Using\n\nYou should always keep things simple (I think).\nThe opposite can lead to racking your brain.\nIn one case at least, that can easily be avoided by using a `using` statement:\n\n- [Avoid brain racking by using `using`](#2)\n- [On the VS operation unspecified error](#3)\n- [Native sons](#4)"
  },
  {
    "original_filename": "1869_using_vs_racking",
    "header_text": "Avoid Brain Racking by Using Using",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Avoid Brain Racking by Using Using\n\nHere is a quick note on the importance\nof [using `using` to automagically dispose and roll back](http://thebuildingcoder.typepad.com/blog/2012/04/using-using-automagically-disposes-and-rolls-back.html) transactions\nand transaction groups, and the grief and brain racking that can easily ensue from failing to do so:\n\n**Question:** For certain users, my add-in is hard crashing Revit to the desktop.\n\nNo exceptions, just everything closes.\n\nI’ve got the journal files and I wanted to get some help seeing if there is anything to learn from them.\n\n**Answer:** Sorry to hear about the hard crashes. And on certain users' systems, to boot.\n\nIs the problem reproducible?\n\nDoes it only happen on certain specific machines?\n\nDo you have any idea at all where the problem might be?\n\nDoes it send error reports to Autodesk?\n\nWhat context can cause it?\n\nDo you think it is due to your add-in, or Revit, or both?\n\n**Response:** Thanks for the follow up.\n\nI was able to get a hold of a customer’s computer that was seeing the error and track it down.\n\nI had a `TransactionGroup` that was started but never completed &ndash; I did not call `Assimilate` or `Rollback`.\n\nAdding the missing rollback fixed the error.\n\nI did a review of all my other code and confirmed I closed all my other transaction groups and transactions after I opened them.\n\nRelying on the destructor to call rollback obviously is a bad idea and was not intentional.\n\nThe relevant lines from the journal file look like this:\n\n<pre>\n' 7:< REGEN_DOC_CONTEXT_INFO: Changing wrong atom in regeneration\n' 7:< REGEN_DOC_CONTEXT_INFO: Document is changed in regeneration while it is not supposed to\n</pre>\n\nThe transaction wasn’t closed and Revit tried to regenerate.\n\n**Answer:** Congratulations on solving the issue!\n\nThank you very much for your research and useful explanation.  \n\nWere your transaction groups originally encapsulated in a `using` statement?\n\nThe Building Coder recommends doing so and claims that will obviate the need to call `Assimilate` or `Rollback`:\n[Using Using Automagically Disposes and Rolls Back](http://thebuildingcoder.typepad.com/blog/2012/04/using-using-automagically-disposes-and-rolls-back.html).\n\nI would be a rather shocked if that would turn out to be false.\n\nSo, I hope your transaction group causing the problem was not enclosed in a `using` statement.\n\nIf that is the case, I would strongly recommend ALWAYS enclosing transactions and transaction groups in `using` statements.\n\nThat would (I still hope) reliably avoid this problem forever.\n\nCan't wait to hear your response on this...\n\n**Response:** Brilliant!\n\nNo, I was not using `using` in my code.\n\nMakes perfect sense to do so to prevent errors like mine.\n\nI’m going to work on adding that to my code. There are 170 places I use a transaction, so it’s going to be a little work.\n\nYour blog is a great resource. I use it quite regularly when trying to figure things out.\n\nI don’t have any interesting code snippet to share.\nIt’s basically a `TransactionGroup` with an `Assimilate` call in an `IF` statement and a forgotten `Rollback` in the `ELSE`.\n\n<center>\n<img src=\"img/brain-rack.png\" alt=\"Brain rack\" title=\"Brain rack\" width=\"300\"/> <!-- 519 -->\n</center>"
  },
  {
    "original_filename": "1869_using_vs_racking",
    "header_text": "On the VS Operation Unspecified Error",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> On the VS Operation Unspecified Error\n\nA small note on the Visual Studio 'Operation could not be Completed, Unspecified Error':\n\nYou may have notices building Revit add-ins within Visual Studio getting strange build failures and a message along the lines of *21>Error: The operation could not be completed. Unspecified error*.\n\nThis seems to be an issue where the Visual Studio IDE gets itself into a strange state and the project in question has not been loaded properly for some reason.\n\nI found it related to switching project configurations before the build or even switching solutions.\n\nIt could also have to do with do a merge in git outside of the IDE that causes projects to change and reload.\n\nAnyway, without being clear the exact steps, when I do see the error, I found one of the following clears things up:\n\n- Close and reopen the solution in question.\n- Fully exit and restart Visual Studio.\n\nCould it have something to do with switching header files, or switching from debug to release?\n\nIt may, but I have seen it just simple closing one solution and loading another.\n\nI also got it in a standalone C# solution with some C++ projects.\nIt usually appears while trying to compile the C++ projects, which are a interop dependency for the C# projects &ndash; one theory is that somehow the C# binary locks the C++ one and doesn’t let msbuild query it for… god knows what, since interop is done at runtime afaik (never seen this error on rebuild, only build ).\nAnd yes, only VS restart cures it; fortunately, we rarely touch the C++ projects, so I just ignored this error so far. \n\nJeremy adds: I never touch C++ code, only C# Revit add-ins, and I see this message now and then as well.\nI just restart VS or even reboot Windows (under Parallels on Mac) and all is well."
  },
  {
    "original_filename": "1869_using_vs_racking",
    "header_text": "Native Sons",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Native Sons\n\nJohn Candela pays tribute to Native Americans for Monday,\n[Indigenous People's Day](https://en.wikipedia.org/wiki/Indigenous_Peoples%27_Day), with\nhis track [Native Sons](https://soundcloud.com/jdcandela/native-sons):\n\n<center>\n<iframe width=\"500\" height=\"100\" scrolling=\"no\" frameborder=\"no\" allow=\"autoplay\" src=\"https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/908029177&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true\"></iframe><div style=\"font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;\"><a href=\"https://soundcloud.com/jdcandela\" title=\"JC\" target=\"_blank\" style=\"color: #cccccc; text-decoration: none;\">JC</a> · <a href=\"https://soundcloud.com/jdcandela/native-sons\" title=\"Native Sons\" target=\"_blank\" style=\"color: #cccccc; text-decoration: none;\">Native Sons</a></div>\n</center>"
  }
]