[
  {
    "original_filename": "0501_vsta_and_updater",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0501_vsta_and_updater",
    "header_text": "VSTA to Stay and Updater to Go",
    "local_header_href": "#vsta-to-stay-and-updater-to-go",
    "chunk_text": "<h3>VSTA to Stay and Updater to Go</h3><p>As you may have heard from Kean, we have safely\n\n<a href=\"http://through-the-interface.typepad.com/through_the_interface/2010/12/arrived-in-mnchen.html\">\narrived in Munich, Germany</a> for\n\nthe next developer conference, the biggest one in our European series.\nActually, he only talks about his own arrival, but our arrival worked all right as well.\n\n<p>One topic that we are discussing at these conferences is cloud computing, so it was a funny coincidence to run into a nice big tangible cloud when we went out to have a dinner with our developer partners in\n\n<a href=\"http://www.heaven23.se\">\nHeaven 23</a>\n\nin Gothenburg before departing for Munich:</p>\n<center>\n<img alt=\"Heaven 23 cloud\" src=\"img/heaven23_cloud.jpg\"/>\n</center>\n<p>The restaurant is on the 23<sup>rd</sup> floor of the\n\n<a href=\"http://sv.wikipedia.org/wiki/Hotel_Gothia_Towers\">\nGothia Towers</a> with\n\na nice view down over\n\n<a href=\"http://en.wikipedia.org/wiki/Liseberg\">\nLiseberg amusement park</a>:</p>\n<center>\n<img alt=\"Heaven 23 view\" src=\"img/heaven23_view.jpg\"/>\n</center>\n<p>As you can see, the cloud can be accessed through reflection as well as the web service  :-)\n\n<p>Meanwhile, here are some questions that cropped up several times at\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/12/the-revit-api-track-at-au-2010.html\">\nAutodesk University</a> and\n\nwere mentioned during some of our meetings here in Europe as well:\n\n<ul>\n<li>Can we rely on <a href=\"#1\">VSTA remaining</a>? We heard that VBA for AutoCAD went away; is there any risk of that happening with VSTA for Revit as well?\n<li>Can I use the Dynamic Model Update technology if I wish to distribute a model to customers without my add-in? <a href=\"#2\">A warning message is displayed</a>. This is incomprehensible and worrying for the uninitiated user. How can I handle this gracefully, and best of all suppress it completely?\n<li>Can I <a href=\"#3\">automate the removal of an updater</a> reference?\n</li></li></li></ul>\n<a name=\"1\"></a>\n<h4>VSTA to Stay</h4>\n<p>VSTA is an acronym for Visual Studio Tools for Applications.\nIt is included in every Revit installation, so every user has access to it.\nIt provides an IDE or Integrated Development Environment for exploring the API and creating macros.\nThe code is almost completely compatible with the .NET API we use for external commands and applications defined in standard add-ins.\n\n<p>Macros written in VSTA can easily be moved to an external add-in, and vice versa.\n\n<p>One advantage of VSTA is the ability to edit and continue, which is currently not supported by the Visual Studio environment when creating standard external add-ins.\n\n<p>Some developers and users have been careful about jumping onto VSTA, because it is a Microsoft product, analogous to the old VBA, Visual Basic for Applications.\nVBA has been around for quite a while and was included in AutoCAD.\nIt is now being phased out, since Microsoft is reducing support for it.\n\n<p>As said, VSTA is here to stay.\nHere is a statement on this by Anthony Hauck, Revit Design Product Line Manager:\n\n<p>Autodesk is happy to announce an agreement with Microsoft to include the Visual Studio Tools for Applications (VSTA) development environment in all Revit products for the foreseeable future.\nPrevious communications touching on the status of VSTA in Revit expressed some uncertainty as to its inclusion with future versions, but with the agreement concluded earlier this year we are pleased that VSTA will continue to be an important development option for users of the Revit API.\n\n\n<a name=\"2\"></a>\n<h4>Removing an Updater Reference</h4>\n<p>One of the most powerful new API features in Revit 2011 is the Dynamic Model Update or DMU framework.\nIt enables you to register an updater to be triggered by certain events, and also to react on these events within the same transaction that triggered them, as demonstrated by the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/element-level-events.html#2\">\nDynamicModelUpdate and DistanceToSurfaces SDK samples</a> and Saikat's\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/08/structural-dynamic-model-update-sample.html\">\nStructural DMU sample</a>.\n\n<p>However, when a Revit model is modified by an updater and then distributed to a client without the add-in installed, a warning message is displayed which is not comprehensible for an uninitiated user.\n\n<p>For example, I implemented a minimal DMU application and ran the updater in a model, saved it, and reopen it later without the add-in defining the updater loaded.\nThe following message appeared:</p>\n<center>\n<img alt=\"Updater warning\" src=\"img/updaterwarning.png\"/>\n</center>\n<p>For completeness' sake, here is the\n\n<a href=\"zip/DummyUpdater.zip\">DummyUpdater</a>\n\napplication that I used to cause this message to appear.\n\n<p>How can I remove the reference to this updater from the model, in order to distribute it to a customer with no access to my add-in?\n\n<p>The very simplest answer is to tell you user to click on 'Do not warn about this updater again and continue working with the file', save the model, and continue working with it as normal.\n\n<p>However, many developers would prefer this message not to appear at all.\n\n<p>To achieve this, simply click on 'Do not warn about this updater again and continue working with the file' and save the model yourself and then pass it on to the customer.\n\n<p>The next time it is opened, the warning will no longer appear, because the reference to the updater has been removed.\n\n<p>Obviously, you need to well understand the consequences of removing this reference, and your application needs to be prepared to handle the situation in case it is ever loaded into the model again at a later stage, when changes may have been applied in its absence.\n\n\n<a name=\"3\"></a>\n<h4>Automating Updater Removal</h4>\n<p>If you downloaded my sample DMU application above, you may have noted an empty add-in skeleton in it named RemoveUpdater.\nI was originally planning to implement an add-in which automates the process of opening a Revit model containing an updater reference to remove, clicking on the option mentioned above, and saving and closing the file.\n\n<p>When I looked at this a bit more closely, I thought that I could save myself some work by creating a journal file to do the job instead.\nIt works really well.\nI did the following:\n\n<ol>\n<li>Copied my Revit document to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Started up Revit.\n<li>Opened the file.\n<li>The warning message appears, I selected the appropriate option.\n<li>Saved the file to a new path wall_updater_triggered_removed.rvt.\n<li>Quit Revit.\n<li>Copied the resulting journal file journal.0575.txt to journal_remove_updater.txt.\n</li></li></li></li></li></li></li></ol>\n<p>As you probably know, the journal files are by default located in the Journals subfolder of the Revit installation directory.\n\n<p>Now I can automate the removal of the updater from any Revit model by creating a batch file which:\n\n<ol>\n<li>Copies the model to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Starts up Revit with the journal file, e.g. using the command line listed below.\n<li>Moves the updated model from C:\\tmp\\wall_updater_triggered_removed.rvt to its final destination.\n</li></li></li></ol>\n<p>Here is the command line to drive Revit using the journal file; it is one single (long) line:\n\n<pre>\n\"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Program\\Revit.exe\"\n  \"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Journals\n    \\journal_remove_updater.txt\"\n</pre>\n<p>Obviously this could also be more cleanly implemented using the API, but that is left as an exercise for the reader.\n\n<p>Best regards to all from Munich!\n\n<!--\n\nMikako \n\nIf you use an updater to modify a document, the client ID (along with certain other information like updater id and name) is stored in the document.  The next time you load the document without that updater running Revit will warn you about it.\n\nBut there should be a number of choices coming from the warning:\n\n- Continue working with file\n- Do not warn about this updater again and continue working with file\n- Close without save\n- Save under different name and continue working\n\nDo not warn about this updater again should remove the association.\n\nThanks,\nScott\n\nFrom: Mikako Harada\nSent: Tuesday, January 05, 2010 5:36 PM\nTo: Harry Mattison; Saikat Bhattacharya; Jeremy Tammik\nCc: Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\nImportance: Low\n\nHello,\n\nJust a minor comment \n\nIt was there in alpha2.  I encountered it while preparing for the DevDay demo.\n\nI somehow got an impression that once I use a certain client ID, it remembers it somewhere.  Is it correct observation?\n(I think I needed to use completely new set of GUID to make it work. ).\n\nIf so, if there a place where I can refresh it?\n\n(If not, maybe it was something else  please ignore.)\n\n-\tMikako\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 8:46 AM\nTo: Saikat Bhattacharya; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThis requirement was introduced relatively recently, so it is possible that it worked in Alpha 2 with a GUID mis-match.\n\nHarry\n\nFrom: Saikat Bhattacharya\nSent: Thursday, December 24, 2009 12:46 AM\nTo: Harry Mattison; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Harry:\n\nAfter I made the GUID of Add-in in the manifest file same as what exists in the code, it worked fine for me. Not sure if this was a requirement with Alpha 2 too, since I dont remember making conscious effort to ensure both are the same (or maybe I did) and the sample used to work. Nevertheless, it works fine now and this information is definitely good to know.\n\nThanks again\nSaikat\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 2:01 AM\nTo: Jeremy Tammik; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Jeremy,\n\nYes, it is required. Removing it results in this error\n\nFrom: Jeremy Tammik\nSent: Wednesday, December 23, 2009 2:35 PM\nTo: Harry Mattison; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nhi harry,\n\nthank you for the info!\n\nis the ClientId field obligatory in the addin manifest, or optional?\n\ncheers\n\njeremy\n\nFrom: Harry Mattison\nSent: Wednesday, December 23, 2009 19:36\nTo: Saikat Bhattacharya; Phil Xia; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThe problem may be a mismatch between your addin file and the  AddInId in the WallUpdater class.\n\nI modified them as follows so the GUIDs match and the updater runs correctly.\n\n        static AddInId m_appId = new AddInId(new Guid(\"7DF81445-63A6-475f-B080-A66895C81B92\"));\n\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<RevitAddIns>\n   <AddIn Type=\"Command\">\n      <Text>Wall Updater Test</Text>\n      <Assembly>C:\\Users\\mattish\\Desktop\\DynamicModel\\Iteration\\bin\\Debug\\Iteration.dll</Assembly>\n      <ClientId>7DF81445-63A6-475f-B080-A66895C81B92</ClientId>\n      <FullClassName>Iteration.RegisterWallUpdate</FullClassName>\n   </AddIn>\n</RevitAddIns>\n\n\nFrom: Saikat Bhattacharya\nSent: Wednesday, December 23, 2009 5:11 AM\nTo: Phil Xia; Harry Mattison; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: Dymanic Model update sample\n\nHi Harry\\Phil:\n\nIf possible, can you please check why I am getting an internal error with the attached Dynamic model sample project. The error occurs at the RegisterUpdater line of code.\n\nThanks\nSaikat\n\n-->\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0501_vsta_and_updater",
    "header_text": "VSTA to Stay",
    "local_header_href": "#vsta-to-stay",
    "chunk_text": "<h4>VSTA to Stay</h4><p>VSTA is an acronym for Visual Studio Tools for Applications.\nIt is included in every Revit installation, so every user has access to it.\nIt provides an IDE or Integrated Development Environment for exploring the API and creating macros.\nThe code is almost completely compatible with the .NET API we use for external commands and applications defined in standard add-ins.\n\n<p>Macros written in VSTA can easily be moved to an external add-in, and vice versa.\n\n<p>One advantage of VSTA is the ability to edit and continue, which is currently not supported by the Visual Studio environment when creating standard external add-ins.\n\n<p>Some developers and users have been careful about jumping onto VSTA, because it is a Microsoft product, analogous to the old VBA, Visual Basic for Applications.\nVBA has been around for quite a while and was included in AutoCAD.\nIt is now being phased out, since Microsoft is reducing support for it.\n\n<p>As said, VSTA is here to stay.\nHere is a statement on this by Anthony Hauck, Revit Design Product Line Manager:\n\n<p>Autodesk is happy to announce an agreement with Microsoft to include the Visual Studio Tools for Applications (VSTA) development environment in all Revit products for the foreseeable future.\nPrevious communications touching on the status of VSTA in Revit expressed some uncertainty as to its inclusion with future versions, but with the agreement concluded earlier this year we are pleased that VSTA will continue to be an important development option for users of the Revit API.\n\n\n<a name=\"2\"></a>\n<h4>Removing an Updater Reference</h4>\n<p>One of the most powerful new API features in Revit 2011 is the Dynamic Model Update or DMU framework.\nIt enables you to register an updater to be triggered by certain events, and also to react on these events within the same transaction that triggered them, as demonstrated by the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/element-level-events.html#2\">\nDynamicModelUpdate and DistanceToSurfaces SDK samples</a> and Saikat's\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/08/structural-dynamic-model-update-sample.html\">\nStructural DMU sample</a>.\n\n<p>However, when a Revit model is modified by an updater and then distributed to a client without the add-in installed, a warning message is displayed which is not comprehensible for an uninitiated user.\n\n<p>For example, I implemented a minimal DMU application and ran the updater in a model, saved it, and reopen it later without the add-in defining the updater loaded.\nThe following message appeared:</p>\n<center>\n<img alt=\"Updater warning\" src=\"img/updaterwarning.png\"/>\n</center>\n<p>For completeness' sake, here is the\n\n<a href=\"zip/DummyUpdater.zip\">DummyUpdater</a>\n\napplication that I used to cause this message to appear.\n\n<p>How can I remove the reference to this updater from the model, in order to distribute it to a customer with no access to my add-in?\n\n<p>The very simplest answer is to tell you user to click on 'Do not warn about this updater again and continue working with the file', save the model, and continue working with it as normal.\n\n<p>However, many developers would prefer this message not to appear at all.\n\n<p>To achieve this, simply click on 'Do not warn about this updater again and continue working with the file' and save the model yourself and then pass it on to the customer.\n\n<p>The next time it is opened, the warning will no longer appear, because the reference to the updater has been removed.\n\n<p>Obviously, you need to well understand the consequences of removing this reference, and your application needs to be prepared to handle the situation in case it is ever loaded into the model again at a later stage, when changes may have been applied in its absence.\n\n\n<a name=\"3\"></a>\n<h4>Automating Updater Removal</h4>\n<p>If you downloaded my sample DMU application above, you may have noted an empty add-in skeleton in it named RemoveUpdater.\nI was originally planning to implement an add-in which automates the process of opening a Revit model containing an updater reference to remove, clicking on the option mentioned above, and saving and closing the file.\n\n<p>When I looked at this a bit more closely, I thought that I could save myself some work by creating a journal file to do the job instead.\nIt works really well.\nI did the following:\n\n<ol>\n<li>Copied my Revit document to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Started up Revit.\n<li>Opened the file.\n<li>The warning message appears, I selected the appropriate option.\n<li>Saved the file to a new path wall_updater_triggered_removed.rvt.\n<li>Quit Revit.\n<li>Copied the resulting journal file journal.0575.txt to journal_remove_updater.txt.\n</li></li></li></li></li></li></li></ol>\n<p>As you probably know, the journal files are by default located in the Journals subfolder of the Revit installation directory.\n\n<p>Now I can automate the removal of the updater from any Revit model by creating a batch file which:\n\n<ol>\n<li>Copies the model to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Starts up Revit with the journal file, e.g. using the command line listed below.\n<li>Moves the updated model from C:\\tmp\\wall_updater_triggered_removed.rvt to its final destination.\n</li></li></li></ol>\n<p>Here is the command line to drive Revit using the journal file; it is one single (long) line:\n\n<pre>\n\"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Program\\Revit.exe\"\n  \"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Journals\n    \\journal_remove_updater.txt\"\n</pre>\n<p>Obviously this could also be more cleanly implemented using the API, but that is left as an exercise for the reader.\n\n<p>Best regards to all from Munich!\n\n<!--\n\nMikako \n\nIf you use an updater to modify a document, the client ID (along with certain other information like updater id and name) is stored in the document.  The next time you load the document without that updater running Revit will warn you about it.\n\nBut there should be a number of choices coming from the warning:\n\n- Continue working with file\n- Do not warn about this updater again and continue working with file\n- Close without save\n- Save under different name and continue working\n\nDo not warn about this updater again should remove the association.\n\nThanks,\nScott\n\nFrom: Mikako Harada\nSent: Tuesday, January 05, 2010 5:36 PM\nTo: Harry Mattison; Saikat Bhattacharya; Jeremy Tammik\nCc: Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\nImportance: Low\n\nHello,\n\nJust a minor comment \n\nIt was there in alpha2.  I encountered it while preparing for the DevDay demo.\n\nI somehow got an impression that once I use a certain client ID, it remembers it somewhere.  Is it correct observation?\n(I think I needed to use completely new set of GUID to make it work. ).\n\nIf so, if there a place where I can refresh it?\n\n(If not, maybe it was something else  please ignore.)\n\n-\tMikako\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 8:46 AM\nTo: Saikat Bhattacharya; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThis requirement was introduced relatively recently, so it is possible that it worked in Alpha 2 with a GUID mis-match.\n\nHarry\n\nFrom: Saikat Bhattacharya\nSent: Thursday, December 24, 2009 12:46 AM\nTo: Harry Mattison; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Harry:\n\nAfter I made the GUID of Add-in in the manifest file same as what exists in the code, it worked fine for me. Not sure if this was a requirement with Alpha 2 too, since I dont remember making conscious effort to ensure both are the same (or maybe I did) and the sample used to work. Nevertheless, it works fine now and this information is definitely good to know.\n\nThanks again\nSaikat\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 2:01 AM\nTo: Jeremy Tammik; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Jeremy,\n\nYes, it is required. Removing it results in this error\n\nFrom: Jeremy Tammik\nSent: Wednesday, December 23, 2009 2:35 PM\nTo: Harry Mattison; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nhi harry,\n\nthank you for the info!\n\nis the ClientId field obligatory in the addin manifest, or optional?\n\ncheers\n\njeremy\n\nFrom: Harry Mattison\nSent: Wednesday, December 23, 2009 19:36\nTo: Saikat Bhattacharya; Phil Xia; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThe problem may be a mismatch between your addin file and the  AddInId in the WallUpdater class.\n\nI modified them as follows so the GUIDs match and the updater runs correctly.\n\n        static AddInId m_appId = new AddInId(new Guid(\"7DF81445-63A6-475f-B080-A66895C81B92\"));\n\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<RevitAddIns>\n   <AddIn Type=\"Command\">\n      <Text>Wall Updater Test</Text>\n      <Assembly>C:\\Users\\mattish\\Desktop\\DynamicModel\\Iteration\\bin\\Debug\\Iteration.dll</Assembly>\n      <ClientId>7DF81445-63A6-475f-B080-A66895C81B92</ClientId>\n      <FullClassName>Iteration.RegisterWallUpdate</FullClassName>\n   </AddIn>\n</RevitAddIns>\n\n\nFrom: Saikat Bhattacharya\nSent: Wednesday, December 23, 2009 5:11 AM\nTo: Phil Xia; Harry Mattison; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: Dymanic Model update sample\n\nHi Harry\\Phil:\n\nIf possible, can you please check why I am getting an internal error with the attached Dynamic model sample project. The error occurs at the RegisterUpdater line of code.\n\nThanks\nSaikat\n\n-->\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0501_vsta_and_updater",
    "header_text": "Removing an Updater Reference",
    "local_header_href": "#removing-an-updater-reference",
    "chunk_text": "<h4>Removing an Updater Reference</h4><p>One of the most powerful new API features in Revit 2011 is the Dynamic Model Update or DMU framework.\nIt enables you to register an updater to be triggered by certain events, and also to react on these events within the same transaction that triggered them, as demonstrated by the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/element-level-events.html#2\">\nDynamicModelUpdate and DistanceToSurfaces SDK samples</a> and Saikat's\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/08/structural-dynamic-model-update-sample.html\">\nStructural DMU sample</a>.\n\n<p>However, when a Revit model is modified by an updater and then distributed to a client without the add-in installed, a warning message is displayed which is not comprehensible for an uninitiated user.\n\n<p>For example, I implemented a minimal DMU application and ran the updater in a model, saved it, and reopen it later without the add-in defining the updater loaded.\nThe following message appeared:</p>\n<center>\n<img alt=\"Updater warning\" src=\"img/updaterwarning.png\"/>\n</center>\n<p>For completeness' sake, here is the\n\n<a href=\"zip/DummyUpdater.zip\">DummyUpdater</a>\n\napplication that I used to cause this message to appear.\n\n<p>How can I remove the reference to this updater from the model, in order to distribute it to a customer with no access to my add-in?\n\n<p>The very simplest answer is to tell you user to click on 'Do not warn about this updater again and continue working with the file', save the model, and continue working with it as normal.\n\n<p>However, many developers would prefer this message not to appear at all.\n\n<p>To achieve this, simply click on 'Do not warn about this updater again and continue working with the file' and save the model yourself and then pass it on to the customer.\n\n<p>The next time it is opened, the warning will no longer appear, because the reference to the updater has been removed.\n\n<p>Obviously, you need to well understand the consequences of removing this reference, and your application needs to be prepared to handle the situation in case it is ever loaded into the model again at a later stage, when changes may have been applied in its absence.\n\n\n<a name=\"3\"></a>\n<h4>Automating Updater Removal</h4>\n<p>If you downloaded my sample DMU application above, you may have noted an empty add-in skeleton in it named RemoveUpdater.\nI was originally planning to implement an add-in which automates the process of opening a Revit model containing an updater reference to remove, clicking on the option mentioned above, and saving and closing the file.\n\n<p>When I looked at this a bit more closely, I thought that I could save myself some work by creating a journal file to do the job instead.\nIt works really well.\nI did the following:\n\n<ol>\n<li>Copied my Revit document to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Started up Revit.\n<li>Opened the file.\n<li>The warning message appears, I selected the appropriate option.\n<li>Saved the file to a new path wall_updater_triggered_removed.rvt.\n<li>Quit Revit.\n<li>Copied the resulting journal file journal.0575.txt to journal_remove_updater.txt.\n</li></li></li></li></li></li></li></ol>\n<p>As you probably know, the journal files are by default located in the Journals subfolder of the Revit installation directory.\n\n<p>Now I can automate the removal of the updater from any Revit model by creating a batch file which:\n\n<ol>\n<li>Copies the model to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Starts up Revit with the journal file, e.g. using the command line listed below.\n<li>Moves the updated model from C:\\tmp\\wall_updater_triggered_removed.rvt to its final destination.\n</li></li></li></ol>\n<p>Here is the command line to drive Revit using the journal file; it is one single (long) line:\n\n<pre>\n\"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Program\\Revit.exe\"\n  \"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Journals\n    \\journal_remove_updater.txt\"\n</pre>\n<p>Obviously this could also be more cleanly implemented using the API, but that is left as an exercise for the reader.\n\n<p>Best regards to all from Munich!\n\n<!--\n\nMikako \n\nIf you use an updater to modify a document, the client ID (along with certain other information like updater id and name) is stored in the document.  The next time you load the document without that updater running Revit will warn you about it.\n\nBut there should be a number of choices coming from the warning:\n\n- Continue working with file\n- Do not warn about this updater again and continue working with file\n- Close without save\n- Save under different name and continue working\n\nDo not warn about this updater again should remove the association.\n\nThanks,\nScott\n\nFrom: Mikako Harada\nSent: Tuesday, January 05, 2010 5:36 PM\nTo: Harry Mattison; Saikat Bhattacharya; Jeremy Tammik\nCc: Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\nImportance: Low\n\nHello,\n\nJust a minor comment \n\nIt was there in alpha2.  I encountered it while preparing for the DevDay demo.\n\nI somehow got an impression that once I use a certain client ID, it remembers it somewhere.  Is it correct observation?\n(I think I needed to use completely new set of GUID to make it work. ).\n\nIf so, if there a place where I can refresh it?\n\n(If not, maybe it was something else  please ignore.)\n\n-\tMikako\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 8:46 AM\nTo: Saikat Bhattacharya; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThis requirement was introduced relatively recently, so it is possible that it worked in Alpha 2 with a GUID mis-match.\n\nHarry\n\nFrom: Saikat Bhattacharya\nSent: Thursday, December 24, 2009 12:46 AM\nTo: Harry Mattison; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Harry:\n\nAfter I made the GUID of Add-in in the manifest file same as what exists in the code, it worked fine for me. Not sure if this was a requirement with Alpha 2 too, since I dont remember making conscious effort to ensure both are the same (or maybe I did) and the sample used to work. Nevertheless, it works fine now and this information is definitely good to know.\n\nThanks again\nSaikat\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 2:01 AM\nTo: Jeremy Tammik; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Jeremy,\n\nYes, it is required. Removing it results in this error\n\nFrom: Jeremy Tammik\nSent: Wednesday, December 23, 2009 2:35 PM\nTo: Harry Mattison; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nhi harry,\n\nthank you for the info!\n\nis the ClientId field obligatory in the addin manifest, or optional?\n\ncheers\n\njeremy\n\nFrom: Harry Mattison\nSent: Wednesday, December 23, 2009 19:36\nTo: Saikat Bhattacharya; Phil Xia; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThe problem may be a mismatch between your addin file and the  AddInId in the WallUpdater class.\n\nI modified them as follows so the GUIDs match and the updater runs correctly.\n\n        static AddInId m_appId = new AddInId(new Guid(\"7DF81445-63A6-475f-B080-A66895C81B92\"));\n\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<RevitAddIns>\n   <AddIn Type=\"Command\">\n      <Text>Wall Updater Test</Text>\n      <Assembly>C:\\Users\\mattish\\Desktop\\DynamicModel\\Iteration\\bin\\Debug\\Iteration.dll</Assembly>\n      <ClientId>7DF81445-63A6-475f-B080-A66895C81B92</ClientId>\n      <FullClassName>Iteration.RegisterWallUpdate</FullClassName>\n   </AddIn>\n</RevitAddIns>\n\n\nFrom: Saikat Bhattacharya\nSent: Wednesday, December 23, 2009 5:11 AM\nTo: Phil Xia; Harry Mattison; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: Dymanic Model update sample\n\nHi Harry\\Phil:\n\nIf possible, can you please check why I am getting an internal error with the attached Dynamic model sample project. The error occurs at the RegisterUpdater line of code.\n\nThanks\nSaikat\n\n-->\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0501_vsta_and_updater",
    "header_text": "Automating Updater Removal",
    "local_header_href": "#automating-updater-removal",
    "chunk_text": "<h4>Automating Updater Removal</h4><p>If you downloaded my sample DMU application above, you may have noted an empty add-in skeleton in it named RemoveUpdater.\nI was originally planning to implement an add-in which automates the process of opening a Revit model containing an updater reference to remove, clicking on the option mentioned above, and saving and closing the file.\n\n<p>When I looked at this a bit more closely, I thought that I could save myself some work by creating a journal file to do the job instead.\nIt works really well.\nI did the following:\n\n<ol>\n<li>Copied my Revit document to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Started up Revit.\n<li>Opened the file.\n<li>The warning message appears, I selected the appropriate option.\n<li>Saved the file to a new path wall_updater_triggered_removed.rvt.\n<li>Quit Revit.\n<li>Copied the resulting journal file journal.0575.txt to journal_remove_updater.txt.\n</li></li></li></li></li></li></li></ol>\n<p>As you probably know, the journal files are by default located in the Journals subfolder of the Revit installation directory.\n\n<p>Now I can automate the removal of the updater from any Revit model by creating a batch file which:\n\n<ol>\n<li>Copies the model to C:\\tmp\\wall_updater_triggered.rvt.\n<li>Starts up Revit with the journal file, e.g. using the command line listed below.\n<li>Moves the updated model from C:\\tmp\\wall_updater_triggered_removed.rvt to its final destination.\n</li></li></li></ol>\n<p>Here is the command line to drive Revit using the journal file; it is one single (long) line:\n\n<pre>\n\"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Program\\Revit.exe\"\n  \"C:\\Program Files\\Autodesk\\Revit Architecture 2011\\Journals\n    \\journal_remove_updater.txt\"\n</pre>\n<p>Obviously this could also be more cleanly implemented using the API, but that is left as an exercise for the reader.\n\n<p>Best regards to all from Munich!\n\n<!--\n\nMikako \n\nIf you use an updater to modify a document, the client ID (along with certain other information like updater id and name) is stored in the document.  The next time you load the document without that updater running Revit will warn you about it.\n\nBut there should be a number of choices coming from the warning:\n\n- Continue working with file\n- Do not warn about this updater again and continue working with file\n- Close without save\n- Save under different name and continue working\n\nDo not warn about this updater again should remove the association.\n\nThanks,\nScott\n\nFrom: Mikako Harada\nSent: Tuesday, January 05, 2010 5:36 PM\nTo: Harry Mattison; Saikat Bhattacharya; Jeremy Tammik\nCc: Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\nImportance: Low\n\nHello,\n\nJust a minor comment \n\nIt was there in alpha2.  I encountered it while preparing for the DevDay demo.\n\nI somehow got an impression that once I use a certain client ID, it remembers it somewhere.  Is it correct observation?\n(I think I needed to use completely new set of GUID to make it work. ).\n\nIf so, if there a place where I can refresh it?\n\n(If not, maybe it was something else  please ignore.)\n\n-\tMikako\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 8:46 AM\nTo: Saikat Bhattacharya; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThis requirement was introduced relatively recently, so it is possible that it worked in Alpha 2 with a GUID mis-match.\n\nHarry\n\nFrom: Saikat Bhattacharya\nSent: Thursday, December 24, 2009 12:46 AM\nTo: Harry Mattison; Jeremy Tammik\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Harry:\n\nAfter I made the GUID of Add-in in the manifest file same as what exists in the code, it worked fine for me. Not sure if this was a requirement with Alpha 2 too, since I dont remember making conscious effort to ensure both are the same (or maybe I did) and the sample used to work. Nevertheless, it works fine now and this information is definitely good to know.\n\nThanks again\nSaikat\n\nFrom: Harry Mattison\nSent: Thursday, December 24, 2009 2:01 AM\nTo: Jeremy Tammik; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nHi Jeremy,\n\nYes, it is required. Removing it results in this error\n\nFrom: Jeremy Tammik\nSent: Wednesday, December 23, 2009 2:35 PM\nTo: Harry Mattison; Saikat Bhattacharya\nCc: Mikako Harada; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye; Phil Xia; Scott Conover\nSubject: RE: Dymanic Model update sample\n\nhi harry,\n\nthank you for the info!\n\nis the ClientId field obligatory in the addin manifest, or optional?\n\ncheers\n\njeremy\n\nFrom: Harry Mattison\nSent: Wednesday, December 23, 2009 19:36\nTo: Saikat Bhattacharya; Phil Xia; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: RE: Dymanic Model update sample\n\nHi Saikat,\n\nThe problem may be a mismatch between your addin file and the  AddInId in the WallUpdater class.\n\nI modified them as follows so the GUIDs match and the updater runs correctly.\n\n        static AddInId m_appId = new AddInId(new Guid(\"7DF81445-63A6-475f-B080-A66895C81B92\"));\n\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<RevitAddIns>\n   <AddIn Type=\"Command\">\n      <Text>Wall Updater Test</Text>\n      <Assembly>C:\\Users\\mattish\\Desktop\\DynamicModel\\Iteration\\bin\\Debug\\Iteration.dll</Assembly>\n      <ClientId>7DF81445-63A6-475f-B080-A66895C81B92</ClientId>\n      <FullClassName>Iteration.RegisterWallUpdate</FullClassName>\n   </AddIn>\n</RevitAddIns>\n\n\nFrom: Saikat Bhattacharya\nSent: Wednesday, December 23, 2009 5:11 AM\nTo: Phil Xia; Harry Mattison; Scott Conover\nCc: Mikako Harada; Jeremy Tammik; Akira Kudo; Katsuaki Takamizawa; Adam Nagy; Joe Ye\nSubject: Dymanic Model update sample\n\nHi Harry\\Phil:\n\nIf possible, can you please check why I am getting an internal error with the attached Dynamic model sample project. The error occurs at the RegisterUpdater line of code.\n\nThanks\nSaikat\n\n-->\n</p></p></p></p></p></p></p>"
  }
]