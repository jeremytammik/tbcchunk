[
  {
    "original_filename": "0817_tooltip_video",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0817_tooltip_video",
    "header_text": "Video Animated Ribbon Item Tooltip",
    "local_header_href": "#video-animated-ribbon-item-tooltip",
    "chunk_text": "<h3>Video Animated Ribbon Item Tooltip</h3><p>We already discussed a number of interesting things you can do with the Revit ribbon and user interface, many inspired by Rudolf Honke's exploration of uses of the .NET \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/automation\">\nUI Automation</a> functionality.\n\n<p>Here is a related contribution by Victor Chekalin, or Виктор Чекалин, fleshed out from his answer to Rudolf's \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/06/retrieve-embedded-resource-image.html?cid=6a00e553e168978833016767281031970b#comment-6a00e553e168978833016767281031970b\">\nquestion on animating a ribbon item tooltip</a>, discussing the retrieval of \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/06/retrieve-embedded-resource-image.html\">\nembedded resource images</a>:\n\n<p>It is possible to add your own video to a Revit ribbon button tool tip, and I've found a way to achieve this.</p>\n<center>\n<img alt=\"Video running in a Revit ribbon item tool tip\" src=\"img/VCButtonsWithVideoToolTip.png\"/>\n</center>\n<p>This can be achieved using the undocumented AdWindows.dll and UIFramework.dll assemblies located in the Revit program folder.\n<p>They provide many interesting classes, as Rudolf Honke already pointed out in his examples using \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/automation\">\nUI Automation</a>.\n\n<p>There is a RibbonToolTip class in the AdWindows.dll assembly. \nThe class provides a property named ExpandedVideo. \nThe next step is to find a class which can contain ToolTip property. \nThis class is Autodesk.Windows.RibbonItem.\n\n<p>So, the idea is to find the correct RibbonItem in the ribbon control and set RibbonToolTip to it.\n\n<p>But here there is the trouble. \nWe can create a PushButton on a Panel using Application.CreatePanel().AddItem(RevitItem) to obtain a Autodesk.Revit.UI.RibbonItem. \nBut we need Autodesk.Windows.RibbonItem.\n\n<p>There are several ways.\n\n<p>The first one – use RevitControl class and iterate all tabs, panels and buttons and find button by name.\n\n<p>We can get RevitControl instance using static property RibbonControl UIFramework.RevitRibbonControl class.\n\n<p>RibbonControl contains exactly Autodesk.Windows.RibbonItem items not a Autodesk.Revit.UI.RibbonItem. \nIt's look like we need.\n\n<p>Here is the <a href=\"http://pastebin.com/aXZ6u2nL\">code</a> implementing this:\n\n<pre class=\"code\">\n  <span class=\"blue\">public</span> Autodesk.Windows.<span class=\"teal\">RibbonItem</span> GetRibbonItem( \n    <span class=\"teal\">RibbonItem</span> item )\n  {\n    <span class=\"teal\">RibbonControl</span> ribbonControl \n      = <span class=\"teal\">RevitRibbonControl</span>.RibbonControl;\n \n    <span class=\"blue\">foreach</span>( <span class=\"blue\">var</span> tab <span class=\"blue\">in</span> ribbonControl.Tabs )\n    {\n      <span class=\"blue\">foreach</span>( <span class=\"blue\">var</span> panel <span class=\"blue\">in</span> tab.Panels )\n      {\n        <span class=\"blue\">foreach</span>( <span class=\"blue\">var</span> ribbonItem \n          <span class=\"blue\">in</span> panel.Source.Items )\n        {\n          <span class=\"blue\">if</span>( ribbonItem.AutomationName\n            == item.Name )\n          {\n            <span class=\"blue\">return</span> ribbonItem <span class=\"blue\">as</span>\n              Autodesk.Windows.<span class=\"teal\">RibbonItem</span>;\n          }\n        }\n      }\n    }\n    <span class=\"blue\">return</span> <span class=\"blue\">null</span>;\n  }\n</pre>\n<p>But there is a second way. \nThe Autodesk.Revit.UI.RibbonItem class has an internal method getRibbonItem which returns Autodesk.Windows.RibbonItem. Interesting. \nTry to use this method. \nThe reflection helps us.\n\n<p>Here is the <a href=\"http://pastebin.com/52hVR61d\">code</a>:\n\n<pre class=\"code\">\n  <span class=\"blue\">public</span> Autodesk.Windows.<span class=\"teal\">RibbonItem</span> GetRibbonItem( \n    <span class=\"teal\">RibbonItem</span> item )\n  {\n    <span class=\"teal\">Type</span> itemType = item.GetType();\n \n    <span class=\"blue\">var</span> mi = itemType.GetMethod( <span class=\"maroon\">\"getRibbonItem\"</span>, \n      <span class=\"teal\">BindingFlags</span>.NonPublic | <span class=\"teal\">BindingFlags</span>.Instance );\n \n    <span class=\"blue\">var</span> windowRibbonItem = mi.Invoke( item, <span class=\"blue\">null</span> );\n \n    <span class=\"blue\">return</span> windowRibbonItem \n      <span class=\"blue\">as</span> Autodesk.Windows.<span class=\"teal\">RibbonItem</span>;\n  }\n</pre>\n<p>So, after we get a Autodesk.Windows.RibbonItem we can set RibbonToolTip to it.\n\n<p>For example <a href=\"http://pastebin.com/XtpKjLYq\">like this</a>:\n\n<pre class=\"code\">\n  RibbonToolTip toolTip1 = <span class=\"blue\">new</span> RibbonToolTip()\n  {\n    Title = <span class=\"maroon\">\"This is important button1\"</span>,\n    ExpandedContent = \n<span class=\"maroon\">@\"Here you can see swf video from local file. </span>\n<span class=\"maroon\">The file path is C:/Program Files</span>\n<span class=\"maroon\">/Autodesk/Revit Structure 2013/Program/videos</span>\n<span class=\"maroon\">/GUID-053F3A19-7EFF-48D5-A0FA-AF0C2CC4BD9D-low.swf\"</span>,        \n    ExpandedVideo = <span class=\"blue\">new</span> <span class=\"teal\">Uri</span>( <span class=\"maroon\">\"C:/Program Files\"</span>\n      + <span class=\"maroon\">\"/Autodesk/Revit Structure 2013/Program/videos\"</span>\n      + <span class=\"maroon\">\"/GUID-053F3A19-7EFF-48D5-A0FA\"</span>\n      + <span class=\"maroon\">\"-AF0C2CC4BD9D-low.swf\"</span> ),\n    ExpandedImage = <span class=\"teal\">BitmapSourceConverter</span>\n      .ConvertFromImage( <span class=\"teal\">Resources</span>.logoITC_16 )\n  };\n</pre>\n<p>PROFIT!!!\n\n<p>Also there is a third way to get a Autodesk.Windows.RibbonItem. \nCreate a tab, panel and button directly via RevitControl class. \nBut I didn't find how to set IExtenalCommand to a button.\n\n<p>RevitToolTip.ExpandedVideo supports SWF video. \nAlso I tried a GIF image. \nThe image was shown but didn't animate. \nAlso I tried to set Internet URL. \nOn my computer it doesn't work. \nMaybe it doesn't work via proxy, or maybe access is denied on video in the internet. \nPlease try and tell me.\n\n<p>To wrap this up, here is the \n\n<a href=\"zip/VCButtonsWithVideoToolTip3.zip\">\nfull source code</a> of \n\nmy solution with test projects displaying video tool tip buttons for both Revit 2012 and 2013.\n\n<p>You may need to re-reference the Revit assemblies to compile them. \n\n<p>The first button loads a video from Revit Structure 201X\\Program\\videos. \nIf you have not installed RST you won't see the video on the first button. \nThe second button loads a video from the internet, and the third button loads one from the embedded resources. \nSo everyone should be able to see the video on the Button3.\n\n<p>Hope this information is useful for you.\n\n<p>Many thanks to Victor for exploring and explaining this exciting possibility!\n\n<a name=\"2\"></a>\n<h4>Adjusting Beam Cutback</h4>\n<p>By the way, here is a yet another topic that I wanted to address for a long time, and now Mikako beat me to it: the FamilyInstance ExtensionUtility property allows you to control the joining, cutback and extension behaviour of beams, columns, girders etc.\n\nMikako shows how in her discussion and real-world sample on \n\n<a href=\"http://adndevblog.typepad.com/aec/2012/09/adjusting-cutback-programmatically-.html\">\nadjusting cutback programmatically</a>.</p>\n<center>\n<img alt=\"Girders with cutback and miter joins\" src=\"img/extensionutility.png\"/>\n</center>\n</p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0817_tooltip_video",
    "header_text": "Adjusting Beam Cutback",
    "local_header_href": "#adjusting-beam-cutback",
    "chunk_text": "<h4>Adjusting Beam Cutback</h4><p>By the way, here is a yet another topic that I wanted to address for a long time, and now Mikako beat me to it: the FamilyInstance ExtensionUtility property allows you to control the joining, cutback and extension behaviour of beams, columns, girders etc.\n\nMikako shows how in her discussion and real-world sample on \n\n<a href=\"http://adndevblog.typepad.com/aec/2012/09/adjusting-cutback-programmatically-.html\">\nadjusting cutback programmatically</a>.</p><center>\n<img alt=\"Girders with cutback and miter joins\" src=\"img/extensionutility.png\"/>\n</center>"
  }
]