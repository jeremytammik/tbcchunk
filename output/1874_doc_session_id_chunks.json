[
  {
    "original_filename": "1874_doc_session_id",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Jailbreak Revit: GraphQL & ServiceBus\n  https://youtu.be/7LnbP4n4RYM\n  Gregor Vilkner, Ph.D.  12:24 AM\n  Got a shout out for you... ðŸŽƒ\n  19:30min mark...\n\n- Document Session ID\n  https://forums.autodesk.com/t5/revit-api-forum/document-session-id/m-p/9844775#M50895\n\n- vendor id\n  Where do I register a Vendor ID for use in Revit .addin files?\n  Q: For what seems like a looong time ago (> 15 years) I registered a Vendor ID for my previous employer Cad Quality AB in Sweden. Now I am trying to do the same for my new employer Tribia AB, but I cannot find any page on ADN or Autodesk websites for doing so.\n  Are the Vendor ID:s still in use, and if so â€“ where can I register a new ID?\n  A: This vendor id is no longer in use.\n  The recommended vendor id to use in a Revit add-in manifest file is your reversed internet url, afaik.\n  For example, i use:\n  <VendorId>com.typepad.thebuildingcoder</VendorId>\n  <VendorDescription>The Building Coder, http://thebuildingcoder.typepad.com</VendorDescription>\n  https://thebuildingcoder.typepad.com/blog/2018/06/add-in-registration-vendorid-and-signature.html#2\n\n- 7848 [How to detect Revit File Version before DA4R]\n\n- Parable of the Polygons -- https://ncase.me/polygons/\n\ntwitter:\n\nDocument session id, valid #RevitAPI context, external events, determining RVT file version for Design Automation workitem and Revit API via HTTP with @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon https://bit.ly/docsessionid\n\nSome new topics, and, as always, some recurring\n&ndash; Document session id\n&ndash; Valid Revit API context and external events\n&ndash; Determining RVT file version for DA4R workitem\n&ndash; Revit API via HTTP\n&ndash; Parable of the polygons...\n\nlinkedin:\n\nDocument session id, valid #RevitAPI context, external events, determining RVT file version for Design Automation workitem and Revit API via HTTP:\n\nhttps://bit.ly/docsessionid\n\nSome new topics, and, as always, some recurring:\n\n- Document session id\n- Valid Revit API context and external events\n- Determining RVT file version for DA4R workitem\n- Revit API via HTTP\n- Parable of the polygons...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1874_doc_session_id",
    "header_text": "Doc Session Id, API Context and External Events",
    "local_header_href": "#doc-session-id-api-context-and-external-events",
    "chunk_text": "### Doc Session Id, API Context and External Events\n\nSome new topics, and, as always, some recurring:\n\n- [Document session id](#2)\n- [Valid Revit API context and external events](#3)\n- [Determining RVT file version for DA4R workitem](#4)\n- [Revit API via HTTP](#5)\n- [Parable of the polygons](#6)"
  },
  {
    "original_filename": "1874_doc_session_id",
    "header_text": "Document Session Id",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Document Session Id\n\nAn interesting question that I have dabbled with in the past came up in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [document session id](https://forums.autodesk.com/t5/revit-api-forum/document-session-id/m-p/9844775).\n\nMy dabbling has to do with a permanent document identifier;\nTobias, asking the question, and Richard, providing a more satisfying and useful answer for this specific case, highlight the use of `Document.GetHashCode` to identify document instances in the current session only:\n\n**Question:** Is there something like a session id for open documents?\n\nI would like to uniquely identify a Autodesk.Revit.DB.Document object, for example in the ViewActivated Event. This is needed while more than one document can be open at the same time in Revit. Because I hold some stuff in memory, I need to know to which document it belongs.\n\nThe DocumentPath as Id is not an option, because newly created documents have a zero string (could be occur more than one as well in a session)\n\n**Answer 1:** Every Revit project includes a singleton `ProjectInformation` database element.\nEvery database element has a unique identifier.\nSo, theoretically, you could use the `ProjectInformation` unique identifier to uniquely identify a project.\n\nUnfortunately, if I create a project A, and then copy it for reuse in project B, the two ProjectInformation elements will have the same unique id, so this solution only works if you can guarantee that no such copy will ever be created,\ncf. [project identifier](https://thebuildingcoder.typepad.com/blog/2017/12/project-identifier-and-fuzzy-comparison.html#2).\n\nHere is some further analysis of the task\nto [identify a project](https://the3dwebcoder.typepad.com/blog/2015/07/implementing-mongo-database-relationships.html#2).\n\nTo address this, I suggested a different and safer solution using an extensible storage schema and a named GUID storage for project identification instead\nusing [named guid storage for project identification](https://thebuildingcoder.typepad.com/blog/2016/04/named-guid-storage-for-project-identification.html).\n\n**Response:** Indeed, I searched before without a satisfying result.\n\nI came to the same conclusion as your solutions.\nI was hoping there was something else &nbsp; :-)\n\nPossibly use the combination of unique identifier and the file path, but this is not very elegant.\nI think I will end up using the extensible storage solution.\nMaybe a second schema, not the same as my plugin uses for storing its data.\n\n**Answer 2:** Some documents don't contain a path (yet to be saved ones).\n\n[Document.GetHashCode](https://www.revitapidocs.com/2020/006a71c2-4393-e036-9987-14467342a7d3.htm) has\nserved me well over the years:\n\n> The hash code is the same for document instances that represent the same document currently opened in the Revit session.\nThe hash code is generated when a Revit file is opened or created in session.\nIf the same Revit file is opened later (in the same session or a different session), the hash code will not be the same.\n\nMainly, I use this in a static variable to see if the current document has switched via the `ViewActivatedEvent`.\n\n**Response:** Ah, very nice. Thank you for that.\n\n\n<!--\n####<a name=\"X\"></a> Vendor Id\n\n  Where do I register a Vendor ID for use in Revit .addin files?\nQ: For what seems like a looong time ago (> 15 years) I registered a Vendor ID for my previous employer Cad Quality AB in Sweden. Now I am trying to do the same for my new employer Tribia AB, but I cannot find any page on ADN or Autodesk websites for doing so.\nAre the Vendor ID:s still in use, and if so â€“ where can I register a new ID?\nA: This vendor id is no longer in use.\nThe recommended vendor id to use in a Revit add-in manifest file is your reversed internet url, afaik.\nFor example, i use:\n    <VendorId>com.typepad.thebuildingcoder</VendorId>\n    <VendorDescription>The Building Coder, http://thebuildingcoder.typepad.com</VendorDescription>\n\nalready discussed in full here:\n\nhttps://thebuildingcoder.typepad.com/blog/2018/06/add-in-registration-vendorid-and-signature.html#2\n-->"
  },
  {
    "original_filename": "1874_doc_session_id",
    "header_text": "Valid Revit API Context and External Events",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Valid Revit API Context and External Events\n\nDevelopers keep attempting to access the Revit API from outside of Revit itself, e.g., in the questions\non [how to open different version Revit files](https://forums.autodesk.com/t5/revit-api-forum/how-to-open-different-version-revit-files/m-p/9861186)\nand [how to raise an external event from a WPF app](https://stackoverflow.com/questions/64683308/how-do-i-raise-an-external-event-in-the-revit-api-from-a-wpf-app):\n\nThe Revit API cannot be used outside a valid Revit API context:\n\n- [Use of the Revit API Requires a Valid Context](http://thebuildingcoder.typepad.com/blog/2015/12/external-event-and-10-year-forum-anniversary.html#2)\n- [Revit API Context Summary](http://thebuildingcoder.typepad.com/blog/2015/08/revit-api-context-and-form-creation-errors.html#2)\n\nYou can work around this limitation, though:\nthe Revit API enables you to define an external event that can be triggered from outside a valid Revit API context.\n\nThe implementation and definition of the external event happens within a Revit add-in and requires a valid Revit API context.\n\nOnce defined, though, the external event can be raised from outside.\n\nThe event handler, again, must reside and execute within."
  },
  {
    "original_filename": "1874_doc_session_id",
    "header_text": "Determining RVT File Version for DA4R Workitem",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Determining RVT File Version for DA4R Workitem\n\nThat said, some operations can be performed on an RVT BIM from outside Revit, without use of the Revit API or such a context.\n\nAnother question that came up repeatedly in the past few weeks is how to detect the Revit file version before passing it to a DA4R or Forge Design Automation for Revit workflow. In DA4R, you can specify what version of the Revit engine to launch. Picking the appropriate one for the given RVT file avoids the time-consuming upgrade process:\n\n**Question:** When I specify `Autodesk.Revit+2021` for the design automation AppBundle and Activity engine, the Revit 2020 version RVT file that I pass in is upgraded to 2021.\n\nI would like to avoid the RVT file version upgrading.\n\nIs it necessary to prepare a separate AppBundle and Activity for each Revit version, detect the Revit file version up front, and select which Activity to use?\n\nIf so, how can I determine the Revit file version?\n\nI saw the article on how\nto [check the version of a Revit file hosted on the cloud](https://forge.autodesk.com/blog/check-version-revit-file-hosted-cloud).\n\nI would like to know more detailed info for the accurate detection.\n\nIt says that the RVT file contains the file `BasicFileInfo` with the following data snippets:\n\n- 0-14 bytes = unknown\n- 15-18 bytes = the length(int32) of the subsequent field value\n- 19-(19+length*2) bytes = the Revit file version (UTF16LE)\n\nIs it true?\nCan I use this data to determine the Revit file version before passing it to DA?\n\n<center>\n<img src=\"img/basicfileinfo_for_da4r.png\" alt=\"BasicFileInfo for DA4R\" title=\"BasicFileInfo for DA4R\" width=\"500\"/> <!-- 666 -->\n</center>\n\n**Answer:** This question is answered in full in the following blog posts:\n\n- [Check the version of a Revit file hosted on the cloud](https://forge.autodesk.com/blog/check-version-revit-file-hosted-cloud)\n- [Basic File Info and RVT File Version](https://thebuildingcoder.typepad.com/blog/2013/01/basic-file-info-and-rvt-file-version.html)\n- [Automatically Open Correct RVT File Version](https://thebuildingcoder.typepad.com/blog/2020/05/automatically-open-correct-rvt-file-version.html)\n\nFurthermore, this recent discussion on StackOverflow addresses your exact requirements more precisely still:\n\n- [Reliably Determine Revit Version of BIM 360 Project](https://stackoverflow.com/questions/63135095/reliably-determine-revit-version-of-bim-360-project)\n\n**Response:** I found the implementation of Python in the blog article that you pointed out really helpful.\n\nThank you so much!"
  },
  {
    "original_filename": "1874_doc_session_id",
    "header_text": "Revit API via HTTP",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Revit API via HTTP\n\nThe implementation and use of external events can be perfected and simplified, as proven by Igor Serdyukov, aka Ð˜Ð³Ð¾Ñ€ÑŒ Ð¡ÐµÑ€Ð´ÑŽÐºÐ¾Ð² or WhiteSharq, and Kennan Chen:\n\n- [External Communication and Async Await Event](https://thebuildingcoder.typepad.com/blog/2020/02/external-communication-and-async-await-event-wrapper.html)\n- [Revit.Async](https://thebuildingcoder.typepad.com/blog/2020/03/another-async-await-rex-and-structural-analysis-sdk.html#3)\n\nGregor Vilkner of [Microdesk](https://www.microdesk.com) makes use of that in his exciting class at\nthe [AEC Tech Hackathon 2020](https://www.aectech.us) in October:\n\n- [Jailbreak Revit: GraphQL and ServiceBus](https://youtu.be/7LnbP4n4RYM)\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/7LnbP4n4RYM\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</center>\n\nSays Greg: Got a shout out for you... 19:30 min mark..."
  },
  {
    "original_filename": "1874_doc_session_id",
    "header_text": "Parable of the Polygons",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Parable of the Polygons\n\nFor something completely different, here is a nice little demonstration of the subtle influence various individual preferences and prejudice can have on collective behaviour; check out\nthe [Parable of the Polygons](https://ncase.me/polygons), a segregation and diversity simulation that clearly proves certain points:\n\n1. Small individual bias &rarr; Large collective bias.\n<br/>When someone says a culture is shapist, they're not saying the individuals in it are shapist. They're not attacking you personally.\n2. The past haunts the present.\n<br/>Your bedroom floor doesn't stop being dirty just coz you stopped dropping food all over the carpet. Creating equality is like staying clean: it takes work. And it's always a work in progress.\n3. Demand diversity near you.\n<br/>If small biases created the mess we're in, small anti-biases might fix it. Look around you. Your friends, your colleagues, that conference you're attending. If you're all triangles, you're missing out on some amazing squares in your life &ndash; that's unfair to everyone. Reach out, beyond your immediate neighbours."
  }
]