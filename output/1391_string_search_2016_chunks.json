[
  {
    "original_filename": "1391_string_search_2016",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<!---\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n</head>\n\n<!---\n\n11379033 [How do I extract all visible text from Revit file from out of process.]\n\n#dotnet #csharp\n#fsharp #python\n#grevit\n#responsivedesign #typepad\n#ah8 #augi #dotnet\n#stingray #rendering\n#3dweb #3dviewapi #html5 #threejs #webgl #3d #mobile #vr #ecommerce\n#Markdown #Fusion360 #Fusion360Hackathon\n#javascript\n#RestSharp #restapi\n#mongoosejs #mongodb #nodejs\n#rtceur\n#xaml\n#3dweb #a360 #3dwebaccel #webgl @adskForge\n\nRevit API, Jeremy Tammik, akn_include\n\nAll Model Text, StringSearch 2016 and New Jobs #revitapi #bim #aec #3dwebcoder #adsk\n\nI migrated another one of my samples to Revit 2016: StringSearch. That was prompted by a question on extracting all visible text from the Revit model that I will take a closer look at below\n&ndash; ADN Internship and Other Jobs\n&ndash; Extracting all Visible Text from the Revit Model\n&ndash; StringSearch for Revit 2016...\n\n-->"
  },
  {
    "original_filename": "1391_string_search_2016",
    "header_text": "All Model Text, StringSearch 2016 and New Jobs",
    "local_header_href": "#all-model-text-stringsearch-2016-and-new-jobs",
    "chunk_text": "### All Model Text, StringSearch 2016 and New Jobs\n\nI migrated another one of my samples to Revit 2016: StringSearch.\n\nThat was prompted by a question on [extracting all visible text from the Revit model](#3) that I will take a closer look at below."
  },
  {
    "original_filename": "1391_string_search_2016",
    "header_text": "<a name=\"2\"></a>ADN Internship and Other Jobs",
    "local_header_href": "#a-name2aadn-internship-and-other-jobs",
    "chunk_text": "#### <a name=\"2\"></a>ADN Internship and Other Jobs\n\nFirst, however, let me point out that there are a number of open job offers at Autodesk right now, including\nan [internship position 15WD19623 as Developer Evangelist](https://autodesk.taleo.net/careersection/adsk_cmp/jobdetail.ftl?job=15WD19623) in\nADN, the Autodesk Developer Network, in our San Francisco office.\n\nFeel free to check out that link yourself or share any candidates you feel would be a great fit for the position.\n\nAnyone wishing to be considered can visit our careers site\nand [apply directly online](https://autodesk.taleo.net/careersection/adsk_cmp/jobsearch.ftl).\n\nWe also have a bunch of openings in Europe right now, e.g., for Associate Customer Success Managers in France, Germany, UK and Sweden.\nGet in touch if you are interested."
  },
  {
    "original_filename": "1391_string_search_2016",
    "header_text": "<a name=\"3\"></a>Extracting all Visible Text from the Revit Model",
    "local_header_href": "#a-name3aextracting-all-visible-text-from-the-revit-model",
    "chunk_text": "#### <a name=\"3\"></a>Extracting all Visible Text from the Revit Model\n\n**Question:** I am trying to extract all the visible text strings or attributes data from a Revit file to use for indexing. My code must run out-of-process &ndash; no user interaction is possible.\n\nI have been searching for a coding sample or snippet but have been unable to find anything. Is there something like this available?\n\n**Answer:** You are basically asking two separate questions, and I would advise you to address and implement them in two separate steps.\n\n1. How do I extract all visible text from a Revit model?\n\n2. How do I drive this functionality programmatically from outside?\n\nWe have already discussed the second question in other threads, and it is addressed in full by The Building Coder topic group\non [Idling and External Events for Modeless Access and Driving Revit from Outside](http://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28).\n\nThe first question is initially very simple, so I can leave it up to you to flesh out.\n\nStart off by implementing, testing and debugging it in a macro or a simple external command before you even think of driving it programmatically, i.e. addressing question 2.\n\nI would use one or several filtered element collectors to retrieve all the elements you are interested in and their properties that you wish to extract.\n\nIn the simplest case, it might just be text notes and their visible text strings.\n\nPossibly you are also interested in other strings that can be found in specific element parameters or elsewhere.\n\nThat should all be pretty simple to determine and access, e.g. using RevitLookup or other,\nmore [intimate database exploration tools](http://thebuildingcoder.typepad.com/blog/2013/11/intimate-revit-database-exploration-with-the-python-shell.html).\n\nOnce you have the extraction functionality up and running to your satisfaction, it should be easy to encapsulate that in a stand-alone function and call it from an external event.\n\n**Response** I know how to drive from outside &ndash; I only included that information so that I did not get a solution that provided user interaction.\n\nI think the RevitLookup may help me &ndash; my biggest issue is that I don't know all the element types that can have visible text.\n\nI was able to use FilteredElementCollector to find TextElement:\n\n<pre>\n  FilteredElementCollector a = Util.GetElementsOfType(\n    doc,\n    typeof( TextElement ),\n    BuiltInCategory.OST_TextNotes );\n</pre>\n\nI know if there are other elements that show text.\n\nDo you have any suggestions how I should determine all element types that would have visible text appearing on the display?\n\n**Answer:** I am glad all that is clear.\n\nTo determine all element types that have visible text appearing on the display, all I can suggest is creating a collection of a number of super simple sample models that demonstrate and enable you to test the cases that you are aware of up front, and then adding new sample files to that collection as you come across examples of test that they do now cover.\n\nTrial and error, basically, and gathering experience as you go along.\n\nYou might also be interested in\nthe [StringSearch Plug-in of the Month utility](http://thebuildingcoder.typepad.com/blog/2011/10/string-search-adn-plugin-of-the-month.html) that\nI implemented as the  a couple of years ago.\n\nI later [updated and created a GitHub repository](http://thebuildingcoder.typepad.com/blog/2014/12/devdays-github-stl-and-obj-model-import.html#4) for\nit as well.\n\nIt searches for all strings in the model.\n\nIt does not differentiate whether the strings it finds are displayed graphically, though.\n\n\n**Response:** Thanks Jeremy, I download the sample and have been playing with it a bit. I think it will be very helpful. I apologize for my stupid questions. I am just not as comfortable with Revit as other products so many of my problems are no doubt caused by not fully understanding the file/element structure and terminology.\n\nOne question about the StringSearch &ndash; it doesn't seem to find dumb text placed in the files. It finds text that is a custom parameter &ndash; like part of the title block. It does not find a dumb text note placed in a view or sheet.\n\nIs this intentional or am I just doing something wrong?\n\n**Answer:** I am glad that you find StringSearch a potentially useful starting point.\n\nIt will also find a simple string in a text note. You just have to set it up to access the right parameters.\n\nStringSearch only searches for strings in various combinations of element parameter values.\n\nYou could add code to it to search for other properties as well, though, e.g. the TextElement.Text property.\n\nThat is not necessary, though, because the text note string value is also accessible through the TEXT_TEXT built-in parameter on the TextNote element.\n\nIt can be kind of complex to define all the potential combinations of parameter values that you are interested in, and the user interface offers a quite huge range of optional settings that influence the search.\n\nI would simply debug through it and see what it does. The code is not very complex and quite well structured.\n\nAs said, you can also easily find out how to retrieve the simple text note string values directly using RevitLookup.\n\nActually, the answer to that is already provided in what has been said above.\n\nThe shortest way to retrieve all TextNote elements string values might be something like this:\n\n<pre class=\"code\">\n&nbsp; <span class=\"teal\">List</span>&lt;<span class=\"blue\">string</span>&gt; testStrings = <span class=\"blue\">new</span> <span class=\"teal\">FilteredElementCollector</span>( doc )\n&nbsp; &nbsp; .OfClass( <span class=\"blue\">typeof</span>( <span class=\"teal\">TextNote</span> ) )\n&nbsp; &nbsp; .Cast&lt;<span class=\"teal\">TextNote</span>&gt;()\n&nbsp; &nbsp; .Select&lt;<span class=\"teal\">TextNote</span>, <span class=\"blue\">string</span>&gt;( tn =&gt; tn.Text )\n&nbsp; &nbsp; .ToList&lt;<span class=\"blue\">string</span>&gt;();\n</pre>"
  },
  {
    "original_filename": "1391_string_search_2016",
    "header_text": "<a name=\"3\"></a>StringSearch for Revit 2016",
    "local_header_href": "#a-name3astringsearch-for-revit-2016",
    "chunk_text": "#### <a name=\"3\"></a>StringSearch for Revit 2016\n\nPrompted by this discussion, I migrated\nthe [StringSearch sample](https://github.com/jeremytammik/StringSearch) to\nRevit 2016 and published the result\nas [release 2016.0.0.0](https://github.com/jeremytammik/StringSearch/releases/tag/2016.0.0.0).\n\nHere is the StringSearch ribbon panel in all its glory in Revit 2016:\n\n<center>\n<img src=\"img/string_search_2016_app.png\" alt=\"StringSearch in Revit 2016\" width=\"107\">\n</center>\n\nI added a sample TextNote to the model for it to search for:\n\n<center>\n<img src=\"img/string_search_2016_target.png\" alt=\"StringSearch TextNote target\" width=\"451\">\n</center>\n\nAs said, the TextNote text string is available through the `Text` property or via the `TEXT_TEXT` built-in parameter, so I enable all built-in parameters for the search:\n\n<center>\n<img src=\"img/string_search_2016_dlg.png\" alt=\"StringSearch dialogue and options\" width=\"247\">\n</center>\n\nAs a result, the target is found and listed in the modeless search hit navigator:\n\n<center>\n<img src=\"img/string_search_2016_result.png\" alt=\"StringSearch results\" width=\"700\">\n</center>\n\nI hope you find this useful as well."
  }
]