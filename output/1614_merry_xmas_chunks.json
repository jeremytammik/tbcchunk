[
  {
    "original_filename": "1614_merry_xmas",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- schedule instance bounding box margin\n  13693151 [ScheduleSheetInstance bounding box]\n  https://forums.autodesk.com/t5/revit-api-forum/schedulesheetinstance-bounding-box/m-p/7619803\n\n- using PostCommand in conjunction with .NET Automation API to drive the Revit UI\n  13672963 [Revit links graphic overrides]\n  https://forums.autodesk.com/t5/revit-api-forum/revit-links-graphic-overrides/m-p/7604332\n\n- https://kevinvandecar.github.io/\n  little 3D holiday greeting by Kevin Vandecar using the Forge Viewer:\n\n- https://stackoverflow.com/questions/234075/what-is-your-best-programmer-joke\n\nWhen your hammer is C++, everything begins to look like a thumb.\n\nAn SQL query walks into a bar and sees two tables. He walks up to them and says 'Can I join you?'\n\nTo understand what recursion is, you must first understand recursion.\n\t\nQ: Whats the object-oriented way to become wealthy?\nA: Inheritance.\n\nQ: how many programmers does it take to change a light bulb?\nA: none, that's a hardware problem.\n\nMore Christmas related:\n\nQ: Why do programmers always mix up Halloween and Christmas?\nA: Because Oct 31 == Dec 25!\n\nTo end it all:\n\nCommand line Russian roulette\n\n[ $[ $RANDOM % 6 ] == 0 ] && rm -rf / || echo *Click*\n\nMagic number, magic automation and magic season in #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/magicnumberautomation\n\nTime to wind down for the year...\nHere are some last things to share before signing off\n&ndash; Magic number for schedule instance bounding box margin\n&ndash; Using <code>PostCommand</code> with the Windows Automation API\n&ndash; Programmer jokes\n&ndash; Season's greetings...\n\n--->"
  },
  {
    "original_filename": "1614_merry_xmas",
    "header_text": "Magic Number, Magic Automation and Magic Season",
    "local_header_href": "#magic-number-magic-automation-and-magic-season",
    "chunk_text": "### Magic Number, Magic Automation and Magic Season\n\nTime to wind down for the year...\n\nHere are some last things to share before signing off:\n\n- [Magic number for schedule instance bounding box margin](#2)\n- [Using PostCommand with the Windows Automation API](#3)\n- [Programmer jokes](#4)\n- [Season's greetings](#5)\n\n####<a name=\"2\"></a>Magic Number for Schedule Instance Bounding Box Margin\n\nI discussed\nthe [ScheduleSheetInstance bounding box](https://forums.autodesk.com/t5/revit-api-forum/schedulesheetinstance-bounding-box/m-p/7619803) \nwith Alexander [@aignatovich](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/1257478) Ignatovich in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160),\nand the Revit development team confirmed the magic number he determined empirically for the hidden margin width:\n\n**Question:** I am trying to place schedules to the view sheet in a vertical chain. The result should be something like:\n\n<center>\n<img src=\"img/ai_sibb_margin_target.png\" alt=\"Target\" width=\"470\"/>\n</center>\n\nActually, there are 2 (or more) schedules. I've already achieved what I want. I retrieve bounding box on active viewsheet of each ScheduleSheetInstance and move insertion point for each schedule.\n \nThe problem is that ScheduleSheetInstance bounding box is a bit larger than actual schedule table:\n\n<center>\n<img src=\"img/ai_sibb_margin_borders.png\" alt=\"Borders\" width=\"282\"/>\n</center>\n\nI've draw borders with this Python shell code:\n\n<pre class=\"prettyprint\">\n  shInst = selection[0] # a ScheduleSheetInstance should be selected to run this code\n  \n  bb = shInst.get_BoundingBox(doc.ActiveView)\n  \n  tx = Transaction(doc, \"bounds\")\n  tx.Start()\n  \n  doc.Create.NewDetailCurve(doc.ActiveView,\n    Line.CreateBound(bb.Min, XYZ(bb.Min.X, bb.Max.Y, 0)))\n  doc.Create.NewDetailCurve(doc.ActiveView,\n    Line.CreateBound(XYZ(bb.Min.X, bb.Max.Y, 0), bb.Max))\n  doc.Create.NewDetailCurve(doc.ActiveView,\n    Line.CreateBound(bb.Max, XYZ(bb.Max.X, bb.Min.Y, 0)))\n  doc.Create.NewDetailCurve(doc.ActiveView,\n    Line.CreateBound(XYZ(bb.Max.X, bb.Min.Y, 0), bb.Min))\n  \n  tx.Commit()\n</pre>\n\nThe distance is ~2.12 mm. I hardcoded this value in my code. It seems it works, but I don't know if it works in every possible case.\n\nSo, the question is:\n \nIs there any way to retrieve this value via API?\n\n**Answer:** The development team confirm your current approach and provide the magic constant that you were looking for:\n\nFor a schedule instance in the sheet view, we add an invisible margin around the actual schedule table.\n\nThis margin will show up when selecting the schedule instance.\n\nThe margin width is a hardcoded value in the schedule code.\n\nIt is 1/12\", which is around 2.12 mm.\n\nRight now, there is no way to retrieve this value through API as it is not exposed yet.\n\nI think it is safe to use this hardcoded value as it has been there and remained constant for years.\n\nThis is what the schedule instance margin looks like when selecting the schedule instance.\n\n<center>\n<img src=\"img/ai_sibb_margin_schedule_instance.png\" alt=\"Schedule instances\" width=\"316\"/>\n</center>\n\nYou can see that the move control and the drag height control are showing at the margin bounding box.\n\n\n####<a name=\"3\"></a>Using PostCommand with the Windows Automation API\n\n[Fausto Mendez](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/3909731) shared\na very nice example of using `PostCommand` in conjunction with\nthe [Windows Automation API](https://msdn.microsoft.com/en-us/library/windows/desktop/ff486375.aspx) to\nsimulate user input to drive the Revit user interface programmatically in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [Revit links graphic overrides](https://forums.autodesk.com/t5/revit-api-forum/revit-links-graphic-overrides/m-p/7604332):\n\n`PostCommand` enables you to launch the Revit command.\n\nThat displays an interactive form expecting manual user input.\n\nThat input can be provided programmatically as well, like this:\n\n<pre class=\"code\">\n  RevitCommandId vgCmdId = RevitCommandId.LookupCommandId(\"ID_VIEW_CATEGORY_VISIBILITY\");\n\n  uidoc.Application.PostCommand(vgCmdId);\n \n  Jrn.TabCtrl _\n    \"Modal , Visibility/Graphic Overrides for 3D View: 3D View And Sheets Start View , 0\" _\n    , \"AFX_IDC_TAB_CONTROL\" _\n    , \"Select\" , \"Revit Links\"\n  \n  Jrn.Grid _\n    \"ChildControl; Page , Revit Links , Dialog_Revit_RvtLinkVisibility; ID_TREEGRID_GRID\" _\n    , \"MoveCurrentCell\" , \"1\" , \"Halftone\"\n  \n  Jrn.Grid _\n    \"ChildControl; Page , Revit Links , Dialog_Revit_RvtLinkVisibility; ID_TREEGRID_GRID\" _\n    , \"PartialEdit\" , \"1\" , \"Halftone\" , \"Yes\"\n  \n  Jrn.Grid _\n    \"ChildControl; Page , Revit Links , Dialog_Revit_RvtLinkVisibility; ID_TREEGRID_GRID\" _\n    , \"MoveCurrentCell\" , \"1\" , \"Halftone\"\n  \n  Jrn.PushButton _\n    \"Modal , Visibility/Graphic Overrides for 3D View: 3D View And Sheets Start View , 0\" _\n    , \"OK, IDOK\"\n</pre>\n\nFor full details, please refer to\nthe [original discussion thread](https://forums.autodesk.com/t5/revit-api-forum/revit-links-graphic-overrides/m-p/7604332).\n\nMany thanks to Fausto for demonstrating this powerful approach!\n\n\n\n####<a name=\"4\"></a>Programmer Jokes\n\nTo celebrate the quiet days coming, I wasted some time reading the StackOverflow list\nof [best programmer jokes](https://stackoverflow.com/questions/234075/what-is-your-best-programmer-joke).\n\nHere is a selection:\n\n- When your hammer is C++, everything begins to look like a thumb.\n- An SQL query walks into a bar and sees two tables. He walks up to them and says, 'Can I join you?'\n- To understand what recursion is, you must first understand recursion.\n- Q: What's the object-oriented way to become wealthy?\n<br/>A: Inheritance.\n- Q: How many programmers does it take to change a light bulb?\n<br/>A: None; that's a hardware problem.\n\nMore Christmas related:\n\n- Q: Why do programmers always mix up Halloween and Christmas?\n<br/>A: Because Oct 31 == Dec 25!\n\nFinally, to end it all:\n\n- Command line Russian roulette:\n<br/><pre>[ $[ $RANDOM % 6 ] == 0 ] && rm -rf / || echo &ast;Click&ast;</pre>\n\n\n####<a name=\"5\"></a>Season's Greetings\n\nA little [3D holiday greeting by Kevin Vandecar](https://kevinvandecar.github.io) using the Forge Viewer... click, zoom, pan at will:\n\n<center>\n<embed src=\"https://kevinvandecar.github.io\" width=\"600\" height=\"400\"> </embed>\n</center>\n\nThank you, Kevin, for sharing this!\n\nMerry Christmas and Happy New Year!"
  }
]