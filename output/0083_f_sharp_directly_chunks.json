[
  {
    "original_filename": "0083_f_sharp_directly",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<style>\n.blue { color: blue; }\n.teal { color: teal; }\n.maroon { color: maroon; }\n.green { color: green; }\n</style>"
  },
  {
    "original_filename": "0083_f_sharp_directly",
    "header_text": "Use F# Directly in Revit",
    "local_header_href": "#use-f-directly-in-revit",
    "chunk_text": "<h3>Use F# Directly in Revit</h3><p>Still struggling to load a native F# module directly as a Revit add-in?\nRalf Huvendiek had a quick look at this issue and created all three different flavours of external commands implemented in F# that can be called directly as external Revit tools:</p><ol type=\"1\">\n<li>Defined in a namespace.</li>\n<li>Defined in a module.</li>\n<li>Defined in a module within a namespace.</li>\n</ol><p>The problem I had when \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/01/hello-f-via-c.html\">\ncalling F# via C#</a>\n\nis caused by the line specifying 'module BuildingCoder', which generates the strange class names.\nBut even those strange names can be entered and will work in the Revit.ini file.</p><p>The decorated name defined for the Execute method in the derived class by adding the interface prefix to it is also no problem.\nApparently, the CLR ignores the name and uses some other method, maybe a position within a table, to determine what method to look up and call.</p><p>Here is Ralf's implementation of the three external command classes and their Execute methods;\nplease watch out for the overly long lines in the F# source code ... you may have to copy and paste to an editor to see the full text:<p>\n<h4>Namespace</h4>\n<pre class=\"code\">\n<span class=\"blue\">#light</span>\n\n<span class=\"blue\">namespace</span> RevitAddin\n\n<span class=\"blue\">open</span> Autodesk.Revit\n\n<span class=\"blue\">type</span> RevitAddin() =\n  <span class=\"blue\">interface</span> Autodesk.Revit.IExternalCommand <span class=\"blue\">with</span>\n    <span class=\"blue\">member public</span> this.Execute( cData, strMessage : string byref, aElements ) =\n      strMessage &lt;- \"Hello world from RevitAddin.RevitAddin\"\n      Autodesk.Revit.IExternalCommand.Result.Failed\n</pre>\n<h4>Module</h4>\n<pre class=\"code\">\n<span class=\"blue\">#light</span>\n\n<span class=\"blue\">module</span> RevitAddinModule\n\n<span class=\"blue\">type</span> RevitAddin() =\n  <span class=\"blue\">interface</span> Autodesk.Revit.IExternalCommand <span class=\"blue\">with</span>\n    <span class=\"blue\">member public</span> this.Execute( cData, strMessage : string byref, aElements ) =\n      strMessage &lt;- \"Hello world from RevitAddinModule.RevitAddin\"\n      Autodesk.Revit.IExternalCommand.Result.Failed\n</pre>\n<h4>Module within Namespace</h4>\n<pre class=\"code\">\n<span class=\"blue\">#light</span>\n\n<span class=\"blue\">namespace</span> RevitAddin\n\n<span class=\"blue\">module</span> RevitAddinModule\n\n<span class=\"blue\">type</span> RevitAddin() =\n  <span class=\"blue\">interface</span> Autodesk.Revit.IExternalCommand <span class=\"blue\">with</span>\n    <span class=\"blue\">member public</span> this.Execute( cData, strMessage : string byref, aElements ) =\n      strMessage &lt;- \"Hello world from RevitAddin.RevitAddinModule.RevitAddin\"\n      Autodesk.Revit.IExternalCommand.Result.Failed\n</pre>\n<p>The corresponding Revit.ini entries for loading the three external commands thus defined look like this:</p>\n<pre>\n[ExternalCommands]\nECCount=3\n\nECName1=F# 1\nECDescription1=F# in namespace\nECAssembly1=...\\RevitAddin.dll\nECClassName1=RevitAddin.RevitAddin\n\nECName2=F# 2\nECDescription2=F# in module\nECAssembly2=...\\RevitAddin.dll\nECClassName2=RevitAddinModule+RevitAddin\n\nECName3=F# 3\nECDescription3=F# in namespace and module\nECAssembly3=...\\RevitAddin.dll\nECClassName3=RevitAddin.RevitAddinModule+RevitAddin\n</pre>\n<p>The three dots need to be replaced by the full path name of your assembly.</p>\n<p>Here is the complete Visual Studio 2008 F# solution\n\n<a href=\"zip/FsRevitAddin.zip\">\nFsRevitAddin.zip</a>.\n\n<p>So nothing more to stop you from checking out this exciting new functional language and creating a Revit-based entry for \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/01/f-contest.html\">\nKean's F# programming contest</a>.\n\n<p>Several people asked how I retrieved the full class name including namespace prefix from \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/10/converting-between-vb-and-c-and-net-decompilation.html\">\nReflector</a>.\n\nIn my installation, the full name of the declaring type is listed in the bottom panel when you select a class or method:</p>\n<img alt=\"Reflector displaying the full class name\" src=\"img/reflector_full_class_name.png\"/>\n<h4>3DS Max, Maya and MotionBuilder Training</h4>\n<p>Rendering is another topic of interest to some Revit developers, so please note that the Media and Entertainment team are inviting all interested parties to a series of free online trainings to\n\n<a href=\"http://through-the-interface.typepad.com/through_the_interface/2009/01/free-online-training-learn-3ds-max-maya-or-motionbuilder-apis-in-just-one-hour-a-day.html\">\nlearn 3ds Max, Maya or MotionBuilder APIs in just one hour a day</a>\n\nduring the March, April and May time frame.</p>\n<h4>Lunedi Sera in Verona</h4>\n<p>Last night was very enjoyable \n... I took a yoga class with Marco in the Scuola Massalungo, opposite the faculty of economy in the Zona Universitá, then had an enjoyable meal in the eminently recommendable Osteria al Duca in Via Arche Scaligere 2, where I met Mauro Neri and had my 'realest' Italian conversation so far, for a couple of hours \n... perfect preparation for the first Revit API introduction in Italiano today.</p>\n</p></p></p></p>"
  },
  {
    "original_filename": "0083_f_sharp_directly",
    "header_text": "Namespace",
    "local_header_href": "#namespace",
    "chunk_text": "<h4>Namespace</h4><pre class=\"code\">\n<span class=\"blue\">#light</span>\n\n<span class=\"blue\">namespace</span> RevitAddin\n\n<span class=\"blue\">open</span> Autodesk.Revit\n\n<span class=\"blue\">type</span> RevitAddin() =\n  <span class=\"blue\">interface</span> Autodesk.Revit.IExternalCommand <span class=\"blue\">with</span>\n    <span class=\"blue\">member public</span> this.Execute( cData, strMessage : string byref, aElements ) =\n      strMessage &lt;- \"Hello world from RevitAddin.RevitAddin\"\n      Autodesk.Revit.IExternalCommand.Result.Failed\n</pre>"
  },
  {
    "original_filename": "0083_f_sharp_directly",
    "header_text": "Module",
    "local_header_href": "#module",
    "chunk_text": "<h4>Module</h4><pre class=\"code\">\n<span class=\"blue\">#light</span>\n\n<span class=\"blue\">module</span> RevitAddinModule\n\n<span class=\"blue\">type</span> RevitAddin() =\n  <span class=\"blue\">interface</span> Autodesk.Revit.IExternalCommand <span class=\"blue\">with</span>\n    <span class=\"blue\">member public</span> this.Execute( cData, strMessage : string byref, aElements ) =\n      strMessage &lt;- \"Hello world from RevitAddinModule.RevitAddin\"\n      Autodesk.Revit.IExternalCommand.Result.Failed\n</pre>"
  },
  {
    "original_filename": "0083_f_sharp_directly",
    "header_text": "Module within Namespace",
    "local_header_href": "#module-within-namespace",
    "chunk_text": "<h4>Module within Namespace</h4><pre class=\"code\">\n<span class=\"blue\">#light</span>\n\n<span class=\"blue\">namespace</span> RevitAddin\n\n<span class=\"blue\">module</span> RevitAddinModule\n\n<span class=\"blue\">type</span> RevitAddin() =\n  <span class=\"blue\">interface</span> Autodesk.Revit.IExternalCommand <span class=\"blue\">with</span>\n    <span class=\"blue\">member public</span> this.Execute( cData, strMessage : string byref, aElements ) =\n      strMessage &lt;- \"Hello world from RevitAddin.RevitAddinModule.RevitAddin\"\n      Autodesk.Revit.IExternalCommand.Result.Failed\n</pre><p>The corresponding Revit.ini entries for loading the three external commands thus defined look like this:</p><pre>\n[ExternalCommands]\nECCount=3\n\nECName1=F# 1\nECDescription1=F# in namespace\nECAssembly1=...\\RevitAddin.dll\nECClassName1=RevitAddin.RevitAddin\n\nECName2=F# 2\nECDescription2=F# in module\nECAssembly2=...\\RevitAddin.dll\nECClassName2=RevitAddinModule+RevitAddin\n\nECName3=F# 3\nECDescription3=F# in namespace and module\nECAssembly3=...\\RevitAddin.dll\nECClassName3=RevitAddin.RevitAddinModule+RevitAddin\n</pre><p>The three dots need to be replaced by the full path name of your assembly.</p><p>Here is the complete Visual Studio 2008 F# solution\n\n<a href=\"zip/FsRevitAddin.zip\">\nFsRevitAddin.zip</a>.\n\n<p>So nothing more to stop you from checking out this exciting new functional language and creating a Revit-based entry for \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2009/01/f-contest.html\">\nKean's F# programming contest</a>.\n\n<p>Several people asked how I retrieved the full class name including namespace prefix from \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2008/10/converting-between-vb-and-c-and-net-decompilation.html\">\nReflector</a>.\n\nIn my installation, the full name of the declaring type is listed in the bottom panel when you select a class or method:</p>\n<img alt=\"Reflector displaying the full class name\" src=\"img/reflector_full_class_name.png\"/>\n<h4>3DS Max, Maya and MotionBuilder Training</h4>\n<p>Rendering is another topic of interest to some Revit developers, so please note that the Media and Entertainment team are inviting all interested parties to a series of free online trainings to\n\n<a href=\"http://through-the-interface.typepad.com/through_the_interface/2009/01/free-online-training-learn-3ds-max-maya-or-motionbuilder-apis-in-just-one-hour-a-day.html\">\nlearn 3ds Max, Maya or MotionBuilder APIs in just one hour a day</a>\n\nduring the March, April and May time frame.</p>\n<h4>Lunedi Sera in Verona</h4>\n<p>Last night was very enjoyable \n... I took a yoga class with Marco in the Scuola Massalungo, opposite the faculty of economy in the Zona Universitá, then had an enjoyable meal in the eminently recommendable Osteria al Duca in Via Arche Scaligere 2, where I met Mauro Neri and had my 'realest' Italian conversation so far, for a couple of hours \n... perfect preparation for the first Revit API introduction in Italiano today.</p>\n</p></p>"
  },
  {
    "original_filename": "0083_f_sharp_directly",
    "header_text": "3DS Max, Maya and MotionBuilder Training",
    "local_header_href": "#3ds-max-maya-and-motionbuilder-training",
    "chunk_text": "<h4>3DS Max, Maya and MotionBuilder Training</h4><p>Rendering is another topic of interest to some Revit developers, so please note that the Media and Entertainment team are inviting all interested parties to a series of free online trainings to\n\n<a href=\"http://through-the-interface.typepad.com/through_the_interface/2009/01/free-online-training-learn-3ds-max-maya-or-motionbuilder-apis-in-just-one-hour-a-day.html\">\nlearn 3ds Max, Maya or MotionBuilder APIs in just one hour a day</a>\n\nduring the March, April and May time frame.</p>"
  },
  {
    "original_filename": "0083_f_sharp_directly",
    "header_text": "Lunedi Sera in Verona",
    "local_header_href": "#lunedi-sera-in-verona",
    "chunk_text": "<h4>Lunedi Sera in Verona</h4><p>Last night was very enjoyable \n... I took a yoga class with Marco in the Scuola Massalungo, opposite the faculty of economy in the Zona Universitá, then had an enjoyable meal in the eminently recommendable Osteria al Duca in Via Arche Scaligere 2, where I met Mauro Neri and had my 'realest' Italian conversation so far, for a couple of hours \n... perfect preparation for the first Revit API introduction in Italiano today.</p>"
  }
]