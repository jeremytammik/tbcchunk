[
  {
    "original_filename": "0269_vertical_projection",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0269_vertical_projection",
    "header_text": "Vertical Projection of Beam Analytical Model",
    "local_header_href": "#vertical-projection-of-beam-analytical-model",
    "chunk_text": "<h3>Vertical Projection of Beam Analytical Model</h3><p>We tried to fly from Milano to Paris this evening for the last DevDays conference, but unfortunately our flight was cancelled due to snow in Paris.\nNow we are stuck at the Milano airport and hoping that the first flight in the morning will not be cancelled as well.\nIf it is, we will not be able to make it at all.\nOtherwise, we will arrive rather late and have to reschedule the agenda, but at least then we will not be forced to cancel the whole conference.\nFervently hoping for the best...\n\n<p>Since I am not sleeping anyway, I may as well post.\n\n<p>First, here are some more titbits from AU:\n\n<p>Kean posted an\n\n<a href=\"http://through-the-interface.typepad.com/through_the_interface/2009/12/post-au-wrap-up.html\">\nAU wrap-up</a> with\n\na short video and some snapshots from various Autodesk University experiences.\n\n<p>As part of AUv, Jim Quanci gave a very informative\n\n<a href=\"http://www.youtube.com/AutodeskUniversity#p/u/11/4c9RPYBOBj4\">\nvirtual interview</a>\n\non the\n\n<a href=\"http://www.autodesk.com/joinadn\">\nAutodesk Developer Network ADN</a>\n\nwhich is the part of Autodesk that provides developer support and that I work in.\nIt has now been posted on the AU YouTube channel and...\n\n<ul>\n<li>Provides an overview of and helps better understand the ADN.\n<li>Shows the wide variety of applications being created by our partners.\n<li>Describes the benefits of being a member of the network.\n<li>Raises interest in ADN and our partners.\n</li></li></li></li></ul>\n<p>Getting back to the Revit API, here is a recent case handled by my colleagues Joe Ye and Saikat Bhattacharya which shows how to handle the setting of the vertical projection of the analytical model of a beam.\nAn interesting aspect of this is that the parameter data type is an element id, and yet we are actually storing an enumeration value in it.\nThis is not uncommon in Revit parameters; there are a few of them that can take both element ids to refer to other database objects as well as a fixed set of enumeration values for specific exceptional cases.\n\n<p><strong>Question:</strong> How can I set the 'Vertical Projection' parameter of a beam to the 'Center of Beam' value?\"\n\n<p><strong>Answer:</strong> Here is a description on how to set the vertical projection parameter of a beam.\n\n<p>Start by defining the following enumeration:\n\n<pre class=\"code\">\n<span class=\"blue\">enum</span> <span class=\"teal\">AnalyticalVerticalProjection_e</span>\n{\n  AVP_AUTODETECT = -1,\n  AVP_TOP_OF_PHYSICAL = -2,\n  AVP_CENTER_OF_PHYSICAL = -3,\n  AVP_BOTTOM_OF_PHYSICAL = -4,\n};\n\n</pre>\n<p>This can be used as follows:\n\n<ul>\n<li>Construct an ElementId object, for instance, id.\n<li>Set id.Value to one of the enumeration member values.\n<li>Set the vertical projection parameter value to id.\n</li></li></li></ul>\n<p>Note that the parameter value can be set successfully to the value, even though it is not a real element id.\n\n<p>Here is a code snippet showing how to set value to top of the slab:\n\n<pre class=\"code\">\n<span class=\"teal\">Element</span> e = SelectSlab( <span class=\"maroon\">\"Please select a slab\"</span>, \n  commandData, <span class=\"blue\">typeof</span>( <span class=\"teal\">Floor</span> ) );\n \n<span class=\"blue\">if</span>( <span class=\"blue\">null</span> != e )\n{\n  <span class=\"teal\">Floor</span> floor = e <span class=\"blue\">as</span> <span class=\"teal\">Floor</span>;\n \n  <span class=\"teal\">BuiltInParameter</span> bip = <span class=\"teal\">BuiltInParameter</span>\n    .STRUCTURAL_ANALYTICAL_PROJECT_FLOOR_PLANE;\n \n  <span class=\"teal\">Parameter</span> p = floor.get_Parameter( bip );\n \n  <span class=\"teal\">ElementId</span> id = p.AsElementId();\n \n  <span class=\"green\">// id.Value is negative if the parameter </span>\n  <span class=\"green\">// value is not a real element id:</span>\n \n  id.Value = -2; <span class=\"green\">// top of the slab</span>\n \n  p.Set( <span class=\"blue\">ref</span> id );\n}\n</pre>\n<p>Thank you Joe and Saikat for this illuminating answer!\n</p></p></p></p></p></p></p></p></p></p></p></p></p>"
  }
]