[
  {
    "original_filename": "1723_add_template_ini_file",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- lots of interesting stuff stored in and modifiable by editing the ininfile:\n  15056740 [Adding Project Template to 'New Project' via API]\n  https://forums.autodesk.com/t5/revit-api-forum/adding-project-template-to-new-project-via-api/m-p/8585348\n\ntwitter:\n\nAccessing and modifying settings in the Revit.ini file, e.g., adding a project template to the 'New Project' dialog on the Start Window, using the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/modini\n \nSome interesting settings are stored in and can be modified by editing the Revit ini file.\nPeter <i>@pgerz</i> pointed out yet another possibility in his answer to \nthe Revit API discussion forum thread on adding a project template to 'New Project' via API.\nQuestion: I noticed the UI method for adding a project template to the 'New Project' dialog on the Start Window by going to Options &gt; File Locations and clicking the little plus symbol...\n\n&ndash; \n...\n\nlinkedin:\n\nof [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2019.0.145.4).\n\n-->"
  },
  {
    "original_filename": "1723_add_template_ini_file",
    "header_text": "Accessing and Modifying Settings in the Ini File",
    "local_header_href": "#accessing-and-modifying-settings-in-the-ini-file",
    "chunk_text": "### Accessing and Modifying Settings in the Ini File\n\nSome interesting settings are stored in and can be modified by editing the Revit ini file `Revit.ini`.\n\nPeter [@pgerz](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/859112) pointed\nout yet another possibility in his answer to \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [adding a project template to 'New Project' via API](https://forums.autodesk.com/t5/revit-api-forum/adding-project-template-to-new-project-via-api/m-p/8585348):\n\n**Question:** I noticed that the UI method for adding a project template to the 'New Project' dialog on the Start Window is by going to Options &gt; File Locations and clicking the little plus symbol.\n\nIs there any way to achieve this same effect using the API?\n\nI would like to add templates to the dropdown.\n\n**Answer:** You can do it by editing the ini file with standard .NET functions; it is located at:\n\n- C:\\Users\\%username%\\AppData\\Roaming\\Autodesk\\Revit\\Autodesk Revit 2019\\Revit.ini\n\nIn the section `[DirectoriesENU]`, modify the setting `DefaultTemplate`.\n\nExample:\n\n<pre class=\"code\">\n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;oriFile&nbsp;=&nbsp;<span style=\"color:maroon;\">@&quot;&quot;</span>\n&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:#2b91af;\">Environment</span>.GetEnvironmentVariable(&nbsp;<span style=\"color:#a31515;\">&quot;appdata&quot;</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:maroon;\">@&quot;\\Autodesk\\Revit\\Autodesk&nbsp;Revit&nbsp;2019\\Revit.ini&quot;</span>;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;tmpFile&nbsp;=&nbsp;<span style=\"color:maroon;\">@&quot;c:\\temp\\11.ini&quot;</span>;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;System.IO.<span style=\"color:#2b91af;\">File</span>.Exists(&nbsp;oriFile&nbsp;)&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">using</span>(&nbsp;<span style=\"color:#2b91af;\">StreamReader</span>&nbsp;sr&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">StreamReader</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oriFile,&nbsp;<span style=\"color:#2b91af;\">Encoding</span>.Unicode&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">StreamWriter</span>&nbsp;sw&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">StreamWriter</span>(&nbsp;tmpFile,&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">false</span>,&nbsp;<span style=\"color:#2b91af;\">Encoding</span>.Unicode&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;inputLine&nbsp;=&nbsp;<span style=\"color:#a31515;\">&quot;&quot;</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">while</span>(&nbsp;(&nbsp;inputLine&nbsp;=&nbsp;sr.ReadLine()&nbsp;)&nbsp;!=&nbsp;<span style=\"color:blue;\">null</span>&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;inputLine.StartsWith(&nbsp;<span style=\"color:#a31515;\">&quot;DefaultTemplate=&quot;</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;inputLine.Contains(&nbsp;<span style=\"color:#a31515;\">&quot;Example_SCHEMA.rte&quot;</span>&nbsp;)&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;do&nbsp;nothing</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">else</span>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inputLine&nbsp;=&nbsp;inputLine\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style=\"color:maroon;\">@&quot;,&nbsp;Example_SCHEMA=C:\\temp\\Example_SCHEMA.rte&quot;</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sw.WriteLine(&nbsp;inputLine&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sw.Close();\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;System.IO.<span style=\"color:#2b91af;\">File</span>.Replace(&nbsp;tmpFile,&nbsp;oriFile,&nbsp;<span style=\"color:blue;\">null</span>&nbsp;);\n&nbsp;&nbsp;}\n</pre>\n\nMany thanks to Peter for this solution!\n\n<center>\n<img src=\"img/stencil.png\" alt=\"Stencil\" width=\"320\">\n</center>"
  }
]