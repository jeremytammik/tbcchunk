[
  {
    "original_filename": "1863_param_optimise_tbcfts",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n\n<style type=\"text/css\">\n  .jt { background-color:#eee;border-collapse:collapse; }\n  .jt th { background-color:#000;color:white; }\n  .jt td, .jt th { padding:5px;border:1px solid #000; }\n</style>\n</head>\n\n<!---\n\n- optimising shared parameter setting\n  Modify Shared Parameters for high number of family instance\n  https://forums.autodesk.com/t5/revit-api-forum/modify-shared-parameters-for-high-number-of-family-instance/m-p/9727166\n\n- [Let's build a Full-Text Search engine](https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine)\n  by Artem Krylysov\n  https://github.com/akrylysov/simplefts\n  /a/src/go/tbcfts/\n  tar -cf tbcdump.tar *htm *html\n  gzip tbcdump.tar  \n\n- troubleshooting the OBJ importer\n  https://truevis.com/troubleshoot-revit-mesh-import/\n  Re: Addin broken on Czech language OS\n  Eric Boehlke <design@truevis.com>\n\ntwitter:\n\nDabbling with the Go programming language, optimising setting shared parameters and full-text search for The Building Coder posts for the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/optimiseparams\n\nI have been dabbling with the Go programming language in the past week, besides optimising and answering Revit API questions\n&ndash; Optimising setting shared parameters\n&ndash; Full-text search for The Building Coder posts\n&ndash; Decimal point woe...\n\nlinkedin:\n\nDabbling with the Go programming language, optimising setting shared parameters and full-text search for The Building Coder posts for the #RevitAPI\n\nhttp://bit.ly/optimiseparams\n\nI have been dabbling with the Go programming language in the past week, besides optimising and answering Revit API questions:\n\n- Optimising setting shared parameters\n- Full-text search for The Building Coder posts\n- Decimal point woe...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "1863_param_optimise_tbcfts",
    "header_text": "Optimising Parameters and Full-Text Search",
    "local_header_href": "#optimising-parameters-and-full-text-search",
    "chunk_text": "### Optimising Parameters and Full-Text Search\n\nI have been dabbling with the Go programming language in the past week, besides optimising and answering Revit API questions:\n\n- [Optimising setting shared parameters](#2)\n- [Full-text search for The Building Coder posts](#3)\n- [Decimal point woe](#4)\n\n####<a name=\"2\"></a>Optimising Setting Shared Parameters\n\nI took a successful stab at optimising the setting of a large number of shared parameters in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [modifying shared parameters for a high number of family instances](https://forums.autodesk.com/t5/revit-api-forum/modify-shared-parameters-for-high-number-of-family-instance/m-p/9727166):\n\n**Question:** I have the code below working fine when my collection contains less than 30 objects; above 30, the transaction commit doesn't affect the document and there is no error or exception raised.\n\n<pre class=\"code\">\n<span style=\"color:blue;\">void</span>&nbsp;<span style=\"color:#2b91af;\">IExternalEventHandler</span>.Execute(&nbsp;<span style=\"color:#2b91af;\">UIApplication</span>&nbsp;app&nbsp;)\n{\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">UIDocument</span>&nbsp;uidoc&nbsp;=&nbsp;app.ActiveUIDocument;\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc&nbsp;=&nbsp;uidoc.Document;\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">View</span>&nbsp;view&nbsp;=&nbsp;doc.ActiveView;\n \n&nbsp;&nbsp;<span style=\"color:blue;\">using</span>(&nbsp;<span style=\"color:#2b91af;\">Transaction</span>&nbsp;tr&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">Transaction</span>(&nbsp;doc&nbsp;)&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param1&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param2;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param3;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param4&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param5&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param6&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;param7&nbsp;=&nbsp;<span style=\"color:blue;\">null</span>;\n \n&nbsp;&nbsp;&nbsp;&nbsp;tr.Start(&nbsp;<span style=\"color:#a31515;\">&quot;synchro&quot;</span>&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green;\">//&nbsp;Main.idForSynchros&nbsp;is&nbsp;the&nbsp;collection&nbsp;of&nbsp;data</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">for</span>(&nbsp;<span style=\"color:blue;\">int</span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;Main.idForSynchros.Count;&nbsp;i++&nbsp;)&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">IdForSynchro</span>&nbsp;i&nbsp;=&nbsp;Main.idForSynchros[&nbsp;i&nbsp;];\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Element</span>&nbsp;element&nbsp;=&nbsp;doc.GetElement(&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">ElementId</span>(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Convert</span>.ToInt32(&nbsp;i.RevitId&nbsp;)&nbsp;)&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param1&nbsp;=&nbsp;element.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM1&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param2&nbsp;=&nbsp;element.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM2&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param3&nbsp;=&nbsp;element.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM3&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param4&nbsp;=&nbsp;element.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM4&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param5&nbsp;=&nbsp;element.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM5&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param6&nbsp;=&nbsp;element.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM6&quot;</span>&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param7&nbsp;=&nbsp;element.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM7&quot;</span>&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;param1.AsInteger()&nbsp;&lt;&nbsp;1&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param1.Set(&nbsp;i.param1&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;param6Value&nbsp;=&nbsp;<span style=\"color:#2b91af;\">DateTime</span>.Parse(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.data.param6,&nbsp;CultureInfo.InvariantCulture&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ToLongDateString();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">string</span>&nbsp;param7Value&nbsp;=&nbsp;<span style=\"color:#2b91af;\">DateTime</span>.Parse(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.data.param7,&nbsp;CultureInfo.InvariantCulture&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ToLongDateString();\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utils.SetParameterValueString(&nbsp;param2,&nbsp;i.data.param2&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utils.SetParameterValueString(&nbsp;param3,&nbsp;i.data.param2&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utils.SetParameterValueString(&nbsp;param4,&nbsp;i.data.param4&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utils.SetParameterValueString(&nbsp;param5,&nbsp;i.data.param5&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utils.SetParameterValueString(&nbsp;param6,&nbsp;param6Value&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utils.SetParameterValueString(&nbsp;param7,&nbsp;param7Value&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;tr.Commit();\n&nbsp;&nbsp;}\n}\n \n<span style=\"color:green;\">//&nbsp;Method&nbsp;of&nbsp;Utils&nbsp;class&nbsp;that&nbsp;set&nbsp;Parameter&nbsp;value</span>\n<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">static</span>&nbsp;<span style=\"color:blue;\">void</span>&nbsp;SetParameterValueString(&nbsp;\n&nbsp;&nbsp;<span style=\"color:#2b91af;\">Parameter</span>&nbsp;parameter,&nbsp;<span style=\"color:blue;\">string</span>&nbsp;value&nbsp;)\n{\n&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;parameter&nbsp;!=&nbsp;<span style=\"color:blue;\">null</span>&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.Set(&nbsp;value&nbsp;);\n&nbsp;&nbsp;}\n}\n</pre>\n\nDoes anyone have any idea to solve this?\n\n**Answer:** `LookupParameter` is unnecessarily costly.\n\nThere is no need to re-execute it for every parameter on every single element.\n\nThat is costing you a lot of time and hurting performance.\n\nEvery shared parameter is equipped with a GUID to identify it.\n\nDetermine the GUID once only on the first element.\n\nThen, you can use the GUID to retrieve each parameter directly from the element without any further need for `LookupParameter` to search through the entire list of parameters each time.\n\nHere is my suggestion for an improvement:\n\n<pre class=\"code\">\n<span style=\"color:blue;\">class</span>&nbsp;<span style=\"color:#2b91af;\">IdForSynchro</span>\n{\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:#2b91af;\">ElementId</span>&nbsp;RevitId&nbsp;{&nbsp;<span style=\"color:blue;\">get</span>;&nbsp;<span style=\"color:blue;\">set</span>;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">int</span>&nbsp;Param1&nbsp;{&nbsp;<span style=\"color:blue;\">get</span>;&nbsp;<span style=\"color:blue;\">set</span>;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">string</span>&nbsp;Param2&nbsp;{&nbsp;<span style=\"color:blue;\">get</span>;&nbsp;<span style=\"color:blue;\">set</span>;&nbsp;}\n&nbsp;&nbsp;<span style=\"color:blue;\">public</span>&nbsp;<span style=\"color:blue;\">double</span>&nbsp;Param3&nbsp;{&nbsp;<span style=\"color:blue;\">get</span>;&nbsp;<span style=\"color:blue;\">set</span>;&nbsp;}\n}\n \n<span style=\"color:blue;\">void</span>&nbsp;modifyParameterValues(&nbsp;<span style=\"color:#2b91af;\">Document</span>&nbsp;doc,&nbsp;<span style=\"color:#2b91af;\">IList</span>&lt;<span style=\"color:#2b91af;\">IdForSynchro</span>&gt;&nbsp;data&nbsp;)\n{\n&nbsp;&nbsp;<span style=\"color:blue;\">using</span>(&nbsp;<span style=\"color:#2b91af;\">Transaction</span>&nbsp;tr&nbsp;=&nbsp;<span style=\"color:blue;\">new</span>&nbsp;<span style=\"color:#2b91af;\">Transaction</span>(&nbsp;doc&nbsp;)&nbsp;)\n&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Guid</span>&nbsp;guid1&nbsp;=&nbsp;<span style=\"color:#2b91af;\">Guid</span>.Empty;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Guid</span>&nbsp;guid2&nbsp;=&nbsp;<span style=\"color:#2b91af;\">Guid</span>.Empty;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Guid</span>&nbsp;guid3&nbsp;=&nbsp;<span style=\"color:#2b91af;\">Guid</span>.Empty;\n \n&nbsp;&nbsp;&nbsp;&nbsp;tr.Start(&nbsp;<span style=\"color:#a31515;\">&quot;synchro&quot;</span>&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">foreach</span>(&nbsp;<span style=\"color:#2b91af;\">IdForSynchro</span>&nbsp;d&nbsp;<span style=\"color:blue;\">in</span>&nbsp;data&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">Element</span>&nbsp;e&nbsp;=&nbsp;doc.GetElement(&nbsp;d.RevitId&nbsp;);\n \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue;\">if</span>(&nbsp;<span style=\"color:#2b91af;\">Guid</span>.Empty&nbsp;==&nbsp;guid1&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guid1&nbsp;=&nbsp;e.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM1&quot;</span>&nbsp;).GUID;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guid2&nbsp;=&nbsp;e.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM2&quot;</span>&nbsp;).GUID;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guid3&nbsp;=&nbsp;e.LookupParameter(&nbsp;<span style=\"color:#a31515;\">&quot;PLUGIN_PARAM3&quot;</span>&nbsp;).GUID;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.get_Parameter(&nbsp;guid1&nbsp;).Set(&nbsp;d.Param1&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.get_Parameter(&nbsp;guid2&nbsp;).Set(&nbsp;d.Param2&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.get_Parameter(&nbsp;guid3&nbsp;).Set(&nbsp;d.Param3&nbsp;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;tr.Commit();\n&nbsp;&nbsp;}\n}\n</pre>\n\nI added this code in the original and updated forms\nto [The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples).\n\nHere is the [diff between the two](https://github.com/jeremytammik/the_building_coder_samples/commit/fea7381f51b660fc9b5660c2e64f548623b11d8b).\nand the [current implementation code](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/BuildingCoder/CmdCreateSharedParams.cs#L547-L584).\n\nPlease equip your code with a little benchmark timer stopwatch and let us know whether this helps and how it affects the processing time required before and after making this modification.\n\n**Response:** I applied the solution and the execution time improved.\n\nHere are some results before and after the modification, correlating the number of family instances with the execution time required in milliseconds before and after the enhancement:\n\n<center>\n<table class=\"jt\">\n<tr><th class=\"r\">Instances</th><th class=\"r\">&nbsp;&nbsp;ms before</th><th class=\"r\">&nbsp;&nbsp;ms after</th></tr>\n<tr><td class=\"r\">58</td><td class=\"r\">896</td><td class=\"r\">794</td></tr>\n<tr><td class=\"r\">375</td><td class=\"r\">1958</td><td class=\"r\">1549</td></tr>\n<tr><td class=\"r\">1052</td><td class=\"r\">16777</td><td class=\"r\">8152</td></tr>\n</table>\n</center>\n\nBut there are still times when changes are not applied to the document.\n\n**Answer:** Not sure if you caught it when you refactored, but in your original code you used `param2` to set `2` and `3`.\nCould that be affecting what your results are?\n\nMay be good to throw in some Try/Catch block to try and see where or if it's failing or at least a task dialog to tell user if a param is missing.\n\n####<a name=\"3\"></a>Full-Text Search for The Building Coder Posts\n\nI discovered a nice article by Artem Krylysov\nsuggesting [let's build a full-text search engine](https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine)\nusing the [Go programming language](https://golang.org),\nwith an accompanying [simplefts GitHub repository](https://github.com/akrylysov/simplefts) sharing the final result.\n\nThat prompted me to dabble a bit with Go and use it to implement full text search functionality for The Building coder blog posts as well.\n\nThe work in progress is available from my [tbcfts GitHub repository](https://github.com/jeremytammik/tbcfts).\n\n[The Building Coder blog source `tbc`](https://github.com/jeremytammik/tbc) is available from GitHub as well, so you have all you need to play with it yourself, if you please.\n\nHere is a sample run searching for the word 'dabble', which includes today's draft post, still lacking the public URL:\n\n<pre>\n/a/src/go/tbcfts $ ./tbcfts -q \"dabble\"\n2020/09/09 10:31:40 Starting tbcfts, p=/a/doc/revit/tbc/git/a, q=dabble\n2020/09/09 10:31:41 Loaded 1863 documents in 377.397917ms\n2020/09/09 10:31:44 Indexed 1863 documents in 2.876775333s\n2020/09/09 10:31:44 Search for 'dabble' found 5 documents in 9.703µs\n2020/09/09 10:31:44 582 [Wiki API Help, View Event and Structural Material Type](http://thebuildingcoder.typepad.com/blog/2011/05/wiki-api-help-view-event-and-structural-material-type.html)\n2020/09/09 10:31:44 906 [Export Wall Parts Individually to DXF](http://thebuildingcoder.typepad.com/blog/2013/03/export-wall-parts-individually-to-dxf.html)\n2020/09/09 10:31:44 961 [Super Insane MP3 and Songbird Playlist Exporter](http://thebuildingcoder.typepad.com/blog/2013/06/super-insane-mp3-and-songbird-playlist-exporter.html)\n2020/09/09 10:31:44 1008 [Open MEP Connector Warning](http://thebuildingcoder.typepad.com/blog/2013/08/open-mep-connector-warning.html)\n2020/09/09 10:31:44 1863 [Optimising Parameters and Full-Text Search](http thebuildingcoder.typepad.com not yet published)\n</pre>\n\nAccording to `wc`, the current blog post HTML source consists of 355233 lines, 2230690 words and 20676311 characters, including markup.\n\nAs you can see, loading the documents and storing their body text in memory costs ca. 400 ms.\n\nThe indexing is costly, clocking in at ca. 3 seconds.\n\nOnce indexing is complete, the lookup is very fast, consuming just 10 microseconds.\n\nObviously, the next feature to address would be caching the index.\n\nAnother important enhancement would be to split the documents into smaller sections.\n\nFor instance, I could create much smaller and more targeted documents to index by using the `h4` tags that delimit individual sections of text within each blog post instead of retaining each blog post in its entirety as a single document.\n\n####<a name=\"4\"></a>Decimal Point Woe\n\nA few of my Revit sample add-ins have been promoted to full-fledged commercial applications.\n\nOne of them is the OBJ importer, which Eric Boehlke has published to the AppStore and continuously enhanced.\n\nA new little issue arose with it that is useful to be aware of, since it applies to many other contexts as well:\n\n**Question:** I had a strange phenomenon happen.\nI have an OBJ Import app customer using Czech language on Windows.\nHis Revit is English 2020.\n\nThe problem is that with the same OBJ file, and the same Revit version, on my computer it works fine, and on his the app runs but fails and imports 0 faces.\n\nHave you ever seen an add-in fail because the OS was a language that had non-English characters?\n\nI really don't know what is causing the problem.\n\n**Answer:** Yes, often!\n\nSome language cultures use comma instead of decimal point and then crash when trying to read floating point numbers.\n\n**Response:** Aha!\n\nYes, I see, e.g., in a different OBJ software,\n[OBJ export is broken on locales with comma instead of dot](https://github.com/keenanwoodall/Deform/issues/17).\n\nThat was the problem.\n\nI told the client and updated\nthe [Troubleshooting *Mesh Import from OBJ Files* for Revit](https://truevis.com/troubleshoot-revit-mesh-import) with the workaround:\n\n**Region Number Format**\n\nSome regions use commas instead of dots for the decimal place.\nThat may cause the import to fail.\nA workaround is to set Window’s Region to United States before importing the OBJ.\n\n<center>\n<img src=\"img/windows_regional_number_format.png\" alt=\"Windows regional number format\" title=\"Windows regional number format\" width=\"400\"/> <!-- 511 -->\n</center>"
  }
]