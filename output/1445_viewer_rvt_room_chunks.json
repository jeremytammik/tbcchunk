[
  {
    "original_filename": "1445_viewer_rvt_room",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<title>The Building Coder</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n<link rel=\"stylesheet\" type=\"text/css\" href=\"3dwc.css\"/>\n<!--\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n-->\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true&amp;skin=sunburst&amp;lang=css\" defer=\"defer\"></script>\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true&amp;skin=sunburst\" defer=\"defer\"></script>\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\"></script>\n</head>\n\n<!---\n\nHighlighting Revit Rooms in the Forge Viewer @AutodeskForge @CubeAthens #3dwebcoder #revitapi #3dweb #threejs\n\nI am leaving Athens today. The Athens Forge meetup and web server workshop at The Cube went well.\nNow it is full steam ahead towards the Forge DevCon in San Francisco week after next. Not to forget the 3D Web Fest on June 15, in parallel with Forge DevCon, showcasing the best of the 3D web as live performance art with a catered reception in a film festival atmosphere...\n\n-->"
  },
  {
    "original_filename": "1445_viewer_rvt_room",
    "header_text": "Highlighting Revit Rooms in the Forge Viewer",
    "local_header_href": "#highlighting-revit-rooms-in-the-forge-viewer",
    "chunk_text": "### Highlighting Revit Rooms in the Forge Viewer\n\nI am leaving Athens today.\n\nThe [Athens Forge meetup](http://www.meetup.com/de-DE/I-love-3D-Athens/events/230543759) and\n[web server workshop](http://www.meetup.com/de-DE/I-love-3D-Athens/events/230544059)\nat [The Cube](http://thecube.gr) went well.\n\nHere are a couple of pictures before and after the events:\n\n<center>\n<a data-flickr-embed=\"true\"  href=\"https://www.flickr.com/photos/jeremytammik/albums/72157669263727915\" title=\"Athens\"><img src=\"https://c8.staticflickr.com/8/7125/27430452255_afc4f13059_n.jpg\" width=\"320\" height=\"240\" alt=\"Athens\"></a><script async src=\"//embedr.flickr.com/assets/client-code.js\" charset=\"utf-8\"></script>\n</center>\n\t\nNow it is full steam ahead towards\nthe [Forge DevCon](http://forge.autodesk.com/conference) in San Francisco week after next.\n\nNot to forget the [3D Web Fest](http://www.3dwebfest.com) on June 15, in parallel with Forge DevCon, showcasing the best of the 3D web as live performance art with a catered reception in a film festival atmosphere. This year all proceed go to the non-profit [CODAME](http://www.codame.com) ART+TECH project.\n\nAt the recent Barcelona [Forge](http://forge.autodesk.com) [Accelerator](http://autodeskcloudaccelerator.com), I talked with Jaroslav Daníček\nof [CAD Studio a.s.](http://www.cadstudio.cz).\n\nJaroslav very kindly shared his hard-won experience and algorithm how to [highlight a specific Room in the Forge viewer](#4).\n\nThe [Forge Viewer discussion forum](http://forums.autodesk.com/t5/view-and-data-api/bd-p/95)\nincludes some other hints\non [handling Revit rooms](http://forums.autodesk.com/t5/view-and-data-api/revit-rooms/m-p/5297233) that might be worth mentioning first."
  },
  {
    "original_filename": "1445_viewer_rvt_room",
    "header_text": "<a name=\"2\"></a>Accessing Room Data",
    "local_header_href": "#a-name2aaccessing-room-data",
    "chunk_text": "#### <a name=\"2\"></a>Accessing Room Data\n\nThe Forge viewer displays geometrical objects.\n\nBy default, the rooms in a Revit model do not generate any geometry.\n\nHowever, their other information, attributes and parameters are all present in the translated model.\n\nIf you know the room element id, you can retrieve it from the translated viewer data.\n\nIt is not immediately accessible through the user interface, since there is no geometry associated with it.\n\nA room is a void, and the viewer is mainly focused on displaying (non-void) geometrical objects.\n\nYou can easily implement your own extensions to retrieve, display and interact with the room data in any way you like."
  },
  {
    "original_filename": "1445_viewer_rvt_room",
    "header_text": "<a name=\"3\"></a>Automatically Navigating to a Specific Room",
    "local_header_href": "#a-name3aautomatically-navigating-to-a-specific-room",
    "chunk_text": "#### <a name=\"3\"></a>Automatically Navigating to a Specific Room\n\nOne approach to automatically navigate to a specific room was implemented at\nthe [cloud accelerator in Prague](http://the3dwebcoder.typepad.com/blog/2015/09/towards-a-comphound-mongo-database-table-view.html)\nin September last year by Jaroslav's colleague Vitezslav Peka:\n\nSeveral participant interested in Revit models ran into this issue, and various solutions were implemented.\n\nThe simplest approach to zoom to a Revit room in the Forge viewer seems to be the following:\n\n- Place a family instance with some geometry inside each room. You might want to place it at the ceiling level, somewhere in the 'centre' of the room, for the zooming and cutting described below.\n- Save and translate the modified file, then discard it and revert to original state, e.g., by saving active doc A to new project B, open B in background, modify, save, translate, delete, continue working in A.\n- Search in the viewer for the Revit `Rooms` category.\n- That returns a list of the (invisible) rooms.\n- Find the corresponding family instance for the room to retrieve its data.\n- Get its bounding box in the viewer.\n- Make a section cut at that location to show the room.\n- Set the camera to the correct view and zoom."
  },
  {
    "original_filename": "1445_viewer_rvt_room",
    "header_text": "<a name=\"4\"></a>Highlighting a Specific Room in the Forge Viewer",
    "local_header_href": "#a-name4ahighlighting-a-specific-room-in-the-forge-viewer",
    "chunk_text": "#### <a name=\"4\"></a>Highlighting a Specific Room in the Forge Viewer\n\nJaroslav took Vitezslav's solution one step further to implement Revit room highlighting in the Forge viewer. In his own words:\n\nHere is what I did basically:\n\nRevit side:\n\n- Add lines for every room following its 'floor plan', so in the viewer every line has its own object and DbID.\n- Sort them in order like 'drawn with pencil in one move', second line should start where previous ends.\n- Upload Revit model to the cloud.\n- Store information in the database which lines (respective DbIDs of lines) belongs to which rooms and their order.\n\nIf a room contains holes it is a little bit more complicated for drawing in the viewer; you must also store information whether a line represents a hole or main 'circle'.\n\nViewer side (for 3D models only):\n\n- When selecting a room from the room list, identify the room and its lines in the database, via ajax send DbIDs of lines back.\n- Now you have got array of DbIDs of lines.\n- For every line get its start and end point; they provide coordinates for the vertices.\n- Create a 2D shape from the vertices and extrude shape to height of a room or cut plane.\n- From shape and extrusion setup create a mesh with transparent material and add it to the viewer.\n- Set correct Z coordinate for the new mesh.\n- For better orientation and visibility is good to set the cut plane to the height of a level where a room is located and animate the camera to look from above.\n\nHere are some sample images:\n\nA clean level cut:\n\n<center>\n\t<img src=\"img/viewer_hilite_room_1.png\" alt=\"Viewer highlight room &mdash; a clean level cut\" width=\"460\">\n</center>\n\nA complicated room shape:\n\n<center>\n\t<img src=\"img/viewer_hilite_room_2.png\" alt=\"Viewer highlight room &mdash; a complicated room shape\" width=\"460\">\n</center>\n\nA simple room shape next to the complicated one:\n\n<center>\n\t<img src=\"img/viewer_hilite_room_3.png\" alt=\"Viewer highlight room &mdash; a simple room shape next to the complicated one\" width=\"460\">\n</center>\n\nMany thanks to Jaroslav for sharing these valuable hints!\n\nHave fun implementing your own Forge viewer extensions!"
  },
  {
    "original_filename": "1445_viewer_rvt_room",
    "header_text": "<a name=\"5\"></a>Forge Viewer Extension Starting Points",
    "local_header_href": "#a-name5aforge-viewer-extension-starting-points",
    "chunk_text": "#### <a name=\"5\"></a>Forge Viewer Extension Starting Points\n\nIf you are looking for handy starting points, you can look at\nmy [roomedit3d](https://github.com/jeremytammik/roomedit3d) sample,\nKean Walmsley's [introduction to creating extensions](http://through-the-interface.typepad.com/through_the_interface/2016/05/creating-extensions-for-the-autodesk-viewer.html)\nand [vertical toolbar extension](http://through-the-interface.typepad.com/through_the_interface/2016/05/creating-a-vertical-toolbar-extension-for-the-autodesk-viewer.html),\nand, above all, the mother of them all, Philippe Leefsma's\n[collection of JavaScript extensions for the viewer](https://github.com/Developer-Autodesk/library-javascript-viewer-extensions) and gallery.\n\nMaxim [@redcraft](https://github.com/redcraft) Gurkin's\n[lmv-extensions](https://github.com/Developer-Autodesk/lmv-extensions) also\nlook interesting... has anyone taken a look at them?"
  }
]