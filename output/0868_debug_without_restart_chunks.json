[
  {
    "original_filename": "0868_debug_without_restart",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0868_debug_without_restart",
    "header_text": "Reload Add-in for Debug Without Restart",
    "local_header_href": "#reload-add-in-for-debug-without-restart",
    "chunk_text": "<h3>Reload Add-in for Debug Without Restart</h3><p>We explored and learned a lot of interesting areas during the DevLab at AU on Tuesday last week.\n\n<p>One recurring theme is how to effectively debug an add-in without having to restart Revit and reload the entire model each time a change is made to the source code.</p>\n<p>A long, long time back, right in the beginning of the Revit .NET API, it was briefly possible to use the Visual Studio Edit and Continue feature for that.\nThat was obviously an absolutely perfect solution.\nAlas, those times are past, and unlikely to return.\nI almost find it hard to believe I am not imagining things.</p>\n<p>There are in fact several other known solutions to this problem, which I would classify as follows:\n\n<ul>\n<li>Stupid: set up the Revit project and Visual Studio debug settings to bring you to the exact required debugging position and context in one F5 'start debugging' click.\nEvery time a code modification is required, simply stop debugging, modify the code, recompile and restart Revit.\nThat is the approach I use myself, since I can get by working in absolutely minimal test models.\n\n<li>Cool: use an interactive scripting language such as\n\n<!-- 865_python_ui_server_api.htm -->\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/11/au-classes-on-python-ui-server-and-framework-apis.html#1\">\nPython</a> or\n\n<!-- 797_revitrubyshell.htm -->\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/07/meetings-football-and-revitrubyshell.html#2\">\nRuby</a>.\n\nIn fact, the wish be able to modify the API code interactively without requiring the tedious recompile and reload cycle was one of the main motivating factors in implementing the latter.\nThe use of this functionality is obviously just a side effect of the much larger main advantage of being able to play interactively with the code in complete freedom, since it is interpreted on the fly and no compilation at all is required.\n\n<li>Effective and laborious: convert the code to be debugged to a macro and use the built-in SharpDevelop IDE.\nThis means that you convert the part of your add-in that your are debugging and modifying to a macro.\nThe rest can be left as a compiled DLL.\nThe two components can communicate with each other.\nWhen finished debugging, you move the code out of the macro environment into the external DLL again.\n\n<li>Efficient: use the\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/03/addinmanager.html\">\nAddInManager</a> and\n\nattach to process to reload repeatedly, with compile and edit cycles.\n</li></li></li></li></ul>\n<p>I already described all three of the solutions not involving Python and Ruby in an earlier discussion on\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/05/debugging-an-add-in-without-restarting-revit.html\">\ndebugging an add-in without restarting Revit</a>.\n\n<p>Melissa Manalac of\n\n<a href=\"http://www.s-frame.com\">S-frame</a>\n\nwas making such efficient use of the AddInManager approach at the DevLab that I asked her to document it for you once again.</p>\n<p>She points out that James LeVieux already summarized the process in his\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/05/debugging-an-add-in-without-restarting-revit.html?cid=6a00e553e16897883301538f2ad15a970b#comment-6a00e553e16897883301538f2ad15a970b\">\ncomment</a> on\n\nthat discussion:</p> <!--  mentioned above -->\n<p>Here are the required steps:</p>\n<ol>\n<li>Start Revit 2013.\n<li>Before coding, make sure all processes are detached.\n<li>After coding, rebuild your solution and attach to the Revit process.\n<li>In Revit, go to the Add-Ins tab &gt; Add-In Manager and reload the desired add-in DLL.\n<li>Run desired external command.\n<li>Repeat steps 2 to 5.\n</li></li></li></li></li></li></ol>\n<p>You also need to be aware that the AddInManager requires the external commands it loads to use manual transaction mode.\nThis is no significant restriction, since\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/05/read-only-and-automatic-transaction-modes.html\">\nautomatic transaction mode is not recommended</a> anyway.\n\n<p>Here are some screen snapshots to further clarify these steps:</p>\n<a name=\"1\"></a>\n<p><b>1</b>. Start Revit 2013.</p>\n<a name=\"2\"></a>\n<p><b>2</b>. Before coding, make sure all processes are detached:</p>\n<center>\n<img alt=\"Detach all processes\" src=\"img/debug_no_restart_1.png\" width=\"400\"/>\n</center>\n<a name=\"3\"></a>\n<p><b>3</b>. After coding, rebuild the add-in solution and attach to Revit process.</p>\n<p>Rebuild solution:</p>\n<center>\n<img alt=\"Rebuild solution\" src=\"img/debug_no_restart_2.png\" width=\"400\"/>\n</center>\n<p>Attach to process:</p>\n<center>\n<img alt=\"Attach to Revit.exe process\" src=\"img/debug_no_restart_3.png\" width=\"400\"/>\n</center>\n<p>Select the Revit.exe process:</p>\n<center>\n<img alt=\"Attach to Revit.exe process\" src=\"img/debug_no_restart_4.png\" width=\"400\"/>\n</center>\n<a name=\"4\"></a>\n<p><b>4</b>. In Revit, go to the Add-Ins tab &gt; Add-In Manager and reload the desired add-in DLL.</p>\n<p>Launch the Add-in Manager:</p>\n<center>\n<img alt=\"Launch the Add-in Manager\" src=\"img/debug_no_restart_5.png\" width=\"400\"/>\n</center>\n<p>Load the add-in DLL:</p>\n<center>\n<img alt=\"Load the add-in DLL\" src=\"img/debug_no_restart_6.png\" width=\"400\"/>\n</center>\n<a name=\"5\"></a>\n<p><b>5</b>. Run the desired external command:</p>\n<center>\n<img alt=\"Run the add-in command\" src=\"img/debug_no_restart_7.png\" width=\"400\"/>\n</center>\n<a name=\"6\"></a>\n<p><b>6</b>. Repeat steps 2 to 5 as desired.</p>\n<p>Many thanks to Melissa for the detailed up-to-date description!</p>\n<a name=\"20\"></a>\n<h4>Source Code Coloriser</h4>\n<p>As I mentioned quite a while back, I use the Visual Studio\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/04/updated-sdk-2012-products-and-source-code-colourisation.html#4\">\nCopyToHtml</a> plug-in\n\nto copy and paste colour coded C# and VB source code to HTML for my blog posts.\n\n<p>Harri Mattison of\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/12/boost-your-bim-and-dance-with-an-elephant.html\">\nBoost Your BIM</a> now\n\npointed out that this utility obviously cannot be used in the built-in Revit SharpDevelop macro environment.\n\n<p>He found this\n\n<a href=\"http://www.pvladov.com/p/code-colorizer.html\">\nonline C# code coloriser tool</a> by\n\nPavel Vladov that is quite nice and can be used instead.\n\n<p>Oh, and I found another one myself,\n\n<a href=\"http://tohtml.com\">tohtml.com</a>,\n\nthat supports a huge number of different languages besides C#.\nUnfortunately, it does not escape all the HTML characters, e.g. '&lt;' remains '&lt;' instead of being converted to '&amp;lt;'.</p>\n</p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0868_debug_without_restart",
    "header_text": "Source Code Coloriser",
    "local_header_href": "#source-code-coloriser",
    "chunk_text": "<h4>Source Code Coloriser</h4><p>As I mentioned quite a while back, I use the Visual Studio\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/04/updated-sdk-2012-products-and-source-code-colourisation.html#4\">\nCopyToHtml</a> plug-in\n\nto copy and paste colour coded C# and VB source code to HTML for my blog posts.\n\n<p>Harri Mattison of\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2012/12/boost-your-bim-and-dance-with-an-elephant.html\">\nBoost Your BIM</a> now\n\npointed out that this utility obviously cannot be used in the built-in Revit SharpDevelop macro environment.\n\n<p>He found this\n\n<a href=\"http://www.pvladov.com/p/code-colorizer.html\">\nonline C# code coloriser tool</a> by\n\nPavel Vladov that is quite nice and can be used instead.\n\n<p>Oh, and I found another one myself,\n\n<a href=\"http://tohtml.com\">tohtml.com</a>,\n\nthat supports a huge number of different languages besides C#.\nUnfortunately, it does not escape all the HTML characters, e.g. '&lt;' remains '&lt;' instead of being converted to '&amp;lt;'.</p>\n</p></p></p>"
  }
]