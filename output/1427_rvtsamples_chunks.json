[
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"run_prettify.js\" type=\"text/javascript\"></script>\n<!--\n<script src=\"https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js\" type=\"text/javascript\"></script>\n-->\n</head>\n\n<!---\n\nRvtSamples for Revit 2017 #revitAPI #3dwebcoder @AutodeskRevit #adsk #aec #bim #python #dynamobim\n\nSetting up RvtSamples for Revit 2017\n&ndash; Copy Html Markup in Visual Studio 2015\n&ndash; Running Revit 2017 in the Visual Studio 2015 debugger\n&ndash; 'Security &ndash; Unsigned Add-In' message\n&ndash; RvtSamples DLL and TXT should be together\n&ndash; Specifying the Revit SDK samples root path\n&ndash; Correcting errors in individual SDK sample entries\n&ndash; PlacementOptions description line is missing\n&ndash; The five FabricationPartLayout external commands\n&ndash; RvtSamples loads and RvtSamples.txt is cleaned up...\n\n-->"
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "RvtSamples for Revit 2017",
    "local_header_href": "#rvtsamples-for-revit-2017",
    "chunk_text": "### RvtSamples for Revit 2017\n\nPrompted by\n\nDan Tartaglia [commented](http://thebuildingcoder.typepad.com/blog/2016/04/revit-2017-revitlookup-and-sdk-samples.html#comment-2633447580) on\nthe [Revit 2017 SDK sample compilation](http://thebuildingcoder.typepad.com/blog/2016/04/revit-2017-revitlookup-and-sdk-samples.html), saying:\n\n> A couple of other issues to note about the SDK examples (RvtSamples).\n>\n> 1. The Icons folder has to be copied to where the RvtSamples.dll exists (probably obvious to most).\n> 2. RvtSamples.txt: there are only 6 statements for PlacementOptions.dll (the description is missing).\n> 3. RvtSamples.txt: The assembly path for CreateShared.dll is not correct (for both paths).\n\nThat was the first time in history that someone else took a look at RvtSamples for a new major release of Revit before I did.\n\nYipee!\n\nSo I guess I'd better get going with it as well:\n\n- [Setting up RvtSamples for Revit 2017](#2)\n- [Copy Html Markup in Visual Studio 2015](#3)\n- [Running Revit 2017 in the Visual Studio 2015 debugger](#4)\n- ['Security &ndash; Unsigned Add-In' message](#5)\n- [RvtSamples DLL and TXT should be together](#6)\n- [Specifying the Revit SDK samples root path](#7)\n- [Correcting errors in individual SDK sample entries](#8)\n- [PlacementOptions description line is missing](#9)\n- [The five FabricationPartLayout external commands](#10)\n- [RvtSamples loads and RvtSamples.txt is cleaned up](#11)"
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"2\"></a>Setting up RvtSamples for Revit 2017",
    "local_header_href": "#a-name2asetting-up-rvtsamples-for-revit-2017",
    "chunk_text": "#### <a name=\"2\"></a>Setting up RvtSamples for Revit 2017\n\nThe first thing I did was add the RvtSamples add-in manifest and input text file to its project files:\n\n<center>\n<img src=\"img/RvtSamples_addin_manifest_input_txt.png\" alt=\"RvtSamples add-in manifest and input text file\" width=\"299\">\n</center>\n\nThen in `Application.cs`, I set the Boolean test variable `testClassName` to true:\n\n<pre class=\"code\">\n  <span style=\"color:blue;\">bool</span>&nbsp;testClassName&nbsp;=&nbsp;<span style=\"color:blue;\">true</span>;&nbsp;<span style=\"color:green;\">//&nbsp;jeremy</span>\n</pre>\n\nSearch for 'jeremy' to find it.\n\nNow RvtSamples will complain on any external command specified in `RvtSamples.txt` that cannot be found."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"3\"></a>Copy Html Markup in Visual Studio 2015",
    "local_header_href": "#a-name3acopy-html-markup-in-visual-studio-2015",
    "chunk_text": "#### <a name=\"3\"></a>Copy Html Markup in Visual Studio 2015\n\nWhile writing this, I notice that I have to install something like `CopySourceAsHtml` in my Visual Studio 2015 IDE before I can start describing my steps here.\n\nFirst things first.\n\nIt was not completely trivial\nto [enable CopySourceAsHtml for Visual Studio 2012](http://thebuildingcoder.typepad.com/blog/2014/04/migrating-roomeditorapp-to-revit-2015.html#5).\n\nI tried to use a similar procedure for Visual Studio 2015, e.g.:\n\n<pre>\n&gt; md \"C:\\Users\\tammikj\\Documents\\Visual Studio 2015\\Addins\"\n\n&gt; copy \"C:\\Users\\tammikj\\Documents\\Visual Studio 2012\\Addins\" \"C:\\Users\\tammikj\\Documents\\Visual Studio 2015\\Addins\"\nC:\\Users\\tammikj\\Documents\\Visual Studio 2012\\Addins\\CopySourceAsHtml.AddIn\n  1 file(s) copied.\n</pre>\n\nI edited the add-in file analogously to the last installation, only to discover &ndash; after some significant effort and frustration &ndash;\n[Visual Studio 2015: goodbye add-ins, hello VsPackage extensions](http://visualstudioadventures.com/2015/04/25/visual-studio-2015-goodbye-add-ins-hello-vspackage-extensions).\n\nSo I will have to set up an entirely new system for this now.\n\nAfter quite a bit of fruitless searching I ended up installing\nthe [Productivity Power Tools 2015](https://visualstudiogallery.msdn.microsoft.com/34ebc6a2-2777-421d-8914-e29c1dfa7f5d).\n\nNow I once again have my &ndash; or 'a' &ndash; 'Copy Html Markup' menu entry:\n\n<center>\n<img src=\"img/visual_studio_2015_copy_html_markup.png\" alt=\"Copy Html Markup menu entry\" width=\"497\">\n</center>\n\nIt does a really good job!\n\nThis is the RvtSamples add-in manifest, retrieved via the new tool, pasted into the blog post text completely unmodified:\n\n<pre style=\"font-family:Consolas;font-size:13;color:black;background:white;\"><span style=\"color:blue;\">&lt;?</span><span style=\"color:#a31515;\">xml</span><span style=\"color:blue;\">&nbsp;</span><span style=\"color:red;\">version</span><span style=\"color:blue;\">=</span>&quot;<span style=\"color:blue;\">1.0</span>&quot;<span style=\"color:blue;\">&nbsp;</span><span style=\"color:red;\">encoding</span><span style=\"color:blue;\">=</span>&quot;<span style=\"color:blue;\">utf-8</span>&quot;<span style=\"color:blue;\">?&gt;</span>\n<span style=\"color:blue;\">&lt;</span><span style=\"color:#a31515;\">RevitAddIns</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515;\">AddIn</span><span style=\"color:blue;\">&nbsp;</span><span style=\"color:red;\">Type</span><span style=\"color:blue;\">=</span>&quot;<span style=\"color:blue;\">Application</span>&quot;<span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515;\">Name</span><span style=\"color:blue;\">&gt;</span>External&nbsp;Tool<span style=\"color:blue;\">&lt;/</span><span style=\"color:#a31515;\">Name</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515;\">Assembly</span><span style=\"color:blue;\">&gt;</span>C:\\a\\lib\\revit\\2017\\SDK\\Samples\\RvtSamples\\CS\\bin\\Debug\\RvtSamples.dll<span style=\"color:blue;\">&lt;/</span><span style=\"color:#a31515;\">Assembly</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515;\">ClientId</span><span style=\"color:blue;\">&gt;</span>42cb0a70-2ee7-4e64-a42d-87b9cdcc41c8<span style=\"color:blue;\">&lt;/</span><span style=\"color:#a31515;\">ClientId</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515;\">FullClassName</span><span style=\"color:blue;\">&gt;</span>RvtSamples.Application<span style=\"color:blue;\">&lt;/</span><span style=\"color:#a31515;\">FullClassName</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515;\">VendorId</span><span style=\"color:blue;\">&gt;</span>ADSK<span style=\"color:blue;\">&lt;/</span><span style=\"color:#a31515;\">VendorId</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515;\">VendorDescription</span><span style=\"color:blue;\">&gt;</span>Autodesk,&nbsp;www.autodesk.com<span style=\"color:blue;\">&lt;/</span><span style=\"color:#a31515;\">VendorDescription</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515;\">AddIn</span><span style=\"color:blue;\">&gt;</span>\n<span style=\"color:blue;\">&lt;/</span><span style=\"color:#a31515;\">RevitAddIns</span><span style=\"color:blue;\">&gt;</span></pre>\n\nNow, to continue with RvtSamples..."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"4\"></a>Running Revit 2017 in the Visual Studio 2015 Debugger",
    "local_header_href": "#a-name4arunning-revit-2017-in-the-visual-studio-2015-debugger",
    "chunk_text": "#### <a name=\"4\"></a>Running Revit 2017 in the Visual Studio 2015 Debugger\n\nNext, I set up the RvtSamples project to launch Revit 2017 in the Visual Studio debugger.\n\nStarting up Revit 2017 in the Visual Studio 2015 debugger does not work at all initially:\n\n<center>\n<img src=\"img/revit_2017_debug_01.png\" alt=\"Debugging Revit 2017 in Visual Studio 2015\" width=\"400\">\n</center>\n\nHappily, this issue has been addressed, e.g. in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api/bd-p/160) thread discussing\n[cannot start Revit 2015 for API debugging](http://forums.autodesk.com/t5/revit-api/cannot-start-revit-2015-for-api-debugging/td-p/4978060) and\n[Visual Studio 2015](http://forums.autodesk.com/t5/revit-api/visual-studio-2015/td-p/5647387).\n\nThey suggest to \"Use Managed Compatibility Mode\", found under Tools &gt; Options &gt; Debugging, and enabling native code debugging, respectively.\n\nI opted for the former:\n\n<center>\n<img src=\"img/revit_2017_debug_02.png\" alt=\"Use Managed Compatibility Mode\" width=\"532\">\n</center>\n\nWith that setting, I am now able to start up Revit 2017 in the Visual Studio 2015 debugger and continue with my RvtSamples installation."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"5\"></a>'Security &ndash; Unsigned Add-In' Message",
    "local_header_href": "#a-name5asecurity-ndash-unsigned-add-in-message",
    "chunk_text": "#### <a name=\"5\"></a>'Security &ndash; Unsigned Add-In' Message\n\nRevit asked me to sign in using my Autodesk account.\n\nIt then brought up the new security dialogue, explaining that the RvtSamples add-in assembly that I am attempting to load is not equipped with a trusted signature, and asking me to confirm loading it:\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_02.png\" alt=\"Security &ndash; Unsigned Add-In message\" width=\"616\">\n</center>\n\nIn text format, this reads:\n\n<pre>\n[Window Title]\nSecurity - Unsigned Add-In\n\n[Main Instruction]\nThe publisher of this add-in could not be verified. What do you want to do?\n\n[Content]\nName:       External Tool\nPublisher:  Unknown Publisher\nLocation:   C:\\a\\lib\\revit\\2017\\SDK\\Samples\\RvtSamples\\CS\\bin\\Debug\\RvtSamples.dll\nIssuer:     None\nDate:       2016-04-20 15:28:45\n\nMake sure that this add-in comes from a trusted source.\n\n[Always Load] [Load Once] [Do Not Load]\n\n[Footer]\nWhat are the risks?\n</pre>\n\nI selected 'Always Load' for this one."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"6\"></a>RvtSamples DLL and TXT Should be Together",
    "local_header_href": "#a-name6arvtsamples-dll-and-txt-should-be-together",
    "chunk_text": "#### <a name=\"6\"></a>RvtSamples DLL and TXT Should be Together\n\nOnce RvtSamples itself is properly loaded, it reads its input text file `RvtSamples.txt`, which specifies the locations of all the external commands to add to the RvtSamples toolbox.\n\nOn my first attempt, the RvtSamples external application is loaded and is unable to locate its input text file:\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_03.png\" alt=\"RvtSamples.txt not found\" width=\"366\">\n</center>\n\nWe need to explicitly set up the path to it, or, alternatively and simpler, modify the RvtSamples.dll output location to the RvtSamples `CS` root folder, so they are both in the same directory; then it will be found automatically.\n\nObviously, the add-in manifest needs to be updated to that path as well, then."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"7\"></a>Specifying the Revit SDK Samples Root Path",
    "local_header_href": "#a-name7aspecifying-the-revit-sdk-samples-root-path",
    "chunk_text": "#### <a name=\"7\"></a>Specifying the Revit SDK Samples Root Path\n\nWith the Boolean test variable `testClassName` set to true, as described above, every entry in the text file is verified.\n\nSince I have not updated the paths specified in the input text file yet, the very first entry generates an error:\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_04.png\" alt=\"Invalid path specified in RvtSamples.txt\" width=\"366\">\n</center>\n\nSo let's edit those paths.\n\nIn RvtSamples.txt, I replaced all occurrences of `C:\\Revit Copernicus SDK\\Samples\\` by my SDK samples root folder `C:\\a\\lib\\revit\\2017\\SDK\\Samples\\`.\n\n187 occurrences were replaced."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"8\"></a>Correcting Errors in Individual SDK Sample Entries",
    "local_header_href": "#a-name8acorrecting-errors-in-individual-sdk-sample-entries",
    "chunk_text": "#### <a name=\"8\"></a>Correcting Errors in Individual SDK Sample Entries\n\nRestart debugging.\n\nThis time, we get further.\n\nThe VB.NET sample DeleteObject generates an error in line 63.\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_05.png\" alt=\"DeleteObject VB.NET sample error\" width=\"366\">\n</center>\n\nThat one, and several other VB.NET samples as well, have always caused some strange issues for me, as I already [pointed out in previous releases](http://thebuildingcoder.typepad.com/blog/2013/04/compiling-the-revit-2014-sdk.html#9).\n\n<!--- Its path is specified as `...\\DeleteObject\\CS\\bin\\Debug\\DeleteObject.dll`, but for some reason, all the VB.NET samples end up in a differnt location on my system, as I already [pointed out in previous releases](http://thebuildingcoder.typepad.com/blog/2013/04/compiling-the-revit-2014-sdk.html#9). -->\n\nI ignored that one, and other VB.NET issues as well."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"9\"></a>PlacementOptions Description Line is Missing",
    "local_header_href": "#a-name9aplacementoptions-description-line-is-missing",
    "chunk_text": "#### <a name=\"9\"></a>PlacementOptions Description Line is Missing\n\nThe issue that Dan pointed out about a missing description for the PlacementOptions sample is reported rather cryptically like this:\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_06.png\" alt=\"Missing description for the PlacementOptions sample\" width=\"366\">\n</center>\n\nI added the description line and restarted the debugger."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"10\"></a>The Five FabricationPartLayout External Commands",
    "local_header_href": "#a-name10athe-five-fabricationpartlayout-external-commands",
    "chunk_text": "#### <a name=\"10\"></a>The Five FabricationPartLayout External Commands\n\nSkipping a few more VB.NET errors, the FabricationPartLayout sample apparently has a wrong external command name:\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_07.png\" alt=\"Invalid external command name for the FabricationPartLayout sample\" width=\"366\">\n</center>\n\nNot only that, but it also has its `CopyLocal` flag set to `true` on the Revit API assemblies, thus creating local copies of them all.\n\nThis is not recommended, quite the contrary, so I filed an issue REVIT-90156 [API SDK Sample: FabricationPartLayout Revit API assemblies copy local is true] with the development team to have it fixed.\n\nI also noticed another important omission.\n\nThe FabricationPartLayout sample defines five different external commands:\n\n- ConvertToFabrication\n- FabricationPartLayout\n- OptimizeStraights\n- RenumberingPart\n- StretchAndFit\n\n<pre>\nC:\\...\\FabricationPartLayout\\CS &gt; grep class.*IExtern *.cs\nConvertToFabrication.cs:   public class ConvertToFabrication : IExtern...\nFabricationPartLayout.cs:   public class FabricationPartLayout : IExte...\nOptimizeStraights.cs:   public class OptimizeStraights : IExternalCommand\nRenumberingPart.cs:   public class RenumberingPart : IExternalCommand\nStretchAndFit.cs:   public class StretchAndFit : IExternalCommand\n</pre>\n\nAll five should be added to RvtSamples.txt. e.g. like this:\n\n<pre>\nMEP\nFabricationPartLayout: ConvertToFabrication\nFabrication Part sample layout\nLargeImage:\nImage:\nC:\\...\\FabricationPartLayout\\CS\\bin\\Debug\\FabricationPartLayout.dll\nRevit.SDK.Samples.FabricationPartLayout.CS.ConvertToFabrication\n\nMEP\nFabricationPartLayout: FabricationPartLayout\nFabrication Part sample layout\nLargeImage:\nImage:\nC:\\...\\FabricationPartLayout\\CS\\bin\\Debug\\FabricationPartLayout.dll\nRevit.SDK.Samples.FabricationPartLayout.CS.FabricationPartLayout\n\nMEP\nFabricationPartLayout: OptimizeStraights\nFabrication Part sample layout\nLargeImage:\nImage:\nC:\\...\\FabricationPartLayout\\CS\\bin\\Debug\\FabricationPartLayout.dll\nRevit.SDK.Samples.FabricationPartLayout.CS.OptimizeStraights\n\nMEP\nFabricationPartLayout: RenumberingPart\nFabrication Part sample layout\nLargeImage:\nImage:\nC:\\...\\FabricationPartLayout\\CS\\bin\\Debug\\FabricationPartLayout.dll\nRevit.SDK.Samples.FabricationPartLayout.CS.RenumberingPart\n\nMEP\nFabricationPartLayout: StretchAndFit\nFabrication Part sample layout\nLargeImage:\nImage:\nC:\\...\\FabricationPartLayout\\CS\\bin\\Debug\\FabricationPartLayout.dll\nRevit.SDK.Samples.FabricationPartLayout.CS.StretchAndFit\n</pre>\n\nI submitted another issue for this, REVIT-90157 [API SDK samples: RvtSamples lists wrong external command for FabricationPartLayout].\n\nNext, the CreateShared DLL is reported as missing:\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_08.png\" alt=\"CreateShared missing\" width=\"366\">\n</center>\n\nThat is another one of those pesky VB.NET samples, so I'll ignore it."
  },
  {
    "original_filename": "1427_rvtsamples",
    "header_text": "<a name=\"11\"></a>RvtSamples Loads and RvtSamples.txt is Cleaned Up",
    "local_header_href": "#a-name11arvtsamples-loads-and-rvtsamplestxt-is-cleaned-up",
    "chunk_text": "#### <a name=\"11\"></a>RvtSamples Loads and RvtSamples.txt is Cleaned Up\n\nThat was it!\n\nRvtSamples loads, and RvtSamples.txt has been cleaned up a bit:\n\n<center>\n<img src=\"img/revit_2017_rvt_samples_09.png\" alt=\"RvtSamples in Revit 2017\" width=\"626\">\n</center>\n\n<!--- /v/C/a/lib/revit/2017/SDK/Samples/RvtSamples/CS/RvtSamples.txt -->\n\nHere is my first final version of [RvtSamples.txt](zip/RvtSamples_2017.txt) for Revit 2017.\n\nIf anyone feels like telling us how to fix the VB.NET sample errors, please be my guest.\n\nOh, and I must not forget to turn off the `testClassName` flag again, or it will slow down loading tremendously and pop up all those warning messages each time I restart Revit:\n\n<pre class=\"code\">\n  <span style=\"color:blue;\">bool</span>&nbsp;testClassName&nbsp;=&nbsp;<span style=\"color:blue;\">false</span>;&nbsp;<span style=\"color:green;\">//&nbsp;jeremy</span>\n</pre>\n\nI hope this will save some effort on your part.\n\nGood luck and have fun with the Revit 2017 API!\n\nLots more to come on this subject!"
  }
]