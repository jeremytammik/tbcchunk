[
  {
    "original_filename": "2027_refresh",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- refresh spot elevation prefix\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1706517751186399\n  UIDocument.UpdateAllOpenViews Method\n  https://www.revitapidocs.com/2024/5cc3231e-ee7e-e1fc-2bd6-d164da617954.htm\n\n- Excel -- RVT data exchange options\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1706289884274909\n\n- Defining the start view using Revit API\n  https://forums.autodesk.com/t5/revit-api-forum/defining-the-start-view-using-revit-api/m-p/12506862#M76426\n\n- People are really bad at understanding just how big LLM's actually are.\n  I think this is partly why they belittle them as 'just' next-word predictors.\n  https://x.com/jam3scampbell/status/1748200331215835561?s=20\n  Searle's Chinese Room: Slow Motion Intelligence\n  http://lironshapira.blogspot.com/2011/02/searles-chinese-room-intelligence-in.html?m=1\n\n- Base rate fallacy (redirect from False positive paradox)\n  https://en.wikipedia.org/wiki/Base_rate_fallacy#False_positive_paradox\n  courtesy of Cory Doctorow in Little Brother\n\n- The period from February 2023 to January 2024 reached 1.52C of warming compared with pre-industrial levels, i.e., we have achieved\n  the [world's first year-long breach of the key 1.5C warming limit](https://www.bbc.com/news/science-environment-68110310)\n  [2023 confirmed as world's hottest year on record](https://www.bbc.com/news/science-environment-67861954)\n\ntwitter:\n\nExchanging data with Excel, setting the start view, random titbits related to AI, politics, climate, UpdateAllOpenViews and refreshing graphics with the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/refreshgraphics\n\nRefreshing graphics, exchanging data, setting the start view, and random titbits related to AI, politics and climate\n&ndash; UpdateAllOpenViews\n&ndash; Refreshing spot elevation prefix\n&ndash; Excel data exchange options\n&ndash; Defining the start view\n&ndash; How big is a LLM\n&ndash; Base rate fallacy\n&ndash; Last year was hot\n&ndash; Previous climate changes negligeable\n&ndash; PV panel price trend...\n\nlinkedin:\n\nExchanging data with Excel, setting the start view, random titbits related to AI, politics, climate, UpdateAllOpenViews and refreshing graphics with the #RevitAPI\n\nhttps://autode.sk/refreshgraphics\n\n- UpdateAllOpenViews\n- Refreshing spot elevation prefix\n- Excel data exchange options\n- Defining the start view\n- How big is a LLM\n- Base rate fallacy\n- Last year was hot\n- Previous climate changes negligeable\n- PV panel price trend...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Refresh Graphics, Start View and Excel",
    "local_header_href": "#refresh-graphics-start-view-and-excel",
    "chunk_text": "### Refresh Graphics, Start View and Excel\n\nRefreshing graphics, exchanging data, setting the start view, and random titbits related to AI, politics and climate:\n\n- [UpdateAllOpenViews](#1)\n- [Refreshing spot elevation prefix](#2)\n- [Excel data exchange options](#3)\n- [Defining the start view](#4)\n- [How big is a LLM](#5)\n- [Base rate fallacy](#6)\n- [Last year was hot](#7)\n- [Previous climate changes negligeable](#8)\n- [PV panel price trend](#9)"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "UpdateAllOpenViews",
    "local_header_href": "#1",
    "chunk_text": "####<a name=\"1\"></a> UpdateAllOpenViews\n\nIn an internal discussion on refreshing spot elevation graphics after modifying its prefix, Dimitar Venkov pointed out\nthe [`UIDocument` `UpdateAllOpenViews` method](https://www.revitapidocs.com/2024/5cc3231e-ee7e-e1fc-2bd6-d164da617954.htm).\nIt forces a redraw, which may be one step higher than a refresh.\nRefresh triggers a redraw only if a change is detected and may failing to detect some changes.\n`UpdateAllOpenViews` was introduced in Revit 2018 to force\na [view update for DirectContext3D](https://thebuildingcoder.typepad.com/blog/2017/04/whats-new-in-the-revit-2018-api.html#3.26.15).\nIt sounds really powerful:\n\n> Updates all open views in this document after elements have been changed, deleted, selected or de-selected. Graphics in the views are fully redrawn regardless of which elements have changed. This function should only rarely be needed, but might be required when working with graphics drawn from outside of Revit's transactions and elements, for example, when using DirectContext3D.\n\n> This function is potentially expensive as many views may be updated at once, including regeneration of view's geometry and redisplay of graphics. Thus for most situations it is recommended that API applications rely on the Revit application framework to update views more deliberately.\n\nWell worth taking a look at!"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Refreshing Spot Elevation Prefix",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Refreshing Spot Elevation Prefix\n\nUnfortunately, there is no silver bullet for all graphics refresh cases,\nand the [need to regenerate](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.33) comes\nin many different flavours.\nFor this issue, a different and simpler solution was required:\n\n**Question:** How can I make Revit refresh spot elevation prefix automatically?\nMy code adds a plus-minus <code>&#177;</code> sign to the spot elevation tag \"prefix\" in batches.\nHowever, nothing changes in the view unless you refresh each tag.\nI call both `RefreshActiveView` and `Regenerate` to no avail.\n\n**Answer:** Try calling [`UpdateAllOpenViews`](#1).\n\n**Response:** I tried `UpdateAllOpenViews` but failed.\nHowever, I found a way to update the tag by changing the view scale manually.\nIs there any method to do the similar thing through API?\n\n**Answer:** You can change the view scale with the `Scale` property, but I'm not sure that will help here.\nI don't know of any other API call that would force the view to redraw, sorry.\n\nMaybe you can retrieve\nthe [UIView](https://www.revitapidocs.com/2024/2a070256-00f0-5cab-1412-bee5bbfcfc5e.htm) of\nthe active view, close it and then re-open it with the `uidoc.ActiveView` property.\nIt's pretty extreme, but if nothing else works...\n\n**Response:** I found a solution: just select all the tags as the selected annotation elements;\nafter this operation, all the tags will update.\nHere is a code snippet:\n\n<pre><code class=\"language-cs\">ts.Start();\nforeach (SpotDimension item in spotdimensionList)\n{\n  Parameter para = item.get_Parameter(BuiltInParameter.SPOT_ELEV_DISPLAY_ELEVAT...\n  if (para.AsInteger() == 3)\n    MixResetter (item, spotdimensionTypeCollector);\n  else\n    DefaultResetter (item, spotdimensionIypeCollector);\n  doc.Regenerate();\n  uidoc.Selection.SetElementIds(new List&lt;ElementId&gt; ( item. id ));\n}\n//doc.ActiveView.Scale = 100;\nts.Commit();\n//uidoc.UpdateAl10penViews();\n</code></pre>\n\n<center>\n<img src=\"img/select_to_refresh.png\" alt=\"Select to refresh graphics\" title=\"Select to refresh graphics\" width=\"100\"/> <!-- Pixel Height: 358 Pixel Width: 602 -->\n</center>\n\nThe highlighted code is the final solution used to resolve the issue.\n\nMany thanks to Shen Wang for sharing this!"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Excel Data Exchange Options",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Excel Data Exchange Options\n\nMany add-ins exchange Revit data with Microsoft Excel spreadsheets.\nThe SDK has two samples which do import/export from Excel spreadsheets, FireRating and ArchSample.\nThey rely on a very old DLL which isn't playing nicely with .NET Core.\nIf the Revit to Excel workflow is high value, it might be worthwhile modernising.\nIf it is low value, export to CSV or some other easily supported document type may do the trick.\n\nThe [3rd most downloaded add-in in the AppStore](https://apps.autodesk.com/RVT/en/Detail/Index?id=6290726048826015851&appLang=en&os=Win64) is\nan Import/Export Excel tool\nusing [EPPlus](https://github.com/EPPlusSoftware/EPPlus),\nand that exchange with Excel is an important part of many other popular add-ins.\n\nHere is a modern way\nto [Open a spreadsheet document for read-only access](https://learn.microsoft.com/en-us/office/open-xml/spreadsheet/how-to-open-a-spreadsheet-document-for-read-only-access?tabs=cs-0%2Ccs-1%2Ccs-2%2Ccs).\n\nYou can also use a COM library that works so long as you have Excel installed on your computer.\n\nBy the way, for the sake of completeness, I implemented a multi-project cloud-based NoSql version of the FireRating SDK sample using the Revit Element `UniqueId` and MongoDB instead of element id and Excel in [FireRatingCloud](https://github.com/jeremytammik/FireRatingCloud)."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Defining the Start View",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Defining the Start View\n\nAdrian Crisan of [Studio A International, LLC](http://www.studio-a-int.com) shared a solution using\nthe [StartingViewSettings class](https://www.revitapidocs.com/2024/aaa6f49c-faeb-851e-45e9-d3d5799c1753.htm)\nfor [defining the start view using Revit API](https://forums.autodesk.com/t5/revit-api-forum/defining-the-start-view-using-revit-api/m-p/12506862):\n\n**Question:** Is it possible to define the start view using the API?\nSimilar to the UI functionality\nfor [specify the starting view for a model](https://help.autodesk.com/view/RVT/2024/ENU/?guid=GUID-622E667E-FB0B-47E1-8F66-E237A70771BD).\nAt the moment, I can only find a way to access the parameter and find out if a view is defined as the start view.\nThanks  :-)\n\n**Answer:** Use this method to set your starting view:\n\n<pre><code class=\"language-cs\">void SetStartingView ()\n{\n  // Code provided courtesy of:\n  // Studio A International, LLC\n  // http://www.studio-a-int.com\n  // The below code set the Starting View to a specific view that exists in Active Project\n\n  FilteredElementCollector feCollector = new FilteredElementCollector(activeDoc);\n  var myView = feCollector\n    .OfClass(typeof(Autodesk.Revit.DB.View)).Cast&lt;Autodesk.Revit.DB.View&gt;()\n    .Where&lt;Autodesk.Revit.DB.View&gt;(v\n      =&gt; ViewType.ThreeD == v.ViewType\n        && v.IsTemplate == false\n        && v.Name == \"my3DStartingView\")\n    .ToList()\n    .FirstOrDefault();\n\n  FilteredElementCollector svsCollector = new FilteredElementCollector(activeDoc);\n  Autodesk.Revit.DB.StartingViewSettings svs = svsCollector\n    .OfClass(typeof(StartingViewSettings))\n    .Cast&lt;Autodesk.Revit.DB.StartingViewSettings&gt;()\n    .ToList()\n    .FirstOrDefault();\n\n  if (myView is object)\n  {\n    ElementId myViewId = new ElementId(Convert.ToInt32((myView.Id.ToString())));\n    if (svs.IsAcceptableStartingView(myViewId))\n    {\n      using (Transaction t = new Transaction(activeDoc))\n      {\n        t.Start(\"Set Starting View\");\n        svs.ViewId = myViewId;\n        t.Commit();\n      }\n    }\n  }\n}\n</code></pre>\n\n**Response:** It works perfectly! Thanks a lot!"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "How Big is a LLM",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> How Big is a LLM\n\nPeople are really bad at understanding just how big LLM's actually are.\nI think this is partly why they belittle them as 'just' next-word predictors.\nCheck out the explanation\nby [@jam3scampbell](https://x.com/jam3scampbell/status/1748200331215835561?s=20),\nleading to\nthe [Searle Chinese Room Slow Motion Intelligence](http://lironshapira.blogspot.com/2011/02/searles-chinese-room-intelligence-in.html) thought\nexperiment."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Base Rate Fallacy",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Base Rate Fallacy\n\nReading [Little Brother](https://en.wikipedia.org/wiki/Little_Brother_(Doctorow_novel))\nby [Cory Doctorow](https://en.wikipedia.org/wiki/Cory_Doctorow) led me to check out\nthe [base rate fallacy or false positive paradox](https://en.wikipedia.org/wiki/Base_rate_fallacy#False_positive_paradox) that\nwe have been seeing more and more of &ndash; and suffering the consequences of &ndash; in real life in recent years."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Last Year Was Hot",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Last Year Was Hot\n\nTalking about suffering the consequences, the period from February 2023 to January 2024 reached 1.52C of warming compared with pre-industrial levels\nSo, we have already achieved\nthe [world's first year-long breach of the key 1.5C warming limit](https://www.bbc.com/news/science-environment-68110310).\nThe calendar year was one month earlier,\nand [2023 was confirmed as world's hottest year on record](https://www.bbc.com/news/science-environment-67861954)."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Previous Climate Changes Negligeable",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Previous Climate Changes Negligeable\n\nTo put that into perspective, [xkcd](https://xkcd.com) published\n[a timeline of earth's average temperature since the last ice age glaciation](https://xkcd.com/1732/) to\ndemonstrate\n\n> when people say, \"the climate has changed before\", these are the kinds of changes they're talking about.\n\n<center>\n<img src=\"img/xkcd_earth_temperature_timeline.png\" alt=\"Earth average temperature timeline\" title=\"Earth average temperature timeline\" width=\"600\"/> <!-- Pixel Height: 29,913 Pixel Width: 1,480 -->\n<p style=\"font-size: 80%; font-style:italic\">Global warming is a joke\n&ndash; Even the Antarctic ice sheets are cracking up</p>\n</center>"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "PV Panel Price Trend",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> PV Panel Price Trend\n\nAre you thinking about installing PV?\nI am.\nNow is a good time for buying PV panels, cf.\nthe [price trending down below 13 cents per Watt](https://www.pvxchange.com/Price-Index),\nthe lowest price ever.\nWill the trend continue?\nHow fast can it turn around?\n\n<center>\n<img src=\"img/2024_pv_panel_price_trend.png\" alt=\"PV panel price trend\" title=\"PV panel price trend\" width=\"600\"/> <!-- Pixel Height: 1,556 Pixel Width: 1,676 -->\n</center>"
  }
]