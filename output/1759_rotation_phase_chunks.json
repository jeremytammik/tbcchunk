[
  {
    "original_filename": "1759_rotation_phase",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- two enhancements on AddMaterials, and flat migration to Revit 2020\n  pull request #4 by @ridespirals: handle 0 or negative DashPatterns https://github.com/jeremytammik/AddMaterials/pull/4\n  suggestion by Александр Пекшев: Replace FillPattern = '{Binding CutPattern}' with FillPattern = '{Binding CutPattern, IsAsync=True}' and drawing thumbnails can get even faster\n  add_materials_segments_le_zero.png\n  add_materials_segments_le_zero_fixed.png\n\n- retrieving element rotation:\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1560327374009400\n  Shigekazu Saitou\n  Revit2018:Get rotation angle of element(15426610)\n  If you are rotating an element with the rotation tool, how do you write source code to get the rotation angle?\n  https://www.revitapidocs.com/2020/3968f4e8-759c-f975-6c1f-7de42be633ed.htm\n  RotateElement Method\n  Scott Conover  [12 minutes ago]\n  RotateElement has an angle parameter, but that angle is not necessarily stored in an element.  It depends on how the element's location is stored.   For many elements, Element.Location can be cast to LocationPoint and the rotation property read.  For Elements which inherit from Instance, they inherit a GetTransform() which can be parsed to read the rotation.  For elements that don't align with one or both of those, the rotation is more implicit with other element properties, e.g. a wall which is driven by endpoints and a curve, after rotating, is still driven by endpoints and a curve, just in different locations.\n\n- 15395147 [Changing an Element's Phase Created Parameter]\n  https://forums.autodesk.com/t5/revit-api-forum/changing-an-element-s-phase-created-parameter/m-p/8808894\n  [Setting an elements phase]\n  https://forums.autodesk.com/t5/revit-api-forum/setting-an-elements-phase/m-p/6224664\n  [Q] How can I set the Phase Created or the Phase Demolished of a element?\n  I can retrieve the Phase Created of an element with:\n  phaseCreated = element.Document.GetElement(element.CreatedPhaseId) as Phase;\n  However, I can't figure out how to change it to set the phase.\n  [A] element.get_Parameter(BuiltInParameter.PHASE_CREATED).Set(phaseCrea​ted.Id);\n  and\n  element.get_Parameter(BuiltInParameter.PHASE_DEMOLISHED).Set(phaseC​reated.Id);\n\ntwitter:\n\nBarcelona accelerator, AddMaterials dash pattern fix, element rotation and phase in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/barca2019\n\nI am participating in the Forge Accelerator in Barcelona this week.\nLet me mention some pending Revit API issues before diving into any accelerator topics\n&ndash; AddMaterials enhancements\n&ndash; Retrieving element rotation\n&ndash; Changing the phase created parameter...\n\nlinkedin:\n\nBarcelona accelerator, AddMaterials dash pattern fix, element rotation and phase in the #RevitAPI\n\nhttp://bit.ly/barca2019\n\nI am participating in the Forge Accelerator in Barcelona this week.\n\nLet me mention some pending Revit API issues before diving into any accelerator topics:\n\n- AddMaterials enhancements\n- Retrieving element rotation\n- Changing the phase created parameter...\n\n#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n-->"
  },
  {
    "original_filename": "1759_rotation_phase",
    "header_text": "Accelerator, Dash Pattern Fix, Rotation and Phase",
    "local_header_href": "#accelerator-dash-pattern-fix-rotation-and-phase",
    "chunk_text": "### Accelerator, Dash Pattern Fix, Rotation and Phase\n\nI am participating in the Forge Accelerator in Barcelona this week.\n\nWe are hosting a large number of participants, split up into separate manufacturing and AEC related groups:\n\n<center>\n<img src=\"img/2019-06_forge_accelerator_barcelona.jpg\" alt=\"Forge Accelerator in Barcelona\" width=\"500\">\n</center>\n\nI arrived good and early, spending the weekend visiting my sister, who moved here last summer:\n\n<center>\n<img src=\"img/20190623_123615_jt_jeremy_barca_2_612x612.jpg\" alt=\"Barcelona view\" width=\"500\">\n</center>\n\nMy brother came too, and we went climbing, right in the middle of town,\nin [Las Foixardas](http://www.rockclimbing.com/routes/Europe/Spain/Catalunya/Las_Foixardas) in\nthe [Parc Montju%C3%AFc](https://en.wikipedia.org/wiki/Montju%C3%AFc):\n\n<center>\n<img src=\"img/20190622_143629_lissy_climbing_el_tunel_8429_1008x1344.jpg\" alt=\"El tunel de las Foixardas\" width=\"500\">\n</center>\n\nLet me mention some pending Revit API issues before diving into any accelerator topics:\n\n- [AddMaterials enhancements](#3)\n- [Retrieving element rotation](#4)\n- [Changing the phase created parameter](#5)"
  },
  {
    "original_filename": "1759_rotation_phase",
    "header_text": "AddMaterials Enhancements",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> AddMaterials Enhancements\n\nThe [AddMaterials add-in](https://github.com/jeremytammik/AddMaterials) originally\njust added materials to the Revit model from a list of properties defined in Excel.\n\nIt has since been enhanced to also visualise them in WPF.\n\nI recently added a couple of enhancements to the it that have not been mentioned here yet:\n\n- Integrated [pull request #4 by @ridespirals to handle 0 or negative DashPatterns](https://github.com/jeremytammik/AddMaterials/pull/4)\n- Flat migration from Revit 2016 to Revit 2020 API\n- Acted on\nthe [suggestion by Александр Пекшев](https://thebuildingcoder.typepad.com/blog/2014/04/wpf-fill-pattern-viewer-control-benchmark.html#comment-4497075532) to\nreplace `FillPattern` = `'{Binding CutPattern}'` with `FillPattern` = `'{Binding CutPattern, IsAsync=True}'` to speed up the drawing of thumbnails\n\nIn the pull request, John [@ridespirals](https://github.com/ridespirals) Varga points out an important hint to handle errors caused by real number imprecision in dash or hash pattern definitions:\n\n> We are using similar code in a project of ours, and we ran into an issue where some fill patterns had blank preview images.\nSome of the patterns had very small negative values (such as -5.9211894646675012E-16), and DashPatterns must be greater than 0.\nUsing `float.Epsilon` produces previews that actually look correct.\n\nExample preview we got by filtering out segments that were <= 0 (Third Bond - Emporer Brick - partial fix):\n\n<center>\n<img src=\"img/add_materials_segments_le_zero.png\" alt=\"Segments almost zero\" width=\"256\">\n</center>\n\nExample using the fix in this pull request, using `float.Epsilon` (Third Bond - Emporer Brick - fixed):\n\n<center>\n<img src=\"img/add_materials_segments_le_zero_fixed.png\" alt=\"Segments fixed using float.Epsilon\" width=\"256\">\n</center>"
  },
  {
    "original_filename": "1759_rotation_phase",
    "header_text": "Retrieving Element Rotation",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Retrieving Element Rotation\n\n**Question:** How can I retrieve the rotation angle of an element that has been rotated, e.g., using the rotation tool or\nthe [`RotateElement` method](https://www.revitapidocs.com/2020/3968f4e8-759c-f975-6c1f-7de42be633ed.htm)?\n\n**Answer:** `RotateElement` takes an angle parameter, but that angle is not necessarily stored in an element.\n\nIt depends on how the element's location is stored.\n\nFor many elements, `Element.Location` can be cast to a `LocationPoint`, and its `Rotation` property read.\n\nElements that inherit from `Instance` inherit a `GetTransform` method whose result can be parsed to read the rotation.\n\nFor elements that don't align with either of these options, the rotation is more implicit with other element properties.\n\nFor instance, a wall that is driven by endpoints and a curve, after rotating, is still driven by endpoints and a curve, just in different locations."
  },
  {
    "original_filename": "1759_rotation_phase",
    "header_text": "Changing the Phase Created Parameter",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Changing the Phase Created Parameter\n\nFrom the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [changing an element's phase created parameter](https://forums.autodesk.com/t5/revit-api-forum/changing-an-element-s-phase-created-parameter/m-p/8808894)\nand [setting an element's phase](https://forums.autodesk.com/t5/revit-api-forum/setting-an-elements-phase/m-p/6224664):\n\n**Question:** How can I set the 'Phase Created' or the 'Phase Demolished' of an element?\n\nI know I can retrieve the 'Phase Created' like this:\n\n<pre class=\"code\">\n&nbsp;&nbsp;phaseCreated&nbsp;=&nbsp;element.Document.GetElement(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;element.CreatedPhaseId&nbsp;)&nbsp;<span style=\"color:blue;\">as</span>&nbsp;<span style=\"color:#2b91af;\">Phase</span>;\n</pre>\n\nHowever, I can't figure out how to change it to set the phase.\n\n**Answer:** You can use two built-in parameters:\n\n<pre class=\"code\">\n&nbsp;&nbsp;element.get_Parameter(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.PHASE_CREATED&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Set(&nbsp;phaseCrea​ted.Id&nbsp;);\n\n&nbsp;&nbsp;element.get_Parameter(&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af;\">BuiltInParameter</span>.PHASE_DEMOLISHED&nbsp;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Set(&nbsp;phaseC​reated.Id&nbsp;);\n</pre>"
  }
]