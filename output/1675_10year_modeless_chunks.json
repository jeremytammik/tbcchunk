[
  {
    "original_filename": "1675_10year_modeless",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- tbc birthday ten years\n\n- Out of clutter, find Simplicity.\n  From discord, find Harmony.\n  In the middle of difficulty lies Opportunity.\n  ALBERT EINSTEIN\n  Three Rules of Work\n\n- Revit API with WPF (New message on the Autodesk forums or ideas)\n  https://forums.autodesk.com/t5/revit-api-forum/revit-api-with-wpf/m-p/8209618\nhttps://stackoverflow.com/questions/51918495/revit-pick-element-from-winform\nYour Windows form is presumably not running as a modal form within a valid Revit API context.\n\nConsequently, you are trying to access Revit and its API from outside. This is basically not possible. A workaround exists via the use of an [external event](http://www.revitapidocs.com/2018/05089477-4612-35b2-81a2-89c4f44370ea.htm).\n\nThis issue is currently also being discussed in the [Revit API discussion forum](https://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread on [Revit API with WPF](https://forums.autodesk.com/t5/revit-api-forum/revit-api-with-wpf/m-p/8209618).\n\nThe official approach is presented in the Revit SDK sample ModelessDialog/ModelessForm_ExternalEvent.\n\nMany other discussions and soutions are listed by The Building Coder in the topic group on [Idling and External Events for Modeless Access and Driving Revit from Outside](http://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28).\n\nhttps://forums.autodesk.com/t5/revit-api-forum/using-mvvm-amp-wpf-with-transaction-amp-doc-regenerate/m-p/8207716\nusing mvvm & wpf with transaction & doc.regenerate()\n[Q]\ni'm working on simple command\nit have wpf form bonded to class as per mvvm methods\ni call the wpf from my command and it show up using wpf,show();\ni use the form and change data then click the buttom to run command on viewmodel from my form as usual in mvvm to pick the objects and change its data\ni can close my form\nwhen selecting the object after that i can see that parameter data has changed as i want but document can't fell that changes and i can't generate the document\nmy problem is i cant use transaction.start on my mvvm command and ca't regenerate the document to see the changes in the tags\nhow can i solve that?\n[A]\nIt sounds as if your WPF form is not running as a modal form within a valid Revit API context.\nConsequently, you are trying to access Revit and its API from outside. This is basically not possible. A workaround exists via the use of an external event:\nhttp://www.revitapidocs.com/2018/05089477-4612-35b2-81a2-89c4f44370ea.htm\nThis issue was recently discussed in another thread on Revit API with WPF:\nhttps://forums.autodesk.com/t5/revit-api-forum/revit-api-with-wpf/m-p/8209618\nThe official approach is presented in the Revit SDK sample ModelessDialog/ModelessForm_ExternalEvent.\nMany other discussions and solutions are listed by The Building Coder in the topic group on Idling and External Events for Modeless Access and Driving Revit from Outside:\nhttp://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28\n\nTen Years Anniversary and Revit add-ins using MVVM, WPF and WinForm in the #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon http://bit.ly/tbc10years\n\nToday is The Building Coder's tenth birthday!\nThe first post was a warm welcome on August 22, 2008.\nVery many thanks to the entire community for all your support, interest, comments and above all numerous contributions over the years!\nToday, let's pick up the recurring topic of accessing the Revit API from a modeless context...\n\n--->"
  },
  {
    "original_filename": "1675_10year_modeless",
    "header_text": "Ten Years of TBC and Revit API with MVVM, WPF and WinForm",
    "local_header_href": "#ten-years-of-tbc-and-revit-api-with-mvvm-wpf-and-winform",
    "chunk_text": "### Ten Years of TBC and Revit API with MVVM, WPF and WinForm\n\nToday is The Building Coder's tenth birthday!\n\nThe first post was\na [warm welcome on August 22, 2008](http://thebuildingcoder.typepad.com/blog/2008/08/welcome.html).\n\nVery many thanks to the entire community for all your support, interest, comments and above all numerous contributions over the years!\n\nA suitable quote for the day:\n\n<center>\n<i>Out of clutter, find Simplicity.\n<br/>From discord, find Harmony.\n<br/>In the middle of difficulty lies Opportunity.\n<br/><br/>Albert Einstein &ndash; Three Rules of Work</i>\n<br/><br/><img src=\"img/809_bee_in_lotus_580x500.jpg\" alt=\"Bumble bee in lotus flower\" width=\"290\"/>\n</center>\n\nToday, let's pick up the recurring topic of accessing the Revit API from a modeless context.\n\nIt was discussed fruitfully in some depth in \nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [Revit API with WPF](https://forums.autodesk.com/t5/revit-api-forum/revit-api-with-wpf/m-p/8209618).\n\nI'll skip most of the answer, because it is convoluted.\n\nThe most important aspect, though, is short and sweet:\n\n[The Revit API cannot be used in a modeless context](http://thebuildingcoder.typepad.com/blog/2015/12/external-event-and-10-year-forum-anniversary.html#2).\n\nIt can only be used in a valid Revit API context.\n\nA valid Revit API context is provided within the handlers executed by Revit call-backs, and nowhere else.\n\nFor instance,\nan [external command](http://www.revitapidocs.com/2018/ad99887e-db50-bf8f-e4e6-2fb86082b5fb.htm) defines\nan `Execute` methods and registers itself with Revit.\n\nRevit calls that method and supplies a valid Revit API context to it via its `ExternalCommandData` input argument.\n\nA Windows form can be displayed either using `Show` or `ShowDialog`.\n\nIf you use `Show`, it becomes a modeless dialogue and all interaction which it is outside of any valid Revit API context.\n\nIf you use `ShowDialog`, it becomes modal and remains in the same thread that launched it, possibly inheriting a valid Revit API context.\n\nIf you happen to be in a modeless context, you can implement a solution to access a valid Revit API context by implementing\nan [external event](http://www.revitapidocs.com/2018/05089477-4612-35b2-81a2-89c4f44370ea.htm) and calling that.\n\nSimilarly to the external command, it also defines an `Execute` methods and registers itself with Revit.\n\nRevit calls that method and supplies a valid Revit API context to it when it is prompted by an external trigger.\n\nThe official approach for implementing an external event is demonstrated by a Revit SDK sample:\n\n- ModelessDialog/ModelessForm_ExternalEvent\n\nIt may require some redesign of your application logic to use.\n\nRyan Singleton added some good real-world advice to this:\n\nTo add my experience to what Jeremy said (you need External Events to make your transactions work modelessly), I have built a dockable dialog with WPF that used a lot of external events. Autodesk recommends that you try to use modal dialogs as much as you can instead of modeless. It will make your project much easier.\n\nHowever, I can tell you that a fully functional suite of tools with external events is possible. But you need to be sure that the added complexity is worth it.\n\nIf you are going to have multiple external events, I strongly recommend that you look at the Revit SDK sample for External Events specifically. It shows how to use enums and a handler to swap out external events so that you do not have a sloppy mess of external events in your application.\n\nYou can also have a modeless dialog that, when you press a button to start a transaction, will open a modal window (progress bar or some other window), and that window will start the transaction instead. Once done, it closes, and the user feels like they are using a modeless context. A system like that would be much easier to maintain.\n\nI hope this helps.\n\nHere are some other recent threads raising the same question:\n\n- [Revit Pick element from WinForm](https://stackoverflow.com/questions/51918495/revit-pick-element-from-winform)\n- [Using MVVM and WPF with transaction and `doc.regenerate`](https://forums.autodesk.com/t5/revit-api-forum/using-mvvm-amp-wpf-with-transaction-amp-doc-regenerate/m-p/8207716)\n\nMany other discussions and solutions are listed by The Building Coder in the topic group\non [Idling and external events for modeless access and driving Revit from outside](http://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28)."
  }
]