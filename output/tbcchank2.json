[
  {
    "original_filename": "2000_materials",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- GetMaterialArea\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1685384981134679\n  https://forums.autodesk.com/t5/revit-api-forum/method-getmaterialarea-appears-to-use-different-formulas-for/td-p/11988215\n\n- Materials, Material Assets (Appearance, Structural, Thermal) and the Visual API\n  https://forums.autodesk.com/t5/revit-api-forum/materials-material-assets-appearance-structural-thermal-and-the/td-p/12088469\n\n- filter for annotation families\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1688664085416909\n\n- Revit Batch Processor (RBP)\n  https://github.com/bvn-architecture/RevitBatchProcessor\n  came up in\n  Is there a way to change the workset configuration of a revit file without opening revit?\n  https://stackoverflow.com/questions/76630229/is-there-a-way-to-change-the-workset-configuration-of-a-revit-file-without-openi\n\ntwitter:\n\nTwo very different aspects of BIM materials, GetMaterialArea behaviour, material assets and the Visual API, a powerful batch processor utility and filtering for annotations with the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/materials\n\nTwo very different aspects of BIM materials, filtering for annotations and a powerful batch processor utility:\n&ndash; GetMaterialArea behaviour varies\n&ndash; Material assets and the Visual API\n&ndash; Filter for annotation families\n&ndash; Revit batch processor RBP...\n\nlinkedin:\n\nTwo very different aspects of BIM materials, GetMaterialArea behaviour, material assets and the Visual API, a powerful batch processor utility and filtering for annotations with the #RevitAPI\n\nhttps://autode.sk/materials\n\n- GetMaterialArea behaviour varies\n- Material assets and the Visual API\n- Filter for annotation families\n- Revit batch processor RBP...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2000_materials",
    "header_text": "RBP, Materials, Assets and the Visual API",
    "local_header_href": "#rbp-materials-assets-and-the-visual-api",
    "chunk_text": "### RBP, Materials, Assets and the Visual API\n\nTwo very different aspects of BIM materials, filtering for annotations and a powerful batch processor utility:\n\n- [GetMaterialArea behaviour varies](#2)\n- [Material assets and the Visual API](#3)\n- [Filter for annotation families](#4)\n- [Revit batch processor RBP](#5)\n- [The Building Coder Blog Post &#35;2000](#6)"
  },
  {
    "original_filename": "2000_materials",
    "header_text": "GetMaterialArea Behaviour Varies",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> GetMaterialArea Behaviour Varies\n\nGetMaterialArea returns different results for different kinds of elements, as explained in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non the [method `GetMaterialArea` appears to use different formulas for computing the area depending on the element category](https://forums.autodesk.com/t5/revit-api-forum/method-getmaterialarea-appears-to-use-different-formulas-for/td-p/11988215):\n\n**Question:** How does the method GetMaterialArea compute the area depending on the element category? It appears to use different formulas for different categories. For a wall, it is the area of one of the side faces for a layer (which probably makes sense); for a window, however, the method returns the sum over all 6 faces (assuming a simple cuboid). Please provide documentation on how the method functions on different elements\nor a unified way of computing the area.\n\nI also noticed that GetMaterialIds returns null for elements of (at least) these categories:\n\n- Pipe, Flex Pipe, Duct, Flex Duct, Duct Insulation, Ramp\n\nGetMaterialArea(matId) and GetMaterialVolume(matId) returns 0 for these categories.\n\n**Answer 1:** You should check Category.HasMaterialQuantities for that, some categories don't support material quantities.\n\nHowever, it is noted that such material quantities are calculated either from compound structure layers or geometry.\nSince the `Window` isn't a compound structure, area will be taken from faces of geometry I suspect; `Wall`, on the other hand, has compound structure.\nThe geometry of the wall would at the same time be lacking the layers detail.\n\n**Answer 2:** I think the customer is referring mostly to the difference between system families and loaded families in Revit itself.\nThe API is probably returning the same values.\n\n- Hosts will return 1 face, because in construction, you would refer to the area of a wall material (for example) as the area to be covered when looking at the wall.\n- Stairs, railing, ramps, site, and curtain wall also have special behaviour.\n- Loaded families (like windows) will report an area including all faces.\n\nThis is confirmed and workarounds are posted in the Revit Clinic article\non [Material Takeoff Area Schedule](https://revitclinic.typepad.com/my_weblog/2009/10/material-takeoff-area.html).\nSome other special cases are listed in the Autodesk Support article\non [Material Takeoff shows incorrect values of areas and/or volumes in Revit](https://www.autodesk.com/support/technical/article/caas/sfdcarticles/sfdcarticles/Material-Takeoff-shows-incorrect-areas-in-Revit.html).\n\nAs far as the API goes, check out these 2 resources from The Building Coder and Scott Conover that may help confirm the API designed behaviour:\n\n- [Material Quantity Extraction](https://thebuildingcoder.typepad.com/blog/2010/02/material-quantity-extraction.html)\n- [Analyse Geometry of Buildings Using the Revit API](https://thebuildingcoder.typepad.com/au/2009/AU09_CP222-3_Analyze_Geometry_Revit_API.pdf) at AU 2009 by Scott Conover, Autodesk\n\nThis is from Scott's presentation:\n\nMaterial quantity extraction One common analytical requirement is to extract material quantities of elements in the document.  Revit 2010 introduced methods to directly obtain the material volumes and areas computed by Revit for material takeoff schedules:\n\n- Element.Materials &ndash; obtains a list of materials within an element\n- Element.GetMaterialVolume() &ndash; obtains the volume of a particular material in an element\n- Element.GetMaterialArea() &ndash; obtains the area of a particular material in an element\n\nThe methods apply to categories of elements where Category.HasMaterialQuantities property is true.\nIn practice, this is limited to elements that use compound structure, like walls, roofs, floors, ceilings, a few other basic 3D elements like stairs, plus 3D families where materials can be assigned to geometry of the family, like windows, doors, columns, MEP equipment and fixtures, and generic model families.\nNote that within these categories there are further restrictions about how material quantities can be extracted.\nFor example, curtain walls and curtain roofs will not report any material quantities themselves; the materials used by these constructs can be extracted from the individual panel elements that make up the curtain system.\nNote that the volumes and areas computed by Revit may be approximate in some cases.\nFor example, for individual layers within a wall, minor discrepancies might appear between the volumes visible in the model and those shown in the material takeoff schedule.\nThese discrepancies tend to occur when you use the wall sweep tool to add a sweep or a reveal to a wall, or under certain join conditions."
  },
  {
    "original_filename": "2000_materials",
    "header_text": "Material Assets and the Visual API",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Material Assets and the Visual API\n\nA completely different aspect of materials is addressed by\nGary J. Orr of [MBI Companies Inc.](https://www.mbicompanies.com/),\nwho shares a nice VB.NET sample in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\ndemonstrating the interaction\nwith [Materials, Material Assets (Appearance, Structural, Thermal) and the Visual API](https://forums.autodesk.com/t5/revit-api-forum/materials-material-assets-appearance-structural-thermal-and-the/m-p/12089438).\nIn his own words:\n\nThis has been a journey. The past few weeks have seen me spending all the time that I can spare reading the API help, reading posts going back years, reading blogs (which get really hard to pull targeted information out of sometimes).\n\nThen came trying to put it all together, Snippets of code from the API, some of which can cause just as much confusion as the help that they provide, translating snippets of code that I can barely understand because I don't speak that particular coding language, which is made even worse by the fact that it is usually written by programming professionals that use code shortcuts (which makes reading their examples even harder) and often refer to advanced coding techniques that I simply haven't ever learned since none of this is my real occupation...\n\nBut hey, I did it.\n\nI can now take materials and their related Assets apart and I can create/recreate them.\n\nYou are welcome to the [attached VB file `MaterialTools.vb`](zip/go_materials_visual_api.zip) if you are struggling with these same issues (dump it into a VS project with the appropriate references or copy the subs/functions into a VB macro with the appropriate mods for launching the included tools).\n\nIt has functions for collecting and logging the Properties of the Application resident Appearance Assets; the Assets within a Document; the materials within a document and their associated Properties and connected assets; and one for creating a new material with all new assets. Those functions will generate TXT and XML log files that can be used to further examine all of the above.\n\nI have attempted to document (with in line comments) the steps required and/or taken, along with why one method may have been chosen over another when such applied, as well as some cautions and some still outstanding questions and/or shortcomings that had to be worked around.\n\nIf you're well versed in Materials, and have both the time and desire, perhaps you can take a look and see if you have any answers for the commented questions that I still have and have left in the code.\n\nThere are still plenty of issues, some may just be because I haven't learned all I need to learn yet, but the bigger ones seem to be common from what I have found:\nOne biggie (in my opinion) is the lack of any direct correlation between the return values when you read Appearance Asset Properties to the Visual API Classes and their properties that should be used to work with them. This is a big complication and makes it really hard to avoid using strings and thereby keep your code language neutral. The descriptions in the API help do not help with that mapping the least little bit.\nAnother would be the absence of any clear and concise method to differentiate between Physical Property Sets... Structural vs Thermal.\n\nOf course, this may all just be an exercise in vanity from a wanna-be but perhaps some may find some of it helpful.\n\nLater: Oops,\nThe Asset Property type \"List\" was supposed to recurse to get the values of the list items, but I had forgotten to get back and actually make it do so.\n\nThat is fixed now.\nAlong the way I decided to actually do something with that massive volume of returns from GetRevitAppearanceAssets, i.e.: application.GetAssets(AssetType.Appearance).\nSo, I created an option to import one of each schema type into the current document.\n\nI still don't know the actual source of these assets since they don't match any of the Revit libraries (and I still don't understand why we can't access any material libraries via the API), but I did find something else that is unusual: the only PrismWoodSchema that is contained in that library,\n\n<center>\n<img src=\"img/go_visual_api_1.png\" alt=\"Materials and Visual API\" title=\"Materials and Visual API\" width=\"500\"/> <!-- Pixel Height: 143 Pixel Width: 610 -->\n</center>\n\nshows as being an \"Old Style\" rendering Asset once it has been imported into the document:\n\n<center>\n<img src=\"img/go_visual_api_2.png\" alt=\"Materials and Visual API\" title=\"Materials and Visual API\" width=\"500\"/> <!-- Pixel Height: 382 Pixel Width: 894 -->\n</center>\n\nYet, Assets using the PrismOpaqueSchema show as \"New Style\" Asset types (as would be expected for the above):\n\n<center>\n<img src=\"img/go_visual_api_3.png\" alt=\"Materials and Visual API\" title=\"Materials and Visual API\" width=\"500\"/> <!-- Pixel Height: 578 Pixel Width: 1,298 -->\n<br/>\n<img src=\"img/go_visual_api_4.png\" alt=\"Materials and Visual API\" title=\"Materials and Visual API\" width=\"500\"/> <!-- Pixel Height: 591 Pixel Width: 1,191 -->\n</center>\n\nJust another glitch?\n\nHere are the main problems I struggled with:\n\nOne biggie (in my opinion) is the lack of any direct correlation between the return values when you read Appearance Asset Properties to the Visual API Classes and their properties that should be used to work with them. This is a big complication and makes it really hard to avoid using strings and thereby keep your code language neutral. The descriptions in the API help do not help with that mapping the least little bit.\n\nAnother big one would be the absence of any clear and concise method to differentiate between Physical Property Sets... Structural vs Thermal.\n\nWe need a firm method of being able to differentiate Structural and Thermal Property Sets.\nPSE elements will often return both a thermal and a structural Property Set, and EVERY PSE element will return a structural (RevitLookup Snoop shows that pretty well)... yet they can only be used for the correct Property type, so something somewhere knows which one is which; we need that information in the API as well.\n\nThen, we have: where does application.GetAssets draw from?\nThere is nothing that matches what is found in that return list of assets anywhere that I can find in the system.\nThe PrismWoodSchema returned from that list shows as an \"Old style\" rendering Asset once pulled into a document, even though it is clearly a procedural Asset.\n\nWe need access to the AEC material Library as well as any user created libraries (as can be browsed to in the Material Browser.\n\nWe need access to the Asset libraries (as can be browsed to in the Assets dialog).\n\nThere are a few other requirements in my comments within the code, but most end up boiling down to one of these.\n\nWill that help get the development team started?\n\nBTW: this was written to the 2023 API, I haven't tested it for compatibility beyond that.\n\nMany thanks to Gary for sharing the results of his research!"
  },
  {
    "original_filename": "2000_materials",
    "header_text": "Filter for Annotation Families",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Filter for Annotation Families\n\nA quick note on filtering for annotation families:\n\n**Question:** Is there an identifier which I can use to sort out annotation families vs other types of families using the Revit API?\nI'd like to iterate over the `IEnumerable` to then group items as I need them.\nThe code I'm currently using and would like to modify:\n\n<pre class=\"prettyprint\">\n  var families = new FilteredElementCollector(doc)\n    .OfClass(typeof(ElementType))\n    .Cast&lt;ElementType&gt;();\n</pre>\n\n**Answer:** See if this works for you:\nhttps://forum.dynamobim.com/t/how-can-i-collect-all-family-types-that-are-considered-annotation-symbols-in-revit/37480/10\n\nIt shows you that you need [`FamilySymbol`](https://www.revitapidocs.com/2024/a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.htm) instead of `ElementType`.\n\nThen, filter for:\n\n<pre class=\"prettyprint\">\n  fs.Family.FamilyCategory.CategoryType\n    == CategoryType.Annotation\n</pre>\n\n**Response:** For some added context,\nI am hoping to first get all system families, then iterate over the collection of all system families and separate out the annotation families from that list.\nUltimately, I will end up with two CSV's, one with Annotation Families only, and the other CSV file with all system families minus annotation families which is why I think I was using `ElementType` instead of `FamilySymbol`.\n\n**Answer:** `FamilySymbol` should be fine in your case &ndash; it is derived from `ElementType`.\nElementTypes are more general.\nFor example, a `Wall` element can have a `WallType` which is also derived from `ElementType`.\n\n**Response:** I gave it a try, but now system families I was hoping to extract (prior to filtering out annotation families), like a basic wall, do not come through in my filter.\n\n**Answer:** Sorry my bad. You are right.\nFor element types that are not family symbols you will not be able to do\n\n<pre class=\"prettyprint\">\n  elem.Family.FamilyCategory.CategoryType\n</pre>\n\nYou may check its own category I guess.\n\n**Response:** That got me on the right track.\nI ended up having to filter out items which have null category information:\n\n<pre class=\"prettyprint\">\n  Category.CategoryType != CategoryType.Annotation\n</pre>\n\nThank you very much for your help!"
  },
  {
    "original_filename": "2000_materials",
    "header_text": "Revit Batch Processor RBP",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Revit Batch Processor RBP\n\nLet's wrap up with a pointer to\nthe [Revit Batch Processor RBP](https://github.com/bvn-architecture/RevitBatchProcessor).\nIt looks like a very powerful and full-fledged utility; it came up in the StackOverflow question\nasking [is there a way to change the workset configuration of a Revit file without opening Revit?](https://stackoverflow.com/questions/76630229/is-there-a-way-to-change-the-workset-configuration-of-a-revit-file-without-openi)"
  },
  {
    "original_filename": "2000_materials",
    "header_text": "The Building Coder Blog Post &#35;2000",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> The Building Coder Blog Post &#35;2000\n\nActually, before closing, we have something to celebrate, a special issue, so to speak.\n\nThis blog post is The Building Coder's 2000th.\n\nYou can check out the entire chronological list in\nthe [GitHub tbc repository](https://github.com/jeremytammik/tbc).\n\nAll in all, The Building Coder has published over four hundred thousand lines of text, two-and-a-half million words and over 22 million characters since its inception in 2008.\n\nIt is also interesting to see what topics we started out covering back then; several are equally relevant and still recurring today:\n\n<pre>\n% wc *htm *md\n      12     301    1909 0001_welcome.htm\n       9     213    1366 0002_devtech.htm\n      69     553    4297 0003_getting_started.htm\n      68     756    5505 0004_revit_sdk_contents.htm\n      19     497    3322 0005_managing_sdk_samples.htm\n     122     916    6098 0006_sdk_samples_solution.htm\n     120     865    5890 0007_loading_sdk_samples.htm\n     125    1409    9349 0008_debugging.htm\n       8     376    2121 0009_what_next.htm\n     102    1062    8226 0010_selecting_all_walls.htm\n     447    3131   32490 0011_units.htm\n      66    1316    8954 0012_geometry_library.htm\n      44     524    3712 0013_geometry_viewers.htm\n...\n     491    2762   20716 1997_sdk_brep.md\n     267    1609   12882 1998_unittest_arcdim.md\n     323    2249   18196 1999_mep_calculation.md\n     259    2335   16834 2000_visual_api.md\n  417722 2480900 22669323 total\n</pre>\n\nLong live The Building Coder!\n\n####<a name=\"6.1\"></a>\n\n[LinkedIn feedback from Mikhail Smirnov](https://www.linkedin.com/feed/update/urn:li:activity:7085118894100623361?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7085118894100623361%2C7085135341363347457%29):\n\n> Thanks a lot for the article, Jeremy! As always, you are at the peak of the research wave.\n\nThank you for your appreciation!\nHowever, just to clarify: there is actually no research of mine in here at all.\nI am just as reporter, a librarian... there seems to be a greater lack of those than of researchers, programmers, and especially documenters...\nResearching and programming is much more fun!\nStill, someone has to do what I do, it seems..."
  }
][
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- roman [jeremytammik/RevitLookup] Revit api. Retrieve all parameters and categories (Discussion #183)\n\n- How to get the BoundingBox that corresponds to the shape of the Family\n  https://forums.autodesk.com/t5/revit-api-forum/how-to-get-the-boundingbox-that-corresponds-to-the-shape-of-the/m-p/12089970\n\n- Transform of linked element creates an empty outline\n  https://forums.autodesk.com/t5/revit-api-forum/transform-of-linked-element-creates-an-empty-outline/m-p/12089717#M72649\n\n- nice svg path explanation --  https://www.nan.fyi/svg-paths\n\n- claude.ai\n  https://claude.ai/chats\n  You have to use a USA or UK VPN.\n  A competitor to OpenAI. Can upload big files. Any better for coding?\n  Video about it: https://www.youtube.com/watch?v=dofH3EBjK1o\n  Falls euch der aktuelle zustand der KI-Entwicklung interessieren sollte… ich habe nach der vertragsunterzeichnung andere arbeiten ausgefuehrt, und bin im laufe dessen auch auf eine neuen konkurrenten von ChatGPT gestossen, namens Claude.AI:\n  https://claude.ai\n  ChatGPT: bisher ueber 13 millarden $, Microsoft hauptsponsor\n  Claude.AI: bisher 1.5 millarden $, Google hauptsponsor.\n  [claude versus chatgpt](https://duckduckgo.com/?q=claude+versus+chatgpt)\n  Ich habe claude.ai gebeten, den kuri architektenvertrag auszuwerten, und dann nach sinn und unsinn von hoai gefragt.\n  Unten sind die antworten angehaengt.\n  /Users/jta/a/doc/revit/tbc/git/a/img/claudeai*\n  summarise my last blog post\n  You could batch that last one to summarize all of your blog posts programmatically for SEO.\n\n- Why transformative AI is really, really hard to achieve\n  https://zhengdongwang.com/2023/06/27/why-transformative-ai-is-really-really-hard-to-achieve.html\n\ntwitter 2:\n\nAspects of axis-aligned bounding boxes and bounding box transformation with the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/all_params_all_cats\n\nAspects of axis-aligned bounding boxes, SVG paths and AI news\n&ndash; BoundingBox is axis-aligned\n&ndash; BoundingBox transformation\n&ndash; Interactive explanation of SVG path\n&ndash; Claude.AI\n&ndash; Relativising the impact of AI...\n\n\ntwitter 1:\n\nGround-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and bounding box transformation with the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/all_params_all_cats\n\nGround-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and AI news\n&ndash; All categories and parameters\n&ndash; BoundingBox is axis-aligned\n&ndash; BoundingBox transformation\n&ndash; Interactive explanation of SVG path\n&ndash; Claude.AI\n&ndash; Relativising the impact of AI...\n\nlinkedin 1:\n\nGround-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and bounding box transformation with the #RevitAPI\n\nhttps://autode.sk/all_params_all_cats\n\n- All categories and parameters\n- BoundingBox is axis-aligned\n- BoundingBox transformation\n- Interactive explanation of SVG path\n- Claude.AI\n- Relativising the impact of AI...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Bounding Boxes Axis Alignment and Transformation",
    "local_header_href": "#bounding-boxes-axis-alignment-and-transformation",
    "chunk_text": "### Bounding Boxes Axis Alignment and Transformation\n\n<!--\nToday we present ground-breaking research on accessing all built-in parameters and categories, thoughts on axis-aligned bounding boxes and AI news:\n-->\n\nToday we look at some aspects axis-aligned bounding boxes, bounding box transformation and AI news:\n\n<!--\n- [All categories and parameters](#2)\n    - [Summary](#2.1)\n    - [Solution](#2.2)\n    - [Result](#2.3)\n    - [Limitations](#2.4)\n-->\n\n- [BoundingBox is axis-aligned](#3)\n- [BoundingBox transformation](#4)\n- [Interactive explanation of SVG path](#5)\n- [Claude.AI](#6)\n- [Relativising the impact of AI](#7)\n\n<!--"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "All Categories and Parameters",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> All Categories and Parameters\n\nRoman [Nice3point](https://github.com/Nice3point), principle maintainer of RevitLookup, presents a new discovery; in his own words:\n\nI made a new discovery for me.\nAs far as I know, it is impossible to get a list of all built-in parameters using the public Revit API.\nWe are offered an `enum`, but we cannot get the `Parameter` itself from it.\nBy exploring private unmanaged code using reflection and pointers, I managed to do it, as described in\nthe [RevitLookup discussion 183 &ndash; retrieve all parameters and categories](https://github.com/jeremytammik/RevitLookup/discussions/183):\n\n<center>\n<img src=\"img/rk_get_all_bips.png\" alt=\"Get all built-in parameters\" title=\"Get all built-in parameters\" width=\"600\"/>\n</center>\n\n####<a name=\"2.1\"></a> Summary\n\nI recently came across a problem from my business partner who wanted to get all the built-in Revit parameters to extract metadata such as data type, units, storage type, etc. As we know, this is not possible using the Autodesk Revit public API.\n\nSimilar situation with categories; we can't get all the built-in categories; so far, the only known available way is to get them from the document settings, but it contains a very truncated list:\n\n<center>\n<img src=\"img/rk_get_all_bips_1_categories.png\" alt=\"Only some categories\" title=\"Only some categories\" width=\"600\"/>\n</center>\n\nBy the way,\n[The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples/tree/master) include\nsome related naive attempts in\nthe [module `CmdCategories.cs`](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/CmdCategories.cs).\n\n####<a name=\"2.2\"></a> Solution\n\nWe can use private code with reflection and pointers; we only need a document.\nThe point of the method is not to get them but create it.\n\nExample code to get all parameters:\n\n<pre class=\"prettyprint\">\npublic static List&lt;Parameter&gt; GetBuiltinParameters(\n  Document document)\n{\n  const BindingFlags bindingFlags = BindingFlags.NonPublic\n    | BindingFlags.Instance | BindingFlags.DeclaredOnly;\n\n  var documentType = typeof(Document);\n  var parameterType = typeof(Parameter);\n  var assembly = Assembly.GetAssembly(parameterType);\n  var aDocumentType = assembly.GetType(\"ADocument\");\n  var elementIdType = assembly.GetType(\"ElementId\");\n  var elementIdIdType = elementIdType.GetField(\"&lt;alignment member&gt;\", bindingFlags)!;\n  var getADocumentType = documentType.GetMethod(\"getADocument\", bindingFlags)!;\n  var parameterCtorType = parameterType.GetConstructor(bindingFlags, null,\n    new[] {aDocumentType.MakePointerType(), elementIdType.MakePointerType()},\n    null)!;\n\n  var builtinParameters = Enum.GetValues(typeof(BuiltInParameter));\n  var parameters = new List&lt;Parameter&gt;(builtinParameters.Length);\n  foreach (BuiltInParameter builtinParameter in builtinParameters)\n  {\n    var elementId = Activator.CreateInstance(elementIdType);\n    elementIdIdType.SetValue(elementId, builtinParameter);\n\n    var handle = GCHandle.Alloc(elementId);\n    var elementIdPointer = GCHandle.ToIntPtr(handle);\n    Marshal.StructureToPtr(elementId, elementIdPointer, true);\n\n    var parameter = (Parameter) parameterCtorType.Invoke(\n      new[] {getADocumentType.Invoke(document, null), elementIdPointer});\n    parameters.Add(parameter);\n    handle.Free();\n  }\n\n  return parameters;\n}\n</pre>\n\nExample code to get all categories:\n\n<pre class=\"prettyprint\">\npublic static List&lt;Category&gt; GetBuiltinCategories(\n  Document document)\n{\n  const BindingFlags bindingFlags = BindingFlags.NonPublic\n    | BindingFlags.Instance | BindingFlags.DeclaredOnly;\n\n  var documentType = typeof(Document);\n  var categoryType = typeof(Category);\n  var assembly = Assembly.GetAssembly(categoryType);\n  var aDocumentType = assembly.GetType(\"ADocument\");\n  var elementIdType = assembly.GetType(\"ElementId\");\n  var elementIdIdType = elementIdType.GetField(\"&lt;alignment member&gt;\", bindingFlags)!;\n  var getADocumentType = documentType.GetMethod(\"getADocument\", bindingFlags)!;\n  var categoryCtorType = categoryType.GetConstructor(bindingFlags, null,\n    new[] {aDocumentType.MakePointerType(), elementIdType.MakePointerType()},\n    null)!;\n\n  var builtInCategories = Enum.GetValues(typeof(BuiltInCategory));\n  var categories = new List&lt;Category&gt;(builtInCategories.Length);\n  foreach (BuiltInCategory builtInCategory in builtInCategories)\n  {\n    var elementId = Activator.CreateInstance(elementIdType);\n    elementIdIdType.SetValue(elementId, builtInCategory);\n\n    var handle = GCHandle.Alloc(elementId);\n    var elementIdPointer = GCHandle.ToIntPtr(handle);\n    Marshal.StructureToPtr(elementId, elementIdPointer, true);\n\n    var category = (Category) categoryCtorType.Invoke(\n      new[] {getADocumentType.Invoke(document, null), elementIdPointer});\n    categories.Add(category);\n    handle.Free();\n  }\n\n  return categories;\n}\n</pre>\n\n####<a name=\"2.3\"></a> Result\n\nAs a result, we have created all the parameters and all the categories of the entire `Enum`:\n\n<center>\n<img src=\"img/rk_get_all_bips_2_all_params.png\" alt=\"All built-in parameters\" title=\"All built-in parameters\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">All built-in parameters</p>\n\n<img src=\"img/rk_get_all_bips_3_all_cats.png\" alt=\"All built-in categories\" title=\"All built-in categories\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">All built-in categories</p>\n</center>\n\n####<a name=\"2.4\"></a> Limitations\n\nCreated parameters have no binding to any element, and consequently have no value, only metadata.\n\nMany thanks to Roman for this interesting in-depth research and documentation!\n\n-->"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "BoundingBox is Axis-Aligned",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> BoundingBox is Axis-Aligned\n\nLet's move on to the more mundane question\nof [how to get the `BoundingBox` that corresponds to the shape of the family](https://forums.autodesk.com/t5/revit-api-forum/how-to-get-the-boundingbox-that-corresponds-to-the-shape-of-the/m-p/12089970):\n\n**Question:** I would like to inquire about `BoundingBox`.\nIn the left image, the area of the BoundingBox is similar to the shape of the pipe;\nhowever, in the right one, the BoundingBox is much larger than its pipe:\n\n<center>\n<img src=\"img/pipe_boundingbox.png\" alt=\"Pipe bounding box\" title=\"Pipe bounding box\" width=\"600\"/>\n</center>\n\nIt seems that this happens only for Pipes (probably for System Families).\nFor FamilyInstance, it seems that they always have a same size for BoundingBox, even if they are rotated.\n\nIs there a way to know the area of the Family, which always corresponds to its shape, regardless of it being rotated or not?\n\n**Answer:**  No, this does not only happen for pipes.\nThis happens for all kinds of objects that have different dimensions in different directions and are placed at an angle to the cardinal axes.\nFor instance, a vertical wall at a 45-degree angle in the XY plane will exhibit the exact same behaviour.\nThis behaviour is intentional.\nThe Revit bounding box is always aligned with the cardinal axes.\nThat makes it extremely fast and efficient to work with.\nWikipedia calls this\nan [axis-aligned bounding box](https://en.wikipedia.org/wiki/Minimum_bounding_box#Axis-aligned_minimum_bounding_box)."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "BoundingBox Transformation",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> BoundingBox Transformation\n\nThat question leads over nicely to the explanation why\nthe [transform of linked element creates an empty outline](https://forums.autodesk.com/t5/revit-api-forum/transform-of-linked-element-creates-an-empty-outline/m-p/12089717),\nsolved by appropriately transforming the bounding box:\n\n**Question:** I want to create an outline from a linked element's bounding box to use in a `BoundingBoxIntersectsFilter`.\nMy approach below works for some cases, but where a link or element is rotated beyond a certain limit, the bounding box goes askew and the `Outline(XYZ, XYZ)` method returns an empty outline.\nI've tried scaling the bounding box up with an offset which fixes some cases, but not all of them.\nSome advice on solutions would be appreciated.\n\n\n<center>\n<img src=\"img/xform_boundingbox_1.png\" alt=\"Non-rotated link\" title=\"Non-rotated link\" width=\"400\"/> <!-- Pixel Height: 647 Pixel Width: 793 -->\n<p style=\"font-size: 80%; font-style:italic\">Non-rotated link</p>\n\n<img src=\"img/xform_boundingbox_2.png\" alt=\"Rotated link\" title=\"Rotated link\" width=\"400\"/> <!-- Pixel Height: 746 Pixel Width: 961 -->\n<p style=\"font-size: 80%; font-style:italic\">Rotated link</p>\n</center>\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "get the elements bounding box",
    "local_header_href": "#get-the-elements-bounding-box",
    "chunk_text": "# get the elements bounding box\n\ns_BBox = element.get_BoundingBox(doc.ActiveView)"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "apply the link documents transform",
    "local_header_href": "#apply-the-link-documents-transform",
    "chunk_text": "# apply the link documents transform\n\ns_BBox_min = link_trans.OfPoint(s_BBox.Min)\ns_BBox_max = link_trans.OfPoint(s_BBox.Max)"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "make the outline",
    "local_header_href": "#make-the-outline",
    "chunk_text": "# make the outline\n\nnew_outline = Outline(s_BBox_min, s_BBox_max)"
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "make the filter",
    "local_header_href": "#make-the-filter",
    "chunk_text": "# make the filter\n\nbb_filter = BoundingBoxIntersectsFilter(new_outline)\n</pre>\n\n**Answer:** Yes.\nYou can corrupt the bounding box by transforming it.\nI would suggest the following:\n\n- Extract all eight corner vertices of the bounding box\n- Transform all eight vertices as individual points\n- Create a new bounding box from the eight transformed results\n\n[The Building Coder samples](https://github.com/jeremytammik/the_building_coder_samples/tree/master) include\nthe [method `ExpandToContain`](https://github.com/jeremytammik/the_building_coder_samples/blob/master/BuildingCoder/Util.cs#L2724-L2739) to\ncreate and enlarge a bounding box point by point that will come in handy for the last step:\n\n<pre class=\"prettyprint\">\n  /// &lt;summary&gt;\n  ///   Expand the given bounding box to include\n  ///   and contain the given point.\n  /// &lt;/summary&gt;\n  public static void ExpandToContain(\n    this BoundingBoxXYZ bb,\n    XYZ p)\n  {\n    bb.Min = new XYZ(Math.Min(bb.Min.X, p.X),\n      Math.Min(bb.Min.Y, p.Y),\n      Math.Min(bb.Min.Z, p.Z));\n\n    bb.Max = new XYZ(Math.Max(bb.Max.X, p.X),\n      Math.Max(bb.Max.Y, p.Y),\n      Math.Max(bb.Max.Z, p.Z));\n  }\n</pre>\n\n**Response:** Hi Jeremy, this solution works well, thanks."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Interactive Explanation of SVG Path",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Interactive Explanation of SVG Path\n\nI made good use of and learned to love SVG paths working on\nthe [room polygon and furniture picker in SVG](http://thebuildingcoder.typepad.com/blog/2012/10/room-polygon-and-furniture-picker-in-svg.html) and\nimplementing [2D SVG editing on mobile device with Raphael](http://thebuildingcoder.typepad.com/blog/2013/02/2d-svg-editing-on-mobile-device-with-rapha%C3%ABl.html).\n\nIf you would like to enjoy a much nicer explanation of the concepts of SVG paths than I had access to back then, take a quick dive\ninto [understanding SVG paths](https://www.nan.fyi/svg-paths)."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Claude.AI",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Claude.AI\n\nChatGPT has a new competitor,\n[claude.ai](https://claude.ai).\n\nEric Boehlke of [truevis BIM Consulting](https://truevis.com) pointed it out to me, saying:\n\n> You can create an account in the USA or UK, or use VPN to get there.\nA competitor to OpenAI. Can upload big files. Any better for coding?\n\nI tested it myself by asking it to summarise\nmy [last blog post](https://thebuildingcoder.typepad.com/blog/2023/07/rbp-materials-their-assets-and-the-visual-api.html),\nevaluate a German architectural contract without providing any hint of what it might be, and discuss\nthe German [HOAI](https://de.wikipedia.org/wiki/Honorarordnung_f%C3%BCr_Architekten_und_Ingenieure).\nThe results were completely satisfying in all three cases:\n\n<center>\n<img src=\"img/claudeai_tbc2000.png\" alt=\"Claude.AI analyses blog post\" title=\"Claude.AI analyses blog post\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">Claude.AI analyses blog post</p>\n\n<img src=\"img/claudeai_archvertrag.png\" alt=\"Claude.AI analyses a German architectural contract\" title=\"Claude.AI analyses a German architectural contract\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">Claude.AI analyses a German architectural contract</p>\n\n<img src=\"img/claudeai_hoai.png\" alt=\"Claude.AI discusses the HOAI\" title=\"Claude.AI discusses the HOAI\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">Claude.AI discusses the HOAI</p>\n</center>\n\nEric suggests:\n\n> You could batch that blog post analysis to summarise all of your blog posts programmatically for SEO."
  },
  {
    "original_filename": "2001_boundingbox",
    "header_text": "Relativising the Impact of AI",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Relativising the Impact of AI\n\nLet's close with some wise and pertinent thoughts &ndash; not following the hype &ndash; on the possible impact of AI on our life and economy, presented in the explanation\nof [why transformative AI is really, really hard to achieve](https://zhengdongwang.com/2023/06/27/why-transformative-ai-is-really-really-hard-to-achieve.html)."
  }
][
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- [Ripcord Engineering](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/3926242) shares\n  a possible solution to DLL Hell in certain circumstances, using the Python `subprocess` module for disentanglement without need for any IPC:\n  CPython and PyRevit\n  https://forums.autodesk.com/t5/revit-api-forum/cpython-and-pyrevit/m-p/12011805\n  pyRevit - Dynamo Incompatibility: Two versions of Same DLL #1731\n  https://github.com/eirannejad/pyRevit/issues/1731\n  Python Module subprocess — Subprocess management\n  https://docs.python.org/3/library/subprocess.html\n\n- Export of multiple GBXML models\n  https://forums.autodesk.com/t5/revit-api-forum/export-of-multiple-gbxml-models/m-p/12011838#M71878\n\n- gbXml export using energy settings\n  https://forums.autodesk.com/t5/revit-api-forum/gbxml-export-using-energy-settings/m-p/12011894#M71881\n\ntwitter:\n\nAttaining DLL paradise in Python, Multiple gbXML export, gbXML energy settings, automate FBX export with SendKeys and RFA export to MongoDB with the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://thebuildingcoder.typepad.com/blog/2023/07/export-gbxml-and-python-tips.html\n\nDiscussions on Python, handling DLLs, and various aspects of exporting to gbXML, FBX and MongoDB\n&ndash; DLL paradise in Python\n&ndash; Multiple gbXML export\n&ndash; GbXML energy settings\n&ndash; Automate FBX export with SendKeys\n&ndash; RFA export to MongoDB...\n\nlinkedin:\n\nDiscussions on Python, handling DLLs, and various aspects of exporting to gbXML, FBX and MongoDB with th #RevitAPI\n\nhttps://thebuildingcoder.typepad.com/blog/2023/07/export-gbxml-and-python-tips.html\n\n- DLL paradise in Python\n- Multiple gbXML export\n- GbXML energy settings\n- Automate FBX export with SendKeys\n- RFA export to MongoDB...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "Export, gbXML and Python Tips",
    "local_header_href": "#export-gbxml-and-python-tips",
    "chunk_text": "### Export, gbXML and Python Tips\n\nLooking at several useful discussions on Python, handling DLLs, and various aspects of exporting to gbXML, FBX and MongoDB today:\n\n- [DLL paradise in Python](#2)\n- [Multiple gbXML export](#3)\n- [GbXML energy settings](#4)\n- [Automate FBX export with `SendKeys`](#5)\n- [RFA export to MongoDB](#6)"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "DLL Paradise in Python",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> DLL Paradise in Python\n\nJake of [Ripcord Engineering](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/3926242) shared several\nuseful [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) solutions recently.\nMany thanks to Jake for his support!\n\nOne is a possible approach to\nhandle [DLL Hell](https://en.wikipedia.org/wiki/DLL_Hell) using\nthe Python `subprocess` module for disentanglement without need for any IPC, e.g.,\nfor [CPython and pyRevit](https://forums.autodesk.com/t5/revit-api-forum/cpython-and-pyrevit/m-p/12011805):\n\n**Question:** I need to use CPython via pyRevit to have access to libraries such as `numpy` and `pandas`.\nAt the same time, I want to take advantage of pyRevit’s capabilities such as forms etc.\nAs far as I understood, I can’t have both of these in a single script file.\nIf I got this correctly, is there any way to do this?\n\nThe numpy part is quite decoupled since it is meant to help me with the data exchange process from other data sources; after that point, everything would be focused on Revit APIs.\n\n**Answer:** I dealt with the same challenge a little while back.\nPlease look at\nthe [pyRevit issue 1731 on Dynamo incompatibility: two versions of Same DLL](https://github.com/eirannejad/pyRevit/issues/1731)\nfor a short discussion on using [Python `subprocess` module for subprocess management](https://docs.python.org/3/library/subprocess.html) in\nthe Revit/pyRevit context.\n\nWhile I am not a Revit API / Python / pyRevit expert I can report that `subprocess` worked well enough.\nLearning `subprocess` should be a productive use of time assuming the underlying characteristics are a good match for your application.\n\n**Response:** Thanks, Jake. I tried the same approach, and it also worked perfectly for my case. Appreciate it.\n\n**Answer:** Thanks for giving it a go. And thanks for the feedback."
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "Multiple GbXML Export",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Multiple GbXML Export\n\nJake also helped answer the question\non [export of multiple gbXML models](https://forums.autodesk.com/t5/revit-api-forum/export-of-multiple-gbxml-models/m-p/12011838):\n\n**Question:** For my university thesis work I have to create a lot of different GBXML models (around 18000).\nNo way I can do that without code.\nThis is what I came up with (I attached only a part of it; FloorR, WallsR, RoofR are lists to set R value of corresponding elements):\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "Setting Energy Analysis parameters ###",
    "local_header_href": "#setting-energy-analysis-parameters",
    "chunk_text": "### Setting Energy Analysis parameters ###\n\nopt=Analysis.EnergyAnalysisDetailModelOptions()\nopt.EnergyModelType=Analysis.EnergyModelType.BuildingElement\nopt.ExportMullions=False\nopt.IncludeShadingSurfaces=False\nopt.SimplifyCurtainSystems=True\nopt.Tier=Analysis.EnergyAnalysisDetailModelTier.SecondLevelBoundaries"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "loop over all R-value combinations and create models ###",
    "local_header_href": "#loop-over-all-r-value-combinations-and-create-models",
    "chunk_text": "### loop over all R-value combinations and create models ###\n\nt=Transaction(doc,\"R change\")\nc=Transaction(doc,\"model creation\")\n\nfor i in range(len(FloorR)):\n  for j in range(len(WallsR)):\n    for k in range(len(RoofR)):\n    t.Start()\n    Floor.Set(FloorR[i]/0.3048)  #R-value change for floor\n    Wall.Set(WallsR[j]/0.3048)#R-value change for Walls\n    Roof.Set(RoofR[k]/0.3048)#R-value change for roof\n    t.Commit()\n    t.Dispose()\n\n    c.Start()\n    model=Analysis.EnergyAnalysisDetailModel.Create(doc, opt)\n    model.TransformModel()\n    GBopt=GBXMLExportOptions()\n    GBopt.ExportEnergyModelType=ExportEnergyModelType.BuildingElement\n    doc.Export(\"C:\\Users\\Миша\\Desktop\\ASD\",\"0\"+\",\"+str(0.2/FloorR[i])+\",\"+str(0.3/WallsR[j])+\",\"+str(0.3/RoofR[k]), GBopt)\n    c.Commit()\n</pre>\n\nThis creates models, but I ran into a problem I don't fully understand: as the process continues, it slows down and stops at about 170-175 created models.\nApparently, something is taking up the memory.\nI tried calling `doc.Delete(model)` at the end of each `for` loop, but that didn't help either.\n\nWhat could be a solution?\n\n**Answer:** The behaviour you describe is completely expected and as designed.\n\nRevit is an end user product designed to be driven by a human being.\nHuman beings are not expected to sit down and create 18000 models in one sitting.\nI suggest you implement an external executable that drives Revit using the code you shared above and monitors progress as you export results from the models you create.\n\nWhenever Revit starts slowing down, take note of how far you got in processing, kill the process, restart Revit and continue from where you left off.\nThis is a common approach to programmatically drive processes in batch mode that were not designed for it.\nYou can also search The Building Coder for further hints\non [batch processing Revit documents](https://www.google.com/search?q=batch+processing&as_sitesearch=thebuildingcoder.typepad.com).\nAlternatively, you could generate your 18000 models online\nusing [APS and DA4R](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.55).\n\nFurthermore, based on the code snippet provided, it appears that only R-values are manipulated and not the underlying model geometry.\nIf that's the case, it might be best to use Revit to export a single gbXML seed file.\nThen, iterate over the desired seed file parameters (like R-value) in an environment like Python which is excellent for large scale text operations.\n\nTwo utilities that would help with the route described above:\n\n- [XmlNotepad](https://microsoft.github.io/XmlNotepad/) &ndash; to build familiarity with gbXML structure and mechanization\n- [xgbxml](https://xgbxml.readthedocs.io/en/latest/what_is_xgbxml.html) &ndash; Python library for gbXML parsing and manipulation\n\n<center>\n<img src=\"img/export_gbxml_settings.png\" alt=\"gbXML export\" title=\"gbXML export\" width=\"600\"/>\n</center>"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "GbXML Energy Settings",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> GbXML Energy Settings\n\nJake points to the same solution to answer another question as well,\non [gbXml export using energy settings](https://forums.autodesk.com/t5/revit-api-forum/gbxml-export-using-energy-settings/m-p/12011894):\n\n**Question:** Sorry to revive a thread which has been solved more than one year ago, however the solution provided is not working for me as I am programming in Python.\n\nI am using pyRevit to program functions in Python.\nWhen I use the code presented above, I get the following error:\n\n<pre class=\"prettyprint\">\n  EnergyAnalysisDetailModelOptions.ExportMullions = False\n\n  Traceback (most recent call last):\n    File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  AttributeError: static property 'ExportMullions' of 'EnergyAnalysisDetailModelOptions' can only be assigned to through a type, not an instance\n</pre>\n\nIf I understand this correctly, I am having a problem due to the type of variable in my code.\nHowever, Python does not allow the declaration of variables.\nHow can I make the statement to become a type and not an instance?\n\nAny idea how I can get past this issue without moving on to another language?\n\n**Answer:** A nice example of Python `EnergyAnalysisDetailModelOptions` administration is discussed in\nthe [export of multiple gbXML models](https://forums.autodesk.com/t5/revit-api-forum/export-of-multiple-gbxml-models/m-p/9392003).\n\nThe relevant code snippet is this:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "Setting Energy Analysis parameters ###",
    "local_header_href": "#setting-energy-analysis-parameters",
    "chunk_text": "### Setting Energy Analysis parameters ###\n\nopt=Analysis.EnergyAnalysisDetailModelOptions()\nopt.EnergyModelType=Analysis.EnergyModelType.BuildingElement\nopt.ExportMullions=False\nopt.IncludeShadingSurfaces=False\nopt.SimplifyCurtainSystems=True\nopt.Tier=Analysis.EnergyAnalysisDetailModelTier.SecondLevelBoundaries\n</pre>"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "Automate FBX Export with SendKeys",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Automate FBX Export with SendKeys\n\nWe already shared a C# solution\nto [handle a Revit dialogue using `Idling`, `DialogBoxShowing` and `SendKeys`](https://thebuildingcoder.typepad.com/blog/2021/02/birthday-devdays-postcommand-sendkeys.html#4) to\nimplement\nthe [TwinMotion dynamic link export FBX automatically](https://forums.autodesk.com/t5/revit-api-forum/twinmotion-dynamic-link-export-fbx-automatically/m-p/12123438).\n\nNow [Onur Er](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/14209191) cleaned it up further in his updated answer:\n\n**Question:** I want to export FBX using TwinMotion Dynamic Link.\nI would like to export FBX files from many Revit files.\nHow I can use `PostCommand` and then handle the Windows forms on the export panel?\n\n**Answer:** Thank you for sharing your solution.\nIt saved me unbelievable amount of time, maybe days or weeks.\nThank you VERY VERY MUCH!!!\nI cleaned the code and made it more readable in case someone needs it.\nMy own Revit plugin calls this Twinmotion macro automatically after Revit starts up like this:\n\n<pre class=\"prettyprint\">\nusing System.Threading.Tasks;\nusing Autodesk.Revit.UI;\nusing System.Windows.Forms;\nusing Autodesk.Revit.UI.Events;\n\nnamespace YourNamespaceHere\n{\n  public class Class2 : IExternalApplication\n  {\n    UIControlledApplication UIControlledApplication;\n\n    public Result OnStartup(UIControlledApplication Application)\n    {\n      UIControlledApplication = Application;\n      UIControlledApplication.Idling += Application_Idling;\n\n      return Result.Succeeded;\n    }\n\n    public Result OnShutdown(UIControlledApplication Application) => Result.Succeeded;\n\n    void Application_Idling(object Sender, IdlingEventArgs E)\n    {\n      UIControlledApplication.Idling -= Application_Idling;\n\n      var UIApplication = (UIApplication)Sender;\n\n      MyMacro(UIApplication);\n\n      //TaskDialog.Show(\"Application_Idling\", Sender.GetType().FullName);\n    }\n\n    void OnDialogBoxShowing(object Sender, DialogBoxShowingEventArgs Args) => ((TaskDialogShowingEventArgs)Args).OverrideResult((int)TaskDialogResult.Ok);\n\n    static async void RunCommands(UIApplication UIapp, RevitCommandId Id_Addin)\n    {\n      UIapp.PostCommand(Id_Addin);\n      await Task.Delay(400);\n      SendKeys.Send(\"{ENTER}\");\n      await Task.Delay(400);\n      SendKeys.Send(\"{ENTER}\");\n      await Task.Delay(400);\n      SendKeys.Send(\"{ENTER}\");\n      await Task.Delay(400);\n      SendKeys.Send(\"{ESCAPE}\");\n      await Task.Delay(400);\n      SendKeys.Send(\"{ESCAPE}\");\n    }\n\n    void MyMacro(UIApplication UIapp)\n    {\n      try\n      {\n        var Name = \"CustomCtrl_%CustomCtrl_%Twinmotion 2020%Twinmotion Direct Link%ExportButton\";\n        var Id_Addin = RevitCommandId.LookupCommandId(Name);\n\n        if (Id_Addin != null)\n        {\n          UIapp.DialogBoxShowing += OnDialogBoxShowing;\n\n          RunCommands(UIapp, Id_Addin);\n        }\n      }\n      catch\n      {\n        TaskDialog.Show(\"Test\", \"error\");\n      }\n      finally\n      {\n        UIapp.DialogBoxShowing -= OnDialogBoxShowing;\n      }\n    }\n  }\n}\n</pre>\n\nThank you, Onur Er!"
  },
  {
    "original_filename": "2002_dll_hell_gbxml",
    "header_text": "RFA Export to MongoDB",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> RFA Export to MongoDB\n\nTo wrap up, Eduardo [Lalo Ibarra](https://www.linkedin.com/in/eduardo-ibarra91/) of Mexico City shares one\nof [his favourite classes built with #VSC and #MongoDB to facilitate the export of data from Revit families](https://www.linkedin.com/posts/activity-7089535064467795968-A5lj?utm_source=share&utm_medium=member_desktop):\n\nThe class implementation is encoded in the attached image files on LinkedIn:\n\n<center>\n<img src=\"img/li_mongodb_export_1.jpg\" alt=\"MongoDB export\" title=\"MongoDB export\" width=\"400\"/>\n<img src=\"img/li_mongodb_export_2.jpg\" alt=\"MongoDB export\" title=\"MongoDB export\" width=\"400\"/>\n<img src=\"img/li_mongodb_export_3.jpg\" alt=\"MongoDB export\" title=\"MongoDB export\" width=\"400\"/>\n<img src=\"img/li_mongodb_export_4.jpg\" alt=\"MongoDB export\" title=\"MongoDB export\" width=\"400\"/>\n<img src=\"img/li_mongodb_export_5.jpg\" alt=\"MongoDB export\" title=\"MongoDB export\" width=\"400\"/>\n</center>\n\nEduardo also provides it as a PDF, from which I extracted a text file:\n\n> I share the construction of the class.\nI will give myself some time to share the whole process.\n\n- [mongodb_export.pdf](li_mongodb_export.pdf)\n- [mongodb_export.txt](li_mongodb_export.txt)\n\nHere is his useful list of assets:\n\n- [MongoDB Documents](https://www.mongodb.com/docs/)\n- [Visual Studio Community 2022](https://visualstudio.microsoft.com/es/vs/community/)\n- [Revit API docs](https://www.revitapidocs.com/)\n- [Revit SDK](https://aps.autodesk.com/developer/overview/revit)\n- [My First Revit Plug-in Overview](https://www.autodesk.com/support/technical/article/caas/tsarticles/ts/7I2bC1zUr4VjJ3U31uM66K.html)\n- [Create account in GitHub](https://github.com/)\n- [The Builder Coder](https://thebuildingcoder.typepad.com/)\n  [Visual Studio Revit Add-in Templates](https://github.com/jeremytammik/VisualStudioRevitAddinWizard)\n  &ndash; recommendation: clone the repository\n\nMany thanks, Eduardo!"
  }
][
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- email\n  promote Autodesk Platform Services Developer Conference Europe - DevCon 2023 Sept 11-12 in Munich\n\n- resx mnanagement language\n  https://forums.autodesk.com/t5/revit-api-forum/revit-add-in-with-multiple-language-forms-based-on-current-ui/m-p/12140874#M73102\n\ntwitter:\n\nAutodesk Platform Services APS @AutodeskAPS Developer Conferences, @AutodeskRevit #RevitAPI add-in localisation and i18n, RESX language management, ribbon panel localisation and creating the localised WinForms #BIM @DynamoBIM  https://autode.sk/resxlanguage\n\nThe Autodesk Platform Services APS Developer Conferences are coming up, and we all need to deal\nwith application localisation and i18n issues\n&ndash; Resx language management\n&ndash; Ribbon panel localisation\n&ndash; Creating the localised WinForms...\n\nlinkedin:\n\nAutodesk Platform Services APS Developer Conferences, #RevitAPI add-in localisation and i18n, RESX language management, ribbon panel localisation and creating the localised WinForms:\n\nhttps://autode.sk/resxlanguage\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "Resx Language Management and APS DevCons",
    "local_header_href": "#resx-language-management-and-aps-devcons",
    "chunk_text": "### Resx Language Management and APS DevCons\n\nThis year's [Autodesk Platform Services APS](https://aps.autodesk.com/) Developer Conferences are\ncoming up soon, and we all (well, many of us) need to deal\nwith [application localisation and i18n](https://en.wikipedia.org/wiki/Internationalization_and_localization) issues:\n\n- [APS Developer Conferences](#2)\n- [Resx language management](#3)\n- [Ribbon panel localisation](#3.1)\n- [Creating localised WinForms](#3.2)"
  },
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "APS Developer Conferences",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> APS Developer Conferences\n\nThe [Autodesk Developer Conferences DevCon](https://aps.autodesk.com/blog/register-autodesk-devcon-2023) are\ncoming up soon.\n\nThese two-day events will be hosted in:\n\n- [San Francisco, California](https://aps.autodesk.com/devcon):\n  The Historic Klamath Ferry on September 6-7, 2023\n- [Munich, Germany](https://cvent.autodesk.com/w9DQ5Q?rt=99uCmbte1U6VS9RyVp0Gnw&RefId=Generic):\n  Holiday Inn Munich - Westpark on September 11-12, 2023\n\nThese events are a great opportunity for software developers and business innovators to learn about leading edge technology from Autodesk experts, network with other developers and business leaders, as well as see how our desktop APIs and cloud-based [Autodesk Platform Services APS](https://aps.autodesk.com/) (formerly Forge) can power their company’s growth and digital transformation. This is also a great opportunity for Autodesk to engage with its 3rd party development community, learn more about their projects and how they are using our APIs.\n\nAll the up to date information as well as both registration links are provided in\nthe [main blog post](https://aps.autodesk.com/blog/register-autodesk-devcon-2023).\n\nThis is a 2-day event which will provide deep technical training as well high-level overview on Autodesk Platform Services and Autodesk APIs. If you want to learn about Autodesk applications to improve workflows, learn from Autodesk engineers and technology decision-makers as well as other industry professionals, this event will provide all the education and networking you need. You’ll bring back very valuable insights to apply to your work.\n\nThe [European DevCon agenda](img/devcon_eu_2023_agenda.pdf) provides\na detailed overview of the sessions planned.\n\nSpace is limited and we expect this event to sell out.\n\nYou still have a chance to save 50% on your EU ticket until this weekend: 180 euro instead of 360.\n\nAs always, please feel free to reach out if you have any questions.\n\nAs [Kean Walmsley points out](https://www.keanw.com/2023/06/register-today-for-autodesk-devcon-2023-in-munich.html),\nit’s also a special time to be in Munich,\nwith [Oktoberfest starting the following weekend](https://www.oktoberfest.de/en/information/when-is-oktoberfest),\non September 16th.\n\n<center>\n<img src=\"img/2023-08-01_eu_aps_devcon.png\" alt=\"EU APS DevCon 2023\" title=\"EU APS DevCon 2023\" width=\"600\"/>\n</center>"
  },
  {
    "original_filename": "2003_resx_lang_devcon",
    "header_text": "Resx Language Management",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Resx Language Management\n\n[Geoff Jennings](https://www.linkedin.com/in/geoffrey-jennings-9984921/) ([@GJennings-BM](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/9888344)) of [BIModular](https://bimodular.com)\nbrought up and with help\nfrom Luiz Henrique [@ricaun](https://ricaun.com/) Cassettari solved\nimportant aspects of Revit add-in localisation in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [Revit Add-in with Multiple Language Forms based on Current UI Culture](https://forums.autodesk.com/t5/revit-api-forum/revit-add-in-with-multiple-language-forms-based-on-current-ui/m-p/12140874):\n\n**Question:** I am struggling to get my C# code correct to convert my user forms into each culture.\nI tried for days, but I cannot get my labels to change languages when opening Revit in different language versions.\nI can get my Ribbon Panel button to change languages using a RibbonResources.resx file in my App.cs, but my FormExport.resx files are not providing language translation values.\n\n<pre class=\"prettyprint\">\npublic FormExport(Autodesk.Revit.DB.Document doc)\n{\n  CultureInfo cultureName = new CultureInfo(Thread.CurrentThread.CurrentUICulture.Name);\n  string cultureRef = cultureName.Name;\n  Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(cultureRef);\n  Thread.CurrentThread.CurrentUICulture = CultureInfo.CreateSpecificCulture(cultureRef);\n\n  InitializeComponent();\n  familyDocument = doc;\n\n  // Get the localized label text from the resource .resx file\n  string localizedLabelText = GetLocalizedTextFromResource(\"lblFamilyName.Text\");\n  string localizedHeaderText = GetLocalizedTextFromResource(\"lblHeader.Text\");\n\n  // Set the label text with the localized value\n  lblFamilyName.Text = localizedLabelText;\n  lblHeader.Text = localizedHeaderText;\n}\n</pre>\n\nI have this function set below my form code:\n\n<pre class=\"prettyprint\">\nprivate string GetLocalizedTextFromResource(string key)\n{\n  try\n  {\n    // Load the appropriate resource file based on the user's selected language\n    ResourceManager resourceManager = new ResourceManager(\"MyApp.FormExport\", typeof(FormExport).Assembly);\n    CultureInfo currentCulture = Thread.CurrentThread.CurrentUICulture;\n    // Fetch the localized text for the given key from the resource\n    string localizedText = resourceManager.GetString(key, currentCulture);\n    // If the resource for the given key is not found in the selected culture,\n    // explicitly load the default resource (English) using CultureInfo.InvariantCulture\n    if (localizedText == null)\n    {\n      localizedText = resourceManager.GetString(key, CultureInfo.InvariantCulture);\n    }\n    // If the resource is still not found, return the key itself as a fallback\n    return localizedText ?? key;\n  }\n  catch (MissingManifestResourceException ex)\n  {\n    // Log the exception\n    Console.WriteLine($\"Resource file not found. Exception: {ex.Message}\");\n    return key; // Return the key itself as a fallback\n  }\n}\n</pre>\n\nMy form `.resx` files are:\n\n- FormExport.resx\n- FormExport.en.resx\n- FormExport.fr.resx\n- ... (continued)\n\nI am testing various options.\nHere is just a small list sites I have researched and tested against:\n\n- [Create the Multilingual .bundle file](https://adndevblog.typepad.com/aec/2013/08/localized-applications-for-the-revit-exchange-store.html)\n- [All Language Revit Versions](https://help.autodesk.com/view/RVT/2020/ENU/?guid=GUID-BD09C1B4-5520-475D-BE7E-773642EEBD6C)\n- [Language Tags](https://forums.autodesk.com/t5/revit-api-forum/localization-of-add-in-multilanguage/td-p/8936144)\n- [Get Revit Language](https://www.revitapidocs.com/2015/2b1d8b80-a11c-2a57-63bd-6c0d67691879.htm)\n- [Family Content Localization](https://thebuildingcoder.typepad.com/blog/2013/02/content-localisation.html)\n- [Another Resource for Creating Resx files and Revit UI Culture](https://thebuildingcoder.typepad.com/blog/2017/02/multiple-language-resx-resource-files.html)\n- [Label Control for BuiltIn Parameter Languages](https://www.revitapidocs.com/2022/c38e7823-31b3-9bcd-5ab0-d353e0d39fa8.htm)\n- [Localize Ribbon](https://help.autodesk.com/view/RVT/2022/ENU/?guid=Revit_API_Revit_API_Developers_Guide_Introduction_...)\n\nIt has become very confusing since everyone seems to have a different method.\nI am simply building a C# .Net app for Revit under the Add-in tab.\nI have five WinForms.\nOne is a primary WinForms and the other WinForms support secondary operations.\nThis is all been built in Visual Studio 2022 for Revit 2021-2024.\nThe app has been submitted to the app store for publishing.\nNow, I just need to prepare the WinForms for a larger international base of users.\n\nIt should be extremely simple.\nAgain, I have my ribbon panel working for any language, but the translations of my WinForms are my challenge.\nBeyond the sites listed below, I spent hours reviewing YouTube videos, ChatGPT, reading manuals, and website blogs.\nIn Visual Studio, I have done the process of setting each form to 'Localizable' = true, then Language = \"France, Spanish,...\", customized the forms for .resx files.  I have tested with separate manual .resx files, and tons of programming methods.  Frustrating for something that is effectively a basic task.\n\nI am hoping someone can provide c# .net guidance showing the code requirements of a single form that references the appropriate .resx based upon the user's Revit language version.\nI currently have a `Forms` folder for all of my WinForms and their associated `.resx` language files.\n\n**Answer:** The `.resx` file should swap automatically when depending on the `CultureInfo`; if the resource is now changed automatically probably your key language is different from the CultureInfo in the application, like `en` is different from `en-US` and `fr` is different from `fr-FR`.\nJust update your resource file name to match the same `CultureInfo` that Revit uses.\nHere is a [table listing all the languages and keys](https://github.com/ricaun/RevitAddin.ResourcesExample).\n\n**Response:** Thank you for your answer and excellent quality video of your .resx management.\nYour methods will be useful on some other apps I plan to create.\n\nI was finally successful at getting my C# Winforms to show in any UICulture languages!\nI want to share this information with others:\n\n####<a name=\"3.1\"></a> Ribbon Panel Localization\n\nI added a language switcher file based on Andrey Bushman's sample file.\nThis has been modified to `RVTLanguages.cs`.\nThe file was placed in my root folder below my C# project name.\nIn the same location, I also created three .resx files:\n\n- RibbonResources.resx (empty &ndash; set to `Internal`)\n- RibbonResources.en-US.resx (my panel data &ndash; see image below)\n- RibbonResources.fr-FR.resx (my French translations)\n\nTo keep my panel button narrow and allow for wrapping of text, I created two lines in the .resx file:\n\n<center>\n<img src=\"img/ribbon_resx_file_en.png\" alt=\"Ribbon panel resource file\" title=\"Ribbon panel resource file\" width=\"800\"/> <!-- Pixel Height: 417 Pixel Width: 1,686 -->\n</center>\n\nIn my `App.cs`:\n\n<pre class=\"prettyprint\">\npublic Result OnStartup(UIControlledApplication application)\n{\n\n#region READ AND SET THE LANGUAGE ENVIRONMENT USING THE RVTLanguages.cs file\n  RVTLanguages.Cultures(application.ControlledApplication.Language);\n  ResourceManager res_mng = new ResourceManager(typeof(RibbonResources));\n#endregion\n\n  RibbonPanel p = application.CreateRibbonPanel(RibbonResources.ResourceManager.GetString(\"PanelName\"));\n\n  string thisAssemblyPath = Assembly.GetExecutingAssembly().Location;\n  string buttonText1 = RibbonResources.ResourceManager.GetString(\"CommandName1\");\n  string buttonText2 = RibbonResources.ResourceManager.GetString(\"CommandName2\");\n\n  PushButtonData btnMyApp = new PushButtonData(\"btnMyApp\", buttonText1 + \"\\n\" + buttonText2, thisAssemblyPath, typeof(Command).FullName)\n  {\n    LargeImage = imgSrc,\n    Image = imgSrcTB,\n    LongDescription = RibbonResources.ResourceManager.GetString(\"CommandDescription\"),\n    ToolTip = RibbonResources.ResourceManager.GetString(\"CommandToolTip\")\n  };\n\n  // set help file to reference .bundle file help.html\n  string helpFolder = Path.Combine(parentFolder, \"help.html\");\n  ContextualHelp contextHelp = new ContextualHelp(\n  ContextualHelpType.ChmFile, helpFolder);\n  btnMyApp.SetContextualHelp(contextHelp);\n\n  p.AddItem(btnMyApp);\n</pre>\n\nThis was all that was required for setting up a localized ribbon button:\n\n<center>\n<img src=\"img/ribbon_resx_en_and_fr.png\" alt=\"Ribbon panel localisation\" title=\"Ribbon panel localisation\" width=\"800\"/> <!-- Pixel Height: 430 Pixel Width: 1,200 -->\n</center>\n\n####<a name=\"3.2\"></a> Creating Localized WinForms\n\nI created a folder called `Forms` and then placed all of my WinForms under this folder.\nAfter my forms were created, I then manually created two new `.resx` files, for example, `MyForm.en-US.resx` and `MyForm.fr-FR.resx`.\nThese files were placed in the Forms folder along with my main WinForm.\n\nIn my Winform code I did the following in `MyForm.cs`:\n\n<pre class=\"prettyprint\">\npublic sealed class UICultureSwitcher : IDisposable\n{\n  CultureInfo previous;\n  public UICultureSwitcher()\n  {\n    CultureInfo culture = new CultureInfo(Thread\n    .CurrentThread.CurrentCulture.Name);\n\n    previous = Thread.CurrentThread.CurrentUICulture;\n    Thread.CurrentThread.CurrentUICulture = culture;\n   }\n   void IDisposable.Dispose()\n   {\n     Thread.CurrentThread.CurrentUICulture = previous;\n   }\n}\n\npublic MyForm( Autodesk.Revit.DB.Document doc)\n{\n    ResourceManager res_mng = new ResourceManager(typeof(MyForm));\n    ResourceSet resourceSet = res_mng.GetResourceSet(Thread.CurrentThread.CurrentUICulture, true, true);\n\n    InitializeComponent();\n    familyDocument = doc;\n\n    label1.Text = GetLocalizedTextFromResource(\"label1Text\");\n    label2.Text = GetLocalizedTextFromResource(\"label2.Text\");\n    label3.Text = GetLocalizedTextFromResource(\"label3.Text\");\n    label4.Text = GetLocalizedTextFromResource(\"label4.Text\");\n\n    // rest of code ...\n}\n</pre>\n\nBelow I have a function that will collect the necessary language information in the .resx file:\n\n<pre class=\"prettyprint\">\nprivate string GetLocalizedTextFromResource(string key)\n{\n  try\n  {\n    // Load the appropriate resource file based on the user's selected language\n    ResourceManager resourceManager = new ResourceManager(\"MyApp.Forms.MyForm\", typeof(MyForm).Assembly);\n    CultureInfo currentCulture = Thread.CurrentThread.CurrentUICulture;\n\n    // Fetch the localized text for the given key from the resource\n    string localizedText = resourceManager.GetString(key, currentCulture);\n\n    // If the resource for the given key is not found in the culture,\n    // explicitly load the default resource (English) using CultureInfo.InvariantCulture\n    if (localizedText == null)\n    {\n      localizedText = resourceManager.GetString(key, CultureInfo.InvariantCulture);\n    }\n\n    // If the resource is still not found, return the key itself as a fallback\n    return localizedText ?? key;\n  }\n  catch (MissingManifestResourceException ex)\n  {\n    // Handle the exception if the resource file is not found\n    // Log the exception\n    Console.WriteLine($\"Resource file not found. Exception: {ex.Message}\");\n    return key; // Return the key itself as a fallback\n   }\n}\n</pre>\n\nI then repeat the same methods for my other forms.\nHere are screenshots of the end results:\n\n<center>\n<img src=\"img/ribbon_resx_familytypeexporter_en.png\" alt=\"FamilyType Exporter EN\" title=\"FamilyType Exporter EN\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">FamilyType Exporter EN</p>\n<br/>\n<img src=\"img/ribbon_resx_familytypeexporter_fr.png\" alt=\"FamilyType Exporter FR\" title=\"FamilyType Exporter FR\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">FamilyType Exporter FR</p>\n</center>\n\nNow, I am updating the datagrid based upon a similar workflow.\n\nI truly hope this helps others.\nThis has been a very confusing journey.\nEverything mentioned was done in Visual Studio 2022 and for Revit 2022-2024:\n\n- [Source code module RVTLanguages.cs](zip/ribbon_resx_rvtlanguages.zip)\n\n**Answer:** Neat!\n\nI believe setting the *Thread.CurrentThread.CurrentUICulture* and *Thread.CurrentThread.CurrentCulture* is not necessary to make multilanguage work, Revit already starts with the `CultureInfo` correctly set; the only reason to change it might be to test whether your Form is working in another `CurrentUICulture` language.\nUsing your class `UICultureSwitcher` does the trick.\n\nAnd why are you using `CommandName1` and `CommandName2` to create the second line? Just one single `CommandName` entry with multiple lines should work, like your `CommandDescription` that has multiple lines.\n\n**Response:** You are correct about the CommandName1 and CommandName2.\nI originally created the two strings before I did the multiline commandDescription.\nPreviously, I had tried the \"\\r\\n\" method in the .resx file and it was making it part of a single full string versus giving me two lines of strings.\nI changed the .resx files for my Ribbon code and generated the Spanish version.\nThe single CommandName with a `shift`+`return` allows for the multiple lines in the ribbon button:\n\n<center>\n<img src=\"img/ribbon_resx_ribbon_es.png\" alt=\"FamilyType Exporter ES\" title=\"FamilyType Exporter ES\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">FamilyType Exporter ES</p>\n<br/>\n</center>\n\nAs for the language switcher, I have plans for expanding functionality for an upcoming Pro version of the app.\n\nThanks again for your video and quick response.\n\nMany thanks to Geoff and Luiz for clarifying the confusion and sharing the solution!"
  }
][
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\nhttps://github.com/GastonBC/GasTools/wiki\n\n- Key Schedule + Revit API\n  https://forums.autodesk.com/t5/revit-api-forum/key-schedule-revit-api/m-p/12143666\n  control hierarchy of the schedule in project browser\n\n- Revit Command Ids\n  https://forums.autodesk.com/t5/revit-api-forum/revit-command-ids/m-p/12154992\n  I was looking for the same thing and found that exporting the keyboard shortcuts xml file gives you a list of all command names and ids.\n  Yes it does (Revit 2022.1.3 I might add)\n  cmd_id_in_shortcut_xml.png Pixel Height: 458 Pixel Width: 2,017\n\n- Typography-Fell-Types-font\n  https://www.linyangchen.com/Typography-Fell-Types-font\n  A 17th-century font in a 21st-century thesis\n  special guy: https://www.linyangchen.com/\n\ntwitter:\n\nAI generates 3D model from 2D drawings, GasTools, key schedule browser API and @AutodeskRevit command id list for the #RevitAPI  #BIM @DynamoBIM @AutodeskAPS https://autode.sk/rvt_cmd_ids\n\nA nice, varied bouquet of topics\n&ndash; GasTools\n&ndash; Key schedule browser API\n&ndash; Revit command id list\n&ndash; AI generates 3D model from 2D drawings\n&ndash; Careful with infant screen use\n&ndash; Baroque typography in the digital world...\n\nlinkedin:\n\nAI generates 3D model from 2D drawings, GasTools, key schedule browser API and Revit command id list for the #RevitAPI\n\nhttps://autode.sk/rvt_cmd_ids\n\nA nice, varied bouquet of topics\n\n- GasTools\n- Key schedule browser API\n- Revit command id list\n- AI generates 3D model from 2D drawings\n- Careful with infant screen use\n- Baroque typography in the digital world...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "GasTools, Cmd Ids, Key Schedule et al",
    "local_header_href": "#gastools-cmd-ids-key-schedule-et-al",
    "chunk_text": "### GasTools, Cmd Ids, Key Schedule et al\n\nToday we present a nice, varied bouquet of interesting topics:\n\n- [GasTools](#2)\n- [Key schedule browser API](#3)\n- [Revit command id list](#4)\n- [AI generates 3D model from 2D drawings](#5)\n- [Careful with infant screen use](#6)\n- [Baroque typography in the digital world](#7)"
  },
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "GasTools",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> GasTools\n\nGastón Balparda Corsi, Architect and Project Developer at [/slantis](https://slantis.com/),\nannounced his [GasTools](https://github.com/GastonBC/GasTools/wiki), saying:\n\n> I'm lazy.\nWhen I notice I'm doing something repetitive or boring I default to look for a better way to do stuff.\nThat mentality allowed me to make the jump from AutoCAD to Revit early and learn a couple of programming languages to help me on my everyday tasks.\nThe same laziness led me to mix the two and develop my own addins to help my team and I be more efficient with our time.\nI received positive feedback, so I decided to share them and save more time in combined hours.\nI recommend you start by checking what Match Grid Extents and Outline Elevations do.\nYou will find the downloads and a brief explanation for each tool in my GitHub account.\nLook for a tab in Revit called \"Gas Tools\" (subject to change).\n\nI'm open to questions and suggestions so don't be afraid to hit me up! These are all independent to install so just download the ones you want. There is some nuance to the installation but nothing terrible.\n\n- [GasTools](https://github.com/GastonBC/GasTools/wiki) &ndash; tools I've developed over the years to make my life easier using Revit.\nThey automate repetitive tasks or provide a better way of visualizing the information, like the location of linked and imported CADs, legends. Examples of use are in the referenced links.\n- Match Grid Extents &ndash; This tool lets you copy the layout of the grids in a sheet (for example the elbows, 2D extents and bubble visibility) and transfer it to another view. It also reveals and hides grids according to the view chosen as template.\n- Outline Elevations &ndash; If you've ever done elevations, you are used to making fill regions around the enclosing walls and giving it a pen thickness. This tool takes the crop region extent and overrides its thickness to the desired number.\n- Auto Dimension Grids &ndash; Dimension your selected grids automatically to the top and the left.\n- Smart Grid Bubbles &ndash; Turn the top and left grid bubbles on.\n- Set by Index &ndash; Create a sheet set by selecting a schedule like the one in your cover sheet instead of checking sheet by sheet."
  },
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "Key Schedule Browser API",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Key Schedule Browser API\n\nJacob Small, Autodesk Implementation Consultant, chipped in with some new advice on how to control the hierarchy of the schedule in the project browser in the thread\non [Key Schedule + Revit API](https://forums.autodesk.com/t5/revit-api-forum/key-schedule-revit-api/m-p/12143666):\n\n**Question:** I have previously asked about using Revit API to create a Key Schedule and add bunch of new parameters to it.\nThat question is still out here somewhere so I am not going to repeat it here.\nInstead, I just manually added bunch of parameters to Key Schedule and moved on to the next task.\nI was able to access Data Table and add more rows to the data.\nWhat I am trying to do now, is to fill the cells with data.\nObviously, there is no clear method for that.\nHence my question: How does one, using API, fill in the Key Schedule data?\nAny ideas/suggestions are welcome.\n\n<center>\n<img src=\"img/key_schedule_api.jpg\" alt=\"Key schedule API\" title=\"Key schedule API\" width=\"400\"/> <!-- Pixel Height: 460 Pixel Width: 460 -->\n</center>\n\n**Answer:** A keyschedule behaves in most ways just like a normal schedule.\nThe most important similarity being that they show a collection of elements.\nConfusion can arise when thinking about the elements in the keyschedule, because they do not physically exist in the Revit model.\nI like to think of them as 'ghost elements', who's image (= set of parameter values) can be imprinted on real elements.\n\nThis being the case, the elements in the keyschedule can be simply retrieved by using a `FilteredElementCollector` with the `KeyScheduleID` as an argument.\nParameters shown in the keyschedule can then be retrieved and set in the elements themselves.\nThe newly set parameter values will then of course show up in the key schedule.\n\n**Response:** This solution works pretty well!\n\nNow just to make it clear for everyone here's what really happens:\n\nEach row in a Key Schedule is an Element that contains a set of Parameters.\nParameters represent each column of the schedule.\n\nWe can collect all \"rows\" (elements) just by doing this:\n\n<pre class=\"prettyprint\">\n  elements = FilteredElementCollector(doc, viewSchedule.Id).ToElements()\n</pre>\n\nThen we can query each element that is being returns for parameters:\n\n<pre class=\"prettyprint\">\n  params = []\n  for i in elements:\n    params.append(i.Parameters)\n</pre>\n\nOnce you have the parameters, you can just write values to them and they will appear in a schedule.\n\nNot all parameters represent a field in the key schedule, though.\nBut that can be easily filtered out by checking the parameter's definition name toward schedulable fields.\n\nMaybe the Revit API SDK team can include some of the code in the schedule samples, before a more intrinsic method for reaching this goal being created.\n\n**Question:** Which parameter is responsible of defining the hierarchy of the schedule in project browser, at the question marks in this picture?\n\n<center>\n<img src=\"img/key_schedule_in_browser.jpg\" alt=\"Key schedule in browser\" title=\"Key schedule in browser\" width=\"390\"/> <!-- Pixel Height: 306 Pixel Width: 390 -->\n</center>\n\nNo elements are collected by this code:\n\n<pre class=\"prettyprint\">\n  Category category = Category.GetCategory(doc, BuiltInCategory.OST_Rooms);\n  viewSchedule = ViewSchedule.CreateKeySchedule(doc, category.Id);\n  FilteredElementCollector elementCollector = new FilteredElementCollector(doc, viewSchedule.Id);\n  IList&lt;Element&gt; rows = elementCollector.ToElements();\n</pre>\n\n**Answer:** This is something I've taken a stab at in the past for a Dynamo project, so I'll weigh in.\n\nFirst thing to know: the project browser is a view of the model itself and can be organised in different ways per project.\nAs always, you want to explore how things are in the UI before attempting to automate it, so first check info on managing it manually:\n[Organizing the Project Browser](https://help.autodesk.com/view/RVT/2024/ENU/?guid=GUID-96F9CDB5-C46D-4597-943B-DF231E8EC688)\n\nFrom there we can look at managing it via the API.\nFor that there is the\nhandy [`BrowserOrganization` class](https://www.revitapidocs.com/2024/4fd57c3f-6127-efd9-f79e-70ad3e5dc1cc.htm).\n\nSo, while we could manage the setup, we don't know how your browser is organized on a given project (and if your code is intended to scale across orgs/projects you can't assume there is a single setup).\nAs such, you likely want to start off by looking at\n[the GetCurrentBrowserOrganizationForSchedules method](https://www.revitapidocs.com/2024/b32365b9-54d0-08b3-ee34-4a2cde7fa1d8.htm)\n\nGood luck! &nbsp;   :-)\n\nMille grazie, Jacob!"
  },
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "Revit Command Id List",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Revit Command Id List\n\nOne approach to retrieve a list of all [Revit command ids](https://forums.autodesk.com/t5/revit-api-forum/revit-command-ids/m-p/12154992):\n\n> I found that exporting the keyboard shortcuts XML file gives you a list of all command names and ids (Revit 2022.1.3, I might add):\n\n<center>\n<img src=\"img/cmd_id_in_shortcut_xml.png\" alt=\"Command id in shortcuts XML\" title=\"Command id in shortcuts XML\" width=\"1000\"/> <!-- Pixel Height: 458 Pixel Width: 2,017 -->\n</center>"
  },
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "AI Generates 3D Model from 2D Drawings",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> AI Generates 3D Model from 2D Drawings\n\nOf special interest to CAD and BIM modelers, a new method to generate a 3D CAD model from 2D line drawings of three orthographic views is described in\n[PlankAssembly: robust 3D reconstruction from three orthographic views with learnt shape programs](https://manycore-research.github.io/PlankAssembly/)."
  },
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "Careful with Infant Screen Use",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Careful with Infant Screen Use\n\nVital and life-changing effects are seen to correlate with infant interaction with digital devices:\naccording to a study by the National University of Singapore and several other research labs,\n[infant screen use leads to reduced cognitive skills at age 9](https://www.uxtigers.com/post/infant-screen-use)."
  },
  {
    "original_filename": "2004_cmd_id_key_schedule",
    "header_text": "Baroque Typography in the Digital World",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Baroque Typography in the Digital World\n\nTo close on a pleasant note, I very much enjoyed the explanation (and good taste) by Lin Yangchen in his article on\nusing [a 17th-century font in a 21st-century thesis](https://www.linyangchen.com/Typography-Fell-Types-font).\nHe seems like a special person in many ways, and I found his entire web site\n[linyangchen.com](https://www.linyangchen.com/) very interesting indeed."
  }
][
  {
    "original_filename": "2005_net_core",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- tbc 15th birthday august 22, almost passed its puberty by now, soon a grown-up blog, assuminbg human time spans for maturilty\n\n- .net core migration coming in september\n  dropping macro support for document macros\n  https://thebuildingcoder.typepad.com/blog/2022/05/analysis-of-macros-journals-and-add-in-manager.html#2\n  how to convert form project to application macro\n\n- .net core 5\n  https://autodesk.slack.com/archives/C0531NMR189/p1692239493644339\n  Mona Khanapurkar\n  thanks for checking here. We are targeting a preview release in Fall 2023. As soon as we can get Revit to build with the updated .Net version we will be in a better position to provide the details. In the meantime, below is a rough draft for communications. CC\n  https://www.keanw.com/2023/08/the-next-release-of-autocad-and-net.html\n  https://adndevblog.typepad.com/autocad/2023/08/call-for-action-next-release-of-autocad.html\n  autocad and civil3d already published the preview\n  revit is still working on it\n  acad is platform\n  revit has many dependencies (dynamo, inventor) and addons\n  microsoft is releasing .net code 8 in november\n  acad migrated to .net core 6\n  inventor went straight to 7\n  revit is debating whether to move straight to 7 or 8\n  acad worked around the problem preventing 6 and are now discussing moving straight to 7 as well\n  all products are using acad components\n  revit september preview will not contain anything yet\n  revit november is not guaranteed\n  point to autocad one\n  dynamo also annouced that they are working on it\n  familiarise yourself with the Revit feedback portal now.\n  then you will be ready to check out the new Revit API as soon as it becomes available\n\n- polygon area algorithms\n  https://forums.autodesk.com/t5/revit-api-forum/area-of-a-wall-opening/m-p/12174104#M73476\n\n- AI recreates clip of Pink Floyd song from recordings of brain activity\n  https://www.newscientist.com/article/2387343-ai-recreates-clip-of-pink-floyd-song-from-recordings-of-brain-activity/\n\n- Allie K. Miller on LinkedIn: You can now write one sentence to train an entire ML model.\n  185 comments\n  You can now write one sentence to train an entire ML model.\n  How does it work?\n  You just describe the ML model you want ... a chain of AI systems will take that ...\n  https://www.linkedin.com/posts/alliekmiller_you-can-now-write-one-sentence-to-train-an-activity-7097974848001331200-DtJE?utm_source=share&utm_medium=member_desktop\\\n\n- compression and size reduction\n  1759026 Aug 22 11:33 2023-09-01_nachbarschaftstreffen.jpg height 3506 pixel\n   850770 Aug 22 13:01 2023-09-01_nachbarschaftstreffen1.jpg compressed using https://compressjpeg.com/\n   149291 Aug 22 13:03 2023-09-01_nachbarschaftstreffen2.jpg height 900\n    97220 Aug 22 13:03 2023-09-01_nachbarschaftstreffen3.jpg compressed using https://compressjpeg.com/\n  factor ca. 18.1\n\ntwitter:\n\nThe Building Coder 15-year birthday celebration, @AutodeskRevit #RevitAPI with .NET Core and macro prospects, and polygon area algorithms to determine wall area without openings #BIM @DynamoBIM @AutodeskAPS https://autode.sk/dotnetcoreprospect\n\nA birthday celebration, a forward-looking statement or two and observations on geometry, AI and emissions\n&ndash; 15 years of The Building Coder\n&ndash; Revit API with .NET Core\n&ndash; Bye-bye document macro?\n&ndash; Polygon area algorithms\n&ndash; AI recreates Pink Floyd from brain activity\n&ndash; Create ML model with one sentence?\n&ndash; Compress greenhouse gas emissions...\n\nlinkedin:\n\njeremytammik\n\nhttps://www.linkedin.com/posts/jeremytammik_15-years-polygon-areas-and-net-core-activity-7100129768016093185-SO6O\n\nBIM Experts\n\nhttps://www.linkedin.com/feed/update/urn:li:activity:7100129808394641409\n\nThe Building Coder 15-year birthday celebration, #RevitAPI with .NET Core and macro prospects, and polygon area algorithms to determine wall area without openings\n\nhttps://autode.sk/dotnetcoreprospect\n\n- 15 years of The Building Coder\n- Revit API with .NET Core\n- Bye-bye document macro?\n- Polygon area algorithms\n- AI recreates Pink Floyd from brain activity\n- Create ML model with one sentence?\n- Compress greenhouse gas emissions...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "15 Years, Polygon Areas and .NET Core",
    "local_header_href": "#15-years-polygon-areas-and-net-core",
    "chunk_text": "### 15 Years, Polygon Areas and .NET Core\n\nA birthday celebration,\na [forward-looking statement](https://en.wikipedia.org/wiki/Forward-looking_statement) or two\nand observations on geometry, AI and emissions:\n\n- [15 years of The Building Coder](#2)\n    - [Congratulations](#2.1)\n- [Revit API with .NET Core](#3)\n- [Bye-bye document macro?](#4)\n- [Polygon area algorithms](#5)\n- [AI recreates Pink Floyd from brain activity](#6)\n- [Create ML model with one sentence?](#7)\n- [Compress greenhouse gas emissions](#8)"
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "15 Years of The Building Coder",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> 15 Years of The Building Coder\n\nWe celebrated The Building Coder's 15th birthday yesterday, August 22.\n\n<center>\n<img src=\"img/tbc_15_years.jpg\" alt=\"The Building Coder's 15th birthday\" title=\"The Building Coder's 15th birthday\" width=\"600\"/> <!-- Pixel Height: 810 Pixel Width: 1,160 -->\n</center>\n\nIt has soon passed its puberty now and is almost a full grown-up blog now, preparing to stand on its own legs.\nAnd, in case you didn't know, this is blog post number 2005.\nWe silently crossed into the third millennium in July.\n\n####<a name=\"2.1\"></a> Congratulations\n\nOn [LinkedIn](https://www.linkedin.com/posts/jeremytammik_15-years-polygon-areas-and-net-core-activity-7100129768016093185-SO6O):\nand [BIM Experts](https://www.linkedin.com/feed/update/urn:li:activity:7100129808394641409):\n\n- Tim Hoffeller:\n  Thank you Jeremy, for all the inspiration through all those years! The BIM world would be a less creative one without you 😊\n- Prasad Sumanasekara, MagiCAD Group AB:\n  Congratulations ...!!!\n- Alex Vila Ortega, WSP, Sydney:\n  Congrats!!!\n- Diego Mendoza Acosta, Ingeniero Civil:\n  Congratulations !!!\n- Simon Jones, Freelance BIM Consultant & Developer, AEC BIM Tools:\n  Congratulations Jeremy &ndash; glad to see it still going!\n- José Ignacio Montes Herraiz, North London Heat Power Project:\n  Congratulations Jeremy!\n- Stephen Preston, Developer Relations and Platform Ecosystems leader:\n  Congratulations Jeremy. This is a great achievement. Its heartwarming to think of the many people you've helped in their careers, businesses and hobbies by sharing your knowledge.\n- Matt Taylor, WSP Aotearoa:\n  Happy birthday TBC/Jeremy! Thanks for all you do.\n- Emile Kfouri, Senior Technology Product Leader:\n  Amazing! I remember your first blog post and thinking what an amazing thing it was going to be for Revit. Thank you for helping all of us be better developers and solve problems we could not solve on our own.\n- Madhukar Moogala, Principal Developer Advocate at Autodesk:\n  Congrats Jeremy an epic milestone ! 😀\n- Chris Theobald, Technology Officer at SCS:\n  Happy 15th!\n- Ali Najmi, BIMLOGiQ:\n  Congrats Jeremy, Thanks for all that hard work over the past 15 years\n- João Teixeira, Software Solutions for AEC and Manufacturing:\n  Congrats for all the contributions to the community over the last 15 years! Keep up the excellent work!\n- Kean Walmsley, Software Architect & Senior Manager, Convergence Engineering, Autodesk Research:\n  Congratulations, Jeremy! It's been wonderful seeing TBC go from strength to strength with your continued focus and investment. A fantastic milestone and achievement!\n- Chuong Ho, Computational Design Researcher:\n  Thank you Jeremy, your blog is awesome.\n- Carlos Ernesto Suárez Guerra, EMPAI:\n  Congratulations!!!!!\n- Nastya Baranouskaya, Software engineer and BIM Manager:\n  Congratulations!!!\n- Wouter Hilhorst, Projectleider bij OPL architecten / re-designers:\n  Congratulations! The next 15 years From API to AI?\n- Lester Molina Espinosa, Sr. Principal CAD/BIM Designer:\n  Happy 15th birthday!!! Well done Jeremy. Keep up the good work!\n- Michelangelo Capraro, Autodesk:\n  I reference your pages constantly, what a great community resource, congrats!\n- Boy d'Hont, Senior Architect / BIM Programmer at WGA Architects:\n  Thank you for all your input for the API. You brought the polish that made that rusty old Revit shine.\n- Luís Filipe Santos, Architect at OSLO WORKS:\n  Congrats for the great blog and all the help building plugins for Revit!\n- Jakob Hirn, BIM, digital twins, building data platforms, Revit training, CAD-CAM automation:\n  Happy Birthday and thanks a lot for all the work you’ve done for the Revit community in these years. 🙏\n\nThank you all and the entire Revit add-in developer community for your appreciation and support!"
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "Revit API with .NET Core",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Revit API with .NET Core\n\nA number of questions were raised in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) on\nRevit API support for .NET Core, e.g.:\n\n- [Does Revit target .NET standard](https://forums.autodesk.com/t5/revit-api-forum/does-revit-target-net-standard/m-p/9792894?search-action-id=812462935117&search-result-uid=9792894)\n- [Revit API should support .NET 5+](https://forums.autodesk.com/t5/revit-api-forum/revitapi-should-support-net-5/m-p/10533160?search-action-id=812462935117&search-result-uid=10533160)\n- [TypeLoadException on addin startup after changing project to .NET 5](https://forums.autodesk.com/t5/revit-api-forum/typeloadexception-on-addin-startup-after-changing-project-to-net/m-p/10341283?search-action-id=812462935117&search-result-uid=10341283)\n- [Has anyone been successful in building a NetStandard-2.0 or Net-5.0 plug-in?](https://forums.autodesk.com/t5/revit-api-forum/has-anyone-been-successful-in-building-a-netstandard-2-0-or-net/m-p/10694884?search-action-id=812462935117&search-result-uid=10694884)\n\nMore significantly, we have\na [Revit Idea Station](https://forums.autodesk.com/t5/revit-ideas/idb-p/302)\n[wishlist item for .NET version 6](https://forums.autodesk.com/t5/revit-ideas/net-version/idc-p/12196972) that\nhas now been accepted:\n\n- **Request:** Could you use .NET 6 for the Revit API?\nThat would greatly improve the quality of the tools I develop.\nThe use of .NET 6 would also improve Revit's performance as it is faster and more efficient than the .NET framework.\nAlso, with a .NET version greater than .NET 5 comes C# 9, which offers newer and more functionality for developing with the Revit API.\nFurthermore, with the latest version of .NET comes the latest version of WPF, which offers better looks and overall improvements.\n- **Response:** Status changed to: Accepted. Congrats!\nWe think this is a great idea, so we've decided to add it to our roadmap.\nThanks for the suggestion!\nTo follow the progress of features in development, please see\nthe [Revit Public Roadmap](https://blogs.autodesk.com/revit/roadmap/) and join\nthe [Revit Preview Release](https://feedback.autodesk.com/key/LHMJFVHGJK085G2M) to\nparticipate in feature testing.\n(Note that Accepted Ideas may not be immediately available.)\n<p class=\"author\">The Factory</p>\n\nSol Amour has covered most of what can be said on this topic in his overview of [Dynamo upgrading to .NET 6](https://forum.dynamobim.com/t/dynamo-upgrading-to-net-6).\n\nMadhukar Moogala and Kean Walmsley have already published some information about the situation in AutoCAD and Civil3D:\n\n- [Call for Action : Next Release of AutoCAD API](https://adndevblog.typepad.com/autocad/2023/08/call-for-action-next-release-of-autocad.html)\n- [The next release of AutoCAD and .NET](https://www.keanw.com/2023/08/the-next-release-of-autocad-and-net.html)\n\nAutoCAD and Civil3D have published preview versions with .NET Core 6 support for developers to explore.\nHowever, it is by no means clear yet which version of .NET Core will be targeted by their next major releases.\nMicrosoft may release [.NET Core 8 in November](https://devblogs.microsoft.com/dotnet/announcing-dotnet-8-preview-7/).\n\nSo, as you can imagine, we will probably be facing a similar transition in the Revit API as well.\nThe situation for Revit is complicated by dependencies, addons, and other components and relationships to consider.\nThe development team is still working out the details.\n\nSo, basically, all we can say about this at the moment is that we are working on it, and it remains a moving target.\n\nPlease keep your eyes peeled for the Revit preview releases.\nThere is no guarantee yet by when the internal dependencies will have settled enough to include a version of the Revit API supporting .NET Core in a Revit preview release.\nIt may take until the end of the year.\n\nWhat can I do right now?\n\nAbove all, if you are interested in this topic, please ensure that you have joined the Revit feedback community and have access to the upcoming preview releases for evaluation.\nThen, you can also participate in the feedback forum discussions.\nFamiliarise yourself with the Revit feedback portal now.\nThen you will be ready to jump in and actively join the fray as soon as possible."
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "Bye-Bye Document Macro?",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Bye-Bye Document Macro?\n\nIn the course of revamping the Revit API, the development team also took a look at the macro environment.\nSupport for .NET Core will obviously affect that as well.\nLast year, they asked for feedback from the add-in developer community\non [how you use Revit macros](https://forums.autodesk.com/t5/revit-api-forum/research-how-do-you-use-revit-macros/m-p/11158305)\nand [shared back the results](https://thebuildingcoder.typepad.com/blog/2022/05/analysis-of-macros-journals-and-add-in-manager.html#2).\n\nAs a result of this and other usage analysis, the current plan is to drop support for document macros.\nConverting a document macro to an application macro is easy, and I hope to share some simple instructions on that anon."
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "Polygon Area Algorithms",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Polygon Area Algorithms\n\nMoving on from plans and speculations about what the future might bring,\nRichard [RPThomas108](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/1035859) Thomas\nshared some valuable hints and examples of polygon area algorithms answering a question on how to obtain\nthe [area of a wall opening](https://forums.autodesk.com/t5/revit-api-forum/area-of-a-wall-opening/m-p/12174104):\n\n**Question:** How can I calculate the area of a wall opening?\nI cannot delete any object.\n\n**Answer:** You can delete an object temporarily inside a transaction that is never committed, so the changes are never stored in the database:\n\n- [Calculating gross and net wall areas](http://thebuildingcoder.typepad.com/blog/2015/03/calculating-gross-and-net-wall-areas.html)\n- [Gross and net wall area calculation enhancement](https://thebuildingcoder.typepad.com/blog/2015/04/gross-and-net-wall-area-calculation-enhancement-and-events.html)\n\n**Response:** I cannot delete elements, even transitory.\n\n**Answer:** Here is a possible solution, except for ruled faces (for ruled faces, there must be a mathematical approximation similar to below):\n\nGenerally, for other types of faces you can find the inner loops of the face and use `Edge.GetCurveUV` to create a loop in the dimensions of the face parameters.\nUnfortunately, there is no tessellate for `CurveUV`, but you can evaluate points along the loop to get a set of ordered UVs.\nEach `U` and `V` can then be multiplied based on how the face is parameterised in that direction, i.e., for a planar face, it 1 in both directions, but for a cylindrical face the `U` is based on angles, so, instead you have to multiply it based on radius to get the segment length (`V` is still in length, so you can use 1 for that).\nPrior to the existence of `CurveUV`, you would likely have had to have used `Edge.EvaluateOnFace` to create the tessellated points.\n\nOnce you've multiplied the UV's, you can create a polygon and use\nthe [shoelace formula](https://en.wikipedia.org/wiki/Shoelace_formula) etc. to find the area of the polygon and so the surface area of the opening.\n\nIt is hard for faces with normalised parametrisation (such as ruled faces), because the multiple used to convert normalised to raw in one direction changes along the other direction.\nFor example, if you have a ruled surface between two lines of different length, one at the base (Vmin) and one at the top (Vmax), the length varies from base to top, so how you convert `U` to raw parameter isn't constant, but varies according to the height of `V` where `U` is being measured.\n\nHow we measure openings in surfaces can also be a bit subjective to a degree.\nIf you have a cylindrical wall, then the area for the same opening on the outer face will be larger than the inner, but neither, I suspect, will likely be the thing that is useful to an MEP engineer.\nI assume they would likely want the projected (flat opening area).\nFor this, you would probably have to take the worst case (inner area) and project it onto a plane to establish what can fit into that 2D area (or how much ventilation you have).\n\nAnother method I used in the past for 2D is to tesselate the perimeter and fill the opening with a grid of points, then\nuse [Delaunay triangulation](https://en.wikipedia.org/wiki/Delaunay_triangulation) etc., adding up the sum area of resulting triangles.\nThe area is always slightly underestimated for concave edges and slightly overestimated for convex edges.\nUsing smaller triangles obviously improves that but also increases processing time.\n\nAnother option is to create a single faced solid over the opening with one of the shape builders.\nSome surface types are not supported by all shape builders, however.\n\n<center>\n<img src=\"img/area_of_wall_opening_1.png\" alt=\"Area of wall opening\" title=\"Area of wall opening\" width=\"800\"/> <!-- Pixel Height: 450 Pixel Width: 1,087 -->\n</center>\n\nYou can then extract the surface area of those.\n\n<center>\n<img src=\"img/area_of_wall_opening_2.png\" alt=\"Area of wall opening\" title=\"Area of wall opening\" width=\"800\"/> <!-- Pixel Height: 439 Pixel Width: 1,082 -->\n</center>\n\nI think walls are quite simple compared to floors.\nIn shaped floors, especially, you don't always get inner loops.\nFor example, in the below there are no inner loops.\nThe thing you do know however is that the actual outline edges always have vertical faces adjacent.\nTherefore, fold edges always contain two horizontal or quasi-horizontal faces.\nSo, by elimination of those that way, you are left with the outline edge curves and it is then just a case of ordering them into loops and determining if they are outer or inner.\nYou can't rely on direction of curve for that because in reality they are all outer edges to their face.\n\n<center>\n<img src=\"img/area_of_wall_opening_3.png\" alt=\"Area of wall opening\" title=\"Area of wall opening\" width=\"600\"/> <!-- Pixel Height: 566 Pixel Width: 1,065 -->\n</center>\n\nSo, there isn't a universal solution to these things.\n\nMany thanks to Richard for sharing his thoughts and extensive experience on this!"
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "AI Recreates Pink Floyd from Brain Activity",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> AI Recreates Pink Floyd from Brain Activity\n\nLet me briefly point out two AI-related news items that I found interesting:\n\n- [AI recreates clip of Pink Floyd song from recordings of brain activity](https://www.newscientist.com/article/2387343-ai-recreates-clip-of-pink-floyd-song-from-recordings-of-brain-activity/)"
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "Create ML Model with one Sentence?",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Create ML Model with one Sentence?\n\nFor a lengthier discussion on how ML can be used or misused, check out the several hundred comments\non [Allie K. Miller's post on LinkedIn: You can now write one sentence to train an entire ML model](https://www.linkedin.com/posts/alliekmiller_you-can-now-write-one-sentence-to-train-an-activity-7097974848001331200-DtJE):\n\n> How does it work?\nYou just describe the ML model you want...\na chain of AI systems will take that..."
  },
  {
    "original_filename": "2005_net_core",
    "header_text": "Compress Greenhouse Gas Emissions",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Compress Greenhouse Gas Emissions\n\nPlease compress stuff!\n\nIt is worthwhile paying attention to the carbon footprint of today's widespread and growing usage of the Internet and digital devices.\n\nSome estimates deem it comparable with the pollution generated by airlines and flying.\n\nI just checked out the effect of reduction of resolution and compression (using [compressjpeg.com](https://compressjpeg.com/)) on an image that I emailed to some friends:\n\n- a0.jpg &ndash; 3506 pixel height original &ndash; 1.759.026 bytes\n- a1.jpg &ndash; 3506 pixel height compressed &ndash; 850.770 bytes\n- a2.jpg &ndash; 900 pixel height  &ndash; 149.291 bytes\n- a3.jpg &ndash; 900 pixel height compressed &ndash; 97.220 bytes\n\nThe shrunk and compressed image was virtually indistinguishable from the original &ndash; it was even a bit easier to read due to slightly higher contrast.\n\nThe combination of lower pixel count and compression reduced the size from over 1.7 MB to less than 100 kB, by a factor of over 18.\n\n<!--\n\n2023-09-02 another bafudi email list image to send\n564769 original image, pixel width > 1800\n180374 reduced width = 900\n96328 [compressjpeg.com](https://compressjpeg.com)\nless radical savings, factor of 5.9\n\n-->\n\nSome supporting articles that I checked out:\n\n- Wikipedia entry on [Greenhouse gas](https://en.wikipedia.org/wiki/Greenhouse_gas)\n- [Greenhouse emissions by sector](https://ourworldindata.org/emissions-by-sector)\n- [Powering the Internet: your virtual carbon footprint infographic](https://www.webfx.com/blog/marketing/carbon-footprint-internet/)\n- [The Internet’s invisible carbon footprint](https://foundation.mozilla.org/en/blog/ai-internet-carbon-footprint/)\n> Did you know that writing an email can send 17 grams or more of carbon dioxide into the atmosphere?\nOr that going audio-only on Zoom calls reduces carbon emissions by up to 96%?\n\n<center>\n<img src=\"img/greenhouse_emissions_by_sector.png\" alt=\"Greenhouse gas emissions by sector\" title=\"Greenhouse gas emissions by sector\" width=\"600\"/> <!-- Pixel Height: 1,233 Pixel Width: 1,302 -->\n</center>\n\n<!--\n\nimg/internet_carbon_footprint.png\n\ncarbon footprint of driving versus flying\n\nflight Basel-Malaga Roundtrip ca. 3,100 km, 2 travellers\nCO2 amount: 1.2 t\n\nhttps://co2.myclimate.org/en/portfolios?calculation_id=6115626\n\ncar Basel-Garnatilla\n1935 km\nCO2 amount: 0.476 t\nreturn trip 1 t\n\nEmissions by sector\nhttps://ourworldindata.org/emissions-by-sector\ngreenhouse_emissions_by_sector.png\n\nThe Internet’s Invisible Carbon Footprint\nhttps://foundation.mozilla.org/en/blog/ai-internet-carbon-footprint/\n> Did you know that writing an email can send 17 grams or more of carbon dioxide into the atmosphere? Or that going audio-only on Zoom calls reduces carbon emissions by up to 96%?\n\nPowering the Internet: Your Virtual Carbon Footprint [Infographic]\nhttps://www.webfx.com/blog/marketing/carbon-footprint-internet/\ninternet_carbon_footprint.png\n\n-->"
  }
][
  {
    "original_filename": "2006_threads_geo_equal",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Equality methods of GeometryObject\n  https://forums.autodesk.com/t5/revit-api-forum/equality-methods-of-geometryobject/m-p/12155610\n\n- on single threaded API versus multi-threaded Revit\n  Is my plugin restricted by the computing resources of Revit?\n  https://forums.autodesk.com/t5/revit-api-forum/is-my-plugin-restricted-by-the-computing-resources-of-revit/m-p/12155865#M73273\n\ntwitter:\n\nDeep Revit API questions requiring clarification on add-in threads, GeometryObject comparison methods and accessing MS Access in the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/objequals\n\nDeep Revit API questions requiring clarification and a simple database connection issue resolved\n&ndash; Add-in threads\n&ndash; <code>GeometryObject</code> comparison methods\n&ndash; Accessing Access\n&ndash; The INTERCAL programming language...\n\nlinkedin:\n\nDeep Revit API questions requiring clarification on add-in threads, GeometryObject comparison methods and accessing MS Access in the #RevitAPI\n\nhttps://autode.sk/objequals\n\n- Add-in threads\n- GeometryObject comparison methods\n- Accessing Access\n- The INTERCAL programming language...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2006_threads_geo_equal",
    "header_text": "Add-In Threads and Geometry Comparison",
    "local_header_href": "#add-in-threads-and-geometry-comparison",
    "chunk_text": "### Add-In Threads and Geometry Comparison\n\nA couple of rather deep Revit API questions can use some clarification, plus a simple database connection issue is resolved:\n\n- [Add-in threads](#2)\n- [`GeometryObject` comparison methods](#3)\n- [Accessing Access](#4)\n- [The INTERCAL programming language](#5)"
  },
  {
    "original_filename": "2006_threads_geo_equal",
    "header_text": "Add-In Threads",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Add-In Threads\n\nSome aspects of the single-threaded Revit API versus multi-threaded Revit.exe and add-ins were highlighted in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\nasking [Is my plugin restricted by the computing resources of Revit?](https://forums.autodesk.com/t5/revit-api-forum/is-my-plugin-restricted-by-the-computing-resources-of-revit/m-p/12155865):\n\n**Question:** The Revit API is a single-threaded (therefore single-core) process.\nI was wondering if a Revit plugin would then have to live with the same restriction or whether a plugin could theoretically run multi-threaded/multi-processed?\nAnd what about GPU access?\nI know that some commercial plugin providers have developed standalone software with bidirectional connections to and from Revit, and I was wondering whether the hardware restrictions of Revit were the reason behind that.\n\n**Answer:** The limitation of running tasks on a single thread in the Revit API is not due to hardware restrictions but rather a deliberate design choice aimed at ensuring data consistency.\n\nTo clarify, the term \"single-threaded\" does not necessarily mean it all operates on a single core; it depends on the nature of the data your application handles during different phases.\n\nWhen we refer to \"single-threaded,\" we are likely talking about the \"event loop\" utilized by Revit to manage model modifications. The event loop is a common design pattern used in UI applications. However, internally, Revit can utilize multi-core or GPU cores to parallelize rendering processes and generate model data into images.\n\nIn the majority of cases, achieving parallel execution of tasks requires a careful design to split jobs into multiple individual sub-jobs. This can be quite challenging for most real-world scenarios.\n\nFor many UI applications, opting for a single-threaded approach offers greater stability and simplicity in maintaining data consistency. This holds particularly true for Revit, which is a software equipped with a third-party plugin system. In Revit, all operations related to reading and updating the model are queued and executed sequentially on the main thread, a decision rooted in Revit's specific business domain.\n\nWhile it is possible to design Revit to support multi-threading, similar to a database software, doing so would entail sacrificing simplicity and introduce complexities related to handling thread-safety during modifications.\n\nMoreover, it's important to note that even for writing data in parallel, a database relies on locking mechanisms to ensure data consistency, effectively making it single-threaded at its core. This approach is based on the widely accepted understanding that modifying related data must be regulated to guarantee data consistency.\n\nYour add-in is not restricted in any way.\nThe only restriction imposed by Revit is the single-threaded implementation of the Revit API and access to Revit functionality.\nAll other operations performed by your add-in are not restricted, limited or influenced by Revit in any way whatsoever.\nThe next limiting factor might be the .NET environment in which your add-in lives, and the `AppDomain` that Revit provides for it.\nPlease examine the official .NET documentation for that.\n\nHowever, you also can always implement whatever functionality you like outside of your Revit add-in and communicate between that and the add-in in a number of ways.\n\nMany thanks to Kennan Chen for this clarification!"
  },
  {
    "original_filename": "2006_threads_geo_equal",
    "header_text": "GeometryObject Comparison Methods",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> GeometryObject Comparison Methods\n\nA pertinent question from\nRichard [RPThomas108](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/1035859) Thomas\non [equality methods of `GeometryObject`](https://forums.autodesk.com/t5/revit-api-forum/equality-methods-of-geometryobject/td-p/12149045):\nwas clarified by the development team:\n\n**Question:** Can someone confirm what the equality methods of `GeometryObject` are based upon, i.e.:\n\n- Memory reference\n- Geometric configuration and/or properties of the class\n- Id assigned to the class alone (GeometryObject.Id)\n- Something else?\n\nI'm specifically interested in the equality/inequality operators and the overridden `Object.Equals`:\n\n<center>\n<img src=\"img/geo_obj_comparison.png\" alt=\"Object.Equals et al\" title=\"Object.Equals et al\" width=\"800\"/> <!-- Pixel Height: 353 Pixel Width: 974 -->\n</center>\n\nI guess the simple yes / no answer (if it exists) would be: are the equality methods noted above based on memory reference alone?\nHowever, isn't `Object.Equals` based on memory reference to begin with?\nIf it is overridden, then how is it overridden?\nI tend to create a lot of class objects whose purpose is to wrap an API object and attach an id due to uncertainty about the equality of the API objects.\nSome clarification here or in the documentation would probably be quite helpful in reducing this aspect.\nI see the following in the RevitAPI.chm under GeometryObject.Equals in the Remarks section:\n\n> This compares the internal identifiers of the geometry, and doesn't compare them geometrically\n\nNow that we've ruled out the geometric configuration, we just need to know what the 'internal identifiers' are exactly.\nIs it the `GeometryObject.Id` or something else?\nWhat kind of operations affect these identifiers?\nDo they exist for every API object created or just the items coming directly from element geometry?\n\nI've now also reviewed the below from RevitAPI.chm on `GeometryObject.Id`:\n\n> This id can be stored and used for future referencing.\nThe reference should be stable between minor geometric changes and modifications, but may not remain valid if there are major changes to the element or its surroundings.\nNote that the id may be negative (and thus invalid for referencing) if obtained from view-specific geometry, or if obtained from most GeometryObjects created in memory by the API.\nNegative ids cannot be used for referencing.\nThese integer ids should not be used for comparison purposes (other than to check if they are equivalent or not).\nNothing should be assumed about rules about how an element populates the sequence of different numeric values as this may change based on the element's definition.\n\nI've noticed previously that geometry from two different elements could have the same id (the id values are low so that is reasonable).\nThat being the case, I'm also looking to confirm that the equality methods noted above are not equating two geometry objects with the same id from two different elements as being the same (internal identifier <> GeometryObject.Id).\n\nI think knowing more about this could be quite helpful either way.\nWe could test and find answers, but it would then remain an unknown aspect to new people encountering the API.\n\nPersonally, I always look at the equals functions in the documentation to see if it has been overridden for a class or not.\nThat then informs me if I can use Linq extensions such as `distinct` and `union` with it (so we need to know how it is overridden also).\n\nFor classes such as `ElementId`, it is inherently obvious, but some objects are less so and need more description.\nIf it is just using GeometryObject.Id, then I can live with the limitations of that; I just need to know that is what it is doing.\n\n**Answer:** Good question, might be something worth documenting:\n\n- GeometryObject.Equals &ndash; This compares the memory references of the compared objects.\n- GeometryObject.operator == &ndash; This compares the pointers of the Revit-internal geometry objects.\n- GeometryObject.GetHashCode &ndash; This is a hash of the pointer to the Revit-internal geometry object.\n\nIn principle, there could be two different Revit.DB.GeometryObject objects that are both handles to the same Revit-internal geometry object; for example, if you retrieve the GeometryObject from the same `Reference` twice in succession, you will end up with two different GeometryObjects that both are handles to the same Revit-internal object.\nIn this case, GeometryObject.Equals would return false, but GeometryObject.operator == would return true.\nBoth GeometryObjects would have the same hash code.\n\nIf either comparison method returns true, then that guarantees that they both have the same GeometryObject.Id, which is an attribute of the underlying Revit object.\nHowever, two totally unrelated GeometryObjects may have the same Id, since this is not intended to be a globally unique identifier.\n\nFor completeness, the inequality operator is simply the negation of the equality operator.\nTwo GeometryObjects that internally hold null pointers to Revit-internal objects are considered equal when compared with operator ==.\n\nI think this behaviour could be considered reasonable, if we update the documentation to reflect the actual behaviour.\n\nAlso, as noted, it may not make sense to override Object.Equals at all.\n\n**Response:** I think I'm largely happy with the status quo; as stated, it is probably more important that how it works is better described in the documentation; we then can make the right allowances based on that.\n\nSeems like there is no real logic in two managed objects that point to the same unmanaged object not returning true for Equals.\nI can't think of a reason off of the top of my head as to why the Equals function doesn't work exactly the same way as the == operator.\nHowever, the Linq extensions will only be using 'Equals', not ==, so it might be useful therefore to make Equals the same as ==.\nSecondly, `GetHashCode` will be called by Linq extensions prior to `Equals`, so therefore it should be overridden to return 0 to force the comparison by `Equals` or be overridden to perhaps provide a better hashing function related to the unmanaged memory reference (not the managed counterpart.\n\nI have a feeling that the default algorithm that Object.GetHashCode uses in .NET is fast rather than perfect in terms of comparing two objects as being the same.\nSince the hash code is based on the reference (64 bit on 64-bit system) but the hash code itself is only 32 bits.\nSo, in theory there can be clashes that then need further resolution via `Equals`.\nIn contrast, if you are comparing the value of 64-bit memory pointers directly on the unmanaged side, then there can be no doubt it is the same object.\n\nAll I'm aiming for in the end is that when I extract objects from Revit I can then pass those objects through my functions which could perhaps sort them or group them, but in the end I can compare what comes out against the original set.\nI also need to remove items from a List (List&lt;T&gt;.Remove) which is sometimes hard if `Equals` and `GetHashCode` have not been overridden, since that method will use the default equality comparer.\n\nTo deal with these kinds of things I recently wrote the following generic classes where comparisons are conducted during the context of the external command.\nI think a lot of it comes down to trust in `GetHashCode`.\nObviously, the below is for all kinds of things, not just geometry objects.\nThe pain of this kind of approach is that you have to create a new list of items of the below classes from the existing list of API objects rather than just knowing you can use the API objects directly.\n\n<pre class=\"prettyprint\">\n  Public Class RT_GeometryObjWithId(Of T As GeometryObject)\n    Inherits RT_ApiObjectWithId(Of T)\n\n    Public ReadOnly Property GeometryId As Integer\n    Public Sub New(Obj As T)\n      MyBase.New(Obj)\n      GeometryId = Obj.Id\n    End Sub\n  End Class\n\n  Public Class RT_ApiObjectWithId(Of T As APIObject)\n    Implements IDisposable\n\n    Public ReadOnly Property UID As Guid = Guid.NewGuid\n    Private disposedValue As Boolean\n    Private IntAPIObj As T\n    Public Property APIObject As T\n      Get\n        Return IntAPIObj\n      End Get\n      Set(value As T)\n        IntAPIObj = value\n      End Set\n    End Property\n    Public Sub New(Obj As T)\n      IntAPIObj = Obj\n    End Sub\n\n    Public Overrides Function GetHashCode() As Integer\n      'Force consideration of Equals\n      'Likely I could leave this alone and rely on the default implementation\n      'However I have more trust in comparing two guids than GetHashCode\n      Return 0\n    End Function\n    Public Overrides Function Equals(obj As Object) As Boolean\n      Dim Other As RT_ApiObjectWithId(Of T) = _\n        TryCast(obj, RT_ApiObjectWithId(Of T))\n      If Other Is Nothing Then Return False else\n      Return Me.UID = Other.UID\n    End Function\n\n    Public Shared Operator =(A As RT_ApiObjectWithId(Of T), _\n      B As RT_ApiObjectWithId(Of T)) As Boolean\n      Return A.Equals(B)\n    End Operator\n    Public Shared Operator &lt;&gt;(A As RT_ApiObjectWithId(Of T), _\n      B As RT_ApiObjectWithId(Of T)) As Boolean\n      Return Not A.Equals(B)\n    End Operator\n\n    Protected Overridable Sub Dispose(disposing As Boolean)\n      If Not disposedValue Then\n        If disposing Then\n          ' TODO: dispose managed state (managed objects)\n          If APIObject IsNot Nothing Then\n            APIObject.Dispose()\n          End If\n        End If\n\n        ' TODO: free unmanaged resources (unmanaged objects) and override finalizer\n        ' TODO: set large fields to null\n        disposedValue = True\n      End If\n    End Sub\n\n    ' ' TODO: override finalizer only if 'Dispose(disposing As Boolean)' has code to free unmanaged resources\n    ' Protected Overrides Sub Finalize()\n    '   ' Do not change this code. Put cleanup code in 'Dispose(disposing As Boolean)' method\n    '   Dispose(disposing:=False)\n    '   MyBase.Finalize()\n    ' End Sub\n\n    Public Sub Dispose() Implements IDisposable.Dispose\n      ' Do not change this code. Put cleanup code in 'Dispose(disposing As Boolean)' method\n      Dispose(disposing:=True)\n      GC.SuppressFinalize(Me)\n    End Sub\n  End Class\n</pre>\n\nMany thanks to Richard for raising this important question and sharing his viable and well-considered solution."
  },
  {
    "original_filename": "2006_threads_geo_equal",
    "header_text": "Accessing Access",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Accessing Access\n\nA repeating question\non [connecting with a MS Access database](https://forums.autodesk.com/t5/revit-api-forum/connecting-to-ms-access/m-p/12208698) came\nup once again, and the answer is known, so worthwhile to point out here as well.\n\nOleg 'OR_AND_NO' Rodygin of [RZD Project](https://en.wikipedia.org/wiki/Russian_Railways) very kindly pointed out that the answer is provided in a previous post:\n[Can't make connection to Access database](https://forums.autodesk.com/t5/revit-api-forum/cant-make-connection-to-acces-database/m-p/10879626):\n\n> You need to install the [Microsoft Access 2013 Runtime](https://www.microsoft.com/en-us/download/details.aspx?id=39358)\n\nThank you, Oleg."
  },
  {
    "original_filename": "2006_threads_geo_equal",
    "header_text": "The INTERCAL Programming Language",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> The INTERCAL Programming Language\n\nFor some slightly less useful information,\nin case you are interested in weird programming languages,\n[INTERCAL](https://en.wikipedia.org/wiki/INTERCAL) may rank pretty high.\nReading the Wikipedia entry made me laugh out loud."
  }
][
  {
    "original_filename": "2007_sys_fam_py_section",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- determine is family system or not?\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1691697108465579\n  [Q] Given a Family in the API what is the most straight forward approach to determining if the family is a system family or not in C#?\n  [A] Jacob Small\n\n- you need a column family to define a column family\n  Custom Family Type - BuiltIn Parameters\n  https://forums.autodesk.com/t5/revit-api-forum/custom-family-type-builtin-parameters/m-p/12203945\n\n- Create section with Revit API, Python\n  creates a section that looks at a window from the outside\n  https://forums.autodesk.com/t5/revit-api-forum/create-section-with-revit-api-python/m-p/12211534\n\ntwitter:\n\nShed some light on family and section view creation, a system family predicate, level-based family template and creating section view in Python with @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/pythonsection\n\nToday, we shed some light on family and section view creation\n&ndash; System family predicate\n&ndash; Level-based family template\n&ndash; Create section view in Python...\n\nlinkedin:\n\nShed some light on family and section view creation, a system family predicate, level-based family template and creating section view in Python with #RevitAPI\n\nhttps://autode.sk/pythonsection\n\n- System family predicate\n- Level-based family template\n- Create section view in Python...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2007_sys_fam_py_section",
    "header_text": "System Family Predicate and Python Section Creation",
    "local_header_href": "#system-family-predicate-and-python-section-creation",
    "chunk_text": "### System Family Predicate and Python Section Creation\n\nToday, we shed some light on family and section view creation:\n\n- [System family predicate](#2)\n- [Level-based family template](#3)\n- [Create section view in Python](#4)"
  },
  {
    "original_filename": "2007_sys_fam_py_section",
    "header_text": "System Family Predicate",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> System Family Predicate\n\nJacob Small and Ivan Dobrianov suggest an efficient and simple solution to identify system families:\n\n**Question:** Given a family, what is the most straight-forward approach to determine programmatically whether it is a system family or not in the C# Revit API?\n\n**Answer:** I would try to use a combination of the `IsEditable` and `IsInPlace` properties.\n`IsEditable` will let you know if the family can be saved, which means it isn't a system family.\nIt would however return a false positive for in-place families.\n`IsInPlace` will cover the in-place families:\n\n- [IsEditable](https://www.revitapidocs.com/2024/d7d3ef05-d2bd-b770-47df-96b7fd280f9f.htm)\n- [IsInPlace](https://www.revitapidocs.com/2024/eb138fd5-6092-5257-e6e1-073013cb8582.htm)\n\n**Question:**  A meaningful related question:\nGiven an `ElementType`, does it specify a system family or a real, user-defined RFA-based family?\n\n**Answer:** To answer that, you can try to cast it to a `FamilySymbol`.\nIf that fails, it refers to a system family.\nIf it succeeds, you can read the `Family` property, which is a `Family` object that you can interrogate further for in-place, editability, etc.\n\nThank you for that, Jacob and Ivan."
  },
  {
    "original_filename": "2007_sys_fam_py_section",
    "header_text": "Level-Based Family Template",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Level-Based Family Template\n\nIn another family-related discussion\non [custom family type built-in parameters](https://forums.autodesk.com/t5/revit-api-forum/custom-family-type-builtin-parameters/m-p/12203945),\nRichard [RPThomas108](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/1035859) Thomas\nexplains the need to use the appropriate family definition template in order to obtain the built-in properties required to attach to bottom and top levels, for instance.\nTo create structural columns, you need to use the *Metric Structural Column* (or its imperial equivalent).\nSimilarly, to create a structural framing family, you should use the *Metric Structural Framing - Beams and Braces* (or imperial equivalent).\nIn detail:\n\n**Question:** I am using Revit API 2023 to create a family.\nThe family is getting created just fine.\nThen I load that family and create a `FamilyInstance` of type `StructuralColumn` and `StructuralFraming`.\nSo far, so good.\n\nThe problem I am facing is when I try to set the offset related parameters, e.g., `FAMILY_TOP_LEVEL_OFFSET_PARAM` and `FAMILY_BASE_LEVEL_OFFSET_PARAM`.\nThese are null when I try to retrieve them via `get_Parameter`.\n\nThese are not custom parameters, but built-in.\nI read that [I can't create a built-in parameter because it is built-in](https://forums.autodesk.com/t5/revit-api-forum/add-built-in-parameter-to-family/td-p/10674669).\nIt talks about adding them to an existing family and the answer is NO, we can't.\nBut I want to know if I can add them to a newly created family through API.\n\n**Answer:** You can only change the values of a built-in parameter, not add it to a family; they either exist or they don't, depending on the category.\n\nI tend to use\n\n- FAMILY_BASE_LEVEL_PARAM\n- FAMILY_TOP_LEVEL_PARAM\n\nThey are not read-only:\n\n<center>\n<img src=\"img/column_family_level_4.png\" alt=\"Column family properties\" title=\"Column family properties\" width=\"650\"/>\n<p style=\"font-size: 80%; font-style:italic\">FAMILY_TOP_LEVEL_PARAM</p>\n<br/>\n<img src=\"img/column_family_level_5.png\" alt=\"Column family properties\" title=\"Column family properties\" width=\"650\"/>\n<p style=\"font-size: 80%; font-style:italic\">FAMILY_BASE_LEVEL_PARAM</p>\n</center>\n\nThe associated schedule ones are also not read-only but I would not use those since they were added for schedules.\nIt doesn't make sense to me to use the schedule ones when the intended family ones do exactly the same thing, have existing for longer and were obviously created for that purpose.\n\nFamilies placed on a level such as columns point upwards from that level this is unlike in the UI where the column ends up below the view level you place it on.\nSo, your `toplevel` notation indicates to me that you are setting the bottom of your column onto the top level and also setting the top of the column to that same level after placement.\n\nTo be honest, that should trigger a warning, i.e., the top and bottom level can't be the same:\n\n<center>\n<img src=\"img/column_family_level_6.png\" alt=\"Column family properties\" title=\"Column family properties\" width=\"650\"/>\n<p style=\"font-size: 80%; font-style:italic\">LevelId</p>\n<br/>\n<img src=\"img/column_family_level_7.png\" alt=\"Column family properties\" title=\"Column family properties\" width=\"450\"/>\n<p style=\"font-size: 80%; font-style:italic\">Level constraints</p>\n</center>\n\n**Response:**  I tried to use the FAMILY_BASE_LEVEL_PARAM and FAMILY_TOP_LEVEL_PARAM in my case but they are coming as null.\nThen I tried to use the inbuilt families in Revit and for them these parameters are coming as not null.\nAs a next step I tried to see the Revit SDK sample code from GenericModelCreation to create the custom family and used that family in my code but for that as well these parameters FAMILY_BASE_LEVEL_PARAM etc. are coming as null.\nI believe that something is missing from the family creation code which is controlling which built-in parameters should be present in the instance.\n\n**Answer:** If you are using the generic model template to create your column family, then that isn't going to add those built-in parameters, even if you set the category.\n\nThat is the same as the UI.\n\nTo create structural columns, you need to use the *Metric Structural Column* (or imperial equivalent).\nSimilarly, to create a structural framing family you should use *Metric Structural Framing - Beams and Braces* (or imperial equivalent).\nYou should have an imperial and metric version of all your templates/content in reality (likewise versions with localised parameter names if you are localising).\n\nSo, the problem is easier than you think, i.e., if you don't see the built-in parameters in your family (when placed in the project) then you are using the wrong family template to create the family.\n\nOne of the most confusing things when people first interact with the Revit family environment is due to the incorrect assumption that any type of element functionality can come from the same RFT or RFA file.\nIn reality, the content of those templates is hard-coded to suit a certain purpose and you can't change it to match another template type.\nIn that respect it is a bit different to other programs where they would perhaps use a different file extension to note different template types.\n\n**Response:** Thanks for the advice.\nI have now integrated the structural column template and it is giving me non-null parameters for top and base levels.\nI am at least able to move it ahead.\n\nMany thanks to Richard for all his help."
  },
  {
    "original_filename": "2007_sys_fam_py_section",
    "header_text": "Create Section View in Python",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Create Section View in Python\n\nPieter Lamoen raised and solved a question on how\nto [create section with Revit API and Python](https://forums.autodesk.com/t5/revit-api-forum/create-section-with-revit-api-python/m-p/12211534)\nthat creates and orients a section looking at a window from the outside:\n\n**Question:** I'm trying to create a section with Python.\nCreating the section is easy.\nIs there a simple way to change the orientation?\nBy default, the section looks down; I would like it to look forward, like a normal section, e.g., `XYZ(0,1,0)`.\nHow can I achieve this?\nI only know Python and no C#.\n\n**Answer:** I love Python. C# is also very nice.\nMost of my Revit API samples are in C#.\nThe Building Coder includes a whole topic group\non [articles on how to set up section views](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.38).\n\n**Response:**  First of all, thanks for all the sample code!\nI came up with the idea to use ChatGPT to translate your code to Python and then changed it to fit my needs.\nMy code now creates a section that looks at a window from the outside.\nThis code gets the job done:\n\n<pre class=\"prettyprint\">\ndef raamstaat_sections(window):\n  # find window dimensions, center and host(wall)\n  window_bb = window.get_BoundingBox(doc.ActiveView)\n  window_center = (window_bb.Min + window_bb.Max)/2\n  window_width = window.LookupParameter(\"Width\").AsDouble()\n  window_height = window.LookupParameter(\"Height\").AsDouble()\n  window_sill_height = window.LookupParameter(\"Sill Height\").AsDouble()\n  host = window.Host\n\n  # vectors for view direction\n  wall_ext = host.Orientation\n  wall_direction = XYZ(wall_ext.Y, -wall_ext.X, wall_ext.Z)\n  up_direction = XYZ.BasisZ\n  wall_int = XYZ(-wall_ext.X, -wall_ext.Y, wall_ext.Z)\n\n  ### BOUNDING BOX FOR ELEVATION\n  # Calculate the bounding box\n  min_point_elev = XYZ((-window_width/2) - 500/304.8, (-window_height/2) - window_sill_height - 750/304.8, -1000/304.8)\n  max_point_elev = XYZ((window_width/2) + 500/304.8, (window_height/2) + 1000/304.8, 0)\n\n  # create 'rotated' bounding box\n  rotation_transform_elev = Transform.Identity\n  rotation_transform_elev.Origin = window_center\n  rotation_transform_elev.BasisX = wall_direction\n  rotation_transform_elev.BasisY = up_direction\n  rotation_transform_elev.BasisZ = wall_int\n\n  rotated_bounding_box_elev = BoundingBoxXYZ()\n  rotated_bounding_box_elev.Transform = rotation_transform_elev\n  rotated_bounding_box_elev.Min = min_point_elev\n  rotated_bounding_box_elev.Max = max_point_elev\n\n  ### CREATE SECTION\n  # create sections, change name, apply view template\n  t = Transaction(doc, \"create section\")\n  t.Start()\n\n  type = window.LookupParameter(\"S3A_Type\").AsString()\n  #elevation\n  newViewElev = ViewSection.CreateSection(doc, SectionTypes[1].Id, rotated_bounding_box_elev)\n  newViewElev.Name = type + \" - aanzicht TEST\"\n  newViewElev.ViewTemplateId = templateS.Id\n\n  t.Commit()\n</pre>\n\n**Answer:** Great!\nCongratulations!\nThank you for the interesting point that ChatGPT was useful in translating the code.\n\nMany thanks to Pieter for raising this and sharing his nice solution and coding approach."
  }
][
  {
    "original_filename": "2008_rdbe_elem_diff",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- compare element\n  Chuong Ho\n  It's been a while since our last Revit Add-in manager update, but we've got some exciting news to share today!\n  I thrilled to introduce a new tool that's now part of the Add-in manager. This tool is a game-changer for both developers and users as it allows you to easily compare differences between two elements. Not only that, but it also uses color to visually highlight all parameter variations, making it incredibly intuitive and user-friendly. Plus, you can view the similarity results of value comparisons between parameters from those two elements\n  Stay tuned for more updates and get ready to experience a whole new level of efficiency with our latest addition to the Revit Add-in manager!\"\n  Open Source : https://github.com/chuongmep/RevitAddInManager\n  Documentation : [How to use Compare Parameter Element](https://github.com/chuongmep/RevitAddInManager/wiki/How-to-use-Compare-Parameter-Element)\n  #OpenSource #addinmanager #bim #autodesk #revitapi\n  /Users/jta/a/doc/revit/tbc/git/a/img/ch_compare_element.png\n\n- Revit database explorer (RDBE)\n  https://github.com/NeVeSpl/RevitDBExplorer\n  mentioned last year\n  https://thebuildingcoder.typepad.com/blog/2022/07/immutable-uniqueid-and-revit-database-explorer.html#3\n  The fastest, most advanced, asynchronous Revit database exploration tool for Revit 2021+.**\n  Yet another [RevitLookup](https://github.com/jeremytammik/RevitLookup) like tool. RevitLookup was an indispensable tool to work with Revit API for many years. But now, there is a better tool for the job. Let me introduce you to RDBE and its capabilities. RDBE not only allows us to explore database in a more efficient way thanks to querying, but also to modify Revit database through ad hoc scripts written in C#.\n  - [query Revit database](#query-revit-database-with-rdq-revit-database-querying)\n  - [script Revit database](#script-revit-database-with-rds-revit-database-scripting)\n    - [ad hoc SELECT query](#ad-hoc-select-query)\n    - [ad hoc UPDATE command](#ad-hoc-update-command)\n  - [filterable tree of elements and list of properties and methods](#filterable-tree-of-elements-and-list-of-properties-and-methods)\n  - [easy access to Revit API documentation](#easy-access-to-revit-api-documentation)\n  - [edit parameter value](#edit-parameter-value)\n  - [extensive support for ForgeTypeId](#extensive-support-for-forgetypeid)\n  - [better support for Revit Extensible Storage](#better-support-for-revit-extensible-storage)\n  - [easier work with Element.Geometry](#easier-work-with-elementgeometry)\n  - [dark and light UI themes](#dark-and-light-ui-themes)\n  - [more advanced tree view](#more-advanced-tree-view)\n  - [snoop Revit events](#snoop-revit-events-with-rem-revit-event-monitor)\n  - [snoop updaters](#snoop-updaters)\n  You can always use an alternative tool that offers access to Extensible Storage Scheme. (:\n  https://github.com/NeVeSpl/RevitDBExplorer#better-support-for-revit-extensible-storage\n\n- Python 2D Geometry Library\n  https://forums.autodesk.com/t5/revit-api-forum/gbxml-from-adjacent-conceptual-mass-adjacent-space-missing-small/m-p/12238726#M74138\n  shapely\n  Manipulation and analysis of geometric objects in the Cartesian plane.\n  https://pypi.org/project/shapely/\n  https://pypi.org/project/xgbxml/\n  https://shapely.readthedocs.io/en/stable/set_operations.html\n\n- Dan North & Associates discuss measuring developer productivity, describing\n  [The Worst Programmer I Know](https://dannorth.net/2023/09/02/the-worst-programmer/):\n  > Measure productivity by all means...\n  Just don’t try to measure the individual contribution of a unit in a complex adaptive system...\n\ntwitter:\n\nExciting new and enhanced tools and libraries to check out: Revit element difference comparison, database explorer RDBE and the Shapely Python 2D geometry library in the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/elementdiff\n\nExciting new and enhanced tools and libraries to check out\n&ndash; Revit element difference comparison\n&ndash; The Revit database explorer RDBE\n&ndash; The Shapely Python 2D geometry library\n&ndash; Measuring developer productivity...\n\nlinkedin:\n\nExciting new and enhanced tools and libraries to check out: Revit element difference comparison, database explorer RDBE and the Shapely Python 2D geometry library in the #RevitAPI\n\nhttps://autode.sk/elementdiff\n\n- Revit element difference comparison\n- The Revit database explorer RDBE\n- The Shapely Python 2D geometry library\n- Measuring developer productivity...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2008_rdbe_elem_diff",
    "header_text": "Element Diff Compare, Shapely and RDBE",
    "local_header_href": "#element-diff-compare-shapely-and-rdbe",
    "chunk_text": "### Element Diff Compare, Shapely and RDBE\n\nExciting new and enhanced tools and libraries to check out:\n\n- [Revit element difference comparison](#2)\n- [The Revit database explorer RDBE](#3)\n- [The Shapely Python 2D geometry library](#4)\n- [Shapely finds and fixes a hole](#4.1)\n- [Measuring developer productivity](#5)"
  },
  {
    "original_filename": "2008_rdbe_elem_diff",
    "header_text": "Revit Element Difference Comparison",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Revit Element Difference Comparison\n\nChuong Ho announces new functionality enabling highlighting and comparison of differences between Revit database elements in his alternative Revit Add-in Manager:\n\n> It's been a while since our last Revit Add-in manager update, but we've got some exciting news to share today!\n\n> I'm thrilled to introduce a new tool that's now part of the Add-in Manager.\nThis tool is a game-changer for both developers and users as it allows you to easily compare differences between two elements.\nNot only that, but it also uses colour to visually highlight all parameter variations, making it incredibly intuitive and user-friendly.\nPlus, you can view the similarity results of value comparisons between parameters from two elements.\nStay tuned for more updates and get ready to experience a whole new level of efficiency with our latest addition to the Revit Add-in manager!\n\n- [Open source](https://github.com/chuongmep/RevitAddInManager)\n- Documentation on [how to use Compare Parameter Element](https://github.com/chuongmep/RevitAddInManager/wiki/How-to-use-Compare-Parameter-Element)\n\n<center>\n<img src=\"img/ch_compare_element.png\" alt=\"Compare Element\" title=\"Compare Element\" width=\"670\"/> <!-- Pixel Height: 588 Pixel Width: 1,336 -->\n</center>"
  },
  {
    "original_filename": "2008_rdbe_elem_diff",
    "header_text": "The Revit Database Explorer RDBE",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> The Revit Database Explorer RDBE\n\nWe already [mentioned](https://thebuildingcoder.typepad.com/blog/2022/07/immutable-uniqueid-and-revit-database-explorer.html#3)\nthe [Revit database explorer RDBE](https://github.com/NeVeSpl/RevitDBExplorer) last year:\n\n> The fastest, most advanced, asynchronous Revit database exploration tool for Revit 2021+.\nYet another [RevitLookup](https://github.com/jeremytammik/RevitLookup)-like tool.\nRevitLookup was indispensable to work with Revit API for many years.\nNow, there is a better tool for the job.\nLet me introduce RDBE and its capabilities.\nRDBE not only allows us to explore database in a more efficient way thanks to querying, but also to modify Revit database through ad-hoc scripts written in C#.\n\nIt has undergone further enhancement since then.\n\n[NeVeS](https://github.com/NeVeSpl) points out that you can use this alternative Revit database exploration tool for better access to Extensible Storage Schemata, cf. RDBE's extensive list of features:\n\n- [Query Revit database](#query-revit-database-with-rdq-revit-database-querying)\n- [Script Revit database](#script-revit-database-with-rds-revit-database-scripting)\n- [Ad-hoc `SELECT` query](#ad-hoc-select-query)\n- [Ad-hoc `UPDATE` command](#ad-hoc-update-command)\n- [Filterable tree of elements and list of properties and methods](#filterable-tree-of-elements-and-list-of-properties-and-methods)\n- [Easy access to Revit API documentation](#easy-access-to-revit-api-documentation)\n- [Edit parameter value](#edit-parameter-value)\n- [Extensive support for ForgeTypeId](#extensive-support-for-forgetypeid)\n- [Better support for Revit Extensible Storage](#better-support-for-revit-extensible-storage)\n- [Easier work with `Element.Geometry`](#easier-work-with-elementgeometry)\n- [Dark and light UI themes](#dark-and-light-ui-themes)\n- [More advanced tree view](#more-advanced-tree-view)\n- [Snoop Revit events](#snoop-revit-events-with-rem-revit-event-monitor)\n- [Snoop updaters](#snoop-updaters)"
  },
  {
    "original_filename": "2008_rdbe_elem_diff",
    "header_text": "The Shapely Python 2D Geometry Library",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> The Shapely Python 2D Geometry Library\n\nJake of [Ripcord Engineering](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/3926242) recently\nshared a bunch of valuable [Python and gbXML tips](https://thebuildingcoder.typepad.com/blog/2023/07/export-gbxml-and-python-tips.html).\nDiscussing a solution\nto [gbXML from adjacent conceptual mass or space missing small surface](https://forums.autodesk.com/t5/revit-api-forum/gbxml-from-adjacent-conceptual-mass-adjacent-space-missing-small/m-p/12238726),\nhe now added a pointer\nto [Shapely](https://pypi.org/project/shapely/),\na powerful-looking Python 2D geometry library for manipulation and analysis of geometric objects in the Cartesian plane.\nFor instance, it includes support for 2D Booleans\nand [set operations](https://shapely.readthedocs.io/en/stable/set_operations.html).\nIn this context, the Python [xgbxml library](https://pypi.org/project/xgbxml/) looks\nlike another very handy tool.\n\n####<a name=\"4.1\"></a> Shapely Finds and Fixes a Hole\n\nJake added: I'm happy to report [Shapely](https://shapely.readthedocs.io/en/stable/index.html) was\nable to find a missing 'small' surface (hole) in the 'Mass' demo file attached\nto [this thread](https://forums.autodesk.com/t5/revit-api-forum/gbxml-from-adjacent-conceptual-mass-adjacent-space-missing-small/m-p/12253611). To find XY plane holes:\n\n- Make Space surface polygons\n  with [shapely.Polygon](https://shapely.readthedocs.io/en/stable/reference/shapely.Polygon.html#shapely.Polygon)\n- Make Space polygons from Space surface polygons\n  with [shapely.union_all](https://shapely.readthedocs.io/en/stable/reference/shapely.union_all.html#shapely.union_all)\n- Make Level surface polygons from Space polygons\n  with [shapely.union_all](https://shapely.readthedocs.io/en/stable/reference/shapely.union_all.html#shapely.union_all)\n- Ask shapely for\n  the ['interiors' attribute](https://shapely.readthedocs.io/en/stable/reference/shapely.Polygon.html#shapely.Polygon) for\n  a sequence of rings which bound all existing holes in Level surface polygons.\n\nNext step is to correlate holes with Spaces.\nThis is the trickier part in my opinion.\nGoing in plan is to use polygons as defined by Space wall outlines as truth data.\nNot sure how this will mesh with current Ripcord Engineering gbxml workflow.\nTime will tell.\n\nMany thanks to Jake for the great pointer and nice example."
  },
  {
    "original_filename": "2008_rdbe_elem_diff",
    "header_text": "Measuring Developer Productivity",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Measuring Developer Productivity\n\nDealing with programming teams in general, Dan North and Associates share some insights on how to measure developer productivity,\ndescribing [the worst programmer I know](https://dannorth.net/2023/09/02/the-worst-programmer/):\n\n> ... Measure productivity by all means...\nJust don’t try to measure the individual contribution of a unit in a complex adaptive system..."
  }
][
  {
    "original_filename": "2009_optionsbar",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- OptionsBar\n  From: Роман\n  Hi Jeremy) I'm back from holiday, and I've written a new article. I think it can be published on the blog, many people will be interested in it.\n  Link to the post on LinkedIn: https://www.linkedin.com/feed/update/urn:li:activity:7109513543590289409\n  GitHub article: https://github.com/atomatiq/OptionsBar/blob/master/Readme.md\n  Raman Karpovich\n  Lead Developer\n  http://www.atomatiq.io\n  +48 517 989 812\n  ATOMATIQ SP ZOO. ul. Zygmunta Vogla, 28, lok. 02.63, 02-963 Warsaw, Poland. NIP: 9512571785\n\n- Lijuan Zhu: engines below will be REMOVED on 10/30/2023\n  https://autodesk.slack.com/archives/C011QHANM8R/p1695262865665989\n\ntwitter:\n\nA reminder of the deprecated @AutodeskAPS DA4R 2018 engine and a great new open-source #RevitAPI productivity enhancement tool using the @AutodeskRevit OptionsBar for frequently used info, utilities, element selection options etc. #BIM @DynamoBIM https://autode.sk/optionsbar\n\nA great new open-source productivity enhancement tool making use of the built-in @AutodeskRevit OptionsBar provides handy access to frequently used information, utilities, element selection options and more, and a reminder of the deprecated @AutodeskAPS DA4R Revit 2018 engine with the #RevitAPI #BIM @DynamoBIM https://autode.sk/optionsbar\n\nA great new open-source productivity enhancement tool making use of the built-in OptionsBar provides handy access to frequently used information, utilities, element selection options and more, and a reminder of the deprecated DA4R Revit 2018 engine...\n\nlinkedin:\n\nA reminder of the deprecated #AutodeskAPS DA4R 2018 engine and a great new open-source #Revit #API productivity enhancement tool using the #Autodesk OptionsBar for frequently used info, utilities, element selection options etc.\n\nhttps://autode.sk/optionsbar\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2009_optionsbar",
    "header_text": "OptionsBar and Bye Bye to DA4R 2018",
    "local_header_href": "#optionsbar-and-bye-bye-to-da4r-2018",
    "chunk_text": "### OptionsBar and Bye Bye to DA4R 2018\n\nA great new open-source productivity enhancement tool and a reminder of the deprecated DA4R Revit engine:\n\n- [Open-source OptionsBar](#2)\n    - [Introduction](#2.1)\n    - [Configuring OptionsBar step by step](#2.2.0)\n    - [Use case 1: utilities](#2.3.1)\n    - [Use case 2: element selection options](#2.3.2)\n    - [Use case 3: marquee](#2.3.3)\n    - [Conclusion](#2.4)\n- [Bye bye DA4R 2018](#3)\n- [Method Draw online SVG editor](#4)"
  },
  {
    "original_filename": "2009_optionsbar",
    "header_text": "Open-Source OptionsBar",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Open-Source OptionsBar\n\nRaman Karpovich, aka Роман Карпович, is sharing a great new open-source Revit user interface enhancement enabling programmatic use of the options bar:\n\n- [Post on LinkedIn](https://www.linkedin.com/feed/update/urn:li:activity:7109513543590289409)\n- [GitHub article](https://github.com/atomatiq/OptionsBar/blob/master/Readme.md)\n- [GitHub repository](https://github.com/atomatiq/OptionsBar/)\n- Installers with examples in [Releases](https://github.com/atomatiq/OptionsBar/releases)\n\nEnhance the user experience and boost Revit efficiency with `OptionsBar`, a powerful tool to enhance your workflow;\n`OptionsBar` implements a convenient toolbar simplifying the addition of custom tools, options, extra functionality and information to the Revit UI:\n\n- Add custom tools to the ribbon.\n- Fine-tune model element parameters in real-time.\n- Streamline the process of selecting elements in your model.\n- Create unique user interfaces for Revit.\n\n####<a name=\"2.1\"></a> Introduction to OptionsBar\n\n[Revit](https://www.autodesk.com/products/revit/overview) is a powerful tool for building design and modelling, and undoubtedly, high efficiency in working with this software is a key aspect for successful projects.\nOne of the tools that contributes to this efficiency is\nthe [OptionsBar](https://help.autodesk.com/view/RVT/2024/ENU/?guid=GUID-28BDE98C-E8A9-4C74-8ABC-9DABD13163D9).\nThis convenient toolbar within Revit has tremendous potential, but not many people are aware of its capabilities and how to configure it.\n\nIt offers capabilities that span from adding your own tools on the toolbar to displaying information about the operation of your own add-ins.\nHowever, the Revit API documentation doesn't offer sufficient information on fully harnessing the potential of OptionsBar.\n\nBefore we begin customizing the OptionsBar, we'll need to add the necessary dependencies and create a controller to manage this panel.\n\nTechnologies Used:\n\n- Language: C#\n- UI framework: WPF\n\n####<a name=\"2.2.0\"></a> Configuring OptionsBar Step by Step\n\nLet's delve into the process of configuring OptionsBar and how to do it most efficiently.\n\n####<a name=\"2.2.1\"></a> Step 1: Adding Dependencies\n\nUnderstanding that the user interface in Revit is implemented using WPF (Windows Presentation Foundation) technology helps us access all the interface elements.\nFor this, we'll need the `AdWindows.dll` library, which comes with Revit.\n\nTo compile the project on any device, let's add a NuGet package to the `.csproj` project file as follows:\n\n<pre class=\"prettyprint lang-xml\">\n&lt;ItemGroup&gt;\n  &lt;PackageReference Include=\"Nice3point.Revit.Api.AdWindows\" Version=\"$(RevitVersion).*\"/&gt;\n&lt;/ItemGroup&gt;\n</pre>\n\n####<a name=\"2.2.2\"></a> Step 2: Creating a Controller\n\nTo control OptionsBar, we'll need a controller that handles its display and hiding.\nTo access the Revit ribbon and OptionsBar, we'll use the static property `ComponentManager.Ribbon` from the `AdWindows.dll` library that we included in the previous step.\n\nThe process of configuring OptionsBar can be divided into the following stages:\n\n1. Finding the built-in panel.\n2. Creating a custom panel.\n3. Hiding/showing the built-in and custom panels.\n\nIt's important to note that we don't remove or replace the built-in OptionsBar panel to avoid disrupting Revit's functionality.\nInstead, we simply hide it and display our custom panel when necessary.\n\nLet's take a look at a code example that allows displaying and hiding the custom panel:\n\n<pre class=\"prettyprint lang-cs\">\npublic static class RibbonController\n{\n  private static readonly Grid RootGrid;\n  private static ContentPresenter _panelPresenter;\n  private static readonly FrameworkElement InternalToolPanel;\n\n  static RibbonController()\n  {\n    RootGrid = VisualUtils.FindVisualParent&lt;Grid&gt;(ComponentManager.Ribbon, \"rootGrid\");\n    if (RootGrid is null) throw new InvalidOperationException(\"Cannot find root grid in Revit UI\");\n\n    InternalToolPanel = VisualUtils.FindVisualChild&lt;DialogBarControl&gt;(RootGrid, string.Empty);\n    if (InternalToolPanel is null) throw new InvalidOperationException(\"Cannot find internal tool panel in Revit UI\");\n  }\n\n  public static void ShowOptionsBar(FrameworkElement content)\n  {\n    if (_panelPresenter is not null)\n    {\n      _panelPresenter.Content = content;\n      _panelPresenter.Visibility = Visibility.Visible;\n      InternalToolPanel.Height = 0;\n      return;\n    }\n\n    _panelPresenter = CreateOptionsBar();\n    _panelPresenter.Content = content;\n\n    InternalToolPanel.Height = 0;\n  }\n\n  public static void HideOptionsBar()\n  {\n    if (_panelPresenter is null) return;\n\n    _panelPresenter.Content = null;\n    _panelPresenter.Visibility = Visibility.Collapsed;\n\n    InternalToolPanel.Height = 26;\n  }\n\n  private static ContentPresenter CreateOptionsBar()\n  {\n    const int panelRow = 2;\n\n    RootGrid.RowDefinitions.Insert(2, new RowDefinition\n    {\n      Height = new GridLength(1, GridUnitType.Auto)\n    });\n\n    foreach (UIElement child in RootGrid.Children)\n    {\n      var row = Grid.GetRow(child);\n      if (row &gt; 1) Grid.SetRow(child, row + 1);\n    }\n\n    var panelPresenter = new ContentPresenter();\n    Grid.SetRow(panelPresenter, panelRow);\n    RootGrid.Children.Add(panelPresenter);\n\n    return panelPresenter;\n  }\n}\n</pre>\n\nIn the example, only public properties of the Revit API and system methods of WPF are used.\nInteraction with the ribbon is implemented with the `ShowOptionsBar()` and `HideOptionsBar()` methods.\nThe `ShowOptionsBar()` method takes any FrameworkElement, which will be displayed to the user.\n\n####<a name=\"2.2.3\"></a> Step 3: Creating a User Interface\n\nTo create a user interface for OptionsBar, we'll use the MVVM (Model-View-ViewModel) pattern and the WPF (Windows Presentation Foundation) framework.\n\nFor example, let's consider a simple panel layout with a text field and a dropdown list:\n\n<center>\n<!-- https://github.com/Nice3point/OptionsBar/assets/20504884/3932ef5f-82e0-4b59-bc61-b95aef6199c8 -->\n<img src=\"img/rk_optionsbar_2.jpg\" alt=\"OptionsBar\" title=\"OptionsBar\" width=\"600\"/>\n</center>\n\n<pre class=\"prettyprint lang-xml\">\n&lt;StackPanel\n    x:Class=\"OptionsBar.Views.OptionsView\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:viewModels=\"clr-namespace:OptionsBar.ViewModels\"\n    d:DataContext=\"{d:DesignInstance Type=viewModels:OptionsViewModel}\"\n    mc:Ignorable=\"d\"\n    Background=\"#FFE5F0D7\"\n    Orientation=\"Horizontal\"\n    Height=\"26\"\n    d:DesignWidth=\"430\"&gt;\n  &lt;TextBlock\n    Margin=\"10 0 0 0\"\n    Text=\"Wall options\"\n    VerticalAlignment=\"Center\" /&gt;\n  &lt;Border\n    Width=\"3\"\n    BorderThickness=\"1 0\"\n    BorderBrush=\"Azure\"\n    Background=\"Gray\"\n    Margin=\"10 0\" /&gt;\n  &lt;TextBlock\n    Text=\"Offset: \"\n    VerticalAlignment=\"Center\" /&gt;\n  &lt;TextBox\n    Width=\"100\"\n    Margin=\"10 1 0 1\"\n    VerticalContentAlignment=\"Center\"\n    Text=\"{Binding Offset, UpdateSourceTrigger=PropertyChanged}\" /&gt;\n  &lt;TextBlock\n    Text=\"Constraint: \"\n    Margin=\"10 0 0 0\"\n    VerticalAlignment=\"Center\" /&gt;\n  &lt;ComboBox\n    Width=\"100\"\n    Margin=\"10 1 0 1\"\n    VerticalContentAlignment=\"Center\"\n    SelectedIndex=\"0\"\n    ItemsSource=\"{Binding Constraints}\" /&gt;\n&lt;/StackPanel&gt;\n</pre>\n\nSample code for the ViewModel:\n\n<pre class=\"prettyprint lang-cs\">\npublic partial class OptionsViewModel : ObservableObject\n{\n  [ObservableProperty] private double _offset;\n  [ObservableProperty] private string[] _constraints;\n}\n</pre>\n\nThe layout is no different from regular WPF applications, but the root element will be a container like StackPanel, Grid, and so on, since OptionBar is embedded in the Revit UI.\n\n####<a name=\"2.3\"></a> Use Cases\n\nOptionsBar provides endless possibilities for streamlining the workflow in Revit.\nLet's explore some of the most popular use cases:\n\n####<a name=\"2.3.1\"></a> Use Case 1: Utilities\n\nOptionsBar can be used to add custom tools that can be conveniently placed on the toolbar.\nThis is especially useful when creating a separate window is unnecessary.\n\n<center>\n<!-- https://github.com/Nice3point/OptionsBar/assets/20504884/3932ef5f-82e0-4b59-bc61-b95aef6199c8 -->\n<img src=\"img/rk_optionsbar_3.jpg\" alt=\"OptionsBar\" title=\"OptionsBar\" width=\"600\"/>\n</center>\n\n####<a name=\"2.3.2\"></a> Use Case 2: Element Selection Options\n\nThis scenario covers situations where a user is working with a model in Revit and needs to select a specific element for further editing.\nFor more convenient and intuitive parameter customization, you can use OptionsBar instead of creating additional windows.\n\nExample: Suppose you have a plugin that allows users to adjust the top offset of a wall. Let's see how to arrange all the tools on the OptionsBar panel.\n\n<center>\n<!-- https://github.com/Nice3point/OptionsBar/assets/20504884/65a508ce-2f9c-414d-80b3-f996b5e679d6 -->\n<img src=\"img/rk_optionsbar_4.jpg\" alt=\"OptionsBar\" title=\"OptionsBar\" width=\"600\"/>\n</center>\n\n- Step 1: Adding OptionsBar to the Revit Ribbon\n\n  The first step in this scenario is to set up OptionsBar for display on the Revit ribbon.\n  You can create your own view for OptionsBar with parameters that the user can customize.\n\n  Example code using the MVVM pattern:\n\n<pre class=\"prettyprint lang-cs\">\n  private OptionsViewModel SetupOptionsBar()\n  {\n    var options = new OptionsViewModel\n    {\n      Offset = 0,\n      Constraints = Document.EnumerateInstances&lt;Level&gt;(BuiltInCategory.OST_Levels).Select(level => level.Name).ToArray()\n    };\n\n    var view = new OptionsView(options);\n    RibbonController.ShowOptionsBar(view);\n    return options;\n  }\n</pre>\n\n- Step 2: Selecting an Element\n\n  After configuring OptionsBar, the user selects an element in the model with which they want to work.\n  This could be, for example, selecting a wall to adjust the offset.\n\n  Example code for element selection:\n\n<pre class=\"prettyprint lang-cs\">\n  private Wall PickWall()\n  {\n    var selectionConfiguration = new SelectionConfiguration().Allow.Element(selection => selection is Wall);\n    var reference = UiDocument.Selection.PickObject(ObjectType.Element, selectionConfiguration.Filter, \"Select wall\");\n    return reference.ElementId.ToElement&lt;Wall&gt;(Document);\n  }\n</pre>\n\n- Step 3: Adjusting Element Parameters\n\n  Now that the user has selected an element and OptionsBar is configured, you can start adjusting the element's parameters.\n  We'll take the offset value from the ViewModel entered by the user and set it to the wall parameter.\n\n  Example code for adjusting element parameters:\n\n<pre class=\"prettyprint lang-cs\">\n  private void ModifyWall(Wall wall, OptionsViewModel options)\n  {\n    using var transaction = new Transaction(Document);\n    transaction.Start(\"Set offset\");\n    wall.GetParameter(BuiltInParameter.WALL_TOP_OFFSET)!.Set(options.Offset);\n    transaction.Commit();\n  }\n</pre>\n\n- Step 4: Restoring the Revit Ribbon\n\n  After completing the element parameter configuration, it's important to hide OptionsBar and restore the normal state of the Revit ribbon.\n  To do this, add a `finally` block after calling all the methods.\n\n<pre class=\"prettyprint lang-cs\">\n  public override void Execute()\n  {\n    try\n    {\n      var options = SetupOptionsBar();\n      var wall = PickWall();\n      ModifyWall(wall, options);\n    }\n    catch (OperationCanceledException)\n    {\n      // ignored\n    }\n    finally\n    {\n      RibbonController.HideOptionsBar();\n    }\n  }\n</pre>\n\n  This scenario allows users to quickly and conveniently customize the parameters of model elements without the need to open additional windows or perform extra actions.\n  OptionsBar makes the process of editing elements more intuitive and efficient.\n\n####<a name=\"2.3.3\"></a> Use Case 3: Marquee\n\nWant something unusual? A marquee can add excitement to your mundane modeling routine.\n\n<center>\n<!-- https://github.com/Nice3point/OptionsBar/assets/20504884/9427569b-1cce-41c8-a1f5-e88bea4c8683 -->\n<img src=\"img/rk_optionsbar_5.gif\" alt=\"OptionsBar\" title=\"OptionsBar\" width=\"600\"/>\n</center>\n\n####<a name=\"2.4\"></a> Conclusion\n\nOptionsBar is a powerful tool in Revit that allows you to optimize your workflow and make it more efficient.\nDon't limit yourself to the described use cases — experiment, create your unique solutions, and make working in Revit even more productive."
  },
  {
    "original_filename": "2009_optionsbar",
    "header_text": "Bye Bye DA4R 2018",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Bye Bye DA4R 2018\n\nThe Autodesk Platform Services APS consists of several distinct components working together.\n\nOne of them is the viewer, which works with a streamlined generic optimised viewing data format, stripped of much of the original information such as constraints and detailed domain-specific information present in the seed CAD files generated by model authoring tools such as AutoCAD, Inventor and Revit.\n\nAnother important component is the Design Automation API DA that enables processing, generation and manipulation of the seed CAD files using so-called engines running on virtual machines in the cloud.\n\nHere is a quick reminder that the following engines will be REMOVED on October 30, 2023:\n\n- Autodesk.AutoCAD.20_1\n- Autodesk.AutoCAD.21\n- Autodesk.AutoCAD.22\n- Autodesk.Inventor.2018\n- Autodesk.Inventor.22\n- Autodesk.Revit.2018\n\nFor more information on this, please refer to\nthe [APS Engine Lifecycle Policy](https://aps.autodesk.com/en/docs/design-automation/v3/developers_guide/engine-lifecycle/).\n\nIn general, the following rules apply:\n\n- Engine versions are supported for 4 calendar years after the initial release of the corresponding desktop product.\n- After 4 years, the engine version becomes deprecated, but remains available for an additional 2 years and then removed.\n- A deprecated engine version can no longer be referenced in new appbundles and activities, but all existing references continue to work.\n- All attempts to reference a removed engine version will fail.\n\nSo, in the case of Revit, please take heed if you are still using the Revit 2018 engine in DA4R and update to a more recent version before the end of next month."
  },
  {
    "original_filename": "2009_optionsbar",
    "header_text": "Method Draw Online SVG Editor",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Method Draw Online SVG Editor\n\nI keep looking for a handy online vector editor that enables precise measurement, e.g., for creating a simple 2D work sketch with exact millimetre dimensions for a carpentry project.\n\nI found a new likely candidate now, [Method Draw](https://editor.method.ac):\n\n> [Method Draw](https://editor.method.ac) is a simple <a href=\"https://github.com/methodofaction/Method-Draw\">open source</a> vector drawing application. Method Draw was forked from <a href=\"https://github.com/SVG-Edit/svgedit\">SVG-Edit</a> several years ago with the goal of improving and modernizing the interface.\n\n> At this time (2021), the author (<a href=\"http://method.ac/writing\">Mark MacKay</a>) is working on improving stability and improving the codebase, which contains a lot of legacy practices. The goal is to create a vector editor suitable for simple graphic design tasks.\n\nI'll let you know how I get on with that.\nIf you have a recommendation, please let me know.\nThx!"
  }
][
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Get touching elements\n  https://forums.autodesk.com/t5/revit-api-forum/get-touching-elements/m-p/12223781\n\n- The BIM has No Geometry\n  [Simplify elements geometry](https://forums.autodesk.com/t5/revit-api-forum/simplify-elements-geometry/m-p/12266629)\n  **Question:** I am trying to simfplify the geometry of elements (such as cylinders, shperes, etc.) throgh the API.\n  My first idea was simple:\n  1. Retrieve a mesh from all faces with low quality using face.Triangulate(0);\n  2. Apply the new mesh for element's geometry.\n  However, it does not work. I have seen messages on the forum stating that working with geometry through the API is not allowed. Anyway, I believe that there it should be another approach to tackle this issue. I would appreciate any help.\n  **Answer:** No. There is no way that you can specify Revit element geometry. Please bear in mind that Revit is a BIM authoring tool. The BIM is completely driven by parameters and constraints.\n  There is no geometry in the BIM!\n  The model as you see it (and its geometry) is just a view of the elements, their relationships, parameters and constraints.\n\n- Revit and IFC coordinate systems\n  [Revit, IFC and coordinate systems](https://bim-me-up.com/en/revit-ifc-und-koordinatensysteme/)\n  Lejla Secerbegovic\n  Digital Technology Enthusiast | BIM & Sustainability\n\n- Deepfakes of Chinese influencers are livestreaming 24/7\n  https://www.technologyreview.com/2023/09/19/1079832/chinese-ecommerce-deepfakes-livestream-influencers-ai/\n  > With just a few minutes of sample video and $1,000 in costs, brands can clone a human streamer to work 24/7.\n\n- generative ai use and misuse\n  [How people can create &ndash; and destroy &ndash; value with generative AI](https://www.bcg.com/publications/2023/how-people-create-and-destroy-value-with-gen-ai)\n  Key Takeaways &ndash; A first-of-its-kind scientific experiment finds that people mistrust generative AI in areas where it can contribute tremendous value and trust it too much where the technology isn’t competent:\n  Around 90% of participants improved their performance when using GenAI for creative ideation. People did best when they did not attempt to edit GPT-4’s output.\n  When working on business problem solving, a task outside the tool’s current competence, many participants took GPT-4's misleading output at face value. Their performance was 23% worse than those who didn’t use the tool at all.\n  Adopting generative AI is a massive change management effort. The job of the leader is to help people use the new technology in the right way, for the right tasks and to continually adjust and adapt in the face of GenAI’s ever-expanding frontier.\n\ntwitter:\n\nAspects of BIM geometry: no database geometry stored, retrieving touching elements, cut edges and stable representation of geometry references in the #RevitAPI @AutodeskRevit #BIM @DynamoBIM @AutodeskAPS https://autode.sk/bimgeo\n\nDiscussions of BIM, geometry, pyRevit and AI news\n&ndash; pyRevit discourse\n&ndash; The BIM has no geometry\n&ndash; Get touching elements\n&ndash; What is a stable representation of a reference?\n&ndash; CUT_EDGE reference voodoo\n&ndash; Revit and IFC coordinate systems\n&ndash; Chinese influencer deepfakes livestreaming 24/7\n&ndash; Generative AI use and misuse...\n\nlinkedin:\n\nAspects of BIM geometry: no database geometry stored, retrieving touching elements, cut edges and stable representation of geometry references in the #RevitAPI\n\nhttps://autode.sk/bimgeo\n\nDiscussions of BIM, geometry, pyRevit and AI news:\n\n- pyRevit discourse\n- The BIM has no geometry\n- Get touching elements\n- What is a stable representation of a reference?\n- CUT_EDGE reference voodoo\n- Revit and IFC coordinate systems\n- Chinese influencer deepfakes livestreaming 24/7\n- Generative AI use and misuse...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "No Geometry, Touching Geometry and Cut Geometry",
    "local_header_href": "#no-geometry-touching-geometry-and-cut-geometry",
    "chunk_text": "### No Geometry, Touching Geometry and Cut Geometry\n\nDiscussions of BIM, geometry, pyRevit and AI news:\n\n- [pyRevit discourse](#2)\n- [The BIM has no geometry](#3)\n- [Get touching elements](#4)\n- [What is a stable representation of a reference?](#5)\n- [CUT_EDGE reference voodoo](#6)\n- [Revit and IFC coordinate systems](#7)\n- [Chinese influencer deepfakes livestreaming 24/7](#8)\n- [Generative AI use and misuse](#9)"
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "pyRevit Discourse",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> pyRevit Discourse\n\nI just discovered the recommendation to direct all pyRevit questions to\nthe dedicated [pyRevit discussion forums](https://discourse.pyrevitlabs.io/):\n\n> ... questions related to pyRevit should be routed\nto [discourse.pyrevitlabs.io](https://discourse.pyrevitlabs.io/).\nThis type of question has been formulated or answered in many different ways there;\n[search for subprocess](https://discourse.pyrevitlabs.io/search?q=subprocess)...\n\nThanks to Jean-Marc Couffin of [BIM One Inc](https://bimone.com) for pointing this out in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [CPython and PyRevit](https://forums.autodesk.com/t5/revit-api-forum/cpython-and-pyrevit/m-p/12278795#M74411)."
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "The BIM has No Geometry",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> The BIM has No Geometry\n\nOne fundamental and possibly surprising aspect of the BIM: it has no geometry.\nThis came up in the thread on how\nto [simplify elements geometry](https://forums.autodesk.com/t5/revit-api-forum/simplify-elements-geometry/m-p/12266629):\n\n**Question:** I am trying to simplify the geometry of elements such as cylinders, spheres, etc. through the API.\nMy first idea was simple:\n\n- Retrieve a mesh from all faces with low quality using `face.Triangulate(0)`\n- Apply the new mesh to the element geometry\n\nHowever, it does not work.\nI have seen messages on the forum stating that working with geometry through the API is not allowed.\nAnyway, I believe that there it should be another approach to tackle this issue.\n\n**Answer:** No.\nThere is no way that you can specify Revit element geometry.\nPlease bear in mind that Revit is a BIM authoring tool.\nThe BIM is completely driven by parameters and constraints.\n\nThere is no geometry in the BIM!\n\nThe model as you see it (and its geometry) is just a view of the elements, their relationships, parameters and constraints."
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "Get Touching Elements",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Get Touching Elements\n\nIn spite of that, we keep running into tasks that are intimately involved with the BIM element geometry, such as\nthe [retrieval of cut edges between intersecting elements discussed below](#6) and the following task\nto [get touching elements](https://forums.autodesk.com/t5/revit-api-forum/get-touching-elements/m-p/12223781):\n\n**Question:** I want to get the slabs that are on the edge of a beam as shown in this figure:\n\n<center>\n<img src=\"img/touching_elements.png\" alt=\"Touching elements\" title=\"Touching elements\" width=\"500\"/>\n</center>\n\nHow can I get these slabs?\n`ElementIntersectsElement` and `ElementIntersectsSolid` don't work in this case.\n\n**Answer:** You should be able to use `ElementIntersectsSolid` with a slightly enlarged solid.\n\nIf your beam is aligned with one of the cardinal axes, you could even use a `BoundingBoxIntersectsFilter` instead, which is a quick filter.\nJust make the bounding box a bit bigger than the beam.\n\nIf worst comes to worst, you can also use the `ReferenceIntersector` to shoot rays from the beam to detect the neighbouring slab.\n\nFinally, though, and best of all, 11 years ago, The Building Coder presented a solution\nto [filter for touching beams using solid intersection](https://thebuildingcoder.typepad.com/blog/2012/09/filter-for-touching-beams-using-solid-intersection.html)\n\n**Response:** Thank you, that solution helped a lot.\nI made a solution where I used the location line and some transform functions.\nThen, the `solid.IntersectsWithCurve` method enabled me to retrieve the slabs."
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "What is a Stable Representation of a Reference?",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> What is a Stable Representation of a Reference?\n\nAs mentioned above, the BIM database does store any geometry.\nAnd yet, the BIM annotation contains database elements such as dimensioning that refer to the geometry, and even to geometry sub-elements such as cut edges generated by element intersection.\n\nHow can that be?\n\nWell, the dimensioning requires a reference, and since the reference itself disappears when the geometry is gone, Revit uses the concept of a stable representation of the reference to store information about which reference we mean, even if the geometry is gone,\ncf., e.g., this brief explanation\nof [reference and stable representation](https://thebuildingcoder.typepad.com/blog/2012/05/selecting-a-face-in-a-linked-file.html#1)."
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "CUT_EDGE Reference Voodoo",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> CUT_EDGE Reference Voodoo\n\nJoseph Tenenbaum shares a new application of stable reference magic voodoo in his solution\nto [retrieve `CUT_EDGE` references from walls](https://forums.autodesk.com/t5/revit-api-forum/retrieve-cut-edge-references-from-walls/m-p/12278698):\n\n**Question:** I am trying to get the CUT_EDGE references of a given wall using the API. At the moment I can get part of the references based on the Wall geometry. I first go to the Solids and for each edge of the solid I check if the Reference is of type CUT_EDGE. This works but does not get all the options (I see more when generating a dimension line manually in the UI of Revit).\n\nFor example, I have the wall seen in this image:\n\n<center>\n<img src=\"img/cut_edge_voodoo_2.png\" alt=\"CUT_EDGE reference stable representation\" title=\"CUT_EDGE reference stable representation\" width=\"500\"/> <!-- Pixel Height: 786 Pixel Width: 1,120 -->\n</center>\n\nThe dimension is attached to the following `CUT_EDGE` references:\n\n- 3aecdde0-f1aa-42b2-a208-f740e7a17720-003f7f7f:8:CUT_EDGE/0/1\n- 3aecdde0-f1aa-42b2-a208-f740e7a17720-003f7f7f:8:CUT_EDGE/1/1\n\nBut when I run over all the edges of the wall, I only get the following options:\n\n<center>\n<img src=\"img/cut_edge_voodoo_1.png\" alt=\"CUT_EDGE reference stable representation\" title=\"CUT_EDGE reference stable representation\" width=\"400\"/> <!-- Pixel Height: 253\nPixel Width: 514 -->\n</center>\n\nI tested setting visibility options, detail options, and `IncludeNonVisibleObjects`, but nothing helps.\n\nI think knowing better what the structure of the stable representations mean could help a lot.\n\n**Answer:** Here is my finding that actually worked, for example using the Stable Representation *3aecdde0-f1aa-42b2-a208-f740e7a17720-003f7f7f:8:CUT_EDGE/0/1*.\n\n- 3aecdde0-f1aa-42b2-a208-f740e7a17720-003f7f7f: Refers to the element itself\n- 8: Is the ID of the face of the Revit `Element`\n- CUT_EDGE/0/1: This is the type and location of the Reference. It is CUT_EDGE type,  the `1` means which edge of the face, and the `0` is its end-point index.\n\nMy original findings were correct; I was just missing the index of the end-point of the edge I found. All this is possible to find via the Edges of the Solids that are part of the geometry of an Element.\n\nMany thanks to Joseph for his research and clear explanation!\n\nIt provides a welcome addition to The Building Coder collection of stable representation magic voodoo information:\n\n<ul>\n<li><a href=\"http://thebuildingcoder.typepad.com/blog/2016/04/stable-reference-string-magic-voodoo.html\">Reference Stable Representation Magic Voodoo</a></li>\n<li><a href=\"http://thebuildingcoder.typepad.com/blog/2016/08/voodoo-magic-retrieves-global-instance-edges.html\">Voodoo Magic Retrieves Global Instance Edges</a></li>\n<li><a href=\"http://thebuildingcoder.typepad.com/blog/2017/06/hatch-line-dimensioning-voodoo.html\">Hatch Line Dimensioning Voodoo</a></li>\n<li><a href=\"http://thebuildingcoder.typepad.com/blog/2017/06/picked-family-instance-face-geometry-in-lcs-versus-wcs.html\">Picked Instance Face Geometry in LCS Versus WCS</a></li>\n<li><a href=\"http://thebuildingcoder.typepad.com/blog/2018/09/reference-intersector-and-deleting-reference-planes.html#5\">Reformat Stable Representation String for Dimensioning</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2019/02/stable-reference-relationships.html\">Stable Reference Relationships</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2023/03/ifc-dimension-and-reference-intersector-with-links.html#4\">Stable Representation Voodoo for Reference Intersector with Links</a></li>\n</ul>"
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "Revit and IFC coordinate systems",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Revit and IFC coordinate systems\n\nLet's round off the Revit-related topics with a short note to point out Lejla Secerbegovic' article\non [Revit, IFC and coordinate systems](https://bim-me-up.com/en/revit-ifc-und-koordinatensysteme/)."
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "Chinese Influencer Deepfakes Livestreaming 24/7",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Chinese Influencer Deepfakes Livestreaming 24/7\n\nMoving from the Revit API to my other favourite topic, AI et al:\n[deepfakes of Chinese influencers are livestreaming 24/7](https://www.technologyreview.com/2023/09/19/1079832/chinese-ecommerce-deepfakes-livestream-influencers-ai/):\n\n> With just a few minutes of sample video and $1,000 in costs, brands can clone a human streamer to work 24/7."
  },
  {
    "original_filename": "2010_no_geo_adjacent",
    "header_text": "Generative AI Use and Misuse",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> Generative AI Use and Misuse\n\nClosing with another AI-related topic, an experiment reveals how people can make use of generative AI, but also misuse it, and\nthus [how people can create &ndash; and destroy &ndash; value with generative AI](https://www.bcg.com/publications/2023/how-people-create-and-destroy-value-with-gen-ai):\n\n> Key Takeaways &ndash; A first-of-its-kind scientific experiment finds that people mistrust generative AI in areas where it can contribute tremendous value and trust it too much where the technology isn’t competent:\n\n> - Around 90% of participants improved their performance when using GenAI for creative ideation. People did best when they did not attempt to edit GPT-4’s output.\n- When working on business problem solving, a task outside the tool’s current competence, many participants took GPT-4's misleading output at face value. Their performance was 23% worse than those who didn’t use the tool at all.\n- Adopting generative AI is a massive change management effort. The job of the leader is to help people use the new technology in the right way, for the right tasks and to continually adjust and adapt in the face of GenAI’s ever-expanding frontier."
  }
][
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- /Users/jta/a/doc/revit/tbc/git/a/doc/gbxml_small_surface_solution_whole_building.pdf\n\n- LLaVA: Large Language and Vision Assistant\n  https://llava.hliu.cc/\n  Checkout opensource vision assistant >>\n  Best part is it is open source and can be run locally with descent enough hardware. Needs linux and an rtx.\n  But non-Commercial\n  Google Glass but more helpful perhaps :deploy-parrot:\n  Identify plants, tools in a workspace, even run basic support (I know some in my family who could use some help being told where to click on the computer screen sometimes)\n  I'm sure someone will train a commercial-allowed equivalent\n\n- Text to video ($36M in funding so far, and they call themselves ‘lean’): https://moonvalley.ai\n  moonvalley.aimoonvalley.ai\n  > Animate your ideas... a machine learning model that can create visually stunning, high definition videos & animation from simple text prompts. (1 MB)\n\n- Detect objects in images\n  Did you know that you could run neural networks entirely in the browser without contacting a server? This fun demo shows you how.\n  DETR (End-to-End Object Detection) model with ResNet-50 backbone\n  I provided it with a picture of me eating churros ([^](/Users/jta/Pictures/2023/2023-10-10_garnatilla/16.jpg)), it it rapidly identified the following objects:\n  jeremy_eating_churros.png\n\ntwitter:\n\nA mighty beautiful #Python solution to fix gaps in building geometry, render @gbXML BIM model, add missing surfaces and verify waterproof with the #RevitAPI @AutodeskRevit #BIM @DynamoBIM @AutodeskAPS https://autode.sk/fixgaps\n\nA mighty beautiful Python solution for fixing gaps in the building geometry and new AI-related titbits\n&ndash; Fixing building geometry gaps\n&ndash; Open and render gbXML BIM model\n&ndash; Identify gaps in geometry\n&ndash; Add missing surfaces\n&ndash; Verify waterproof\n&ndash; LLaVA large language and vision assistant\n&ndash; Moonvalley text to video\n&ndash; DETR model detects objects in images...\n\nlinkedin:\n\nA mighty beautiful #Python solution to fix gaps in building geometry, render @gbXML BIM model, add missing surfaces and verify waterproof with the #RevitAPI @AutodeskRevit #BIM @DynamoBIM @AutodeskAPS\n\nhttps://autode.sk/fixgaps\n\n- Fixing building geometry gaps\n- Open and render gbXML BIM model\n- Identify gaps in geometry\n- Add missing surfaces\n- Verify waterproof\n- LLaVA large language and vision assistant\n- Moonvalley text to video\n- DETR model detects objects in images...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "Xgbxml Fixes Building Geometry Gaps",
    "local_header_href": "#xgbxml-fixes-building-geometry-gaps",
    "chunk_text": "### Xgbxml Fixes Building Geometry Gaps\n\nAs we approach the weekend, I finally get around to sharing a mighty beautiful Python solution for fixing gaps in the building geometry, followed by a bunch of little AI-related titbits:\n\n- [Fixing building geometry gaps](#2)\n    - [Setup](#2.1)\n    - [Open and render gbXML BIM model](#2.2)\n    - [Identify gaps in geometry](#2.3)\n    - [Add missing surfaces](#2.4)\n    - [Second gap](#2.5)\n    - [Third gap](#2.6)\n    - [Verify waterproof](#2.7)\n    - [Save model](#2.8)\n    - [Low precision and sliver area threshold](#2.9)\n- [LLaVA large language and vision assistant](#3)\n- [Moonvalley text to video](#4)\n- [DETR model detects objects in images](#5)"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "Fixing Building Geometry Gaps",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Fixing Building Geometry Gaps\n\nMany developers have encountered issues with gaps in the building geometry caused by the relatively low precision used by Revit when tessellating surfaces.\nSome of them can be addressed by adding appropriate fuzz and adjusting neighbouring vertices to better match and line up.\nHowever, sometimes a gap remains.\n\nJake of [Ripcord Engineering](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/3926242) recently\nshared a bunch of valuable [Python and gbXML tips](https://thebuildingcoder.typepad.com/blog/2023/07/export-gbxml-and-python-tips.html) and followed up with a pointer\nto [Shapely](https://pypi.org/project/shapely/)\nto [find and fix a gap in the building geometry](https://thebuildingcoder.typepad.com/blog/2023/09/element-diff-compare-shapely-and-rdbe.html#4).\n\nHe followed up with this impressive and beautiful documentation of\nan entire gbXML [small surface solution addressing the whole building](doc/gbxml_small_surface_solution_whole_building.pdf) that I think warrants an entire blog post of its own, so here goes, addressing the issue\non [gbXML from adjacent conceptual mass/adjacent space missing small surface](https://forums.autodesk.com/t5/revit-api-forum/gbxml-from-adjacent-conceptual-mass-adjacent-space-missing-small/m-p/12232100).\n\n####<a name=\"2.1\"></a> Setup\n\nImport packages:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "import packages",
    "local_header_href": "#import-packages",
    "chunk_text": "# import packages\n\nfrom xgbxml import get_parser\nfrom xgbxml import geometry_functions, gbxml_functions, render_functions from lxml import etree\nimport matplotlib.pyplot as plt\nimport copy\nimport math\nfrom uuid import uuid4\n</pre>\n\nGenerate parser:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "uses xgbxml to generate a lxml parser to read gbXML version 0.37",
    "local_header_href": "#uses-xgbxml-to-generate-a-lxml-parser-to-read-gbxml-version-037",
    "chunk_text": "# uses xgbxml to generate a lxml parser to read gbXML version 0.37\n\nparser=get_parser(version='0.37')\n</pre>\n\n####<a name=\"2.2\"></a> Open and Render gbXML BIM Model\n\nOpen file and render *23-013 WH Swan Hill_Mass_23-08-30.xml*:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "opens the file using the custom lxml parser",
    "local_header_href": "#opens-the-file-using-the-custom-lxml-parser",
    "chunk_text": "# opens the file using the custom lxml parser\n\nfp='23-013 WH Swan Hill_Mass_23-08-30.xml' tree=etree.parse(fp,parser) gbxml=tree.getroot()"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "renders the Campus element",
    "local_header_href": "#renders-the-campus-element",
    "chunk_text": "# renders the Campus element\n\nax=gbxml.Campus.render()\nax.figure.set_size_inches(8, 8)\nax.set_title(fp)\nplt.show()\n</pre>\n\n<center>\n<img src=\"img/xgbxml_fix_gap.png\" alt=\"Campus rendering\" title=\"Campus rendering\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\">Campus rendering</p>\n</center>\n\n####<a name=\"2.3\"></a> Identify Gaps in Geometry\n\nIdentify all gaps in the surfaces of the building;\nthis uses a new method of the `Building` element, `get_gaps_in_surfaces`:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "identify gaps in surfaces of building",
    "local_header_href": "#identify-gaps-in-surfaces-of-building",
    "chunk_text": "# identify gaps in surfaces of building\n\ngaps=gbxml.Campus.Building.get_gaps_in_surfaces()\ngaps\n</pre>\n\nThe result is a list of dictionaries. Each dictionary contains two items:\n\n- `space_ids`: a list of the ids of the adjacent Spaces\n- `shell`: a list of the coordinates of the exterior polygon of the gaps\n\nHere, the first and third items appear to be triangle gaps with only one adjacent space &ndash; so these are exterior gaps also adjacent to the outside.\n\n<pre class=\"prettyprint\">\n[{'space_ids': ['aim2197'],\n    'shell': [\n      (72.2287629, -0.3141381, 0.0),\n      (72.2287629, -0.4999998, 0.0),\n      (72.0986211, -0.4999998, 0.0),\n      (72.2287629, -0.3141381, 0.0)]},\n  {'space_ids': ['aim2553', 'aim7413'],\n    'shell': [(80.2291667, 14.5625, 10.0),\n      (80.0208333, 14.5625, 10.0),\n      (80.0208333, 16.020833, 10.0),\n      (80.2291667, 16.020833, 10.0),\n      (80.2291667, 14.5625, 10.0)]},\n  {'space_ids': ['aim6674'],\n    'shell': [(72.2287629, -0.4999998, 10.0),\n      (72.2287629, -0.3141381, 10.0),\n      (72.0986211, -0.4999998, 10.0),\n      (72.2287629, -0.4999998, 10.0)]}]\n</pre>\n\n####<a name=\"2.4\"></a> Add Missing Surfaces\n\nAdding the missing surfaces to the building; first gap:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "print gap",
    "local_header_href": "#print-gap",
    "chunk_text": "# print gap\n\ngap=gaps[0]\ngap\n</pre>\n\nResult:\n\n<pre class=\"prettyprint\">\n{'space_ids': ['aim2197'],\n  'shell': [(72.2287629, -0.3141381, 0.0),\n    (72.2287629, -0.4999998, 0.0),\n    (72.0986211, -0.4999998, 0.0),\n    (72.2287629, -0.3141381, 0.0)]}\n</pre>\n\nFix:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "add Surface",
    "local_header_href": "#add-surface",
    "chunk_text": "# add Surface\n\n"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "surface element",
    "local_header_href": "#surface-element",
    "chunk_text": "# surface element\n\nsurface=gbxml.Campus.add_Surface(\n  id=str(uuid4()),\n  surfaceType=None, # to do\n  constructionIdRef=None, # to do\n  exposedToSun=None # to do\n)"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "adjacent space id child element",
    "local_header_href": "#adjacent-space-id-child-element",
    "chunk_text": "# adjacent space id child element\n\nfor space_id in gap['space_ids']:\n  surface.add_AdjacentSpaceId(\n    spaceIdRef=space_id )"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "planar geometry child element",
    "local_header_href": "#planar-geometry-child-element",
    "chunk_text": "# planar geometry child element\n\nplanar_geometry = surface.add_PlanarGeometry()\nplanar_geometry.set_shell(gap['shell'])"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "check",
    "local_header_href": "#check",
    "chunk_text": "# check\n\nprint(surface.tostring())\n</pre>\n\nResult:\n\n<pre class=\"prettyprint\">\n&lt;Surface xmlns=\"http://www.gbxml.org/schema\" id=\"f20a7dbc-94d5-43ee-bf64-748c3e61658b\"&gt;\n  &lt;AdjacentSpaceId spaceIdRef=\"aim2197\"/&gt;\n  &lt;PlanarGeometry&gt;\n    &lt;PolyLoop&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;72.2287629&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;-0.3141381&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;0.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;72.2287629&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;-0.4999998&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;0.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;72.0986211&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;-0.4999998&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;0.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n    &lt;/PolyLoop&gt;\n  &lt;/PlanarGeometry&gt;\n&lt;/Surface&gt;\n</pre>\n\n####<a name=\"2.5\"></a> Second Gap\n\nSecond gap:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "print gap",
    "local_header_href": "#print-gap",
    "chunk_text": "# print gap\n\ngap=gaps[1]\ngap\n</pre>\n\nResult:\n\n<pre class=\"prettyprint\">\n{'space_ids': ['aim2553', 'aim7413'],\n  'shell':\n    [(80.2291667, 14.5625, 10.0),\n    (80.0208333, 14.5625, 10.0),\n    (80.0208333, 16.020833, 10.0),\n    (80.2291667, 16.020833, 10.0),\n    (80.2291667, 14.5625, 10.0)]}\n</pre>\n\nFix:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "add Surface",
    "local_header_href": "#add-surface",
    "chunk_text": "# add Surface\n\n"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "surface element",
    "local_header_href": "#surface-element",
    "chunk_text": "# surface element\n\nsurface=gbxml.Campus.add_Surface(\n  id=str(uuid4()),\n  surfaceType=None, # to do\n  constructionIdRef=None, # to do\n  exposedToSun=None # to do\n  )"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "adjacent space id child element",
    "local_header_href": "#adjacent-space-id-child-element",
    "chunk_text": "# adjacent space id child element\n\nfor space_id in gap['space_ids']:\n  surface.add_AdjacentSpaceId(\n    spaceIdRef=space_id\n    )"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "planar geometry child element",
    "local_header_href": "#planar-geometry-child-element",
    "chunk_text": "# planar geometry child element\n\nplanar_geometry = surface.add_PlanarGeometry()\nplanar_geometry.set_shell(gap['shell'])"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "check",
    "local_header_href": "#check",
    "chunk_text": "# check\n\nprint(surface.tostring())\n</pre>\n\nResult:\n\n<pre class=\"prettyprint\">\n&lt;Surface xmlns=\"http://www.gbxml.org/schema\" id=\"407a76aa-3287-4b5e-ac62-0440fb629f72\"&gt;\n  &lt;AdjacentSpaceId spaceIdRef=\"aim2553\"/&gt;\n  &lt;AdjacentSpaceId spaceIdRef=\"aim7413\"/&gt;\n  &lt;PlanarGeometry&gt;\n    &lt;PolyLoop&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;80.2291667&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;14.5625&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;10.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;80.0208333&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;14.5625&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;10.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;80.0208333&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;16.020833&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;10.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;80.2291667&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;16.020833&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;10.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n    &lt;/PolyLoop&gt;\n  &lt;/PlanarGeometry&gt;\n&lt;/Surface&gt;\n</pre>\n\n####<a name=\"2.6\"></a> Third Gap\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "print gap",
    "local_header_href": "#print-gap",
    "chunk_text": "# print gap\n\ngap=gaps[2]\ngap\n</pre>\n\nResult:\n\n<pre class=\"prettyprint\">\n{'space_ids': ['aim6674'],\n  'shell':\n    [(72.2287629, -0.4999998, 10.0),\n    (72.2287629, -0.3141381, 10.0),\n    (72.0986211, -0.4999998, 10.0),\n    (72.2287629, -0.4999998, 10.0)]}\n</pre>\n\nFix:\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "add Surface",
    "local_header_href": "#add-surface",
    "chunk_text": "# add Surface\n\n"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "surface element",
    "local_header_href": "#surface-element",
    "chunk_text": "# surface element\n\nsurface=gbxml.Campus.add_Surface(\n  id=str(uuid4()),\n  surfaceType=None, # to do\n  constructionIdRef=None, # to do\n  exposedToSun=None # to do\n  )"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "adjacent space id child element",
    "local_header_href": "#adjacent-space-id-child-element",
    "chunk_text": "# adjacent space id child element\n\nfor space_id in gap['space_ids']:\n  surface.add_AdjacentSpaceId(\n    spaceIdRef=space_id\n    )"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "planar geometry child element",
    "local_header_href": "#planar-geometry-child-element",
    "chunk_text": "# planar geometry child element\n\nplanar_geometry = surface.add_PlanarGeometry()\nplanar_geometry.set_shell(gap['shell'])"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "check",
    "local_header_href": "#check",
    "chunk_text": "# check\n\nprint(surface.tostring())\n</pre>\n\nResult:\n\n<pre class=\"prettyprint\">\n&lt;Surface xmlns=\"http://www.gbxml.org/schema\" id=\"96ad28f6-56fb-42b8-94d0-93c73d398866\"&gt;\n  &lt;AdjacentSpaceId spaceIdRef=\"aim6674\"/&gt;\n  &lt;PlanarGeometry&gt;\n    &lt;PolyLoop&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;72.2287629&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;-0.4999998&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;10.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;72.2287629&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;-0.3141381&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;10.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n      &lt;CartesianPoint&gt;\n        &lt;Coordinate&gt;72.0986211&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;-0.4999998&lt;/Coordinate&gt;\n        &lt;Coordinate&gt;10.0&lt;/Coordinate&gt;\n      &lt;/CartesianPoint&gt;\n    &lt;/PolyLoop&gt;\n  &lt;/PlanarGeometry&gt;\n&lt;/Surface&gt;\n</pre>\n\n####<a name=\"2.7\"></a> Verify Waterproof\n\nRecheck gaps in surfaces of building; there should now be no gaps.\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "identify gaps in surfaces of building",
    "local_header_href": "#identify-gaps-in-surfaces-of-building",
    "chunk_text": "# identify gaps in surfaces of building\n\ngaps=gbxml.Campus.Building.get_gaps_in_surfaces()\ngaps\n</pre>\n\nResult:\n\n<pre class=\"prettyprint\">\n[]\n</pre>\n\n####<a name=\"2.8\"></a> Save Model\n\nSave the updated gbxml file.\n\n<pre class=\"prettyprint\">"
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "writes the gbXML etree to a local file",
    "local_header_href": "#writes-the-gbxml-etree-to-a-local-file",
    "chunk_text": "# writes the gbXML etree to a local file\n\ntree.write('23-013 WH Swan Hill_Mass_23-08-30-UPDATED.xml', pretty_print=True)\n</pre>\n\n####<a name=\"2.9\"></a> Low Precision and Sliver Area Threshold\n\nRegarding:\n\n> ... issues with gaps in the building geometry caused by the relatively low precision used by Revit when tessellating surfaces.\n\nBased on experience over time at Ripcord, 'low precision' appears directly related to an area threshold rather than a length threshold.\nWhat might be considered 'sliver' surfaces export OK.\nBut once 'sliver' surfaces fall under the area threshold, whatever it is, the surface is not exported.\n\nIt is likely that direct control of the area threshold would offer operators relief.\nInability to control the area threshold creates a level of operator compensation that likely compels most to abandon value added analytical tasks.\n\nMany thanks again to Jake for this extremely powerful solution and\nhis [beautiful documentation](doc/gbxml_small_surface_solution_whole_building.pdf)."
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "LLaVA Large Language and Vision Assistant",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> LLaVA Large Language and Vision Assistant\n\nThe [LLaVA Large Language and Vision Assistant](https://llava.hliu.cc/) is\nopen source with a non-commercial license and can be run locally with decent enough hardware.\nNeeds linux and an rtx.\nLike Google Glass but more helpful perhaps.\nIdentify plants, tools in a workspace, even run basic support, e.g., provide help on where to click on the computer screen etc.\nPresumably someone will soon train a commercial-allowed equivalent."
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "Moonvalley Text to Video",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Moonvalley Text to Video\n\n[Moonvalley](https://moonvalley.ai) is a text-to-video startup\n($36M in funding so far, and they call themselves ‘lean’):\n\n> Animate your ideas... a machine learning model that can create visually stunning, high definition videos and animation from simple text prompts."
  },
  {
    "original_filename": "2011_xgbxml_fix_gap",
    "header_text": "DETR Model Detects Objects in Images",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> DETR Model Detects Objects in Images\n\nDid you know that you could run neural networks entirely in the browser without contacting a server?\n\nThe latest StackOverflow newsletter pointed me to a fun demo that shows you how.\nI uploaded a picture and tested it.\nUnfortunately, I lost the link and cannot find it anymore.\nAll I have now is the note I made of the underlying tool, and the result of running it on a photo I had at hand:\n\n- DETR (End-to-End Object Detection) model with ResNet-50 backbone\n\nI provided it with a picture of me eating churros ([^](/Users/jta/Pictures/2023/2023-10-10_garnatilla/16.jpg)) and\nit rapidly (in a handful of seconds) identified the following objects:\n\n<center>\n<img src=\"img/jeremy_eating_churros.png\" alt=\"Jeremy eating churros\" title=\"Jeremy eating churros\" width=\"600\"/>\n</center>\n\nI find that pretty impressive.\n\nExciting times... oh, dear, and deeply troubling, too... thinking of all the conflicts currently blooming..."
  }
][
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n\n<style>\ntable, th, td {\n  border: 1px solid black;\n  border-collapse: collapse;\n}\nth, td {\n  padding-left: 1em;\n  padding-right: 1em;\n  text-align:right;\n}\n</style>\n\n</head>\n\n<!---\n\n- aps intro:\n  We have a new overview video answering the question “What is Autodesk Platform Services?” This gives a quick explanation of what APS is, how it fits into the Autodesk Platform, and shows some of the most popular applications of APS in use with our customers and partners. You can find the video on YouTube here: https://youtu.be/RrAel5Mx7-0?si=lk3C2qLjUHX8PALi\n\n- another open source multimodal model\n  Fuyu-8B: A Multimodal Architecture for AI Agents\n  https://www.adept.ai/blog/fuyu-8b\n  Can be run offline on a laptop CPU\n\n\ntwitter:\n\n@AutodeskAPS overview, and DLL paradise for @AutodeskRevit #RevitAPI add-ins via named pipe IPC, interprocess communication strategies and best practices communicating between .NET 4.8 and .NET 7 #BIM @DynamoBIM @AutodeskAPS https://autode.sk/dllparadise\n\nAPS overview\n&ndash; DLL paradise for Revit add-ins via named pipe IPC\n&ndash; Interprocess communication strategies and best practices\n&ndash; Using named pipes to communicate between different .NET versions\n&ndash; Interactions between .NET 4.8 and .NET 7\n&ndash; Server / client transmission protocol\n&ndash; Connection management\n&ndash; Two-way communication...\n\nlinkedin:\n\nAutodesk Platform Services APS overview, and DLL paradise for #Revit #API add-ins via named pipe IPC, interprocess communication strategies and best practices communicating between .NET 4.8 and .NET 7\n\nhttps://autode.sk/dllparadise\n\n- DLL paradise for Revit add-ins via named pipe IPC\n- Interprocess communication strategies and best practices\n- Using named pipes to communicate between different .NET versions\n- Interactions between .NET 4.8 and .NET 7\n- Server / client transmission protocol\n- Connection management\n- Two-way communication...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "DLL Paradise and a Fall",
    "local_header_href": "#dll-paradise-and-a-fall",
    "chunk_text": "### DLL Paradise and a Fall\n\nOne huge article explaining how you can address DLL hell today, and a bunch of little notes to decorate it:\n\n- [What are the Autodesk Platform Services?](#1)\n- [DLL paradise for Revit add-ins via named pipe IPC](#2)\n- [Interprocess communication: strategies and best practices](#3)\n    - [Table of contents](#3.1)\n    - [Using named pipes to communicate between different .NET versions](#3.2)\n    - [What are named pipes?](#3.3)\n    - [Interactions between applications in .NET 4.8 and .NET 7](#3.4)\n    - [Server creation](#3.5)\n    - [Client creation](#3.6)\n    - [Transmission protocol](#3.7)\n    - [Connection management](#3.8)\n    - [Two-way communication](#3.9)\n    - [Implementation for Revit plug-in](#3.10)\n    - [Installing .NET runtime during plugin installation](#3.11)\n    - [Conclusion](#3.12)\n- [Fuyu-8B multimodal architecture for AI agents](#4)\n- [How open source wins](#6)\n- [HTTP/3](#5)\n\nBy the way, I am writing this from my hospital bed.\nI had a 6-metre fall from a ladder onto earth last weekend and broke my right hipbone, both front and back, plus some other less important bits and pieces.\nNow I am waiting for an operastion to get it all screwed back together again and hope that will provide a stable basis for a speedy recovery.\n\n<center>\n<img src=\"img/2023-10-21_jeremy_in_hospital.jpg\" alt=\"Jeremy in hospital\" title=\"Jeremy in hospital\" width=\"600\"/>\n</center>"
  },
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "What are the Autodesk Platform Services?",
    "local_header_href": "#1",
    "chunk_text": "####<a name=\"1\"></a> What are the Autodesk Platform Services?\n\nWe have a new two-and-a-half-minute overview YouTube video answering\nthe question [What is Autodesk Platform Services?](https://youtu.be/RrAel5Mx7-0?feature=shared) to\ngive a quick explanation of what APS is, how it fits into the Autodesk Platform, and shows some of the most popular applications of APS in use with our customers and partners."
  },
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "DLL Paradise for Revit Add-ins via Named Pipe IPC",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> DLL Paradise for Revit Add-ins via Named Pipe IPC\n\nWindows applications integrating external components occasionally\nencounter [DLL hell](https://duckduckgo.com/?q=dll+hell) due to conflicting dependencies.\nThe Building Coder discussed\nsome [specific and even some pretty generic solutions](https://www.google.com/search?q=dll+hell&as_sitesearch=thebuildingcoder.typepad.com).\nOnce again, Roman [Nice3point](https://github.com/Nice3point) Karpovich\nof [atomatiq](https://www.linkedin.com/company/atomatiq/), aka Роман Карпович,\nprincipal maintainer of RevitLookup, comes to the rescue, sharing a new article about Revit and add-in inter-processor communication:\n\nDive into the world of inter-process communication and discover how to establish seamless communication for running a Revit plugin on .NET 7.\n\nLearn about the essence of Named Pipes:\n\n- Inter-process communication across .NET 4.8 and .NET 7\n- Server setup and client creation\n- Efficient data transmission protocols\n- Connection management strategies\n- Two-way data transfer capabilities\n- Implementation of a Revit plugin\n\nWant to know how it works? Check out the full GitHub article\non [Interprocess Communication: Strategies and Best Practices](https://github.com/atomatiq/InterprocessCommunication):\n\n- [LinkedIn post](https://www.linkedin.com/feed/update/urn:li:activity:7120385512464388096/)\n- [ENU version](https://github.com/atomatiq/InterprocessCommunication)\n- [CIS version](https://github.com/Nice3point/InterprocessCommunication)\n\nPlease be aware that the Revit development team is looking at\npossible [options for moving the Revit API forward from .NET 4.8](https://thebuildingcoder.typepad.com/blog/2023/08/15-years-polygon-areas-and-net-core.html#3) as\nwe speak.\nWith the approach described here, you can move ahead today and address other DLL conflicts as well."
  },
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "Interprocess Communication: Strategies and Best Practices",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Interprocess Communication: Strategies and Best Practices\n\nWe all know how challenging it is to maintain large programs and keep up with progress.\nDevelopers of plugins for Revit understand this better than anyone else.\nWe have to write our programs in .NET Framework 4.8 and forgo modern and fast libraries.\nUltimately, this affects users who are forced to use outdated software.\n\nIn such scenarios, splitting the application into multiple processes using Named Pipes appears to be an excellent solution due to its performance and reliability.\nIn this article, we discuss how to create and use Named Pipes to communicate between the Revit application running on .NET 4.8 and its plugin running on .NET 7.\n\n<!--\n\n####<a name=\"3.1\"></a> Table of Contents\n\n* [Introduction to Using Named Pipes for Communication Between Applications on Different .NET Versions](#introduction-to-using-named-pipes-for-communication-between-applications-on-different-net-versions)\n* [What are Named Pipes?](#what-are-named-pipes)\n* [Interactions between applications in .NET 4.8 and .NET 7](#interactions-between-applications-in-net-48-and-net-7)\n    * [Server Creation](#server-creation)\n    * [Client Creation](#client-creation)\n    * [Transmission Protocol](#transmission-protocol)\n    * [Connection Management](#connection-management)\n    * [Two-Way Communication](#two-way-communication)\n    * [Implementation for Revit plug-in](#implementation-for-revit-plug-in)\n* [Installing .NET Runtime during plugin installation](#installing-net-runtime-during-plugin-installation)\n* [Conclusion](#conclusion)\n\n-->\n\n####<a name=\"3.2\"></a> Using Named Pipes to Communicate Between Different .NET Versions\n\nIn the world of application development, there is often a need to ensure data exchange between different applications, especially in cases where they operate on different versions of .NET or different languages.\nSplitting a single application into multiple processes must be justified.\nWhat is simpler, calling a function directly, or exchanging messages? Obviously, the former.\n\nSo what are the benefits of doing this?\n\n- Resolving Dependency Conflicts\n\nWith each passing year, the size of Revit plugins is growing exponentially, and dependencies are also increasing at a geometric rate.\nPlugins might use incompatible versions of a single library, leading to program crashes. Process isolation solves this problem.\n\n- Performance\n\nHere are a few performance measurements for sorting and mathematical calculations on different .NET versions:\n\n- BenchmarkDotNet v0.13.9, Windows 11 (10.0.22621.1702/22H2/2022Update/SunValley2)\n- AMD Ryzen 5 2600X, 1 CPU, 12 logical and 6 physical cores\n- .NET 7.0.9 (7.0.923.32018), X64 RyuJIT AVX2\n- .NET Framework 4.8.1 (4.8.9139.0), X64 RyuJIT VectorSize=256\n\n<center>\n<table>\n<tr><th> Method</th><th>.NET</th><th>Mean ns</th><th>Error ns</th><th>SthDev ns</th><th>Bytes</th></tr>\n<tr><td> ListSort   </td><td>7.0</td><td>1,113,161</td><td>20,385</td><td>21,811</td><td> 804753</td></tr>\n<tr><td> ListOrderBy</td><td>7.0</td><td>1,064,851</td><td>12,401</td><td>11,600</td><td> 807054</td></tr>\n<tr><td> MinValue   </td><td>7.0</td><td>      979</td><td>     7</td><td>     6</td><td>       </td></tr>\n<tr><td> MaxValue   </td><td>7.0</td><td>      970</td><td>     4</td><td>     3</td><td>       </td></tr>\n<tr><td> ListSort   </td><td>4.8</td><td>2,144,723</td><td>40,359</td><td>37,752</td><td>1101646</td></tr>\n<tr><td> ListOrderBy</td><td>4.8</td><td>2,192,414</td><td>25,938</td><td>24,263</td><td>1105311</td></tr>\n<tr><td> MinValue   </td><td>4.8</td><td>   58,019</td><td>   460</td><td>   430</td><td>     40</td></tr>\n<tr><td> MaxValue   </td><td>4.8</td><td>   66,053</td><td>   610</td><td>   541</td><td>     41</td></tr>\n</table>\n</center>\n\nThe 68-fold difference in speed when finding the minimum value, and the complete absence of memory allocation, is impressive.\n\nHow then to write a program in the latest .NET version that will interact with an incompatible .NET framework?\nCreate two applications, Server and Client, without adding dependencies between each other and configure the interaction between them using a configured protocol.\n\nHere are some possible ways of interaction between two applications:\n\n-  Using WCF (Windows Communication Foundation)\n-  Using sockets (TCP or UDP)\n-  Using Named Pipes\n-  Using operating system signals (e.g., Windows signals):\n\nAn example of the latter from Autodesk's code, the interaction of the Project Browser plugin with the Revit backend via messages.\n\n<pre class=\"prettyprint\">\npublic class DataTransmitter : IEventObserver\n{\n  private void PostMessageToMainWindow(int iCmd) =&gt;\n    this.HandleOnMainThread((Action) (() =&gt;\n      Win32Api.PostMessage(Application.UIApp.getUIApplication().MainWindowHandle, 273U, new IntPtr(iCmd), IntPtr.Zero)));\n\n  public void HandleShortCut(string key, bool ctrlPressed)\n  {\n    string lower = key.ToLower();\n    switch (PrivateImplementationDetails.ComputeStringHash(lower))\n    {\n    case 388133425:\n      if (!(lower == \"f2\")) break;\n      this.PostMessageToMainWindow(DataTransmitter.ID_RENAME);\n      break;\n    case 1740784714:\n      if (!(lower == \"delete\")) break;\n      this.PostMessageToMainWindow(DataTransmitter.ID_DELETE);\n      break;\n    case 3447633555:\n      if (!(lower == \"contextmenu\")) break;\n      this.PostMessageToMainWindow(DataTransmitter.ID_PROJECTBROWSER_CONTEXT_MENU_POP);\n      break;\n    case 3859557458:\n      if (!(lower == \"c\") || !ctrlPressed) break;\n      this.PostMessageToMainWindow(DataTransmitter.ID_COPY);\n      break;\n    case 4077666505:\n      if (!(lower == \"v\") || !ctrlPressed) break;\n      this.PostMessageToMainWindow(DataTransmitter.ID_PASTE);\n      break;\n    case 4228665076:\n      if (!(lower == \"y\") || !ctrlPressed) break;\n      this.PostMessageToMainWindow(DataTransmitter.ID_REDO);\n      break;\n    case 4278997933:\n      if (!(lower == \"z\") || !ctrlPressed) break;\n      this.PostMessageToMainWindow(DataTransmitter.ID_UNDO);\n      break;\n    }\n  }\n}\n</pre>\n\nEach option has its own pros and cons. In my opinion, the most convenient for local machine interaction is Named Pipes. Let's delve into it.\n\n####<a name=\"3.3\"></a> What are Named Pipes?\n\nNamed Pipes are a mechanism for Inter-Process Communication (IPC) that enables processes to exchange data through named channels.\nThey provide a one-way or duplex connection between processes.\nApart from high performance, Named Pipes also offer various security levels, making them an attractive solution for many inter-process communication scenarios.\n\n####<a name=\"3.4\"></a> Interactions between applications in .NET 4.8 and .NET 7\n\nLet's consider two applications, one containing the business logic (server), and the other one for the user interface (client).\nNamedPipe is used to facilitate communication between these two processes.\n\nThe operation principle of NamedPipe involves the following steps:\n\n-  **Creation and configuration of NamedPipe**: The server creates and configures the NamedPipe with a specific name that will be accessible to the client.\n   The client needs to know this name to connect to the pipe.\n-  **Waiting for connection**: The server starts to wait for the client to connect to the pipe.\n   This is a blocking operation, and the server remains in a pending state until the client connects.\n-  **Connecting to NamedPipe**: The client initiates a connection to the NamedPipe, specifying the name of the pipe to which it wants to connect.\n-  **Data exchange**: After a successful connection, the client and server can exchange data in the form of byte streams.\n   The client sends requests for executing the business logic, and the server processes these requests and sends back the results.\n-  **Session termination**: After the data exchange is complete, the client and server can close the connection with NamedPipe.\n\n#####<a name=\"3.5\"></a> Server Creation\n\nOn the .NET platform, the server side is represented by the `NamedPipeServerStream` class.\nThe class implementation provides both asynchronous and synchronous methods for working with NamedPipe.\nTo avoid blocking the main thread, we will utilize asynchronous methods.\n\nHere's an example code snippet for creating a NamedPipeServer:\n\n<pre class=\"prettyprint\">\npublic static class NamedPipeUtil\n{\n  /// &lt;summary&gt;\n  /// Create a server for the current user only\n  /// &lt;/summary&gt;\n  public static NamedPipeServerStream CreateServer(PipeDirection? pipeDirection = null)\n  {\n    const PipeOptions pipeOptions = PipeOptions.Asynchronous | PipeOptions.WriteThrough;\n    return new NamedPipeServerStream(\n      GetPipeName(),\n      pipeDirection ?? PipeDirection.InOut,\n      NamedPipeServerStream.MaxAllowedServerInstances,\n      PipeTransmissionMode.Byte,\n      pipeOptions);\n  }\n\n  private static string GetPipeName()\n  {\n    var serverDirectory = AppDomain.CurrentDomain.BaseDirectory.TrimEnd(Path.DirectorySeparatorChar);\n    var pipeNameInput = $\"{Environment.UserName}.{serverDirectory}\";\n    var hash = new SHA256Managed().ComputeHash(Encoding.UTF8.GetBytes(pipeNameInput));\n\n    return Convert.ToBase64String(hash)\n      .Replace(\"/\", \"_\")\n      .Replace(\"=\", string.Empty);\n  }\n}\n</pre>\n\nThe server name should not contain special characters to avoid exceptions.\nTo generate the pipe name, we will use a hash created from the username and the current folder, which is unique enough for the client to use this server upon connection.\nYou can modify this behavior or use any name within the scope of your project, especially if the client and server are in different directories.\n\nThis approach is used in the [Roslyn .NET compiler](https://github.com/dotnet/roslyn). For those who want to delve deeper into this topic, I recommend studying the source code of the project\n\nThe `PipeDirection` indicates the direction of the channel.\n`PipeDirection.In` implies that the server will only receive messages, while `PipeDirection.InOut` can both receive and send messages.\n\n#####<a name=\"3.6\"></a> Client Creation\n\nTo create the client, we will use the `NamedPipeClientStream` class.\nThe code is almost similar to the server and may vary slightly depending on the .NET versions.\nFor instance, in .NET framework 4.8, the `PipeOptions.CurrentUserOnly` value does not exist, but it appears in .NET 7.\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n/// Create a client for the current user only\n/// &lt;/summary&gt;\npublic static NamedPipeClientStream CreateClient(PipeDirection? pipeDirection = null)\n{\n  const PipeOptions pipeOptions = PipeOptions.Asynchronous | PipeOptions.WriteThrough | PipeOptions.CurrentUserOnly;\n  return new NamedPipeClientStream(\".\",\n    GetPipeName(),\n    pipeDirection ?? PipeDirection.Out,\n    pipeOptions);\n}\n\nprivate static string GetPipeName()\n{\n  var clientDirectory = AppDomain.CurrentDomain.BaseDirectory.TrimEnd(Path.DirectorySeparatorChar);\n  var pipeNameInput = $\"{System.Environment.UserName}.{clientDirectory}\";\n  var bytes = SHA256.HashData(Encoding.UTF8.GetBytes(pipeNameInput));\n\n  return Convert.ToBase64String(bytes)\n    .Replace(\"/\", \"_\")\n    .Replace(\"=\", string.Empty);\n}\n</pre>\n\n#####<a name=\"3.7\"></a> Transmission Protocol\n\nNamedPipe represents a stream, which allows us to write any sequence of bytes to the stream.\nHowever, working with bytes directly might not be very convenient, especially when dealing with complex data or structures.\nTo simplify the interaction with data streams and structure information in a convenient format, transmission protocols are used.\n\nTransmission protocols define the format and order of data transmission between applications.\nThey ensure the structuring of information to facilitate understanding and proper interpretation of data between the sender and the receiver.\n\nIn cases where we need to send a \"Request to execute a specific command on the server\" or a \"Request to update application settings,\" the server must understand how to process it from the client.\nTherefore, to facilitate request handling and data exchange management, we will create an `RequestType` Enum.\n\n<pre class=\"prettyprint\">\npublic enum RequestType\n{\n    PrintMessage,\n    UpdateModel\n}\n</pre>\n\nThe request itself will be represented by a class that will contain all the information about the transmitted data.\n\n<pre class=\"prettyprint\">\npublic abstract class Request\n{\n  public abstract RequestType Type { get; }\n\n  protected abstract void AddRequestBody(BinaryWriter writer);\n\n  /// &lt;summary&gt;\n  ///   Write a Request to the given stream.\n  /// &lt;/summary&gt;\n  public async Task WriteAsync(Stream outStream)\n  {\n    using var memoryStream = new MemoryStream();\n    using var writer = new BinaryWriter(memoryStream, Encoding.Unicode);\n\n    writer.Write((int) Type);\n    AddRequestBody(writer);\n    writer.Flush();\n\n    // Write the length of the request\n    var length = checked((int) memoryStream.Length);\n\n    // There is no way to know the number of bytes written to\n    // the pipe stream. We just have to assume all of them are written\n    await outStream.WriteAsync(BitConverter.GetBytes(length), 0, 4);\n    memoryStream.Position = 0;\n    await memoryStream.CopyToAsync(outStream, length);\n  }\n\n  /// &lt;summary&gt;\n  /// Write a string to the Writer where the string is encoded\n  /// as a length prefix (signed 32-bit integer) follows by\n  /// a sequence of characters.\n  /// &lt;/summary&gt;\n  protected static void WriteLengthPrefixedString(BinaryWriter writer, string value)\n  {\n    writer.Write(value.Length);\n    writer.Write(value.ToCharArray());\n  }\n}\n</pre>\n\nThe class contains the basic code for writing data to the stream. `AddRequestBody()` is used by derived classes to write their own structured data.\n\nExamples of derived classes:\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n/// Represents a Request from the client. A Request is as follows.\n///\n///  Field Name         Type            Size (bytes)\n/// --------------------------------------------------\n///  RequestType        Integer         4\n///  Message            String          Variable\n///\n/// Strings are encoded via a character count prefix as a\n/// 32-bit integer, followed by an array of characters.\n///\n/// &lt;/summary&gt;\npublic class PrintMessageRequest : Request\n{\n  public string Message { get; }\n\n  public override RequestType Type =&gt; RequestType.PrintMessage;\n\n  public PrintMessageRequest(string message)\n  {\n    Message = message;\n  }\n\n  protected override void AddRequestBody(BinaryWriter writer)\n  {\n    WriteLengthPrefixedString(writer, Message);\n  }\n}\n\n/// &lt;summary&gt;\n/// Represents a Request from the client. A Request is as follows.\n///\n///  Field Name         Type            Size (bytes)\n/// --------------------------------------------------\n///  ResponseType       Integer         4\n///  Iterations         Integer         4\n///  ForceUpdate        Boolean         1\n///  ModelName          String          Variable\n///\n/// Strings are encoded via a character count prefix as a\n/// 32-bit integer, followed by an array of characters.\n///\n/// &lt;/summary&gt;\npublic class UpdateModelRequest : Request\n{\n  public int Iterations { get; }\n  public bool ForceUpdate { get; }\n  public string ModelName { get; }\n\n  public override RequestType Type =&gt; RequestType.UpdateModel;\n\n  public UpdateModelRequest(string modelName, int iterations, bool forceUpdate)\n  {\n    Iterations = iterations;\n    ForceUpdate = forceUpdate;\n    ModelName = modelName;\n  }\n\n  protected override void AddRequestBody(BinaryWriter writer)\n  {\n    writer.Write(Iterations);\n    writer.Write(ForceUpdate);\n    WriteLengthPrefixedString(writer, ModelName);\n  }\n}\n</pre>\n\nBy using this structure, clients can create requests of various types, each of which defines its own logic for handling data and parameters.\nThe `PrintMessageRequest` and `UpdateModelRequest` classes provide examples of requests that can be sent to the server to perform specific tasks.\n\nOn the server side, it is necessary to develop the corresponding logic for processing incoming requests.\nTo do this, the server must read data from the stream and use the received parameters to perform the necessary operations.\n\nExample of a received request on the server side:\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n/// Represents a request from the client. A request is as follows.\n///\n///  Field Name         Type                Size (bytes)\n/// ----------------------------------------------------\n///  RequestType       enum RequestType   4\n///  RequestBody       Request subclass   variable\n///\n/// &lt;/summary&gt;\npublic abstract class Request\n{\n  public enum RequestType\n  {\n    PrintMessage,\n    UpdateModel\n  }\n\n  public abstract RequestType Type { get; }\n\n  /// &lt;summary&gt;\n  ///   Read a Request from the given stream.\n  /// &lt;/summary&gt;\n  public static async Task&lt;Request&gt; ReadAsync(Stream stream)\n  {\n    var lengthBuffer = new byte[4];\n    await ReadAllAsync(stream, lengthBuffer, 4).ConfigureAwait(false);\n    var length = BitConverter.ToUInt32(lengthBuffer, 0);\n\n    var requestBuffer = new byte[length];\n    await ReadAllAsync(stream, requestBuffer, requestBuffer.Length);\n\n    using var reader = new BinaryReader(new MemoryStream(requestBuffer), Encoding.Unicode);\n\n    var requestType = (RequestType) reader.ReadInt32();\n    return requestType switch\n    {\n      RequestType.PrintMessage =&gt; PrintMessageRequest.Create(reader),\n      RequestType.UpdateModel =&gt; UpdateModelRequest.Create(reader),\n      _ =&gt; throw new ArgumentOutOfRangeException()\n    };\n  }\n\n  /// &lt;summary&gt;\n  /// This task does not complete until we are completely done reading.\n  /// &lt;/summary&gt;\n  private static async Task ReadAllAsync(Stream stream, byte[] buffer, int count)\n  {\n    var totalBytesRead = 0;\n    do\n    {\n      var bytesRead = await stream.ReadAsync(buffer, totalBytesRead, count - totalBytesRead);\n      if (bytesRead == 0) throw new EndOfStreamException(\"Reached end of stream before end of read.\");\n      totalBytesRead += bytesRead;\n    } while (totalBytesRead &lt; count);\n  }\n\n  /// &lt;summary&gt;\n  /// Read a string from the Reader where the string is encoded\n  /// as a length prefix (signed 32-bit integer) followed by\n  /// a sequence of characters.\n  /// &lt;/summary&gt;\n  protected static string ReadLengthPrefixedString(BinaryReader reader)\n  {\n    var length = reader.ReadInt32();\n    return length &lt; 0 ? null : new string(reader.ReadChars(length));\n  }\n}\n\n/// &lt;summary&gt;\n/// Represents a Request from the client. A Request is as follows.\n///\n///  Field Name         Type            Size (bytes)\n/// --------------------------------------------------\n///  RequestType        Integer         4\n///  Message            String          Variable\n///\n/// Strings are encoded via a character count prefix as a\n/// 32-bit integer, followed by an array of characters.\n///\n/// &lt;/summary&gt;\npublic class PrintMessageRequest : Request\n{\n  public string Message { get; }\n\n  public override RequestType Type =&gt; RequestType.PrintMessage;\n\n  public PrintMessageRequest(string message)\n  {\n    Message = message;\n  }\n\n  protected override void AddRequestBody(BinaryWriter writer)\n  {\n    WriteLengthPrefixedString(writer, Message);\n  }\n}\n\n/// &lt;summary&gt;\n/// Represents a Request from the client. A Request is as follows.\n///\n///  Field Name         Type            Size (bytes)\n/// --------------------------------------------------\n///  RequestType        Integer         4\n///  Iterations         Integer         4\n///  ForceUpdate        Boolean         1\n///  ModelName          String          Variable\n///\n/// Strings are encoded via a character count prefix as a\n/// 32-bit integer, followed by an array of characters.\n///\n/// &lt;/summary&gt;\npublic class UpdateModelRequest : Request\n{\n  public int Iterations { get; }\n  public bool ForceUpdate { get; }\n  public string ModelName { get; }\n\n  public override RequestType Type =&gt; RequestType.UpdateModel;\n\n  public UpdateModelRequest(string modelName, int iterations, bool forceUpdate)\n  {\n    Iterations = iterations;\n    ForceUpdate = forceUpdate;\n    ModelName = modelName;\n  }\n\n  protected override void AddRequestBody(BinaryWriter writer)\n  {\n    writer.Write(Iterations);\n    writer.Write(ForceUpdate);\n    WriteLengthPrefixedString(writer, ModelName);\n  }\n}\n</pre>\n\nThe `ReadAsync()` method reads the request type from the stream and then, depending on the type, reads the corresponding data and creates an object of the corresponding request.\n\nImplementing a data transmission protocol and structuring requests as classes enable efficient management of information exchange between the client and the server, ensuring structured and comprehensible interaction between the two parties.\nHowever, when designing such protocols, it is essential to consider potential security risks and ensure that both ends of the interaction handle all possible scenarios correctly.\n\n#####<a name=\"3.8\"></a> Connection Management\n\nTo send messages from the UI client to the server, let's create a `ClientDispatcher` class that will handle connections, timeouts, and scheduling requests, providing an interface for client-server interaction via named pipes.\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n///     This class manages the connections, timeout and general scheduling of requests to the server.\n/// &lt;/summary&gt;\npublic class ClientDispatcher\n{\n  private const int TimeOutNewProcess = 10000;\n\n  private Task _connectionTask;\n  private readonly NamedPipeClientStream _client = NamedPipeUtil.CreateClient(PipeDirection.Out);\n\n  /// &lt;summary&gt;\n  ///   Connects to server without awaiting\n  /// &lt;/summary&gt;\n  public void ConnectToServer()\n  {\n    _connectionTask = _client.ConnectAsync(TimeOutNewProcess);\n  }\n\n  /// &lt;summary&gt;\n  ///   Write a Request to the server.\n  /// &lt;/summary&gt;\n  public async Task WriteRequestAsync(Request request)\n  {\n    await _connectionTask;\n    await request.WriteAsync(_client);\n  }\n}\n</pre>\n\nWorking principle:\n\n-  **Initialization:** the `NamedPipeClientStream` is initialized in the class constructor, used to create a client stream with a named pipe.\n-  **Establishing Connection:** the `ConnectToServer` method initiates an asynchronous connection to the server.\n   The operation's result is stored in a `Task`.\n   `TimeOutNewProcess` is used to disconnect the client in case of unexpected exceptions.\n-  **Sending Requests:** the `WriteRequestAsync` method is designed for asynchronously sending a Request object through the established connection.\n   The request will be sent only after the connection is established.\n\nTo receive messages by the server, we will create a `ServerDispatcher` class to manage the connection and read requests.\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n///     This class manages the connections, timeout and general scheduling of the client requests.\n/// &lt;/summary&gt;\npublic class ServerDispatcher\n{\n  private readonly NamedPipeServerStream _server = NamedPipeUtil.CreateServer(PipeDirection.In);\n\n  /// &lt;summary&gt;\n  ///   This function will accept and process new requests until the client disconnects from the server\n  /// &lt;/summary&gt;\n  public async Task ListenAndDispatchConnections()\n  {\n    try\n    {\n      await _server.WaitForConnectionAsync();\n      await ListenAndDispatchConnectionsCoreAsync();\n    }\n    finally\n    {\n      _server.Close();\n    }\n  }\n\n  private async Task ListenAndDispatchConnectionsCoreAsync()\n  {\n    while (_server.IsConnected)\n    {\n      try\n      {\n        var request = await Request.ReadAsync(_server);\n        if (request.Type == Request.RequestType.PrintMessage)\n        {\n          var printRequest = (PrintMessageRequest) request;\n          Console.WriteLine($\"Message from client: {printRequest.Message}\");\n        }\n        else if (request.Type == Request.RequestType.UpdateModel)\n        {\n          var printRequest = (UpdateModelRequest) request;\n          Console.WriteLine($\"The {printRequest.ModelName} model has been {(printRequest.ForceUpdate ? \"forcibly\" : string.Empty)} updated {printRequest.Iterations} times\");\n        }\n      }\n      catch (EndOfStreamException)\n      {\n        return; //Pipe disconnected\n      }\n    }\n  }\n}\n</pre>\n\nWorking principle:\n\n-  **Initialization:** the `NamedPipeServerStream` is initialized in the class constructor, used to create a server stream with a named pipe.\n-  **Listening for Connections:** The `ListenAndDispatchConnections()` method asynchronously waits for a client connection.\n   After processing the requests, it closes the named pipe and releases resources.\n-  **Handling Requests:** The `ListenAndDispatchConnectionsCoreAsync()` method handles requests until the client is disconnected.\n   Depending on the type of request, corresponding data processing occurs, such as displaying the message content in the console or updating the model.\n\nAn example of sending a request from the UI to the server:\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n///   Programme entry point\n/// &lt;/summary&gt;\npublic sealed partial class App\n{\n  public static ClientDispatcher ClientDispatcher { get; }\n\n  static App()\n  {\n    ClientDispatcher = new ClientDispatcher();\n    ClientDispatcher.ConnectToServer();\n  }\n}\n\n/// &lt;summary&gt;\n///   WPF view business logic\n/// &lt;/summary&gt;\npublic partial class MainViewModel : ObservableObject\n{\n  [ObservableProperty] private string _message = string.Empty;\n\n  [RelayCommand]\n  private async Task SendMessageAsync()\n  {\n    var request = new PrintMessageRequest(Message);\n    await App.ClientDispatcher.WriteRequestAsync(request);\n  }\n\n  [RelayCommand]\n  private async Task UpdateModelAsync()\n  {\n    var request = new UpdateModelRequest(AppDomain.CurrentDomain.FriendlyName, 666, true);\n    await App.ClientDispatcher.WriteRequestAsync(request);\n  }\n}\n</pre>\n\nThe complete code example is available in the repository, and you can run it on your machine by following a few steps:\n\n- Run \"Build Solution.\"\n- Run \"Run OneWay/Backend.\"\n\nThe application will automatically launch the Server and Client, and you will see the full output of the messages transmitted via the NamedPipe in the IDE console.\n\n#####<a name=\"3.9\"></a> Two-Way Communication\n\nThere are often situations where the usual one-way data transmission from the client to the server is not sufficient.\nIn such cases, it is necessary to handle errors or send results in response.\nTo enable more complex interaction between the client and the server, developers have to resort to the use of two-way data transmission, which allows for the exchange of information in both directions.\n\nSimilar to requests, to efficiently handle responses, it is also necessary to define an enumeration for response types.\nThis will enable the client to interpret the received data correctly.\n\n<pre class=\"prettyprint\">\npublic enum ResponseType\n{\n  // The update request completed on the server and the results are contained in the message.\n  UpdateCompleted,\n\n  // The request was rejected by the server.\n  Rejected\n}\n</pre>\n\nEfficient handling of responses will require creating a new class named `Response`.\nFunctionally, it does not differ from the Request class.\nHowever, unlike Request, which can be read on the server, Response will be written to the stream.\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n/// Base class for all possible responses to a request.\n/// The ResponseType enum should list all possible response types\n/// and ReadResponse creates the appropriate response subclass based\n/// on the response type sent by the client.\n/// The format of a response is:\n///\n/// Field Name       Field Type          Size (bytes)\n/// -------------------------------------------------\n/// ResponseType     enum ResponseType   4\n/// ResponseBody     Response subclass   variable\n/// &lt;/summary&gt;\npublic abstract class Response\n{\n  public enum ResponseType\n  {\n    // The update request completed on the server and the results are contained in the message.\n    UpdateCompleted,\n\n    // The request was rejected by the server.\n    Rejected\n  }\n\n  public abstract ResponseType Type { get; }\n\n  protected abstract void AddResponseBody(BinaryWriter writer);\n\n  /// &lt;summary&gt;\n  ///   Write a Response to the stream.\n  /// &lt;/summary&gt;\n  public async Task WriteAsync(Stream outStream)\n  {\n    // Same as request class from client\n  }\n\n  /// &lt;summary&gt;\n  /// Write a string to the Writer where the string is encoded\n  /// as a length prefix (signed 32-bit integer) follows by\n  /// a sequence of characters.\n  /// &lt;/summary&gt;\n  protected static void WriteLengthPrefixedString(BinaryWriter writer, string value)\n  {\n    // Same as request class from client\n  }\n}\n</pre>\n\nYou can find derivative classes in the project repository: [PipeProtocol](https://github.com/atomatiq/InterprocessCommunication/blob/main/TwoWay/Backend/Server/PipeProtocol.cs)\n\nTo enable the server to send responses to the client, we need to modify the `ServerDispatcher` class.\nThis will allow writing responses to the stream after executing a task.\n\nAdditionally, let's change the pipe direction to bidirectional:\n\n<pre class=\"prettyprint\">\n_server = NamedPipeUtil.CreateServer(PipeDirection.InOut);\n\n/// &lt;summary&gt;\n///     Write a Response to the client.\n/// &lt;/summary&gt;\npublic async Task WriteResponseAsync(Response response) =&gt; await response.WriteAsync(_server);\n</pre>\n\nTo demonstrate the operation, let's add a 2-second delay, emulating a heavy task, in the `ListenAndDispatchConnectionsCoreAsync()` method.\n\n<pre class=\"prettyprint\">\nprivate async Task ListenAndDispatchConnectionsCoreAsync()\n{\n  while (_server.IsConnected)\n  {\n    try\n    {\n      var request = await Request.ReadAsync(_server);\n\n      // ...\n      if (request.Type == Request.RequestType.UpdateModel)\n      {\n        var printRequest = (UpdateModelRequest) request;\n\n        await Task.Delay(TimeSpan.FromSeconds(2));\n        await WriteResponseAsync(new UpdateCompletedResponse(changes: 69, version: \"2.1.7\"));\n      }\n    }\n    catch (EndOfStreamException)\n    {\n      return; //Pipe disconnected\n    }\n  }\n}\n</pre>\n\nCurrently, the client does not handle responses from the server.\nLet's address this. Let's create a `Response` class in the client that will handle the received responses.\n\n<pre class=\"prettyprint\">\n/// &lt;summary&gt;\n/// Base class for all possible responses to a request.\n/// The ResponseType enum should list all possible response types\n/// and ReadResponse creates the appropriate response subclass based\n/// on the response type sent by the client.\n/// The format of a response is:\n///\n/// Field Name       Field Type          Size (bytes)\n/// -------------------------------------------------\n/// ResponseType     enum ResponseType   4\n/// ResponseBody     Response subclass   variable\n///\n/// &lt;/summary&gt;\npublic abstract class Response\n{\n  public enum ResponseType\n  {\n    // The update request completed on the server and the results are contained in the message.\n    UpdateCompleted,\n\n    // The request was rejected by the server.\n    Rejected\n  }\n\n  public abstract ResponseType Type { get; }\n\n  /// &lt;summary&gt;\n  ///   Read a Request from the given stream.\n  /// &lt;/summary&gt;\n  public static async Task&lt;Response&gt; ReadAsync(Stream stream)\n  {\n    // Same as request class from server\n  }\n\n  /// &lt;summary&gt;\n  /// This task does not complete until we are completely done reading.\n  /// &lt;/summary&gt;\n  private static async Task ReadAllAsync(Stream stream, byte[] buffer, int count)\n  {\n    // Same as request class from server\n  }\n\n  /// &lt;summary&gt;\n  /// Read a string from the Reader where the string is encoded\n  /// as a length prefix (signed 32-bit integer) followed by\n  /// a sequence of characters.\n  /// &lt;/summary&gt;\n  protected static string ReadLengthPrefixedString(BinaryReader reader)\n  {\n    // Same as request class from server\n  }\n}\n</pre>\n\nFurthermore, we'll update the `ClientDispatcher` class to handle responses from the server.\nTo do this, we'll add a new method and change the direction to bidirectional.\n\n<pre class=\"prettyprint\">\n_client = NamedPipeUtil.CreateClient(PipeDirection.InOut);\n\n/// &lt;summary&gt;\n///     Read a Response from the server.\n/// &lt;/summary&gt;\npublic async Task&lt;Response&gt; ReadResponseAsync() =&gt; await Response.ReadAsync(_client);\n</pre>\n\nWe'll also add response handling to the ViewModel, where we'll simply display it as a message.\n\n<pre class=\"prettyprint\">\n[RelayCommand]\nprivate async Task UpdateModelAsync()\n{\n  var request = new UpdateModelRequest(AppDomain.CurrentDomain.FriendlyName, 666, true);\n  await App.ClientDispatcher.WriteRequestAsync(request);\n\n  var response = await App.ClientDispatcher.ReadResponseAsync();\n  if (response.Type == Response.ResponseType.UpdateCompleted)\n  {\n    var completedResponse = (UpdateCompletedResponse) response;\n\n    MessageBox.Show($\"{completedResponse.Changes} elements successfully updated to version {completedResponse.Version}\");\n  }\n  else if (response.Type == Response.ResponseType.Rejected)\n  {\n    MessageBox.Show(\"Update failed\");\n  }\n}\n</pre>\n\nThese changes will allow for more efficient organization of the interaction between the client and the server, ensuring a more complete and reliable handling of requests and responses.\n\n#####<a name=\"3.10\"></a> Implementation for Revit plug-in\n\n<center>\n<img src=\"img/2023_revit_technology.jpg\" alt=\"Revit technology 2023\" title=\"Revit technology 2023\" width=\"500\"/>\n<p style=\"font-size: 80%; font-style:italic\">Technology evolves, Revit never changes © Confucius</p>\n</center>\n\nCurrently, Revit is using .NET Framework 4.8.\nHowever, to enhance the plugin user interface, let's consider upgrading to .NET 7.\nIt is important to note that the backend of the plugin will interact only with the outdated framework of Revit and will act as a server.\n\nLet's create a mechanism of interaction that allows the client to send requests for the deletion of model elements and subsequently receive responses regarding the deletion results.\nTo implement this functionality, we will use bidirectional data transfer between the server and the client.\n\nThe first step in our development process will be to enable the plugin to automatically close upon Revit's closure.\nTo accomplish this, we have written a method that sends the ID of the current process to the client.\nThis will help the client to automatically close its process upon the closure of the parent Revit process.\n\nHere is the code for sending the ID of the current process to the client:\n\n<pre class=\"prettyprint\">\nprivate static void RunClient(string clientName)\n{\n  var startInfo = new ProcessStartInfo\n  {\n    FileName = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location)!.AppendPath(clientName),\n    Arguments = Process.GetCurrentProcess().Id.ToString()\n  };\n\n  Process.Start(startInfo);\n}\n</pre>\n\nAnd here is the code for the client, which facilitates the closure of its process upon the closure of the parent Revit process:\n\n<pre class=\"prettyprint\">\nprotected override void OnStartup(StartupEventArgs args)\n{\n  ParseCommandArguments(args.Args);\n}\n\nprivate void ParseCommandArguments(string[] args)\n{\n  var ownerPid = args[0];\n  var ownerProcess = Process.GetProcessById(int.Parse(ownerPid));\n  ownerProcess.EnableRaisingEvents = true;\n  ownerProcess.Exited += (_, _) =&gt; Shutdown();\n}\n</pre>\n\nAdditionally, we require a method that will handle the deletion of selected model elements:\n\n<pre class=\"prettyprint\">\npublic static ICollection&lt;ElementId&gt; DeleteSelectedElements()\n{\n  var transaction = new Transaction(Document);\n  transaction.Start(\"Delete elements\");\n\n  var selectedIds = UiDocument.Selection.GetElementIds();\n  var deletedIds = Document.Delete(selectedIds);\n\n  transaction.Commit();\n  return deletedIds;\n}\n</pre>\n\nLet's also update the method `ListenAndDispatchConnectionsCoreAsync()` to handle incoming connections:\n\n<pre class=\"prettyprint\">\nprivate async Task ListenAndDispatchConnectionsCoreAsync()\n{\n  while (_server.IsConnected)\n  {\n    try\n    {\n      var request = await Request.ReadAsync(_server);\n      if (request.Type == Request.RequestType.DeleteElements)\n      {\n        await ProcessDeleteElementsAsync();\n      }\n    }\n    catch (EndOfStreamException)\n    {\n      return; //Pipe disconnected\n    }\n  }\n}\n\nprivate async Task ProcessDeleteElementsAsync()\n{\n  try\n  {\n    var deletedIds = await Application.AsyncEventHandler.RaiseAsync(_ =&gt; RevitApi.DeleteSelectedElements());\n    await WriteResponseAsync(new DeletionCompletedResponse(deletedIds.Count));\n  }\n  catch (Exception exception)\n  {\n    await WriteResponseAsync(new RejectedResponse(exception.Message));\n  }\n}\n</pre>\n\nAnd finally, the updated ViewModel code:\n\n<pre class=\"prettyprint\">\n[RelayCommand]\nprivate async Task DeleteElementsAsync()\n{\n  var request = new DeleteElementsRequest();\n  await App.ClientDispatcher.WriteRequestAsync(request);\n\n  var response = await App.ClientDispatcher.ReadResponseAsync();\n  if (response.Type == Response.ResponseType.Success)\n  {\n    var completedResponse = (DeletionCompletedResponse) response;\n    MessageBox.Show($\"{completedResponse.Changes} elements successfully deleted\");\n  }\n  else if (response.Type == Response.ResponseType.Rejected)\n  {\n    var rejectedResponse = (RejectedResponse) response;\n    MessageBox.Show($\"Deletion failed\\n{rejectedResponse.Reason}\");\n  }\n}\n</pre>\n\n####<a name=\"3.11\"></a> Installing .NET Runtime during plugin installation\n\nNot every user may have the latest version of .NET Runtime installed on their local machine, so we need to make some changes to the plugin installer.\n\nIf you are using the [Nice3point.RevitTemplates](https://github.com/Nice3point/RevitTemplates), making these adjustments will be effortless.\nThe templates use the WixSharp library, which enables the creation of `.msi` files directly in C#.\n\nTo add custom actions and install .NET Runtime, we will create a `CustomAction`:\n\n<pre class=\"prettyprint\">\npublic static class RuntimeActions\n{\n  /// &lt;summary&gt;\n  ///   Add-in client .NET version\n  /// &lt;/summary&gt;\n  private const string DotnetRuntimeVersion = \"7\";\n\n  /// &lt;summary&gt;\n  ///   Direct download link\n  /// &lt;/summary&gt;\n  private const string DotnetRuntimeUrl = $\"https://aka.ms/dotnet/{DotnetRuntimeVersion}.0/windowsdesktop-runtime-win-x64.exe\";\n\n  /// &lt;summary&gt;\n  ///   Installing the .NET runtime after installing software\n  /// &lt;/summary&gt;\n  [CustomAction]\n  public static ActionResult InstallDotnet(Session session)\n  {\n    try\n    {\n      var isRuntimeInstalled = CheckDotnetInstallation();\n      if (isRuntimeInstalled) return ActionResult.Success;\n\n      var destinationPath = Path.Combine(Path.GetTempPath(), \"windowsdesktop-runtime-win-x64.exe\");\n\n      UpdateStatus(session, \"Downloading .NET runtime\");\n      DownloadRuntime(destinationPath);\n\n      UpdateStatus(session, \"Installing .NET runtime\");\n      var status = InstallRuntime(destinationPath);\n\n      var result = status switch\n      {\n        0 =&gt; ActionResult.Success,\n        1602 =&gt; ActionResult.UserExit,\n        1618 =&gt; ActionResult.Success,\n        _ =&gt; ActionResult.Failure\n      };\n\n      File.Delete(destinationPath);\n      return result;\n    }\n    catch (Exception exception)\n    {\n      session.Log(\"Error downloading and installing DotNet: \" + exception.Message);\n      return ActionResult.Failure;\n    }\n  }\n\n  private static int InstallRuntime(string destinationPath)\n  {\n    var startInfo = new ProcessStartInfo(destinationPath)\n    {\n      Arguments = \"/q\",\n      UseShellExecute = false\n    };\n\n    var installProcess = Process.Start(startInfo)!;\n    installProcess.WaitForExit();\n    return installProcess.ExitCode;\n  }\n\n  private static void DownloadRuntime(string destinationPath)\n  {\n    ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12 | SecurityProtocolType.Tls11 | SecurityProtocolType.Tls;\n\n    using var httpClient = new HttpClient();\n    var responseBytes = httpClient.GetByteArrayAsync(DotnetRuntimeUrl).Result;\n\n    File.WriteAllBytes(destinationPath, responseBytes);\n  }\n\n  private static bool CheckDotnetInstallation()\n  {\n    var startInfo = new ProcessStartInfo\n    {\n      FileName = \"dotnet\",\n      Arguments = \"--list-runtimes\",\n      RedirectStandardOutput = true,\n      UseShellExecute = false,\n      CreateNoWindow = true\n    };\n\n    try\n    {\n      var process = Process.Start(startInfo)!;\n      var output = process.StandardOutput.ReadToEnd();\n      process.WaitForExit();\n\n      return output.Split('\\n')\n        .Where(line =&gt; line.Contains(\"Microsoft.WindowsDesktop.App\"))\n        .Any(line =&gt; line.Contains($\"{DotnetRuntimeVersion}.\"));\n    }\n    catch\n    {\n      return false;\n    }\n  }\n\n  private static void UpdateStatus(Session session, string message)\n  {\n    var record = new Record(3);\n    record[2] = message;\n\n    session.Message(InstallMessage.ActionStart, record);\n  }\n}\n</pre>\n\nThis code checks whether the required version of .NET is installed on the local machine, and if not, it downloads and installs it.\nThe installation process updates the `Status` of the current progress of downloading and unpacking the Runtime.\n\nFinally, we need to connect the `CustomAction` to the WixSharp project. To do this, we initialize the `Actions` property:\n\n<pre class=\"prettyprint\">\nvar project = new Project\n{\n  Name = \"Wix Installer\",\n  UI = WUI.WixUI_FeatureTree,\n  GUID = new Guid(\"8F2926C8-3C6C-4D12-9E3C-7DF611CD6DDF\"),\n  Actions = new Action[]\n  {\n    new ManagedAction(RuntimeActions.InstallDotnet,\n      Return.check,\n      When.Before,\n      Step.InstallFinalize,\n      Condition.NOT_Installed)\n  }\n};\n</pre>\n\n####<a name=\"3.12\"></a> Conclusion\n\nIn this article, we explored how Named Pipes, primarily used for Inter-Process Communication (IPC), can be used in scenarios requiring data exchange between applications running on different .NET versions.\nDealing with code that needs to be maintained across multiple versions, a well-considered IPC strategy can be valuable, providing key benefits such as:\n\n- Dependency conflict resolution\n- Enhancing performance\n- Functional flexibility\n\nWe discussed the process of creating a server and client that interact with each other through a pre-defined protocol, as well as various ways of managing connections.\n\nWe examined an example of server responses and demonstrated the operation of both sides of the interaction.\n\nFinally, we underscored how Named Pipes are used in the development of a plugin for Revit to provide communication between the backend operating on the legacy .NET 4.8 platform and the user interface running on the newer .NET 7 version.\n\nDemo code for each part of this article is available on GitHub.\n\nIn certain cases, splitting applications into separate processes can not only reduce dependencies within the program but also improve the UI responsiveness.\nHowever, let us not forget that the choice of approach requires analysis and should be based on the actual requirements and constraints of your project.\n\nDo you need to split each plugin into multiple processes? Definitely not.\n\nWe hope that this article will help you find the best solution for your interprocess communication scenarios and give you an understanding of how to apply IPC approaches in practice.\n\nMany thanks to Roman for his deep research and careful documentation of this important topic, in addition to all his maintenance work on RevitLookup."
  },
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "Fuyu-8B Multimodal Architecture for AI Agents",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Fuyu-8B Multimodal Architecture for AI Agents\n\nAnother open source multimodal model hit the scene,\n[Fuyu-8B: A Multimodal Architecture for AI Agents](https://www.adept.ai/blog/fuyu-8b).\nIt can be run offline on a laptop CPU."
  },
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "How Open Source Wins",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> How Open Source Wins\n\n[Open Source does not win by being cheaper](https://github.com/getlago/lago/wiki/Open-Source-does-not-win-by-being-cheaper#how-open-source-winsby-solving-an-extensibility-problem),\nbut by offering tranparency, extensibility and quality."
  },
  {
    "original_filename": "2012_dll_paradise",
    "header_text": "HTTP/3",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> HTTP/3\n\nDid you notice that you have started using HTTP/3?\nI hadn't.\nLearn [why HTTP/3 is eating the world](https://blog.apnic.net/2023/09/25/why-http-3-is-eating-the-world/)."
  }
][
  {
    "original_filename": "2013_pernickety",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- pernickety blogging\n\ntwitter:\n\nImportant, less important and absolutely pernickety recommendations on perfecting API-related blog posts for the @AutodeskAPS @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/pernickety\n\nSome important, some less important and some absolutely pernickety recommendations on perfecting API-related blog posts...\n\n&ndash; ...\n\nlinkedin:\n\nImportant, less important and absolutely pernickety recommendations on perfecting API-related blog posts for the #RevitAPI\n\nhttps://autode.sk/pernickety\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2013_pernickety",
    "header_text": "Pernickety Blogging",
    "local_header_href": "#pernickety-blogging",
    "chunk_text": "### Pernickety Blogging\n\nI am still in hospital, convalescent with 9 fractured ribs and the right broken hip screwed back together again front and back.\nThe main screw is 7.3 mm x 180 mm.\nThey would have preferred to use 190 mm length but didn't have any available.\nI have big bones.\n\nMy friend Madlee has a nice saying in her smartphone email footer:\n\n- Alles isch gued; wenn's no nid gued isch denn isch es au no nid am End aacho!\n<span style=\"text-align: right; font-style: italic\">&ndash;  [Alemannic](https://en.wikipedia.org/wiki/Alemannic_German) saying\n&ndash; All is well; if it's not well, it's not over yet</span>\n\nThat applies to my broken hip, basically to all of life, and also to every blog post.\n\nMy colleague George published his first Revit-API-related blog post last week,\n[How to use ToElements Method correctly](https://adndevblog.typepad.com/aec/2023/10/how-to-use-toelements-method-correctly.html).\n\nCongratulations on that, George, and many thanks for your work and contributions!\nIt is perfect in every way.\nAnd yet, it also provides an opportunity for me to share one slightly crazy aspect of my personality: exaggerated perfectionism.\n\nBefore getting to the exaggerated perfectionism, let me point out\nthe more important [blogging tips and tricks](https://thebuildingcoder.typepad.com/blog/2014/07/wishlist-blogging-smartgeometry-dynamo-and-formit.html) that\nI listed for earlier colleagues getting started with this.\n\nI checked the post in advance before publication and gave it my OK.\nHowever, to me, it makes a total difference checking it in advance or actually seeing it in print, in its final published version.\nThe effect of that difference on my perception is tremendous and astounding.\nI use this effect myself writing my own blog posts, correcting, previewing, checking, fixing, twiddling and often making a huge number of minute corrections and improvements in the final stages of publication, just before hitting the ultimate publish button.\n\nIn this case, I noticed a typo to correct.\nWhen I was about to tell George, I noticed another little detail to improve, and another.\nI was astounded by the number and irrelevance of the improvement possibilities that struck my eye.\n\nExcept for the two typos, all my suggestions can be ignored.\nAnd yet, re-reading them, I decided to share them both with George and Carol, who is also just starting to blog, and with you, dear reader, to ponder; please also feel perfectly free to ignore, refute, reject and ridicule:\n\nThe post currently looks like this:\n\n<center>\n<img src=\"img/pernickety_blogging.png\" alt=\"Pernickety blogging\" title=\"Pernickety blogging\" width=\"600\"/> <!-- Pixel Height: 1,702 Pixel Width: 1,572 -->\n</center>\n\n<!--\n\nStill, I made a note of one or two things to improve, e.g., the typo in one of the repetitions of the methos name.\nOnce I'd started, I fiound it hard to stop. One thing added to another, and I ended up with an absolutely shocking list of possible enhancement.\nSince I want to praise George and not criticise in any way whatsoever, I pondered my options and ended up deciding that I am crazy and willing to share the fact including this list of suggestions for pernickety blogging:\n-->\n\nHere are my pernickety suggestions for enhancement:\n\n- Title case in title, Capital U and C: How to Use ToElements Method Correctly\n- Plural 'couple of questions': There *have* been a couple of questions\n- Missing 'the'\n- `ToElements` is code, so should be noted as such typographically, e.g., using a monospace font such as Courier\n- In HTML, code is normally tagged using `pre` or `code`;\n  in [Markdown](https://en.wikipedia.org/wiki/Markdown), you can use a backtick, i.e., <code>&grave;ToElements&grave;</code>\n- The word 'method' is lowercase: usage of `ToElements` Method\n- The word 'class' is lowercase: `FilteredElementCollector` class\n- Typo, missing 'n': ToElemets\n- Typo, 'examples' is plural: examples that demonstrate\n- Code indentation: leading spaces inside the loops\n- Code colourisation: C# syntax and keywords in different colours\n- Avoid long lines in sample code; add line breaks to improve readability\n- Readable link, not just the naked raw URL\n\nMy corrected version ends up looking like this:\n\n<hr/>"
  },
  {
    "original_filename": "2013_pernickety",
    "header_text": "How to Use ToElements Method Correctly",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> How to Use ToElements Method Correctly\n\nThere have been a couple of questions regarding the usage of the `ToElements` method while filtering elements using the `FilteredElementCollector` class.\nThe `ToElements` method in the `FilteredElementCollector` class returns the complete set of elements that meet the specified filter criteria as a generic `IList`.\n\nHowever, it's also worth noting that some members of the Revit API community tend to use the ToElemets method after using the FilteredElementCollector which in turn increases memory usage and slows down the performance of the same.\n\nOne reason for using ToElements is to obtain the element count. However, that can also be achieved by calling GetElementCount.\n\nAnother more valid reason is to access the elements in the list by index, e.g., you have 1000 elements in the list and you want to read their data in a specific order, e.g., #999, #1, #998, #2 or whatever. Then, you need the index provided by the list, and cannot just iterate over them on the predefined order provided by the enumerator.\n\nHere are examples that demonstrate the usage of the two:\n\nExample 1, using FilteredElementCollector alone to iterate over all Wall elements:\n\n<pre class=\"prettyprint\">\n  IEnumerable walls\n    = new FilteredElementCollector(doc)\n      .OfClass(typeof(Wall));\n\n  foreach (Element item in walls)\n  {\n    ElementId id = item.Id;\n  }\n</pre>\n\nExample 2, using both FilteredElementCollector and ToElements to iterate over all Wall elements:\n\n<pre class=\"prettyprint\">\n  IList wallList\n    = new FilteredElementCollector(doc)\n      .OfClass(typeof(Wall))\n        .ToElements();\n\n  foreach (Element item in wallList)\n  {\n    ElementId id = item.Id;\n  }\n</pre>\n\nMore details and links to further related discussions are provided in the analysis of\nthe [performance](https://thebuildingcoder.typepad.com/blog/2016/04/how-to-distinguish-redundant-rooms.html#2)\nin [how to distinguish redundant rooms](https://thebuildingcoder.typepad.com/blog/2016/04/how-to-distinguish-redundant-rooms.html).\n\n<hr/>\n\nHere is a link to the markdown source code for this blog post,\n[2013_pernickety.md](https://github.com/jeremytammik/tbc/blob/gh-pages/a/2013_pernickety.md),\nwhere you can see the Markdown text I edited to produce this.\n\nI have used a variety\nof [tools for C&#35;, Python and VB code colourisation](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.36) in\nthe past.\n\nIn this post, I just employed the [Google JavaScript code prettifier `code-prettify`](https://github.com/googlearchive/code-prettify) instead.\n\nHowever, this tool is no longer being maintained, so it is actually time to switch to yet another solution...\n\nAnother reason to replace it would be that it requires me to manually replace `<` and `>` signs with their HTML escape characters `&lt;` and `&gt;`.\n\nSo, to wrap up:\n\nPlease excuse me for being pernickety, George and Carol.\nIt seems to be my nature, so best accept it and let it be...\nDoes this extra work have any advantages?\nIs it worth the effort?\nUp to each and every person to decide for herself, I would say...\n\n[Jonathon Broughton adds](https://www.linkedin.com/feed/update/urn:li:activity:7124104311315279872?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7124104311315279872%2C7124255520466554880%29&dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287124255520466554880%2Curn%3Ali%3Aactivity%3A7124104311315279872%29):\n\nThe second paragraph of your corrected version contains a typo.\n`ToElemets` should be `ToElements`.\n\nIt takes a persnickety practitioner to know one 😎\n\n*Response:* Great.\nI wonder should I leave it for other practitioners to pick up as well?\nI think it would be appreciated...\nI'll add your correction to the post and out myself (yet again) as a pernickety failure."
  }
][
  {
    "original_filename": "2014_rbp_shapely",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Revit Batch Processor project\nJan Christel <jan.r.christel@gmail.com>\nI’ve been following your website for a number of years by know and would like to say thank you for your posts and insights. They are a really great help when getting started with the Revit API.\nFor the last 3 years I’ve been developing code using the Revit API in context of the Revit Batch Processor project which you are familiar with. The library has now grown to reasonable size and might be useful for others too. It focusses mainly on reporting / modifying element data and families. It show cases how to start a number of batch processor sessions concurrently using either .bat or power shell to process a large number of files.\nA link to the GitHub repo: https://github.com/jchristel/SampleCodeRevitBatchProcessor and the pypi package: https://pypi.org/project/DuHast/\n\n- https://neal.fun/internet-artifacts/\n\n- shapely dynamo\nDurmuş Cesur (Bayryam)\nHi Jeremy,  I read your article about \"Shapely Geometry\" in the last weeks, I was very happy to see it because in April I released a package called \"Shapely\" for Dynamo, so that users can easily work with \"Shapely Geometries\". I am a BIM Manager, the Shapely package plays an incredible role in our daily work and in the plug-in of the office. Here you can find the contents of the package. Github : https://github.com/DurmusCesur/Shapely.git Linkednl : https://www.linkedin.com/pulse/shapely-dynamo-durmu%25C5%259F-cesur-bayryam-/?trackingId=9aYP9eQpR8%2Be%2B7CCRqldtw%3D%3D  I care a lot about this package because apart from manipulating geometries, it is now integrated with Machine Learning. In the following days, I will release the \"1.1.1.1\" version of the package and users will now be able to use their scenarios with Machine Learning training models via Shapely, and as a Dynamo user for many years, I am very excited. I just published an article about the Shapely-Machine Learning relationship on linkednl. You can access it here: Linkednl : https://www.linkedin.com/pulse/machine-learning-dynamo-durmu%25C5%259F-cesur-bayryam--m9xoe/?trackingId=9aYP9eQpR8%2Be%2B7CCRqldtw%3D%3D  What are you thinking? I would really like to chat with you about this.  Best regards, Durmus\nJeremy Tammik (Sir)  4:04 AM\nDear Durmuş, thank you for letting me know. I will add a note of that to the blog as well, if you like. Cheers, Jeremy.\nDurmuş Cesur(Bayryam)  6:02 AM\nHi Jeremy,  That would be great, thank you very much.  Best Durmus\nDurmuş Cesur(Bayryam)  9:25 AM\nHi Jeremy,  Whatever you need for that, you can tell me. I can do it for you\n\ntwitter:\n\nPowerful tools and solutions for RFA and RVT batch processing, 2D geometric analysis with Shapely for Dynamo, machine learning in Dynamo, retrieving Toposolid contour lines with the @AutodeskAPS @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/dynamoshapely\n\nPowerful tools and solutions for batch processing, 2D geometric analysis and toposolids\n&ndash; Revit batch processor sample code\n&ndash; Shapely for Dynamo\n&ndash; Retrieve Toposolid contour lines\n&ndash; Internet artifacts...\n\nlinkedin:\n\nPowerful tools and solutions for RFA and RVT batch processing, 2D geometric analysis with Shapely for Dynamo, machine learning in Dynamo, retrieving Toposolid contour lines with the #RevitAPI\n\nhttps://autode.sk/dynamoshapely\n\n- Revit batch processor sample code\n- Shapely for Dynamo\n- Retrieve Toposolid contour lines\n- Internet artifacts...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2014_rbp_shapely",
    "header_text": "Contour Lines, Batch Processor and Dynamo Shapely",
    "local_header_href": "#contour-lines-batch-processor-and-dynamo-shapely",
    "chunk_text": "### Contour Lines, Batch Processor and Dynamo Shapely\n\nPowerful tools and solutions for batch processing, 2D geometric analysis and toposolids:\n\n- [Revit batch processor sample code](#2)\n- [Shapely for Dynamo](#3)\n- [Machine learning in Dynamo](#3.1)\n- [Retrieve Toposolid contour lines](#4)\n- [Internet artifacts](#5)"
  },
  {
    "original_filename": "2014_rbp_shapely",
    "header_text": "Revit Batch Processor Sample Code",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Revit Batch Processor Sample Code\n\nSeveral  years ago, we pointed out the\npowerful [Revit Batch Processor (RBP)](https://thebuildingcoder.typepad.com/blog/2019/11/the-revit-batch-processor-rbp.html).\n\n[Jan Christel](https://github.com/jchristel) has implemented and shared\na number of Python code samples making use of it in\nhis [code samples for the Revit Batch Processor](https://github.com/jchristel/SampleCodeRevitBatchProcessor),\nexplaining:\n\n> I’ve been following your website for a number of years by know and would like to say thank you for your posts and insights.\nThey are a really great help when getting started with the Revit API.\nFor the last 3 years I’ve been developing code using the Revit API in context of the Revit Batch Processor project which you are familiar with.\nThe library has now grown to reasonable size and might be useful for others too. It focusses mainly on reporting and modifying element data and families.\nIt showcases how to start a number of batch processor sessions concurrently using either `.bat` or PowerShell to process a large number of files.\nHere are links to the [SampleCodeRevitBatchProcessor GitHub repo](https://github.com/jchristel/SampleCodeRevitBatchProcessor) and\nthe [DuHast PyPI package](https://pypi.org/project/DuHast/).\n\nMany thanks to Jan for sharing these."
  },
  {
    "original_filename": "2014_rbp_shapely",
    "header_text": "Shapely for Dynamo",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Shapely for Dynamo\n\nWe recently discussed\nthe [Shapely Python 2D geometry library](https://thebuildingcoder.typepad.com/blog/2023/09/element-diff-compare-shapely-and-rdbe.html#4) and\nhow it can be used\nto [find and fix a hole](https://thebuildingcoder.typepad.com/blog/2023/09/element-diff-compare-shapely-and-rdbe.html#4.1).\n\nDurmuş Cesur (Bayryam) of [BPA Architecture](https://bpa.archi/) announced an associated Dynamo package to wrap it and provide access to its functionality:\n\n- [Github DurmusCesur/Shapely](https://github.com/DurmusCesur/Shapely)\n\nDurmuş adds:\n\n> I read your article about Shapely Geometry in the last weeks. I was very happy to see it, because in April I released a package called Shapely for Dynamo, so that users can easily work with Shapely Geometries.\nI am a BIM Manager, the Shapely package plays an incredible role in our daily work and in the plug-in of the office.\nI care a lot about this package because apart from manipulating geometries, it is now integrated with Machine Learning. In the following days, I will release the \"1.1.1.1\" version of the package and users will be able to use their scenarios with Machine Learning training models via Shapely, and as a Dynamo user for many years, I am very excited.\nI just published an article about\nthe [Shapely Machine Learning relationship in Dynamo](https://www.linkedin.com/pulse/machine-learning-dynamo-durmu%C5%9F-cesur-bayryam--m9xoe) on LinkedIn.\n\n<center>\n<img src=\"img/shapely_dynamo.png\" alt=\"Shapely for Dynamo\" title=\"Shapely for Dynamo\" width=\"600\"/>\n</center>\n\nShapely is a great Python library that helps us analyse and manipulate geometries.\nWe think it is important to include this library in Dynamo.\nShapely uses its own geometry language.\nTherefore, transformations must be made between each other without losing data. In this package you will find a Dynamo version of Shapely geometry.\nI made a tutorial for you on the Github page; you can use it to get a feel for the polygons and let me know if you have any questions or corrections.\nThe package is completely open source.\nI am one of those people who think open source is important!\n\nHere are some examples:\n\n- ShapelytoDynamo &ndash; It converts a dynamo geometry into a \"Shapely\" geometry without any data loss.\n  There is also a transformation of the shapely geometry obtained in a similar way to the dynamo geometry.\n- DynamotoShapely &ndash; It converts a shapely geometry into a dynamo geometry without any data loss.\n- ShapelyBuffer &ndash; Using a dynamo geometry (polygon, polycurve), it creates a new geometry by looking at the user’s offset distance in the same line of the units that make up the geometry. The user can decide the sharpness of the edges of the created geometry.\n- ShapelyDifference &ndash; It allows us to analyse the relationship between 2 geometries. It subtracts one geometry from the other and returns a new closed geometry containing the remaining geometry.\n- Shapelyİntersection &ndash; Allows us to analyse the relationship between 2 geometries. It extracts 2 geometries from each other and returns a new closed geometry. The result is always a polygon, polycurve and a list of points that make up the geometry.\n- ShapelyUnion &ndash; Allows us to analyse the relationship between 2 geometries. It combines 2 geometries and returns a closed new geometry. The result is always a polygon, polycurve and a list of points that make up the geometry.\n- ShapelySnap &ndash; It allows us to analyse the relationship between 2 geometries. It returns a new closed geometry that adapts to the contours of the geometry approaching the distance specified by the user. The result is always a polygon, polycurve and a list of points that make up that geometry.\n- ShapelyConvexHull &ndash; Dynamo uses the points to create the outermost polygon that the points will form. The result is always a polygon, polycurve and a list of points that form that geometry.\n- ShapelyRotateSkew &ndash; Using a 2D dynamo geometry (polygon), it rotates the geometry in the ground plane in the X and Y axes as if it were a 3D geometry and creates a new geometry.\n- ShapelyOffset &ndash; Using a dynamo geometry (polygon, polycurve), it creates a new geometry by looking at the user’s offset distance in the same line of the units that make up the geometry. The generated geometry is always meaningful and stable. The user can decide the sharpness of the edges of the generated geometry.\n- ShapelySetPrecision &ndash; Using a dynamo geometry (polygon, polycurve), it allows the user to specify the points that make up the geometry and returns a new geometry. This geometry differs from the parent geometry because the position of the vertices that make up the geometry has changed.\n- ShapelyTouchesDistance &ndash; Using a dynamo geometry (polygon, polycurve) allows us to analyse geometries within a distance specified by the user. For this purpose, it finds the points at right angles of all geometries around it and analyses the distance between the main geometry and returns \"True\" and \"False\".\n\nMany thanks to Durmuş for implementing and sharing this powerful tool!\n\n####<a name=\"3.1\"></a> Machine Learning in Dynamo\n\nDurmuş adds: A few days ago I wrote an article about Machine Learning on DynamoBlog.\nToday a copy of this article was published somewhere at NASA.\nThis is incredible news.\nI wanted to share it with you.\nYou can find it here:\n[Machine Learning in Dynamo](https://dynamobim.org/machine-learning-in-dynamo/):\n\n> With advancing technology, we see the widespread use of Machine Learning in almost all industries.\nBut can a vector-based numerical design program work with ML?\nThe answer to this question is a definite “Yes, it can.”\nThe “Shapely geometry” package not only allows users to manipulate 2D geometries but also integrates seamlessly with ML.\nIn other words, the “Shapely” package comes equipped with ML capabilities, making it more functional and significantly expanding its processing capacity."
  },
  {
    "original_filename": "2014_rbp_shapely",
    "header_text": "Retrieve Toposolid Contour Lines",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Retrieve Toposolid Contour Lines\n\nNing Zhou raised the question\non [how to get contour lines from toposolid](https://forums.autodesk.com/t5/revit-api-forum/how-to-get-contour-lines-from-toposolid/m-p/12315476) and\nsubsequently discovered, tested and shared the solution.\n\nThe gist of it is that the contour lines are view dependent, so you need to be specific about which view to use to retrieve the toposolid geometry.\n\nMy colleague Carol Gitonga picked up this thread to publish her first Revit API blog post,\nalso titled [how to get contour lines from Toposolid](https://adndevblog.typepad.com/aec/2023/11/how-to-get-contour-lines-from-toposolid.html).\n\nCongratulations, Ning, on solving the issue!\n\nCongratulations, Carol, on a very nice blogging debut!\n\nThank you both for your work and sharing the results!"
  },
  {
    "original_filename": "2014_rbp_shapely",
    "header_text": "Internet Artifacts",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Internet Artifacts\n\nFinally, let's close with an entertaining look back in time through a collection\nof [internet artifacts](https://neal.fun/internet-artifacts/) by Neal.fun."
  }
][
  {
    "original_filename": "2015_2024_2_update",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\ntwitter:\n\nThe Revit 2024.2 update release is interesting for developers as well, addressing extensible storage schema conflicts in Revit 2024 and including universal data access UDA preview with the @AutodeskAPS @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/revit_2024_2_update\n\nThe recent Revit 2024 update release is interesting for developers as well\n&ndash; Autodesk Revit 2024.2 update\n&ndash; Extensible storage schema conflicts in Revit 2024\n&ndash; Universal data access UDA in Revit 2024.2\n&ndash; Inpoly.c point in polygon algorithm...\n\nlinkedin:\n\nThe Revit 2024.2 update release is interesting for developers as well, addressing extensible storage schema conflicts in and including universal data access UDA preview with the #RevitAPI\n\nhttps://autode.sk/revit_2024_2_update\n\n- Autodesk Revit 2024.2 update\n- Extensible storage schema conflicts in Revit 2024\n- Universal data access UDA in Revit 2024.2\n- Inpoly.c point in polygon algorithm...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2015_2024_2_update",
    "header_text": "Revit 2024.2 Update with UDA Preview",
    "local_header_href": "#revit-20242-update-with-uda-preview",
    "chunk_text": "### Revit 2024.2 Update with UDA Preview\n\nThe recent Revit 2024 update release is interesting for developers as well:\n\n- [Autodesk Revit 2024.2 update](#2)\n- [Extensible storage schema conflicts in Revit 2024](#3)\n- [Universal data access UDA in Revit 2024.2](#4)\n- [Inpoly.c point in polygon algorithm](#5)"
  },
  {
    "original_filename": "2015_2024_2_update",
    "header_text": "Autodesk Revit 2024.2 Update",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Autodesk Revit 2024.2 Update\n\n[Autodesk Revit 2024.2 is now available](https://blogs.autodesk.com/aec/2023/11/08/revit-2024-2-is-now-available/).\n\n2024.2 is compatible with the previous 2024.1.1 update and can be used together with it on project work.\n\nThe 2024.1.1 and 2024.2 updates are especially important for work-sharing users.\nIn such a context, all project team members should be using at least these releases of Revit or higher to avoid\nthe [extensible storage schema conflicts in Revit 2024](#3)\ndescribed below.\n\nOther API-related enhancement include:\n\n- Fixed an issue in which API function Parameter.Definition.GetDataType().TypeId returned obsolete specs (spec schemas that inherit from the obsolete base specs \"autodesk.spec:spec.int64-1.0.0\", \"autodesk.spec:spec.measurable-1.0.0\", and \"autodesk.spec:spec.string-1.0.0\".)\n- Added an API for adding points (plural) on SlabShapeEditor\n- Fixed an issue when an element with Entity attached is operated by a user in an upgraded file and a previous version file is opened in the same session containing the same schema, cf. [below](#3)\n- MEP Electrical Circuits: Improved the API ElectricalSystem.Create() to make it use the voltage of the first matched connector when creating an electrical system with the connectors whose voltages were mapped to an instance parameter, cf. ricaun's comment on the Revit API forum discussion thread\non [NewElectricalSystem specify voltage and poles](https://forums.autodesk.com/t5/revit-api-forum/newelectricalsystem-specify-voltage-amp-poles/m-p/12366308#M75140) &ndash; thank you, Luiz!\n- Dynamo for Revit: Upgraded Dynamo Core version to 2.19.3. Please refer to\nthe [DynamoDS 2.19 release notes](https://github.com/DynamoDS/Dynamo/wiki/Release-Notes#219) for more details\n\nNon-API-related enhancements cover Area Plans, Data Analytics, Design Option, Edit, Materials, Properties Dialog, UI Frameworks, Worksharing, Energy &ndash; Analytical Model and MEP Fabrication + Analytical Systems + Electrical Analytical + Electrical Circuits.\n\nFor full details, please refer to\nthe [Revit 2024.2 announcement](https://blogs.autodesk.com/aec/2023/11/08/revit-2024-2-is-now-available/),\nthe [2024.2 update release notes](https://help.autodesk.com/view/RVT/2024/ENU/?guid=RevitReleaseNotes_2024updates_2024_2_html),\nthe [issues resolved](https://help.autodesk.com/view/RVT/2024/ENU/?guid=RevitReleaseNotes_2024updates_2024_2_Resolved_Issues_2024_2_html) and\nthe [list of enhancements](https://help.autodesk.com/view/RVT/2024/ENU/?guid=RevitReleaseNotes_2024updates_2024_2_Enhancements_2024_2_html)."
  },
  {
    "original_filename": "2015_2024_2_update",
    "header_text": "Extensible Storage Schema Conflicts in Revit 2024",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Extensible Storage Schema Conflicts in Revit 2024\n\nOne import issue resolved by Revit 2024.2 and especially related to the Revit API addresses an extensible storage schema issue affecting addons and projects that are upgraded for Revit 2024,\ncf. [not able to delete extensible storage schema](https://forums.autodesk.com/t5/revit-api-forum/not-able-to-delete-extensible-storage-schema/m-p/10729533).\n\nThe 2024.1.1 and 2024.2 updates are especially important for work-sharing users.\nIn such a context, all project team members should be using at least these releases of Revit or higher to avoid the possibility of older versions of Revit 2024 reintroducing schema problems back to the project models.\nTo learn more about this issue, please refer to the support article\non [schema conflicts in Revit 2024](https://www.autodesk.com/support/technical/article/caas/sfdcarticles/sfdcarticles/Schema-Conflicts-with-DatasmithRevitExportSettings-and-DataStorageUniqueId-in-Revit-2024-1.html)."
  },
  {
    "original_filename": "2015_2024_2_update",
    "header_text": "Universal Data Access UDA in Revit 2024.2",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Universal Data Access UDA in Revit 2024.2\n\nRevit 2024.2 includes a Tech Preview of the new Revit Home page, including Universal Data Access (UDA) components.\nRevit customers using this version can access their data &ndash; including cloud data in BIM and ACC &ndash; with the same seamless experience as other products that have adopted UDA such as AutoCAD, Fusion, Civil3D and Inventor.\n\n<!--\n\nFor a quick first impression, watch the three-minute [UDA in Revit 2024.2 demo](https://share.autodesk.com/sites/DesignAndMakeData/_layouts/15/stream.aspx?id=%2Fsites%2FDesignAndMakeData%2FShared%20Documents%2FDemos%2FUDA%20in%20Revit%202024%2E2%20Demo%2Emp4&ga=1&referrer=StreamWebApp%2EWeb&referrerScenario=AddressBarCopied%2Eview) video:\n\n<center>\n<iframe src=\"https://share.autodesk.com/sites/DesignAndMakeData/_layouts/15/embed.aspx?UniqueId=a9b59d52-54e1-40f2-8d79-3e485348f556&embed=%7B%22ust%22%3Atrue%2C%22hv%22%3A%22CopyEmbedCode%22%7D&referrer=StreamWebApp&referrerScenario=EmbedDialog.Create\" width=\"640\" height=\"360\" frameborder=\"0\" scrolling=\"no\" allowfullscreen title=\"UDA in Revit 2024.2 Demo.mp4\"></iframe>\n</center>\n\n-->\n\nIn Revit App Home, toggle the new Revit Home button to activate UDA:\n\n<center>\n<img src=\"img/rvt_2024_2_new_revit_home.png\" alt=\"New Revit Home\" title=\"New Revit Home\" width=\"500\"/>\n</center>\n\n- UDA offers both a list view and grid view granting access to recent files data in ACC and Bing 360.\n- In the recent panel, you can use the pin command to secure files at the top of the list.\n- Filters are available to sort files by date and type and you can click on the column head to sort files.\n- Switching to grid view will reveal detailed preview thumbnails.\n- Pin command is also available in grid view.\n- The search functionality can be used to locate files within the Recent files.\n- Moving to the Autodesk Projects panel, users can explore cloud data.\n- You can switch between hubs, select a project and navigate through folders and files.\n- Use the column settings to adjust column visibility and display order.\n- Files in the cloud can be filtered by their dates and types.\n- Simply click on the file name to open it.\n- By clicking the top left toggle button, you can transition between app home and the design environment.\n- UDA offers flexibility, allowing product teams to incorporate their workflows into UDA, including features like relinquish file version management.\n- One of the significant benefits that UDA brings to rapid users is the search feature.\n- It enables users to find files and projects in the Autodesk cloud swiftly and easily.\n- Command entries are consistently available in both list view and grid view.\n- UDA allows products to display data items in various states.\n- In Revit, users can choose to hide projects and files not in the current version or opt to display them in a disabled state.\n- An enhanced tooltip is also provided for displaying detailed information.\n\nWe are looking forward to your valuable feedback on this functionality."
  },
  {
    "original_filename": "2015_2024_2_update",
    "header_text": "Inpoly.c Point in Polygon Algorithm",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Inpoly.c Point in Polygon Algorithm\n\nLet's close with a useful algorithm and somewhat funny article pointed out by Andrzej Malesa in his post\non [analytical opening creation throws ArgumentException](https://forums.autodesk.com/t5/revit-api-forum/analytical-opening-creation-throws-argumentexception/m-p/12368576/highlight/false#M75167):\n\n- [A Point about Polygons](https://www.visibone.com/inpoly/) including\nthe source code listing of the INPOLY.C algorithm to determine whether a point is inside a polygon\n\nI enjoyed that read and maybe you will as well.\n\nHappy weekend!"
  }
][
  {
    "original_filename": "2016_closed_room_bound",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Boost Your BIM by Harry Mattison\n  Journal File Magic & Exporting Groups to File (the grand finale)\n  https://boostyourbim.wordpress.com/2023/11/03/journal-file-magic-exporting-groups-to-file-the-grand-finale/\n  Journal File Magic & Exporting Groups to File (part 2)\n  https://boostyourbim.wordpress.com/2023/11/02/journal-file-magic-exporting-groups-to-file-part-2/\n  Journal File Magic & Exporting Groups to File (part 1)\n  https://boostyourbim.wordpress.com/2023/11/01/journal-file-magic-exporting-groups-to-file-part-1/\n\n- replacing [Revit 2024 'Other' Parameter Group] or BuiltInParameterGroup.INVALID\n  Revit 2024 'Other' Parameter Group\n  https://forums.autodesk.com/t5/revit-api-forum/revit-2024-other-parameter-group/td-p/12086226\n\ntwitter:\n\nJournal file magic, closed contiguous room boundary loop, challenges identifying adjacent rooms and ForgeTypeId for 'Other' parameter group with the @AutodeskAPS @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/roomboundary\n\nTaking a look at journal files, room boundaries, adjacent rooms, a ForgeTypeId question and where AI might lead\n&ndash; Harry's journal file magic\n&ndash; Closed contiguous room boundary loop\n&ndash; Challenges identifying adjacent rooms\n&ndash; ForgeTypeId for 'Other' parameter group\n&ndash; AI may obsolete all apps...\n\nlinkedin:\n\nJournal file magic, closed contiguous room boundary loop, challenges identifying adjacent rooms and ForgeTypeId for 'Other' parameter group with the #RevitAPI\n\nhttps://autode.sk/roomboundary\n\n- Harry's journal file magic\n- Closed contiguous room boundary loop\n- Challenges identifying adjacent rooms\n- ForgeTypeId for 'Other' parameter group\n- AI may obsolete all apps...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2016_closed_room_bound",
    "header_text": "Journal Magic, Adjacent Rooms and Room Boundary",
    "local_header_href": "#journal-magic-adjacent-rooms-and-room-boundary",
    "chunk_text": "### Journal Magic, Adjacent Rooms and Room Boundary\n\nTaking a look at journal files, room boundaries, adjacent rooms, a ForgeTypeId question and one view of where AI might lead:\n\n- [Harry's journal file magic](#2)\n- [Closed contiguous room boundary loop](#3)\n- [Challenges identifying adjacent rooms](#4)\n- [ForgeTypeId for 'Other' parameter group](#5)\n- [AI may obsolete all apps](#6)"
  },
  {
    "original_filename": "2016_closed_room_bound",
    "header_text": "Harry's Journal File Magic",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Harry's Journal File Magic\n\nBoost Your BIM by Harry Mattison published a nice series\non [journal file magic and exporting groups to file](https://boostyourbim.wordpress.com/2023/11/03/journal-file-magic-exporting-groups-to-file-the-grand-finale/).\nTo be precise, it consists of three instalments:\n\n- [Journal File Magic &amp; Exporting Groups to File (part 1)](https://boostyourbim.wordpress.com/2023/11/01/journal-file-magic-exporting-groups-to-file-part-1/)\n- [Journal File Magic &amp; Exporting Groups to File (part 2)](https://boostyourbim.wordpress.com/2023/11/02/journal-file-magic-exporting-groups-to-file-part-2/)\n- [Journal File Magic &amp; Exporting Groups to File (grand finale)](https://boostyourbim.wordpress.com/2023/11/03/journal-file-magic-exporting-groups-to-file-the-grand-finale/)\n\nMany thanks to Harry for implementing and sharing this useful and educational solution."
  },
  {
    "original_filename": "2016_closed_room_bound",
    "header_text": "Closed Contiguous Room Boundary Loop",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Closed Contiguous Room Boundary Loop\n\nLoren Routh of [GSA](https://www.gsa.gov) presents a quick and easy method to reliably retrieve a closed contiguous boundary loop for a room using `GetRoomBoundaryAsCurveLoopArray` from the `ExporterIFC` module in his answer\nto [creating a generic model from area boundaries](https://forums.autodesk.com/t5/revit-api-forum/creating-a-generic-model-from-area-boundaries/m-p/12371317#M75201):\n\n> This just in:\nI tried the `GetRoomBoundaryAsCurveLoopArray` method, and it totally worked!\nYou need to import the `ExporterIFC` module, etc.\nThis method eliminated a chunk of code, no sorting or extracting the curves.\nIt let me create an extrusion (manually) with no errors at all!\nAs you can see by the pic below, this was not a rectangle.\nDefinitely has my vote to be included in the regular Revit API.\nNow to make it work with Generic Models...\n\n<pre class=\"prettyprint\">\n  import clr\n  clr.AddReferenceToFileAndPath(r'C:\\Program Files\\Autodesk\\Revit 2023\\AddIns\\IFCExporterUI\\Autodesk.IFC.Export.UI.dll')\n  clr.AddReference(\"RevitAPIIFC\")\n  from Autodesk.Revit.DB.IFC import ExporterIFC\n  from Autodesk.Revit.DB.IFC import ExporterIFCUtils\n\n  opt = DB.SpatialElementBoundaryOptions()\n\n  curve_loop = ExporterIFCUtils.GetRoomBoundaryAsCurveLoopArray(selected_area, opt, True)\n\n  with DB.Transaction(doc, \"Create Model Lines\") as tx:\n    tx.Start()\n\n    sketch_plane = DB.SketchPlane.Create(doc,selected_area.LevelId)\n\n    for loop in curve_loop:\n      for line in loop:\n        crv = doc_create.NewModelCurve(line, sketch_plane)\n\n    tx.Commit()\n</pre>\n\n<center>\n<img src=\"img/getroomboundaryascurvelooparray.png\" alt=\"GetRoomBoundaryAsCurveLoopArray\" title=\"GetRoomBoundaryAsCurveLoopArray\" width=\"500\"/> <!-- Pixel Height: 1,278 Pixel Width: 1,590 -->\n</center>\n\nMany thanks to Loren for sharing this valuable hint."
  },
  {
    "original_filename": "2016_closed_room_bound",
    "header_text": "Challenges Identifying Adjacent Rooms",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Challenges Identifying Adjacent Rooms\n\nIlia Krachkovskii [shared](https://www.linkedin.com/posts/ilia-krachkovskii_im-currently-working-on-a-so-called-spatial-activity-7125803558834167808-NXwt?utm_source=share&utm_medium=member_desktop) some\nthoughts and challenges identifying adjacent rooms\n\n> I'm currently working on a so-called \"Spatial Breakdown System\" that identifies location and generates corresponding location code for each element in Revit model. It will allow architects at Marco Casamonti & Partners / Archea Associati to create very flexible schedules and will help with data management inside the projects.\n\n> I have been working with Revit API for quite some time, and just recently started to understand all the complaints one can find on countless threads: so far I have 15 different methods for calculating the room (or the nearest room) for various types of elements. Here are some of them:\n\n> - non-bounding walls: place points on wall curve every X meters using Evaluate() method, check room on each point using GetRoomAtPoint() method.\n- bounding walls: same, but for each point I calculate the normal to the curve (using ComputeDerivatives() method) and check the points on a specified distance from wall curve.\n- roofs: usually they cover lots of rooms, so it's just excessive.\n- furniture: LocationPoint and LocationCurve don't always work, so the backup plan is just checking the centerpoint of a BoundingBox.\n- door and windows: fairly easy, since they have a built-in FromRoom and ToRoom property.\n- floors and ceilings: along with walls, one of the most tricky, but more precise method that features cross-referencing. Find all rooms that contain BoundingBox of a floor, get LocationPoint of each room, and shoot a checking ray from each point using ReferenceIntersector up or down, depending on the element class. If there is an intersection - boom, there's a room that contains your floor or ceiling. Pretty fascinating approach that deserves its own article.\n- stair runs and landings are harder to collect, since they act as a part of the Stair. Getting location can be done with GetRoomAtPoint() method using a BoundingBox centerpoint, however, it may be more reliable to calculate run curve midpoint using GetStairsPath().\n- model in place is the most atrocious piece to work with. They don't have built-in level parameters or anything else that easily identifies them in space. They have only geometry, so the easiest approach, again, would be simply checking the bounding box points - which has many accuracy issues.\n- curtain wall panels and mullions: one could get the location from the host wall, but they usually cover several rooms. My approach: take BoundingBox, enlarge X and Y dimensions by K meters and check for intersection with any rooms in the project.\n\n> Code sample below is used to calculate all the rooms that are formed by (or those that are very near to) a particular wall:\n\n<center>\n<img src=\"img/wall_get_all_adjacent_rooms.jpg\n\" alt=\"Retrieve adjacent rooms\" title=\"Retrieve adjacent rooms\" width=\"600\"/> <!-- Pixel Height: 1,530 Pixel Width: 1,656 -->\n</center>"
  },
  {
    "original_filename": "2016_closed_room_bound",
    "header_text": "ForgeTypeId for 'Other' Parameter Group",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> ForgeTypeId for 'Other' Parameter Group\n\nKevin Fielding shared a quick, easy and effective solution for replacing the `Other` parameter group or the `BuiltInParameterGroup` `INVALID` in his thread\non [Revit 2024 'Other' parameter group](https://forums.autodesk.com/t5/revit-api-forum/revit-2024-other-parameter-group/td-p/12086226):\n\nWith the changeover to `ForgeTypeId` and `GroupTypeId` in Revit 2024 instead of the `BuiltInParameterGroup` enumerations, I just wanted to share how to define the 'Other' group for parameters, as it doesn't appear to be documented.\n\nWhereas previously you would use\n\n<pre class=\"prettyprint\">\n  BuiltInParameterGroup.INVALID\n</pre>\n\nIn 2024 and beyond you need to use\n\n<pre class=\"prettyprint\">\n  new ForgeTypeId(string.Empty)\n</pre>\n\nOther groups can be found using the `GroupTypeId` class, like `GroupTypeId.Data`.\n\nHope this helps others searching for this.\n\nIn fact, the same question came up again in the question\non [Revit 2024 GroupTypeId missing ParameterGroup Other (Invalid)](https://forums.autodesk.com/t5/revit-api-forum/revit-2024-grouptypeid-missing-parametergroup-other-invalid/m-p/12288651/highlight/false#M74502).\n\nThanks, Kevin, for clarifying this!"
  },
  {
    "original_filename": "2016_closed_room_bound",
    "header_text": "AI May Obsolete All Apps",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> AI May Obsolete All Apps\n\nBill Gates presents an interesting vision of the future of personal computing\nin [The future of agents &ndash; AI is about to completely change how you use computers &ndash; and upend the software industry](https://www.gatesnotes.com/AI-agents)."
  }
][
  {
    "original_filename": "2017_os_projects",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- https://github.com/jeremytammik/RevitLookup/releases\n\n- https://forum.dynamobim.com/t/revitpythondocs-for-dynamo-and-pyrevit-request-for-feedback/95280?u=jacob.small\n\n- interactive open source Revit SDK sample browser and launcher\n  https://forums.autodesk.com/t5/revit-api-forum/feedback-requested-on-open-source-revit-api-sample-browser/m-p/12386403\n\n- purge add-in with rave reviews searching for new maintainer\n  https://forums.autodesk.com/t5/revit-api-forum/project-sweeper-revved-and-other-apps-now-open-source/m-p/12386626\n\n- speedcad tools: OptionsBar, StatusBar\n  https://forums.autodesk.com/t5/revit-api-forum/optionsbar/m-p/12377344\n  https://github.com/SpeedCAD/SCADtools.Revit.UI.ProgressMeter\n  https://github.com/SpeedCAD/SCADtools.Revit.UI.OptionsBar\n  cf. Roman's Open-Source OptionsBar\n  https://thebuildingcoder.typepad.com/blog/2023/09/optionsbar-and-bye-bye-to-da4r-2018.html#2\n\n- Jean-Marc Couffin pointed out some interesting solutions to manage multiple versions of API on the pyRevit forum\n  Support multiple versions of Revit in invokebuttons (dll projects, Visual Studio)\n  https://discourse.pyrevitlabs.io/t/support-multiple-versions-of-revit-in-invokebuttons-dll-projects-visual-studio/1849/9?u=ali.tehami\n\n- designscript, rhino, and other geometry libraries in revit add-in\n  Using DesignScript in Revit addin\n  https://forums.autodesk.com/t5/revit-api-forum/using-designscript-in-revit-addin/td-p/8203199\n\ntwitter:\n\n#RevitAPI preview C# 7, RevitPythonDocs, Revit SDK sample browser, purge add-in, OptionsBar, StatusBar, multiple API versions, DesignScript, Rhino, and other geometry libraries with @AutodeskAPS @AutodeskRevit #BIM @DynamoBIM https://autode.sk/dotnetcorepreview\n\nOpen-source related discussions, interesting Revit API and AI related news\n&ndash; Revit preview release with C&#35; 7\n&ndash; RevitLookup 2024.0.9 is here\n&ndash; RevitPythonDocs for Dynamo and pyRevit\n&ndash; New Revit SDK sample browser and launcher\n&ndash; Purge add-in with rave reviews\n&ndash; SpeedCad tools OptionsBar and StatusBar\n&ndash; Managing multiple Revit API versions\n&ndash; DesignScript, Rhino, and other geometry libraries\n&ndash; Trading glass beads for AI IP...\n\nlinkedin:\n\n#RevitAPI preview C# 7, RevitPythonDocs, Revit SDK sample browser, purge add-in, OptionsBar, StatusBar, multiple API versions, DesignScript, Rhino, and other geometry libraries\n\nhttps://autode.sk/dotnetcorepreview\n\n- Revit preview release with C&#35; 7\n- RevitLookup 2024.0.9 is here\n- RevitPythonDocs for Dynamo and pyRevit\n- New Revit SDK sample browser and launcher\n- Purge add-in with rave reviews\n- SpeedCad tools OptionsBar and StatusBar\n- Managing multiple Revit API versions\n- DesignScript, Rhino, and other geometry libraries\n- Trading glass beads for AI IP...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": ".NET Core Preview and Open Source Add-In Projects",
    "local_header_href": "#net-core-preview-and-open-source-add-in-projects",
    "chunk_text": "### .NET Core Preview and Open Source Add-In Projects\n\nA lot of open-source related interaction going on, plus other interesting Revit API and AI related news:\n\n- [Revit preview release with C&#35; 7](#2)\n- [RevitLookup 2024.0.9 is here](#3)\n- [RevitPythonDocs for Dynamo and pyRevit](#4)\n- [New Revit SDK sample browser and launcher](#5)\n- [Purge add-in with rave reviews](#6)\n- [SpeedCad tools OptionsBar and StatusBar](#7)\n- [Managing multiple Revit API versions](#8)\n- [DesignScript, Rhino, and other geometry libraries](#9)\n- [Trading glass beads for AI IP](#10)"
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "Revit Preview Release with C&#35; 7",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Revit Preview Release with C&#35; 7\n\nAs my colleague George points out, the current Revit preview release includes access to the a more modern .NET framework:\n[Revit API is moving to .NET Core 7.0](https://adndevblog.typepad.com/aec/2023/11/revit-api-is-moving-to-net-core-70.html).\n\nThe new preview is now available from\nthe [Revit Preview Project](https://feedback.autodesk.com/key/LHMJFVHGJK085G2M).\n\n[First reactions](https://www.linkedin.com/feed/update/urn:li:activity:7133897795630985216):\n\nPedro Nadal [says](https://www.linkedin.com/feed/update/urn:li:activity:7133897795630985216?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7133897795630985216%2C7133910174628524032%29&dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287133910174628524032%2Curn%3Ali%3Aactivity%3A7133897795630985216%29):\nThe possibility of being able to develop Revit addins in .NET Core is one of the most awaited news for a long time!\nFantastic, hopefully the project will go ahead and we will have news soon.\n\nDeniz Maral [adds a correction](https://www.linkedin.com/feed/update/urn:li:activity:7133897795630985216?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7133897795630985216%2C7133915379029925888%29&dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287133915379029925888%2Curn%3Ali%3Aactivity%3A7133897795630985216%29):\n.NET Core 7 comes with C# 11.0, not 7.0.\nIn .NET Framework 4.8 we had already C# 7.3 &nbsp; :)\n\nThank you for your thoughts and corrections, Pedro and Deniz!"
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "RevitLookup 2024.0.9 is Here",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> RevitLookup 2024.0.9 is Here\n\nA new version RevitLookup 2024.0.9 has been released.\nCheck out the numerous enhancements in\nthe [RevitLookup releases](https://github.com/jeremytammik/RevitLookup/releases).\n\nMany thanks\nto [Sergey Nefyodov](https://github.com/SergeyNefyodov)\nand Roman [@Nice3point](https://t.me/nice3point) Karpovich, aka Роман Карпович,\nfor all their contributions and maintenance work!"
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "RevitPythonDocs for Dynamo and pyRevit",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> RevitPythonDocs for Dynamo and pyRevit\n\n[Gerhard P](https://forum.dynamobim.com/u/gerhard.p)\nshared a new Dynamo and pyRevit initiative,\n[RevitPythonDocs for Dynamo and pyRevit &ndash; request for feedback](https://forum.dynamobim.com/t/revitpythondocs-for-dynamo-and-pyrevit-request-for-feedback/95280):\n\n> Going the first steps at creating a collection of Python scripts for Dynamo and pyRevit 1, I´d like to know what are your needs when you are looking for code, classes, methods.\n\n> - [Revit Python Docs](http://www.revitpythondocs.com/)\n\n> It will for sure get search and filter options, but for now it´s more of creating a good naming convention and finding out what code is really needed. In the following what I have come up with so far and I´m looking forward to your thoughts and hopefully contributions! The code is on Github.\n\n> Some rules for the code:\n\n> - Every script is a full working code including imports.\n- Necessary imports only.\n- No inputs from dynamo needed, necessary elements are created in the code.\n- Dynamo code: tabs as indent only.\n- pyRevit 1 code: spaces as indent only.\n- No comments, just clean code.\n- snake_case only, for variables, functions, everything.\n- No “for i in a:”, proper names for everything (except list comprehension).\n\n> Code is available in different versions, [check the original post for examples](https://forum.dynamobim.com/t/revitpythondocs-for-dynamo-and-pyrevit-request-for-feedback/95280)...\n\nMany thanks to Gerhard for the initiative and to Jacob Small for pointing it out."
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "New Revit SDK Sample Browser and Launcher",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> New Revit SDK Sample Browser and Launcher\n\nChristopher Diggins presents a new interactive open-source Revit SDK sample browser and launcher:\n[feedback requested on open-source Revit API sample browser](https://forums.autodesk.com/t5/revit-api-forum/feedback-requested-on-open-source-revit-api-sample-browser/m-p/12386403):\n\n> I do a fair amount of development using the Revit API.\nFor my own reference, and to test some other plug-ins I am developing, I aggregated all of the Revit C# SDK Sample into a single project.\nI provided a simple UI so that each of the Commands and Applications can be launched by double clicking on the names.\nSelecting an item's load the associated readme file in a rich text edit box:\n\n<center>\n<img src=\"img/cd_revit_sample_browser.png\" alt=\"Revit SDK sample browser\" title=\"Revit SDK sample browser\" width=\"442\"/> <!-- Pixel Height: 613 Pixel Width: 881 -->\n</center>\n\n> I've posted the code to Github here:\n\n> - [Ara 3D Revit Sample Browser](https://github.com/ara3d/revit-sample-browser)\n\n> I haven't had time to test all of the samples, but it seems to be working.\nI'd appreciate any feedback!\n\nThis looks like an absolutely brilliant project and a great piece of work.\nThanks ever so much to Christopher for picking it up, tackling and sharing it.\nIt has some slight similarity to my own RvtSamples project, as aged and old-fashioned as many of the SDK samples.\nThat enables launching all the Revit SDK external commands but implements a more primitive UI and provides no built-in access to the sample documentation.\nThe new sample browser also supports external applications as well as external commands!\nGreat job!"
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "Purge Add-In with Rave Reviews",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Purge Add-In with Rave Reviews\n\n[Kfpopeye shared several useful open-source Revit API projects](https://thebuildingcoder.typepad.com/blog/2021/09/kfpopeye-open-source-avf-and-other-cleanup.html#2) two years ago.\n\nSome of them received rave reviews and a lot of interest was expressed to update them and find a new name and maintainer in the recent continuation of\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [Project Sweeper, ReVVed, and other apps now open source](https://forums.autodesk.com/t5/revit-api-forum/project-sweeper-revved-and-other-apps-now-open-source/m-p/12386626).\n\nIt will be interesting to see where this leads."
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "SpeedCad Tools OptionsBar and StatusBar",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> SpeedCad Tools OptionsBar and StatusBar\n\nIn yet another discussion on open-source code sharing and the importance of adding a suitable license in order to enable people to make use of their code, Speed_CAD shared\ntheir [ProgressMeter](https://forums.autodesk.com/t5/revit-api-forum/progressmeter/td-p/12363674)\nand [OptionsBar](https://forums.autodesk.com/t5/revit-api-forum/optionsbar/m-p/12377344) utility DLLs.\nHere are the associated GitHub repositories:\n\n- [ProgressMeter](https://github.com/SpeedCAD/SCADtools.Revit.UI.ProgressMeter)\n- [OptionsBar](https://github.com/SpeedCAD/SCADtools.Revit.UI.OptionsBar)\n\nBy the way, the latter is comparable with Roman's recent\nfully [Open-Source OptionsBar](https://thebuildingcoder.typepad.com/blog/2023/09/optionsbar-and-bye-bye-to-da4r-2018.html#2)."
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "Managing Multiple Revit API Versions",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Managing Multiple Revit API Versions\n\nAndrea Tassera, Jean-Marc Couffin and others discuss some interesting solutions to manage multiple versions of API on the pyRevit forum thread on how\nto [support multiple versions of Revit in invokebuttons (dll projects, Visual Studio)](https://discourse.pyrevitlabs.io/t/support-multiple-versions-of-revit-in-invokebuttons-dll-projects-visual-studio)."
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "DesignScript, Rhino, and other Geometry Libraries",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> DesignScript, Rhino, and other Geometry Libraries\n\nSome interesting and illuminating aspects of using DesignScript, Rhino, and other geometry libraries with the Revit API are discussed in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [using DesignScript in Revit addin](https://forums.autodesk.com/t5/revit-api-forum/using-designscript-in-revit-addin/td-p/8203199)."
  },
  {
    "original_filename": "2017_os_projects",
    "header_text": "Trading Glass Beads for AI IP",
    "local_header_href": "#10",
    "chunk_text": "####<a name=\"10\"></a> Trading Glass Beads for AI IP\n\nNot too long ago, some people acquired coveted goods from less business savvy folks with glass beads.\n\nNowadays, one example of coveted goods are AI IP, the glass beads are compute time, the less business savvy seem to be the AI enthusiasts of OpenAI, and guess who is business savvy?\n\n- [OpenAI’s Misalignment and Microsoft’s Gain](https://stratechery.com/2023/openais-misalignment-and-microsofts-gain/)"
  }
][
  {
    "original_filename": "2018_topo_mat_came_targ",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script>\n</head>\n\n<!---\n\n- Toposolid\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1700155564738649\n  The creation of the type is based on this thread: https://autodesk.slack.com/archives/C0SR6NAP8/p1673638599787309\n\n- Camera Target\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1700492804688869\n  Jeff Hotchkiss\n  I'm looking to convert Revit views for transfer into cloud REST API calls e.g. into LMV. Looking over supplied Revit help on the subject, I've found most of what I need but I'm curious if there's any way in API to retrieve the view camera target point as listed in that documentation? The docs suggest that the target can be reset to the fov centre, but not how to get the existing value, or whether the value has any significance to Revit e.g. orbit point. Thanks in advance for any assistance. (edited)\n  Alex Pytel\n\ntwitter:\n\nImplement a Chromium browser in your add-in WPF control using the built-in @AutodeskRevit CefSharp, and setting the Toposolid subdivision material and camera target using the #RevitAPI @AutodeskAPS  #BIM @DynamoBIM https://autode.sk/toposubdivmaterial\n\nA quick look at CefSharp and conversations shedding light on Toposolids and camera settings\n&ndash; Using the built-in CefSharp browser\n&ndash; Toposolid subdivision material\n&ndash; Camera target...\n\nlinkedin:\n\nImplement a Chromium browser in your add-in WPF control using the built-in Revit CefSharp, and setting the Toposolid subdivision material and camera target using the #RevitAPI\n\nhttps://autode.sk/toposubdivmaterial\n\n- Using the built-in CefSharp browser\n- Toposolid subdivision material\n- Camera target...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2018_topo_mat_came_targ",
    "header_text": "Camera Target and Toposolid Subdivision Material",
    "local_header_href": "#camera-target-and-toposolid-subdivision-material",
    "chunk_text": "### Camera Target and Toposolid Subdivision Material\n\nToday, let's take a quick look at CefSharp and two conversations shedding light on specific aspects of Toposolids and camera settings:\n\n- [Using the built-in CefSharp browser](#2)\n- [Toposolid subdivision material](#3)\n- [Camera target](#4)"
  },
  {
    "original_filename": "2018_topo_mat_came_targ",
    "header_text": "Using the Built-In CefSharp Browser",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Using the Built-In CefSharp Browser\n\nAndrej Licanin of [Bimexperts](https://bimexperts.com/sr/home) shared\na nice succinct little solution demonstrating how to use the Revit built-in CefSharp installation to display a browser in a WPF control in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [simple WPF with a chromium browser guide](https://forums.autodesk.com/t5/revit-api-forum/simple-wpf-with-a-chromium-browser-guide/td-p/12396552):\n\n> This is for all the lost souls out there, may you avoid my suffering.\n\n> To create a chromium web browser in your Revit addin, you need to reference cefsharp dlls.\nThis is where I had a major hiccup, because I just installed the newest one by nuget.\nDon't do this.\nRevit already has them and it initializes them on start-up.\nYou just need to add references to them like the other Revit API .dlls.\nThey are in the CefSharp folder.\nFor me, that is *C:\\Program Files\\Autodesk\\Revit 2022\\CefSharp*,\nand the files are:\n\n> - CefSharp\n- CefSharp.BrowserSubprocess.Core\n- CefSharp.Core\n- CefSharp.Wpf\n\nOnce installed, you can just add a WPF window, reference the namespace and embed a chromium browser like this:\n\n<pre class=\"prettyprint\">\n&lt;Window x:Class=\"RevitTestProject.TestWindow\"\n  xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n  xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n  xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n  xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n  xmlns:local=\"clr-namespace:RevitTestProject\"\n  xmlns:cef=\"clr-namespace:CefSharp.Wpf;assembly=CefSharp.Wpf\"\n  mc:Ignorable=\"d\"\n  Width=\"1000\" Height=\"500\"&gt;\n  &lt;Grid Background=\"PapayaWhip\"&gt;\n    &lt;cef:ChromiumWebBrowser Name=\"ChromiumBrowser\"\n      Address=\"http://www.google.com\"\n      Width=\"900\" Height=\"450\"/&gt;\n  &lt;/Grid&gt;\n&lt;/Window&gt;\n</pre>\n\nHope this helps someone, as I lost an entire day figuring this out.\n\nThank you very much, Andrej!"
  },
  {
    "original_filename": "2018_topo_mat_came_targ",
    "header_text": "Toposolid Subdivision Material",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Toposolid Subdivision Material\n\nA Toposolid subdivision material can be set using a specific built-in parameter to hold the material id:\n\n**Question:**\nIn Revit 2024, I'm creating a Toposolid using a ToposolidType that has a finish layer with a texture in the material.\nI then use Toposolid.CreateSubDivision to create a subdivision in the toposolid, but this subdivision is not inheriting the material from the hosting toposolid.\nAny ideas what I need to do to get the material to show properly?\nIs there a way to set the material for the top face of a Toposolid?\n\n<center>\n<img src=\"img/toposolid_subdiv_mat_1.png\" alt=\"Toposolid subdivision material\" title=\"Toposolid subdivision material\" width=\"600\"/>\n<p/>\n<img src=\"img/toposolid_subdiv_mat_2.png\" alt=\"Toposolid subdivision material\" title=\"Toposolid subdivision material\" width=\"600\"/>\n</center>\n\nThe brown areas are the subdivisions.\n\n**Answer:** The subdivision is designed NOT to inherit materials from the host toposolid.\nAlso, \"Edit Type\" is not enabled in the UI.\nAs an alternative, could you try to change the material Id of the subdivision element and see if that works?\n\n**Response:** Toposolid does not have a MaterialID.\nThat's why I had to bake the material into the ToposolidType.\n\n**Answer:** The subdivision has a `BuiltInParameter` `TOPOSOLID_SUBDIVIDE_MATERIAL` to control the material.\nIt can only be set to one material id.\nI did a quick example.\nPlease check out the following code for reference:\n\n<pre class=\"prettyprint\">\n  [Transaction(TransactionMode.Manual)]\n  public class ChangeSubdivisionMaterial : IExternalCommand\n  {\n    public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)\n    {\n      var uidoc = commandData.Application.ActiveUIDocument;\n      var doc = uidoc.Document;\n      var sel = uidoc.Selection;\n\n      Toposolid topo = doc.GetElement(sel.PickObject(\n        ObjectType.Element, new ToposolidFilter())) as Toposolid;\n      ToposolidType topoType = doc.GetElement(topo.GetTypeId()) as ToposolidType;\n      ElementId materialId = topoType.GetCompoundStructure().GetLayers().First().MaterialId;\n\n      List&lt;Toposolid&gt; subdivisions = new FilteredElementCollector(doc)\n        .OfClass(typeof(Toposolid))\n        .OfType&lt;Toposolid&gt;()\n        .Where(t =&gt; t.HostTopoId == topo.Id)\n        .ToList();\n      Transaction trans = new Transaction(doc, \"change material\");\n      trans.Start();\n      subdivisions.ForEach(t =&gt; t.get_Parameter(\n        BuiltInParameter.TOPOSOLID_SUBDIVIDE_MATERIAL)\n          .Set(materialId));\n      trans.Commit();\n\n      return Result.Succeeded;\n    }\n  }\n</pre>\n\n<center>\n<img src=\"img/toposolid_subdiv_mat_3.gif\" alt=\"Toposolid subdivision material\" title=\"Toposolid subdivision material\" width=\"600\"/>\n</center>\n\nThanks to Greg Marr and Yueqiang Ni for this explanation."
  },
  {
    "original_filename": "2018_topo_mat_came_targ",
    "header_text": "Camera Target",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Camera Target\n\nThe Revit API does not care much about the camera target, but other environments do:\n\n**Question:**\nI'm looking to convert Revit views for transfer into cloud REST API calls e.g. into LMV.\nLooking over supplied Revit help on the subject, I've found most of what I need but I'm curious if there's any way in API to retrieve the view camera target point as listed in that documentation?\nThe docs suggest that the target can be reset to the FOV centre, but not how to get the existing value, or whether the value has any significance to Revit e.g. orbit point.\n\nI looked at some existing related articles, e.g.:\n\n- [Custom Exporter GetCameraInfo](http://thebuildingcoder.typepad.com/blog/2014/09/custom-exporter-getcamerainfo.html)\n- [Revit Camera Settings, Project Plasma, DA4R and AI](https://thebuildingcoder.typepad.com/blog/2019/06/revit-camera-settings-project-plasma-da4r-and-ai.html)\n- [Revit Camera FOV, Forge Partner Talks and Jobs](https://thebuildingcoder.typepad.com/blog/2020/04/revit-camera-fov-forge-partner-talks-and-jobs.html)\n- [Save and Restore 3D View Camera Settings](https://thebuildingcoder.typepad.com/blog/2020/10/save-and-restore-3d-view-camera-settings.html)\n\nThey help confirm aspects covered by the linked documentation.\nThe challenge is that going the other way, creating a valid target for APS, is less easily grasped since Revit doesn't expose this in the API.\nSo far I'm extrapolating from the crop box, and it doesn't seem to matter if I pick e.g. a ray through the near clipping plane or far clipping plane, LMV gets the general idea.\nIt's not quite right in result yet, though.\n\n**Answer:**\nI am not finding a way to get the target using the API.\nAs a workaround, I can suggest trying to fake the target location.\nFor example, if you look from above, the field of view makes a triangle.\nIf you know the horizontal extent of the view, you can find how far the base of the triangle is from the camera's eye.\nNote that this is different from the distance to near / far planes.\nYou could also perform a calculation based on the bounding box of the scene (view outline).\nIf you can get the outline in view coordinates (and have it axis-aligned), then you can assume that the target is on the far face of the box. (This is still different from the far clipping plane.)\nUnfortunately, the target is not used consistently in Revit, including for navigation.\nSo, it is fair to say that the significance of the location is not great.\nThis might explain why it has been neglected in API.\n\n**Response:**\nI think I grasp the fundamentals you mean but am unsure which components in the API describe them.\nFor example, you mention a distinction between the base of the view's frustum (triangle as seen from above when including the origin) and the far clipping plane.\nYet the diagram in the docs (lets' start with perspective) shows the Crop Box of the view as describing the clipping planes.\nNot clear to me which object contains this smaller frustum you reference. (of course this is all hard to convey in text, we might need a diagram :laughing:).\nI should also have been specific in that the views of interest for us are 3D at this time.\n\n**Answer:**\nThe crop box is view aligned and all six sides are potentially clipping planes.\nNear/Far as used with perspective are generally independently managed.\nFor your case, I would suggest that you disregard perspective near/far and just try to obtain some sensible values based on the crop box and view outline.\nIn other words, a workaround for not having a target position is to try to locate the target based on scene depth.\nYou could place the fake target in the center of some bounding volume of the scene or on its far side.\nYou could even try to shoot a ray and intersect the closest object.\nI think that can be done using the API.\nIt will not be the camera's exact target, however.\nBut, as I said, it is not consistently used for navigation, so it might not be that useful anyway.\n\n**Response:** Sounds good &ndash; I think my current code uses the far side of the crop box at the moment.\nI'll experiment further.\nSome of this will likely depend on what LMV and related tooling does with the input anyway.\na follow-up, if you know &ndash; is it feasible to find out from the Revit API the actual navigation pivot point?\n\n**Answer:**\nI doubt it, because it is a dynamic concept.\nFor example, if you have something selected, then the pivot point can be the center of selection.\nIt looks like you might be able to get/set a home camera using ViewNavigationToolSettings.\nAnd it has a pivot point (but no target).\nThat seems to be the closest one can get...\nFor completeness, there is a target value one can get during the custom exporter process, but it is a fake value, which is computed as I roughly described above.\nIt's something like\n\n<pre class=\"prettyprint\">\n  0.5 * view width / tan(fov / 2)\n</pre>\n\n**Response:**\nThanks very much!\nAnd target and pivot are not the same.\n\nThanks to Jeff Hotchkiss and Alex Pytel for this clarification."
  }
][
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- <script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script> -->\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- https://github.com/jeremytammik/RevitLookup/releases/tag/2024.0.10\n  General\n  Introducing a brand new feature: Restore window size! Now, effortlessly you will open RevitLookup with your preferred window dimensions with a simple click\n  Improvements\n  Add MEPSystem.GetSectionByIndex support by @SergeyNefyodov in #189\n  Add MEPSystem.GetSectionByNumber support by @SergeyNefyodov in #189\n  Add MEPSection.GetElementIds support by @SergeyNefyodov in #192\n  Add MEPSection.GetCoefficient support by @SergeyNefyodov in #192\n  Add MEPSection.GetPressureDrop support by @SergeyNefyodov in #192\n  Add MEPSection.GetSegmentLength support by @SergeyNefyodov in #192\n  Add MEPSection.IsMain support\n  Add show System.Object option (named Root hierarchy) by @SergeyNefyodov in #193\n  Add generic types support for the help button\n  Minor tooltip changes\n  Bugs\n  Fixed search that worked in the main thread\n\n- Calling Revit command from chromium browser\n  https://forums.autodesk.com/t5/revit-api-forum/calling-revit-command-from-chromium-browser/td-p/12413281\n\n- determine element location\n  how can the coordinates for a revit fabricationpart be obtained with the revit api\n  https://stackoverflow.com/questions/77556660/how-can-the-coordinates-for-a-revit-fabricationpart-be-obtained-with-the-revit-a\n\n- Create a 3D view showing only #Revit wall structural layers\n  https://boostyourbim.wordpress.com/2023/12/04/create-a-3d-view-showing-only-revit-wall-structural-layers/\n  - Create new 3D isometric view\n  - Set parts visibility PartsVisibility.ShowPartsOnly\n  - Create parts from all walls\n  - For each part, retrieve its built-in parameter DPART_LAYER_INDEX\n  - Convert from string to wall compound structure layer index\n  - Hide part if its compound structure layer function differs from MaterialFunctionAssignment.Structure\n\n- Dynamo: Curved Sections By Line (Part 1)\n  https://youtu.be/Fic5BD-s3A8\n  Anna Baranova\n  More articles of mine\n  https://www.linkedin.com/in/baranovaanna/\n  private message\n  https://www.linkedin.com/feed/?msgControlName=view_message_button&msgConversationId=2-NDQ2ZDYwYmYtYzY2Yy00MjJlLTgyNTUtM2E4YzA0NTk5MzJhXzAxMg%3D%3D&msgOverlay=true&trk=false\n\n- Researchers quantify the carbon footprint of generating AI images\n  Creating a photograph using artificial intelligence is like charging your phone.\n  https://www.engadget.com/researchers-quantify-the-carbon-footprint-of-generating-ai-images-173538174.html\n  img/ai_image_carbon_footprint.png\n\n- send_data_by_pigeon.jpeg\n  https://autodesk.slack.com/archives/C02NW42JP/p1701262599629959\n  George Langham\n  send_data_by_pigeon.jpeg\n  Jean-Philippe Brault\n  There is a RFC for that https://datatracker.ietf.org/doc/html/rfc1149\n  IETF DatatrackerIETF Datatracker\n  RFC 1149: Standard for the transmission of IP datagrams on avian carriers\n  This memo describes an experimental method for the encapsulation of IP datagrams in avian carriers. This specification is primarily useful in Metropolitan Area Networks. This is an experimental, not recommended standard.\n  1 Apr 1990\n  Feisal Ahmad\n  Never underestimate the bandwidth of a station wagon full of tapes hurtling down the highway.\n  Wikipedia Sneakernet\n  Sneakernet, also called sneaker net, is an informal term for the transfer of electronic information by physically moving media such as magnetic tape, floppy disks, optical discs, USB flash drives or external hard drives between computers, rather than transmitting it over a computer network. The term, a tongue-in-cheek play on net(work) as in Internet or Ethernet, refers to walking in sneakers as the transport mechanism. Alternative terms may be floppy net, train net, or pigeon net.\n  https://en.wikipedia.org/wiki/Sneakernet\n  Ryan Robinson\n  I am reminded of this thread from 2012 - https://superuser.com/questions/419070/transatlantic-ping-faster-than-sending-a-pixel-to-the-screen\n  (John Carmack rolls in to explain himself as the top answer)\n  Super UserSuper User\n  Transatlantic ping faster than sending a pixel to the screen?\n  John Carmack tweeted,\n  I can send an IP packet to Europe faster than I can send a pixel to the screen. How f’d up is that?\n  And if this weren’t John Carmack, I’d file it under “the interwebs being\n\n- hope for the future\n  Drone Tour of Permaculture Farm\n  https://youtu.be/TPxJtKob7Js\n  five-minute\n  > In this video I narrate a drone tour of our entire 250 acre farm showcasing some of the swale,\n  dam, dugout, aquaculture, livestock food forest, cover cropping and other permaculture\n  systems we have on our regenerative farm.\n  https://www.coenfarm.ca\n  > We are literally eating ourselves & our planet to death. Our mission is to provide nutrient-dense food, feed, & permaculture education to regenerate the planet & its people.\n\ntwitter:\n\nRound-trip interaction between your own browser instance and @AutodeskRevit #RevitAPI external command, BIM element location, creating a structural 3D view, and a curved section view in @DynamoBIM @AutodeskAPS #BIM https://autode.sk/browserroundtrip\n\nRevitLookup update, roundtrip interaction between your own browser instance and external command, BIM element location, structural 3D view, curved section view\n&ndash; RevitLookup 2024.0.10\n&ndash; Calling Revit command from Chromium browser\n&ndash; Chromium browser Js round trip callback\n&ndash; Element location\n&ndash; Create a structural-only 3D view\n&ndash; Creating a curved section in Dynamo\n&ndash; Carbon footprint of AI\n&ndash; Sending data by pigeon\n&ndash; Permaculture farm\n&ndash; The Valley of Code...\n\nlinkedin:\n\nRound-trip interaction between your own browser instance and #RevitAPI external command, BIM element location, creating a structural 3D view, and a curved section view in #DynamoBIM\n\nhttps://autode.sk/browserroundtrip\n\n- RevitLookup 2024.0.10\n- Calling Revit command from Chromium browser\n- Chromium browser Js round trip callback\n- Element location\n- Create a structural-only 3D view\n- Creating a curved section in Dynamo\n- Carbon footprint of AI\n- Sending data by pigeon\n- Permaculture farm\n- The Valley of Code...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "3D View, Curved Section and Browser Round-Trip",
    "local_header_href": "#3d-view-curved-section-and-browser-round-trip",
    "chunk_text": "### 3D View, Curved Section and Browser Round-Trip\n\nYet another RevitLookup update, full roundtrip interaction between your own instance of the built-in Revit CefSharp Chromium browser and your Revit API add-in external command, different ways to locate a BIM element, pure structural 3D view and curved section view creation, and more:\n\n- [RevitLookup 2024.0.10](#2)\n- [Calling Revit command from Chromium browser](#3)\n- [Chromium browser Js round trip callback](#4)\n- [Determine element location](#5)\n- [Create a structural-only 3D view](#6)\n- [Creating a curved section in Dynamo](#7)\n- [Carbon footprint of AI image generation](#8)\n- [Sending data by pigeon](#9)\n- [Permaculture farm regenerates natural habitat](#10)\n- [The Valley of Code](#11)"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "RevitLookup 2024.0.10",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> RevitLookup 2024.0.10\n\n[RevitLookup 2024.0.10](https://github.com/jeremytammik/RevitLookup/releases/tag/2024.0.10) is now available with the following enhancements:\n\n- Introducing a brand new feature: Restore window size!\n  Now, effortlessly you will open RevitLookup with your preferred window dimensions with a simple click\n- Add `MEPSystem` and `MEPSection` support for GetSectionByIndex, GetSectionByNumber, GetElementIds,\n  GetCoefficient, GetPressureDrop,  GetSegmentLength and IsMain\n- Show System.Object option (named Root hierarchy)\n- Add generic type support for the help button\n- Minor tooltip changes\n- Fixed search that worked in the main thread"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Calling Revit Command from Chromium Browser",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Calling Revit Command from Chromium Browser\n\nLast week, Andrej Licanin of [Bimexperts](https://bimexperts.com/sr/home) shared\na nice solution demonstrating [how to use the Revit built-in CefSharp browser in WPF](https://thebuildingcoder.typepad.com/blog/2023/11/camera-target-and-toposolid-subdivision-material.html#2).\n\nThis week he expanded on that in his contribution\non [calling Revit command from Chromium browser](https://forums.autodesk.com/t5/revit-api-forum/calling-revit-command-from-chromium-browser/td-p/12413281):\n\nThis is another guide on Chromium browser using CefSharp, a continuation\nof the [simple WPF with a Chromium browser guide](https://forums.autodesk.com/t5/revit-api-forum/simple-wpf-with-a-chromium-browser-guide/td-p/12396552).\nHope someone finds it useful.\n\nBasically, what I wanted was for a button in the browser (on a webpage) to trigger a command in Revit.\nThis works by \"binding\" a JavaScript method to a C# object and its method.\nIn the Javascript we `await` for the object and call its function.\n\nSo, let's make a dummy object for binding and a method in it.\nIn order to call a Revit method it will need a reference to an external event handler and its event:\n\n<pre><code>\n   public class BoundObject\n   {\n     public int Add(int a, int b)\n     {\n       ExtApp.handler.a = a;\n       ExtApp.handler.b = b;\n       ExtApp.testEvent.Raise();\n\n       return a+b;\n     }\n   }\n</code></pre>\n\nThe event and its handler are saved in the external app as `static` for ease of access:\n\n<pre><code>\n  internal class ExtApp : IExternalApplication\n  {\n    public static IExternalApplication MyApp;\n    public static ChromiumWebBrowser browser;\n    public static ExternalEvent testEvent;\n    public static MyEvent handler;\n    public Result OnShutdown(UIControlledApplication application)\n    {\n      // Cef.Shutdown();\n      return Result.Succeeded;\n    }\n\n    public Result OnStartup(UIControlledApplication application)\n    {\n      MyApp = this;\n      //code for making a button\n\n      handler = new MyEvent();\n      testEvent= ExternalEvent.Create(handler);\n\n      return Result.Succeeded;\n    }\n  }\n</code></pre>\n\nIn the WPF control, the browser is embedded like this:\n\n<pre><code>\n  &lt;Window x:Class=\"RevitTestProject.TestWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:local=\"clr-namespace:RevitTestProject\"\n    xmlns:cef=\"clr-namespace:CefSharp.Wpf;assembly=CefSharp.Wpf\"\n    mc:Ignorable=\"d\"\n    Width=\"1000\" Height=\"500\"&gt;\n    &lt;Grid Background=\"PapayaWhip\"&gt;\n      &lt;cef:ChromiumWebBrowser Name=\"ChromiumBrowser\" Address=\"http://www.google.com\" Width=\"900\" Height=\"450\"  /&gt;\n    &lt;/Grid&gt;\n  &lt;/Window&gt;\n</code></pre>\n\nHere is the code behind the window:\n\n<pre><code>\n    public TestWindow()\n    {\n      InitializeComponent();\n      ChromiumBrowser.Address = \"https://www.google.com\";\n      ChromiumBrowser.Address = \"C:\\\\Users\\\\XXX\\\\Desktop\\\\index.html\";\n      BoundObject bo = new BoundObject();\n      ChromiumBrowser.JavascriptObjectRepository.Register(\"boundAsync\", bo, true, BindingOptions.DefaultBinder);\n    }\n\n    public void Dispose()\n    {\n      this.Dispose();\n    }\n</code></pre>\n\nSo, to use it, make an `index.html` and submit the path to it in the browser address.\n\nThe Test webpage look like this:\n\n<pre><code>\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;Bridge Test&lt;/title&gt;\n  &lt;!-- &lt;script src=\"script.js\"&gt;&lt;/script&gt; --&gt;\n  &lt;script type=\"text/javascript\"&gt;\n    async function callCSharpAction() {\n      await CefSharp.BindObjectAsync(\"boundAsync\");\n      boundAsync.add(16, 2);\n    }\n  &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;button id=\"action1\" onclick=\"callCSharpAction()\"&gt;Action 1&lt;/button&gt;\n  &lt;button id=\"action2\" onclick=\"alert('Button is working')\"&gt;Action 2&lt;/button&gt;\n  &lt;button id=\"action3\"&gt;Action 3&lt;/button&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\nThe handler code:\n\n<pre><code>\n  internal class MyEvent : IExternalEventHandler\n  {\n    public int a;\n    public int b;\n    public void Execute(UIApplication app)\n    {\n      TaskDialog.Show( \"yoyoy\",\n        \"data is \" + a.ToString()\n        + \" and \" + b.ToString() + \".\");\n    }\n\n    public string GetName()\n    {\n      return \"YOYOOY\";\n    }\n  }\n</code></pre>"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Chromium Browser Js Round Trip Callback",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Chromium Browser Js Round Trip Callback\n\nNext step: round-trip callback:\nTo make a callback from C# function to the browser, you just need an instance of the browser, and a function in the javascript code that will be called.\nHere is an edited index.html with such a function to call:\n\n<pre><code>\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;Bridge Test&lt;/title&gt;\n  &lt;!-- &lt;script src=\"script.js\"&gt;&lt;/script&gt; --&gt;\n  &lt;script type=\"text/javascript\"&gt;\n    async function callCSharpAction() {\n      await CefSharp.BindObjectAsync(\"boundAsync\");\n      boundAsync.add(16, 2);\n    }\n\n    function showAlert(arg1) {\n      // Your JavaScript logic here\n      alert(\"Function called with arguments: \" + arg1);\n      return;\n    }\n  &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;button id=\"action1\" onclick=\"callCSharpAction()\"&gt;Action 1&lt;/button&gt;\n  &lt;button id=\"action2\" onclick=\"alert('Button is working')\"&gt;Action 2&lt;/button&gt;\n  &lt;button id=\"action3\"&gt;Action 3&lt;/button&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\nIn our bound class, we save a instance to the browser so we can use it on command:\n\n<pre><code>\n  public class BoundObject\n  {\n    public int aS;\n    public int bS;\n    internal ChromiumWebBrowser browser;\n\n    public void CallCSharpMethod()\n    {\n      MessageBox.Show(\"C# method called!\");\n      // Add more code here as needed\n    }\n    public int Add(int a, int b)\n    {\n      ExtApp.handler.a = a;\n      ExtApp.handler.b = b;\n      ExtApp.testEvent.Raise();\n\n      return a+b;\n    }\n\n    public int SendSomeDataFromLocal(int a)\n    {\n      browser.ExecuteScriptAsync(\"showAlert(\"+a.ToString()+\")\");\n      return a;\n    }\n  }\n</code></pre>\n\nPass it in when creating the browser in the window codebehind:\n\n<pre><code>\n  public TestWindow()\n  {\n    InitializeComponent();\n    ChromiumBrowser.Address = \"https://www.google.com\";\n    ChromiumBrowser.Address = \"C:\\\\Users\\\\XXX\\\\Desktop\\\\index.html\";\n    BoundObject bo = new BoundObject();\n    //ExtApp.boundObj = bo;\n    bo.browser = ChromiumBrowser;\n    ChromiumBrowser.JavascriptObjectRepository.Register(\n      \"boundAsync\", bo, true, BindingOptions.DefaultBinder);\n  }\n</code></pre>\n\nFinally, now, you can call it from Revit:\n\n<pre><code>\n  public Result Execute(\n    ExternalCommandData commandData,\n    ref string message,\n    ElementSet elements)\n  {\n    ExtApp.boundObj.SendSomeDataFromLocal(999);\n    return Result.Succeeded;\n  }\n</code></pre>\n\nThis concludes a round trip from the browser and back.\nI hope anyone reading this finds it useful."
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Determine Element Location",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Determine Element Location\n\nWe put together a nice little overview on various methods to determine the location of a BIM element discussing\n[how can the coordinates for a Revit fabrication part be obtained with the Revit API](https://stackoverflow.com/questions/77556660/how-can-the-coordinates-for-a-revit-fabricationpart-be-obtained-with-the-revit-a)?\n\n**Question:** I need to obtain the coordinates for Revit MEP FabricationParts.\nAll of the elements I get have a `Location` property, but not all of them have either a `LocationPoint` or a `LocationCurve`.\nMore specifically, I am only able to get `XYZ` values through the `LocationCurve` for `Pipe` elements.\nElements such as Threadolet, Elbow, Weld and Fishmouth don't have either a `LocationPoint` or a `LocationCurve`.\n\n**Answer:** Three options that can be used on almost all BIM elements are:\n\n- Use the `Location` property\n- Retrieve the element [`Geometry` property](https://www.revitapidocs.com/2024/d8a55a5b-2a69-d5ab-3e1f-6cf1ee43c8ec.htm), e.g., calculate the centroid of all the vertices\n- Use the element [`BoundingBox` property](https://www.revitapidocs.com/2024/def2f9f2-b23a-bcea-43a3-e6de41b014c8.htm), e.g., calculate its midpoint\n\nHowever, for these types of `FabricationParts` specifically,\n[egeer](https://stackoverflow.com/users/15534202/egeer)\nand [bootsch](https://stackoverflow.com/users/21999391/bootsch) suggest\nusing the element's connector locations instead:\n\nFor OLets and ThreadOLets, you can use the connector that connects to the main pipe as its insertion point, since that is technically where the element was inserted:\n\n<pre><code>\n    Connector insertionPointConnector = OLet.ConnectorManager\n        .Connectors\n        .OfType&lt;Connector&gt;()\n        .FirstOrDefault(x =&gt; x.ConnectorType == ConnectorType.Curve);\n\n    XYZ insertionPoint = insertionPointConnector?.Origin;\n</code></pre>\n\nSince their connectors are atypical in that they do not connect to another connector, but instead a curve, you need to get the one that is `ConnectorType.Curve`.\n\nFor welds, elbows and other inline elements, you can similarly use the connectors and get their origins.\nIf you want the center of the element, you can use vector math to calculate that using the connector's direction and location.\nThe direction that the connector points is the `BasisZ` property of the Connector's `CoordinateSystem`.\n\n<pre><code>\n    XYZ connectorDirection = insertionPointConnector?.CoordinateSystem.BasisZ;\n</code></pre>\n\nThe solution I end up with is a bit different from the answer given by egeer above:\nI ended up getting a Connector for each element (the ones without a `LocationCurve` or `LocationPoint`).\nHere's the code in VB:\n\n<pre><code>\n    Dim insertionPointConnector As Connector = CType(e, FabricationPart).ConnectorManager.Connectors.OfType(Of Connector).FirstOrDefault()\n    Dim elementOrigin as XYZ = Connector.insertionPointConnector.Origin\n</code></pre>\n\n`e` is of type Element.\n\nMany thanks to egeer and bootsch for jumping in with these good solutions!"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Create a Structural-Only 3D View",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Create a Structural-Only 3D View\n\nHarry Mattison continues his AU solution spree presenting a nice code sample demonstrating how\nto [create a 3D view showing only Revit wall structural layers](https://boostyourbim.wordpress.com/2023/12/04/create-a-3d-view-showing-only-revit-wall-structural-layers/)\nwhich is discussed in further depth in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non how to [create new View3D that just displays wall layers of \"Structure\" function](https://forums.autodesk.com/t5/revit-api-forum/create-new-view3d-that-just-displays-wall-layers-of-quot/td-p/12344156).\nHarry's sample code performs the following steps:\n\n- Create new 3D isometric view\n- Set view parts visibility `PartsVisibility.ShowPartsOnly`\n- Create parts from all walls\n- For each part, retrieve its built-in parameter `DPART_LAYER_INDEX`\n- Convert from string to wall compound structure layer index\n- Hide part if its compound structure layer function differs from `MaterialFunctionAssignment.Structure`\n\nMany thanks to Harry for addressing this need!"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Creating a Curved Section in Dynamo",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Creating a Curved Section in Dynamo\n\nI have heard several requests for a curved section view, e.g., Alex Vila in 2019:\n[Create curved sections!](https://forums.autodesk.com/t5/revit-api-forum/create-curved-sections/m-p/8931972)\n\nFinally, the cavalry comes to the rescue in the shape\nof [Anna Baranova](https://www.linkedin.com/in/baranovaanna/), presenting a 22-minute video tutorial\non [Dynamo: Curved Sections By Line (Part 1)](https://youtu.be/Fic5BD-s3A8):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/Fic5BD-s3A8?si=bjREzyZh7uCyrZoZ\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n</center>\n\nMany thanks to Anna for this nice piece of work!"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Carbon Footprint of AI Image Generation",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Carbon Footprint of AI Image Generation\n\nResearchers quantify the carbon footprint of generating AI images:\n[creating a photograph using artificial intelligence is like charging your phone](https://www.engadget.com/researchers-quantify-the-carbon-footprint-of-generating-ai-images-173538174.html):\n\n<center>\n<img src=\"img/ai_image_carbon_footprint.png\" alt=\"AI image generation carbon footprint\" title=\"AI image generation carbon footprint\" width=\"600\"/>\n</center>"
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Sending Data by Pigeon",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> Sending Data by Pigeon\n\nTalking about carbon footprint and the cost and efficiency of digital data transmission, there is obviously a point at which transmission of large data can be speeded up by putting it on a storage device and moving that around rather physically than squeezing it through the limited bandwidth of the Internet:\n\n<center>\n<img src=\"img/send_data_by_pigeon.jpg\" alt=\"Send data by pigeon\" title=\"Send data by pigeon\" width=\"600\"/> <!-- Pixel Height: 1,218 Pixel Width: 1,080 -->\n</center>\n\n- There is even an RFC 1149 for this concept,\nthe [Standard for the Transmission of IP Datagrams on Avian Carriers](https://datatracker.ietf.org/doc/html/rfc1149).\n> This memo describes an experimental method for the encapsulation of IP datagrams in avian carriers.\nThis specification is primarily useful in Metropolitan Area Networks.\nThis is an experimental, not recommended standard.\n- Never underestimate the bandwidth of a station wagon full of tapes hurtling down the highway,\ncf. [Wikipedia on Sneakernet](https://en.wikipedia.org/wiki/Sneakernet).\n- Reminds of this thread from 2012\nabout [transatlantic ping faster than sending a pixel to the screen](https://superuser.com/questions/419070/transatlantic-ping-faster-than-sending-a-pixel-to-the-screen)..."
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "Permaculture Farm Regenerates Natural Habitat",
    "local_header_href": "#10",
    "chunk_text": "####<a name=\"10\"></a> Permaculture Farm Regenerates Natural Habitat\n\nHope for the future from a five-minute video [drone tour of permaculture farm](https://youtu.be/TPxJtKob7Js):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/TPxJtKob7Js?si=QoImAfogIIMdU5Sp\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n</center>\n\n> In this video I narrate a drone tour of our entire 250-acre farm showcasing some of the swale,\ndam, dugout, aquaculture, livestock food forest, cover cropping and other permaculture\nsystems we have on our regenerative farm.\n\nPresented by the [Coen Farm](https://www.coenfarm.ca), who say:\n\n> We are literally eating ourselves and our planet to death.\nOur mission is to provide nutrient-dense food, feed, and permaculture education to regenerate the planet and its people.\n\nPersonally, I was very touched watching and listening to it."
  },
  {
    "original_filename": "2019_cefsharp_roundtrip",
    "header_text": "The Valley of Code",
    "local_header_href": "#11",
    "chunk_text": "####<a name=\"11\"></a> The Valley of Code\n\nQuick return to digital before I end for today.\nIf you have friends or others wanting to quickly learn to code for the web, here is a great site to get them started:\n\n- [The Valley of Code](https://thevalleyofcode.com/)\n\n> Welcome to The Valley of Code.\nYour journey in Web Development starts here.\nIn the fundamentals section you'll learn the basic building blocks of the Internet, the Web and how its fundamental protocol (HTTP) works.\n\nToc:\n\n- Fundamentals\n- HTML and CSS\n- Tools\n- Deployment\n- JavaScript\n- TypeScript\n- More CSS\n- More JavaScript\n- DOM and Events\n- Networking\n- Server Runtimes\n- HTTP Servers\n- Forms\n- Databases\n- UI libraries\n- Frameworks"
  }
][
  {
    "original_filename": "2020_net_core_webinar",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- <script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script> -->\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- Autodesk Desktop API Updates: .NET Core Migration Webinar\n  https://aps.autodesk.com/blog/autodesk-desktop-api-updates-net-core-migration-webinar\n\n- Adding Parameters with a specific GUID\n  https://forums.autodesk.com/t5/revit-api-forum/adding-parameters-with-a-specific-guid/m-p/12455887#M76040\n\n- parameter service:\n  How to enable the Autodesk Parameter Service\n  https://goto.archi/blog/post/how-to-enable-the-autodesk-parameter-service\n  How to use the Autodesk Parameter Service in Revit\n  https://goto.archi/blog/post/how-to-use-the-autodesk-parameter-service-in-revit\n  How to migrate Revit parameters into the Parameter Service\n  https://goto.archi/blog/post/how-to-migrate-revit-parameters-into-the-parameter-service\n\ntwitter:\n\nTo end the year, a reminder of the upcoming shift to .NET Core and some notes on @AutodeskRevit parameters: adding a parameter with a specific GUID in the #RevitAPI and getting started with the parameter service... Happy holidays! @AutodeskAPS #BIM @DynamoBIM https://autode.sk/dotnetcorewebinar\n\nLet's end this year with some notes on parameters and a reminder of the upcoming shift to .NET Core\n&ndash; .NET Core migration webinar\n&ndash; Adding a parameter with a specific GUID\n&ndash; Getting started with the parameter service\n&ndash; Happy holidays! ...\n\nlinkedin:\n\nTo end the year, a reminder of the upcoming shift to .NET Core and some notes on #Revit parameters: adding a parameter with a specific GUID in the #RevitAPI and getting started with the parameter service:\n\nhttps://autode.sk/dotnetcorewebinar\n\n- .NET Core migration webinar\n- Adding a parameter with a specific GUID\n- Getting started with the parameter service\n- Happy holidays! ...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2020_net_core_webinar",
    "header_text": "Parameters and .NET Core Webinar",
    "local_header_href": "#parameters-and-net-core-webinar",
    "chunk_text": "### Parameters and .NET Core Webinar\n\nLet's end this year with some notes on parameters and a reminder of the upcoming shift to .NET Core:\n\n- [.NET Core migration webinar](#2)\n- [Adding a parameter with a specific GUID](#3)\n- [Getting started with the parameter service](#4)\n- [Happy holidays!](#5)"
  },
  {
    "original_filename": "2020_net_core_webinar",
    "header_text": ".NET Core Migration Webinar",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> .NET Core Migration Webinar\n\nBefore we end for the year, let's recapitulate the announcement of\nthe [Autodesk Desktop API Updates: .NET Core Migration Webinar](https://aps.autodesk.com/blog/autodesk-desktop-api-updates-net-core-migration-webinar) end of next month:\n\nDo you have an application running on one of the Autodesk desktop products or on Design Automation, such as AutoCAD/Revit/Inventor?\nIf so, please join the upcoming webinar where we will discuss next major releases of hero desktop product APIs moving to .NET Core.\n\n- Title: Autodesk Desktop API Updates: .NET Core Migration\n- Date: Tuesday, January 30, 2024\n- Time: 8AM PST / 11AM EST / 5PM CET\n- Duration: approx. 40 min\n\nTentative Agenda:\n\n- General overview of .NET Core\n- Product specifics\n    - AutoCAD + verticals\n    - Revit\n    - Inventor\n    - Others\n- Q&amp;A\n\nTo join this webinar, you will need to agree to a non-disclosure agreement NDA.\nTo do so, please sign up through one of feedback portal projects for the respective products or the ADN extranet:\n\n- [AutoCAD feedback portal](https://feedback.autodesk.com/project/forum/thread.html?cap=e7f9d0d1828b48b9b0fa1eb608dc91b5&forid=%7Baf68f836-722f-4e0a-a1cd-dcaee47b96d2%7D&topid=%7B518782FF-39F1-4349-9CCF-E7DDE8809FD0%7D&j=518782ff39f143499ccfe7dde8809fd0)\n- [Revit Preview feedback portal](https://feedback.autodesk.com/project/forum/thread.html?cap=e7f9d0d1828b48b9b0fa1eb608dc91b5&forid=%7Baf68f836-722f-4e0a-a1cd-dcaee47b96d2%7D&topid=%7B518782FF-39F1-4349-9CCF-E7DDE8809FD0%7D&j=518782ff39f143499ccfe7dde8809fd0)\n- [Inventor feedback portal](https://feedback.autodesk.com/project/forum/thread.html?cap=fb14413735ee42c99624e3793b19a0b2&forid=%7bdeb2224c-a845-44a8-a857-a54f58c97618%7d&topid=%7bB1A00199-A0E0-44B7-83E2-1DD98CCC649B%7d)\n- [ADN extranet](https://adn.autodesk.io/index.php?r=custom_pages%2Fview&id=312)\n\nIf you haven't already, please join the feedback projects now, and start testing your application against the preview/beta releases.\n\nReminder: ADN members can join the feedback portal through the ADN extranet by selecting SOFTWARE &gt;&gt; \"Beta Portal.\"\nThis will take you to the [Autodesk feedback portal](https://feedback.autodesk.com), Autodesk Developer Network Beta Program.\nGo to \"Product Beta Access\" and join the AutoCAD, Revit, or Inventor feedback project there."
  },
  {
    "original_filename": "2020_net_core_webinar",
    "header_text": "Adding a Parameter with a Specific GUID",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Adding a Parameter with a Specific GUID\n\nAdrian Crisan of [Studio A International, LLC](http://www.studio-a-int.com) shared a very nice solution in both Python and C#\nfor [adding parameters with a specific GUID](https://forums.autodesk.com/t5/revit-api-forum/adding-parameters-with-a-specific-guid/m-p/12455887):\n\n**Question:** I have a requirement to add parameters and bind them to most if not all elements in a model (and one parameter to be bound to a type instead; the blog was most helpful with that), but I'm running into a few issues.\n\nCurrently, my code creates a shared parameter file if not found, creates a group, and then adds the parameters to it. The problem comes as follows:\n\n- Sometimes the parameters are \"duplicated\" because I can't seem to specify a GUID for the parameter; I can only search for it by name - and the shared parameter file was not sent to me for testing, only the Revit File. Revit GUIDs seem to be type 4, which is frustrating because those are fully random and that means I can't predict them at all, which means I can't really test for a specific GUID.\n- If the file is already created (because I was using another Revit document) the parameters \"exist\" in the document but aren't bound to anything, which frustrates the dupe checks because the parameter exists by name; however an insert/reinsert rebinding will work.\n- I can determine via code right now if I have to write the file from scratch, but I haven't yet run into the situation where the customer has a parameter file and I just need to add to it (which I'm sure happens all the time).\n- If the file does exist, I would rather be able to set a specific GUID instead of clobbering the user's file with our own (that seems the only way to set a particular GUID is to write a shared parameter file with the GUID and then tell Revit to use that file).\n- The goal here is that the user can click one button and our parameters are set up to facilitate two-way data binding between our system and the Revit Model.\n\nAm I missing something in the API that allows me to specify a GUID? What are the best practices around this? Does the Revit API have some way to modify the shared parameter file or only the binding functions?\n\nI found a related issue\non [editing SharedParameterFile/deleting shared parameter entry](https://stackoverflow.com/questions/77652588/editing-sharedparameterfile-deleting-shared-parameter-entry);\nhowever, it does not answer nor is it exactly my problem.\n\n**Answer:** Is this what you are looking for?\n\n- [ExternalDefinitionCreationOptions.GUID Property](https://www.revitapidocs.com/2024/c86d0033-8200-15ee-070c-d0a606ed3b2a.htm) &rarr; C# <code>public Guid GUID { get; set; }</code>\n\n> The GUID to use for this parameter definition.\nIf not explicitly set, a random GUID is used.\n\nWe use this day in / day out for our new shared parameters.\n\nYou can use either the Visual Studio Tools `Create GUID` or the Python code below to generate the GUID:\n\n<pre><code>\nimport uuid\nyourGuid = str(uuid.uuid4())"
  },
  {
    "original_filename": "2020_net_core_webinar",
    "header_text": "Your GUID will be like 8-4-4-4-12",
    "local_header_href": "#your-guid-will-be-like-8-4-4-4-12",
    "chunk_text": "# Your GUID will be like 8-4-4-4-12\n\nyourGuid = \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"\n</code></pre>\n\nWe do not recommend, but of course if you want to change the GUID as you want, make the changes.\n\nKeep in mind the algorithms to create global unique id are developed to prevent as much as possible duplicates in large dynamic systems.\n\nThen you can use the following Python code to create a new Shared Parameter definition with your own GUID:\n\n<pre><code>\napp = DocumentManager.Instance.CurrentUIApplication.Application\nyourSharedParamDefFile = r\"yourDefinitionFile.txt\"\napp.SharedParametersFilename = yourSharedParamDefFile\nsharedParametersFileName = app.OpenSharedParameterFile().Filename\nparaGroup = app.OpenSharedParameterFile().Groups.get_Item(\"YourParameterGroup\") # verify in your Definition File the name of the Group under which you want to create the Shared Parameter\nnewParaOptions = ExternalDefinitionCreationOptions(\"yourSharedParaName\", ParameterType.Text) # Text, Integer, Number, Length, Area, Volume, etc. - look at the API for Parameter Type enumerations\nnewParaOptions.UserModifiable = False # Users cannot modify it, only Revit API\nnewParaOptions.Visible = False # Users cannot see it in the properties, but the parameter appears in schedules, etc.\nnewParaOptions.GUID = Guid(yourGuid) # set the Guid\ncreateYourNewParameter = paraGroup.Definitions.Create(newParaOptions)\n</code></pre>\n\nHere is the agnostic method in C#.\n\n<pre><code>\npublic void createSharedParameterDefinition()\n{\n  // Code provided courtesy of:\n  // Studio A International, LLC\n  // http://www.studio-a-int.com\n  // The below code creates a new Shared Parameter in an existing Definition File\n  // If a Shared Parameter with the same name is already in the Definition File,\n  // the execution code will end with an error\n  // You can generate your own GUID to assign it to the Shared Parameter\n  // Use either Visual Studio Tools -&gt; Create GUID\n  // Or Python code to generate the GUID\n  // import uuid\n  // yourGuid = str(uuid.uuid4())\n  // or other programming tools of your choice\n  System.Guid yourGuid = new Guid(\"2778bb70-c715-4a9d-bdc1-76add223f228\");\n  // Shared Parameters Definition file\n  string yourSharedParamDefFile = @\"YourDrive\\YourSharedParametersDefinitionFile.txt\";\n  // Shared Parameter name\n  string yourSharedParaName = \"NewSharedParaNameUnitTesting\";\n  // Initialize a StringBuilder to collect execution results/errors.\n  StringBuilder sbCreateSharedParameterDefinition = new StringBuilder();\n  try\n  {\n    Autodesk.Revit.DB.Document activeDoc = CreateSharedParameterDefinitionCommand.doc;\n    Autodesk.Revit.ApplicationServices.Application app = activeDoc.Application;\n    app.SharedParametersFilename = yourSharedParamDefFile;\n    // Open the Shared Parameters File\n    Autodesk.Revit.DB.DefinitionFile sharedParametersFile = app.OpenSharedParameterFile();\n    string sharedParametersFileName = app.OpenSharedParameterFile().Filename;\n    // Select under which Definition Group the new Shared Parameter will be placed\n    DefinitionGroup paraGroup = app.OpenSharedParameterFile().Groups.get_Item(\"YOURGROUP\");\n    // Create new Options for the Shared Parameter\n    // older APIs uses below method\n    // Autodesk.Revit.DB.ExternalDefinitionCreationOptions newParaOptions = new ExternalDefinitionCreationOptions(yourSharedParaName, ParameterType.Text); // # Text, Integer, Number, Length, Area, Volume, etc. - look at the API for Parameter Type enumerations\n    // newer APIs uses below method\n    Autodesk.Revit.DB.ExternalDefinitionCreationOptions newParaOptions = new ExternalDefinitionCreationOptions(yourSharedParaName, SpecTypeId.String.Text);\n    newParaOptions.UserModifiable = false; // Users cannot modify it, only Revit API can modify this parameter\n    newParaOptions.Visible = false; // Users cannot see it in the properties, but the parameter appears in schedules, etc.\n    newParaOptions.GUID = yourGuid; // set the above GUID to this new Shared Parameter\n    paraGroup.Definitions.Create(newParaOptions);\n  }\n  catch (Exception ex)\n  {\n    sbCreateSharedParameterDefinition.AppendLine(ex.Message.ToString());\n  }\n  if (sbCreateSharedParameterDefinition.Length &lt; 1)\n  {\n    System.Windows.Forms.MessageBox.Show(\"Shared Parameter Definition:\" +\n    \"\\r\\n\" +\n    \"\\r\\n\" + \" \" + yourSharedParaName +\n    \"\\r\\n\" +\n    \"\\r\\n\" + \"was created.\", \"Task complete\");\n  }\n  else if (sbCreateSharedParameterDefinition.Length &gt; 0)\n  {\n    System.Windows.Forms.MessageBox.Show(\"Shared Parameter Definition was not created because:\" +\n    \"\\r\\n\" +\n    \"\\r\\n\" + \" \" + sbCreateSharedParameterDefinition.ToString(), \"Error\");\n  }\n}\n</code></pre>\n\nThank you very much, Adrian, for kindly implementing and sharing this solution!"
  },
  {
    "original_filename": "2020_net_core_webinar",
    "header_text": "Getting Started with the Parameter Service",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Getting Started with the Parameter Service\n\n[Archi](https://goto.archi/) shared a nice series of articles describing step by step how get started with the parameter service:\n\n> ... a much anticipated cloud service from Autodesk that spreads across the entire ecosystem,\nnot just Revit, and comes to improve parameter management and collaboration for teams.\nFor BIM managers with access to the Autodesk Construction Cloud, you can now say goodbye\nto the old shared parameter txt files, and instead use a centralized cloud service that\nallows bulk operation, tagging and search capabilities.\n\n- [How to enable the Autodesk Parameter Service](https://goto.archi/blog/post/how-to-enable-the-autodesk-parameter-service)\n- [How to use the Autodesk Parameter Service in Revit](https://goto.archi/blog/post/how-to-use-the-autodesk-parameter-service-in-revit)\n- [How to migrate Revit parameters into the Parameter Service](https://goto.archi/blog/post/how-to-migrate-revit-parameters-into-the-parameter-service)\n\nMany thanks to Archi for putting together this comprehensive tutorial!\n\n<center>\n<img src=\"img/archi_param_service.jpg\" alt=\"Parameter Service\" title=\"Parameter Service\" width=\"400\"/>\n</center>"
  },
  {
    "original_filename": "2020_net_core_webinar",
    "header_text": "Happy Holidays!",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Happy Holidays!\n\nI wish you a peaceful end of the year,\ncalm [twelve nights](https://en.wikipedia.org/wiki/Twelfth_Night_(holiday)) and\nrestful holidays!\n\n<center>\n<img src=\"img/dino_in_snow_669_cropped_500.jpg\" alt=\"Dino in snow\" title=\"Dino in snow\" width=\"300\"/>\n</center>"
  }
][
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- <script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script> -->\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- AU 2023 classes -- https://www.autodesk.com/autodesk-university/search?fields.year=2023\n\n- Dependency Injection for Revit API\n  https://forums.autodesk.com/t5/revit-api-forum/dependency-injection-for-revit-api/td-p/12467760\n\n- model checker api:\n  https://forums.autodesk.com/t5/revit-api-forum/setting-up-iprebuiltoptionsservice-options-for-checkset-in-ait/td-p/12455815\n\n- Maestro AI for Revit scripting\n  https://maestro.bltsmrt.com/\n  https://www.linkedin.com/posts/christopher-wiesen-b9693b67_maestroforrevit-aectech-automation-activity-7143312975838232576-gLEv?utm_source=share&utm_medium=member_desktop\n  Christopher Wiesen, President, BLT SMRT LLC, Las Vegas, Nevada, United States\n\n- Total Construction Spending: Manufacturing in the United States (TLMFGCONS)\n  https://fred.stlouisfed.org/series/TLMFGCONS#0\n\n- most interesting philosophical discussion i have seen for a long tim:\n  Dennett vs Sapolsky on free will: A clash over different claims?\n  https://philosophy.stackexchange.com/questions/106926/dennett-vs-sapolsky-on-free-will-a-clash-over-different-claims?utm_source=iterable&utm_medium=email&utm_campaign=the-overflow-newsletter\n  comparing a boulder crashing down a mountain and a skier who skis down the mountain\n\ntwitter:\n\nAU 2023 classes, dependency injection for #RevitAPI, RevitLookup updates, model checker API docs, AI for Revit scripting in @AutodeskRevit @AutodeskAPS #BIM @DynamoBIM https://autode.sk/dependencyinjection\n\nHappy New Year!\n&ndash; AU 2023 classes\n&ndash; Dependency injection for Revit API\n&ndash; RevitLookup updates\n&ndash; Model checker API docs\n&ndash; ChatGPT and Maestro AI for Revit scripting\n&ndash; Construction spending rising in the US\n&ndash; Free Will\n&ndash; Vuca...\n\nlinkedin:\n\nHappy New Year!\n\nAU 2023 classes, dependency injection for #RevitAPI, RevitLookup updates, model checker API docs, AI for Revit scripting:\n\nhttps://autode.sk/dependencyinjection\n\n- AU 2023 classes\n- Dependency injection for Revit API\n- RevitLookup updates\n- Model checker API docs\n- ChatGPT and Maestro AI for Revit scripting\n- Construction spending rising in the US\n- Free Will\n- Vuca...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "Dependency Injection and Model Checker API",
    "local_header_href": "#dependency-injection-and-model-checker-api",
    "chunk_text": "### Dependency Injection and Model Checker API\n\nHappy New Year!\n\nLet's begin it gently with the following notes on topics that caught my eye and interest:\n\n- [AU 2023 classes](#2)\n- [Dependency injection for Revit API](#3)\n- [RevitLookup updates](#4)\n- [Model checker API docs](#5)\n- [ChatGPT and Maestro AI for Revit scripting](#6)\n- [Construction spending rising in the US](#7)\n- [Free Will](#8)\n- [Vuca](#9)"
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "AU 2023 Classes",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> AU 2023 Classes\n\nDid you miss an interesting class at AU?\nCheck out the entire collection\nof [Autodesk University 2023 classes online](https://www.autodesk.com/autodesk-university/search?fields.year=2023)."
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "Dependency Injection for Revit API",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Dependency Injection for Revit API\n\nBetween Christmas and New Year,\nLuiz Henrique [@ricaun](https://ricaun.com/) Cassettari implemented, documented and shared a complete solution\nfor [dependency injection for Revit API](https://forums.autodesk.com/t5/revit-api-forum/dependency-injection-for-revit-api/td-p/12467760),\nsaying:\n\n> I created a library to help create a container for Dependency Injection, designed to work with Revit API.\nIt is open-source and has a package in the Nuget:\n\n> - [github.com/ricaun-io/ricaun.Revit.DI](https://github.com/ricaun-io/ricaun.Revit.DI)\n- [www.nuget.org/packages/ricaun.Revit.DI](https://www.nuget.org/packages/ricaun.Revit.DI)\n\n> I created this [22-minute video](https://youtu.be/Q_greabHlUQ) on how to add the package and a simple example with an `ICommand` implementation:\n\n> - [github.com/ricaun-io/RevitAddin.DI.Example](https://github.com/ricaun-io/RevitAddin.DI.Example)\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/Q_greabHlUQ?si=7pyYCcqMuyy3XL-J\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n</center>\n\n> That's it for the year 2023; Happy New Year with best regards!\n\nHappy New Year to you too, <i>ricaun</i>, and to the entire community from me as well!"
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "RevitLookup Updates",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> RevitLookup Updates\n\nBefore the DI project, ricaun also contributed to RevitLookup, working with\nRoman [Nice3point](https://github.com/Nice3point), principal maintainer, helping to produce:\n\n- [RevitLookup release 2024.0.11](https://github.com/jeremytammik/RevitLookup/releases/tag/2024.0.11)\n- [RevitLookup release 2024.0.12](https://github.com/jeremytammik/RevitLookup/releases/tag/2024.0.12)\n\nRevitLookup 2024.0.11 welcomes you with improved visuals, support for templates to fine-tune data display, improved navigation, in-depth color support:\n\n- Navigation. Updated navigation allows `Ctrl + Click` in the tree or grid to open any selected item or group of items in a new tab.\nThis also allows you to analyze items that RevitLookup doesn't support, e.g., looking at StackTrace for exceptions.\n- Color Preview. Changes to the user interface give us the ability to customize the display of any type of data.\nNow you will be able to visually see how materials or ribbon look.\n`Autodesk.Revit.DB.Color` and `System.Windows.Media.Color` are supported.\n- Update available notification**. Updates are now checked automatically and an icon is displayed in the navigation area if a new version is available.\n- Background effects. Available on windows 11 only: Acrylic, Blur; the visual representation of the background depends on your desktop image and current theme.\n- Color extensions. Convert color to other formats HEX, CMYK, etc. Color name identification, `en` and `ru` localizations available. `Autodesk.Revit.DB.Color` and `System.Windows.Media.Color` are supported.\n- Fixed incorrect display when switching themes on Windows 10.\n- Returned deleted notification when checking for updates.\n- Updated developer's [guide](https://github.com/jeremytammik/RevitLookup/blob/dev/Contributing.md#styles).\n- Full changelog: [2024.0.10...2024.0.11](https://github.com/jeremytammik/RevitLookup/compare/2024.0.10...2024.0.11)\n\nHere, I'm wrapping things up. Wishing everyone a splendid New Year and a joyous Christmas ahead. As always, yours truly &ndash; @Nice3point\n\nRevitLookup 2024.0.12 is the last corrective update for 2023, bringing minor tweaks and improvements:\n\n- Add theme update for all open RevitLookup instances by @ricaun in [#200](https://github.com/jeremytammik/RevitLookup/pull/200)\n- Fix incorrect Hue calculation for some colour formats\n- Disable all background effects for Windows 10. Thanks @ricaun for help and testing [#194](https://github.com/jeremytammik/RevitLookup/issues/194)\n- Full changelog: [2024.0.11...2024.0.12](https://github.com/jeremytammik/RevitLookup/compare/2024.0.11...2024.0.12)\n\nThat's all for now.\nAgain, wishing you all a Happy New Year with best regards, do what you love, evolve, travel, don't forget to have a rest and keep coding! &ndash; @ricaun"
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "Model Checker API Docs",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Model Checker API Docs\n\n<i>Shrey_shahE5SN4</i> very kindly points out\nthe [Model Checker API documentation](https://help.autodesk.com/view/AIT4RVT/ENU/?guid=InteroperabilityToolsForRevit_040mcxr_0404mcxr_html) in\nhis question\non [setting up `IPreBuiltOptionsService` options for CheckSet in AIT](https://forums.autodesk.com/t5/revit-api-forum/setting-up-iprebuiltoptionsservice-options-for-checkset-in-ait/td-p/12455815):\n\n> I am... building an add-in button.\nWhen clicked, it will execute the Model Checker from Autodesk Interoperability Tools.\nFollowing the provided guidelines, I am progressing through the necessary steps:\n\n> [Model Checker API](https://help.autodesk.com/view/AIT4RVT/ENU/?guid=InteroperabilityToolsForRevit_040mcxr_0404mcxr_html)\n\nThank you for that hint, Shrey_shahE5SN4."
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "ChatGPT and Maestro AI for Revit Scripting",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> ChatGPT and Maestro AI for Revit Scripting\n\nAI programming assistants are boosting developer effectivity in many areas.\nHere is one dedicated to Revit customisation:\n[Maestro AI for Revit scripting](https://maestro.bltsmrt.com/).\nLooking forward to hearing how it shapes out.\n\nEric Boehlke of [Truevis](https://truevis.com) has also been working to focus LLMs to work better with programming Revit and shared some results:\n\n> My latest attempt:\n\n> - [OpenAI bim-coding-coach](https://chat.openai.com/g/g-7gcy5wueV-bim-coding-coach)\n- [BIM-Coding-Coach GitHub repository](https://github.com/truevis/BIM-Coding-Coach)\n\n> I haven't tested it with C&#35; yet, but it is working well with Python and DesignScript."
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "Construction Spending Rising in the US",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Construction Spending Rising in the US\n\nGood news for the AEC industry: an impressive positive jump\nin [total construction spending: manufacturing in the United States (TLMFGCONS)](https://fred.stlouisfed.org/series/TLMFGCONS#0):\n\n<center>\n<img src=\"img/total_construction_us.png\" alt=\"Total construction spending\" title=\"Total construction spending\" width=\"1200\"/> <!-- Pixel Height: 848 Pixel Width: 2,598 -->\n</center>"
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "Free Will",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Free Will\n\nAs a scientifically and technically minded person, I often find philosophical pondering rather vague.\nI was therefore pleased to read the interesting and precise analytical philosophical discussion\non [Dennett vs Sapolsky on free will: a clash over different claims?](https://philosophy.stackexchange.com/questions/106926/dennett-vs-sapolsky-on-free-will-a-clash-over-different-claims),\ncomparing the volition and predetermination of a boulder crashing down a mountain and a skier who skis down the mountain, including the possible influence of quantum mechanical effects."
  },
  {
    "original_filename": "2021_di_model_checker",
    "header_text": "Vuca",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> Vuca\n\nHave you ever heard the term \"vuca\"?\nI had not.\nApparently, it stands for volatility, uncertainty, complexity and ambiguity.\nFacing us in the recent past, and possibly in coming years as well.\nWhich leads to the dread of a long-term state, a “permavucalution”.\nOh dear.\nLet's hope that our humanity and free will can help handle it."
  }
][
  {
    "original_filename": "2022_logging",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- <script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script> -->\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- logging:\n  21768403 [Assistance Required with Revit Journal Files]\n  https://forums.autodesk.com/t5/revit-api-forum/api-access-to-user-history-quot-show-history-quot/m-p/12472116\n  AdWindows -- https://forums.autodesk.com/t5/revit-api-forum/intercepting-commands-executed-by-keyboard-shortcuts/td-p/12457597\n  https://forums.autodesk.com/t5/revit-api-forum/the-syntax-and-structure-of-the-journal-file-in-revit/m-p/12490089\n\n- aec greenwashing -- https://www.linkedin.com/pulse/can-construction-refrain-from-greenwashing-aarni-heiskanen-dqfuf/?midToken=AQFbSE8RCQ2a5g&midSig=3AqoWZGBDAwH41&trk=eml-email_series_follow_newsletter_01-newsletter_hero_banner-0-open_on_linkedin_cta&trkEmail=eml-email_series_follow_newsletter_01-newsletter_hero_banner-0-open_on_linkedin_cta-null-7371t~lr3k4lr6~ie-null-null&eid=7371t-lr3k4lr6-ie\n\n- https://climpact.ch\n  developed at [EPFL](https://www.epfl.ch), the École Polytechnique Fédérale de Lausanne,\n  > Our actions have an impact on the climate.\n  Is our perception accurate?\n  Take our quiz to develop an intuition about how to reduce your carbon footprint, and to help us understand how people perceive the impact of their actions.\n\n- interesting AI motivation: ensure it goes well:\n  Tristan Hume https://thume.ca/\n  All my favorite tracing tools: eBPF, QEMU, Perfetto, new ones I built and more\n  https://thume.ca/2023/12/02/tracing-methods/\n  > AI now is still missing a lot, but progress is incredibly fast. It’s hard for me to say the coming decade of progress won’t lead to AI as good as us at nearly all jobs, which would be the biggest event in history. Anthropic is unusually full of people who joined because they really care about ensuring this goes well. I think we have the world’s best alignment, interpretability research, and AI policy teams, and I personally work on performance optimization here because I think it’s the best way to leverage my comparative advantage to help the rest of our efforts succeed at steering towards AI going well for the world in the event it keeps up this pace.\n\n- sublime text\n  https://thume.ca/2017/03/04/my-text-editor-journey-vim-spacemacs-atom-and-sublime-text/\n\n- Can anyone share a working implementation of WPF progress bar with abort button?\n  https://forums.autodesk.com/t5/revit-api-forum/can-anyone-share-a-working-implementation-of-wpf-progress-bar/m-p/12427800#M75752\n  already blogged about:\n  https://github.com/SpeedCAD/SCADtools.Revit.UI.ProgressMeter\n\n- BIM-GPT: a Prompt-Based Virtual Assistant Framework for BIM Information Retrieval\n  https://arxiv.org/abs/2304.09333\n  > Efficient information retrieval (IR) from building information models (BIMs) poses significant challenges due to the necessity for deep BIM knowledge or extensive engineering efforts for automation. We introduce BIM-GPT, a prompt-based virtual assistant (VA) framework integrating BIM and generative pre-trained transformer (GPT) technologies to support NL-based IR. A prompt manager and dynamic template generate prompts for GPT models, enabling interpretation of NL queries, summarization of retrieved information, and answering BIM-related questions. In tests on a BIM IR dataset, our approach achieved 83.5% and 99.5% accuracy rates for classifying NL queries with no data and 2% data incorporated in prompts, respectively. Additionally, we validated the functionality of BIM-GPT through a VA prototype for a hospital building. This research contributes to the development of effective and versatile VAs for BIM IR in the construction industry, significantly enhancing BIM accessibility and reducing engineering efforts and training data requirements for processing NL queries.\n  bim_gpt_prompt_manager_nl_processing.png\n\ntwitter:\n\nAccountability, logging, journals, a WPF progress bar with abort button, AI, AEC, #BIM, CO2 and sustainability topics with @AutodeskRevit #RevitAPI @AutodeskAPS @DynamoBIM https://autode.sk/logging\n\nA nice new collection of Revit API, AI and AEC related topics\n&ndash; Accountability, Logging and Journals\n&ndash; WPF progress bar with abort button\n&ndash; Sublime text\n&ndash; Interesting AI motivation: ensure it goes well\n&ndash; Now you see it, now you don't\n&ndash; BIM-GPT AI BIM information retrieval\n&ndash; AEC greenwashing\n&ndash; IKEA life at home report\n&ndash; Climpact carbon footprint action comparison...\n\nlinkedin:\n\nAccountability, logging, journals, a WPF progress bar with abort button, AI, AEC, #BIM, CO2 and sustainability topics with #RevitAPI\n\nhttps://autode.sk/logging\n\n- Accountability, Logging and Journals\n- WPF progress bar with abort button\n- Sublime text\n- Interesting AI motivation: ensure it goes well\n- Now you see it, now you don't\n- BIM-GPT AI BIM information retrieval\n- AEC greenwashing\n- IKEA life at home report\n- Climpact carbon footprint action comparison...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2022_logging",
    "header_text": "Journals, Logging, Progress Bar, AEC, AI and CO2",
    "local_header_href": "#journals-logging-progress-bar-aec-ai-and-co2",
    "chunk_text": "### Journals, Logging, Progress Bar, AEC, AI and CO2\n\nA nice new collection of Revit API, AI and AEC related topics:\n\n- [Accountability, Logging and Journals](#2)\n- [WPF progress bar with abort button](#3)\n- [Sublime text](#4)\n- [Interesting AI motivation: ensure it goes well](#5)\n- [Now you see it, now you don't](#6)\n- [BIM-GPT AI BIM information retrieval](#7)\n- [AEC greenwashing](#8)\n- [IKEA life at home report](#9)\n- [Climpact carbon footprint action comparison](#10)"
  },
  {
    "original_filename": "2022_logging",
    "header_text": "Accountability, Logging and Journals",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Accountability, Logging and Journals\n\n**Question:** I want to analyse the usage of Revit by our staff.\nOur goal is to evaluate the patterns of Revit usage and propose actionable insights based on these findings.\nWe have chosen to use Revit Journal Files as our primary data source since they do not impede Revit's performance.\n\nChallenge: we find it hard to extract relevant data from the Journal Files.\nThe complexity arises from the extensive amount of data within these files, which combines user activity with computer and hardware information.\nThis has been a stumbling block in progressing with our project.\n\nWe are particularly interested in deciphering user commands executed within Revit, such as zooming in/out, changing views, inserting elements, modifying parameters, etc.\nDespite efforts to utilize Regular Expressions (Regex) for parsing the Journal Files, we have not been successful. The format and volume of the data have proven to be challenging.\n\nHow can we interpret Journal Files effectively?\n\n**Answer:** As you may know, Autodesk provides no official support for any use whatsoever of journal files, so you are basically on you own there.\nIn spite of that, The Building Coder has occasionally performed some research in this area and also shared numerous results from other developers in the [category *Journal*](https://thebuildingcoder.typepad.com/blog/journal/).\n\nPossibly, the most complete documentation for interpreting journals is provided by\nthe [Journalysis project](https://github.com/andydandy74/Journalysis/wiki), cf.\nThe Building Coder not on [Journal File Analysis](https://thebuildingcoder.typepad.com/blog/2022/05/analysis-of-macros-journals-and-add-in-manager.html#4).\n\nI would like to point out the possible use\nof [`SLOG` files for monitoring purposes](https://thebuildingcoder.typepad.com/blog/2021/12/logging-and-monitoring-deleted-data.html),\nso it might be interesting to take a look at those also.\n\nA related question was raised\nby Samuel Arsenault-Brassard of [VIM AEC](https://www.vimaec.com/) in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [API Access to user history? \"Show History\"](https://forums.autodesk.com/t5/revit-api-forum/api-access-to-user-history-quot-show-history-quot/m-p/12472116):\n\n**Question:** The data in the \"Show History\" button is extremely useful to analyse the work done on a file or detect plagiarism:\n\n<center>\n<img src=\"img/user_history.jpg\" alt=\"User history\" title=\"User history\" width=\"400\"/> <!-- Pixel Height: 627 Pixel Width: 861 -->\n</center>\n\nIs it possible to obtain this data through the API?\nIf not, is it possible to obtain it though BIM 360/ACC?\nWe want to obtain the name of the users and when they saved or interacted with the project.\n\n**Answer:** I suspect no Revit API access.\nI also suspect that if no Revit API access, then even less so in more removed environments such as BIM 360 or ACC.\nHowever, you can certainly obtain the required information in various ways without any explicit API access to this specific functionality.\n\nA pretty direct approach might be to\nuse [`PostCommand`](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.3) to\nlaunch the built-in `Show History` command and then use the Windows API to harvest the data displayed in the UI form that you show in the screen snapshot.\n\nYou can certainly also scrape the required into from the journal or SLOG files, if you prefer, cf. above.\n\nThe development team adds:\n\nA: This \"history\" is the list of synchronizations if I am not mistaken.\nWhile journals can catch this, you can also pull it from the SLOG associated to the model and that catches all users instead of one by one (which is what the journal would return).\nThere is a limit to the length of that history though (not sure how it compares with the history of the .rvt itself).\n\nB: Yes, it is the list of Syncs. I don’t think there is any Revit API to query this list.\nThere is/are APS DM APIs that query ACC/BIM 360 model history, but it is the history of the publishes that push the versions from RCM to ACC/BIM 360, so it doesn’t include info for all syncs.\n\nC: Thinking outside of the box here… I removed the slog and all the associated files and the history was still extracted… Is there any chance that list of syncs is taken from the \\global\\history portion of the structured storage? Can that data be extracted easily?\n\nIf so a stand-alone app that exposes the username/time/synch number for a list of .rvt files could likely be quite valuable for a good amount of companies and educational institutions…\n\nB: Right, the source for the data on Show History dialog is a stream in the RVT model, rather than the slog file. I agree it should be valuable to expose the data of sync history outside Revit, but afaik it is not feasible, as the data is binary, require Revit for the deserialization.\n\nD: When writing Revit data into AEC data model during sync is available in the future, I think the history of cloud models can be filtered and queried in the AECDM.\n\nAs for file-based and server-based worksharing, we don't have backlog item on such request. SLOG file would be an incomplete workaround.  In my opinion, we may not invest the efforts on file-based and server-based worksharing workflow only. Cloud worksharing might be higher priority than the other two.\n\nBy the way, the development team would be interested to learn about what you would like to achieve and what kind of insights you hope to get from this.\nWhat is the business value in this for you?\n\n**Response:** Teachers use it to see if students copied each other's work.\nI've detected firms that farmed their work to other firms without telling their clients.\nI've found users who worked at 3AM, showing a lack of time management (their Revit work was also pathetic).\n\nOften, engineering firms don't work on models for months.\nThe engineers don't know Revit, refuse to learn it and don't hire enough \"Revit technicians\" to do the work as specified in the contract.\nMeanwhile, the architects are stuck doing the 3D work of the engineers.\nOr, a firm will say they have 10 employees working on the project, but it's really 1-2 underpaid employees doing all the work.\n\nI've also seen projects to major clients where all the users are interns that work for 2-3 months on the project and disappear.\nThen the client is surprised by the low quality of the Revit work and wonders why it's not following the BIM Execution plan.\n\nSometimes a malicious or disgruntled user will go in and mess up a file on purpose or they are just bad and deny their actions.\n\nSo, it's for accountability.\nTo inspect all the warts and mould of the industry that pumps out students who don't know Revit into the workforce year after year.\n\n**Answer:** Thank you very much for your clarification and very sorry to hear of this dismal state of affairs. Where is the world getting to, one asks? Can we be saved? Will AI make it better? Or much, much worse? Interesting times...\n\n**Response:** When owners/clients understand the value/potential of their BIM, give clear BIM instructions (instead of minimal bid contract with no clear BIM requirements) and are able to easily check for compliance, the industry will be \"fixed\".\n\nUntil then, owners don't know that they are receiving subpar BIM, have no vision about the (lost) potential of their BIM models and are unable to judge if what they paid for is good. Designers are not encouraged to deliver anything of value to get profit from the minimal bid contracts and so the cycle of no accountability, no effort & no skills continues.\n\n**Answer:** So, there is hope, and your tool can help &nbsp; :-)\n\n**Response:** Oh yes!\nOur tool will be a scalable accountability monster for those who know what they want and for deep BIM auditing in general.\n\n<center>\n<!-- <img src=\"img/bim_dashboard.png\" alt=\"BIM dashboard\" title=\"BIM dashboard\" width=\"400\"/> Pixel Height: 999 Pixel Width: 999 -->\n\n<img src=\"img/bim_dashboard2.png\" alt=\"BIM dashboard\" title=\"BIM dashboard\" width=\"400\"/> <!-- Pixel Height: 1,024 Pixel Width: 1,024 -->\n</center>\n\n**Answer:** Wow, great picture! DALL-E? Brilliant.\nNone of my attempts have turned out that well.\nI guess I need to learn better prompting.\n\n**Response:** DALL-E prompt: \"Can you make me an image of a BIM manager who is having the time of his life with a dashboard of data showing accountability. He's in a kind of puppet master moment, happy with all the power of the data, able to see where there are deficiencies, gains and issues throughout all his BIM models of complex architectural projects.\"\n\nRicaun shared another useful pointer on journals in his answer\nto [the syntax and structure of the Journal file in Revit](https://forums.autodesk.com/t5/revit-api-forum/the-syntax-and-structure-of-the-journal-file-in-revit/m-p/12490089):\n\n> Journal is used by Autodesk internally to replicate the same steps to make sure the Revit does not break in development.\nIf you want to know more, there is a great AU class from AU 2023 by Brian Mackey and Zach Kron about Revit Journal:\n\n> - [Revit Journal Files: They Aren’t Just for Autodesk Support](https://www.autodesk.com/autodesk-university/class/Revit-Journal-Files-They-Arent-Just-Autodesk-Support-2018#video)\n\nFinally, to round this off, looking at journal file entries is also mentioned as an alternative to `AdWindows`\nfor [intercepting commands executed by keyboard shortcuts](https://forums.autodesk.com/t5/revit-api-forum/intercepting-commands-executed-by-keyboard-shortcuts/td-p/12457597)."
  },
  {
    "original_filename": "2022_logging",
    "header_text": "WPF Progress Bar with Abort Button",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> WPF Progress Bar with Abort Button\n\nVarious solutions are discussed in the question\non [a working implementation of WPF progress bar with abort button](https://forums.autodesk.com/t5/revit-api-forum/can-anyone-share-a-working-implementation-of-wpf-progress-bar/m-p/12427800).\nA promising one is provided by\nthe [SpeedCAD ProgressMeter](https://github.com/SpeedCAD/SCADtools.Revit.UI.ProgressMeter)\nthat [we recently discussed](https://thebuildingcoder.typepad.com/blog/2023/11/net-core-preview-and-open-source-add-in-projects.html#7).\n\nRicaun adds: I created\nthe package [ricaun.Revit.UI.StatusBar](https://www.nuget.org/packages/ricaun.Revit.UI.StatusBar) last year\nto add a progress bar similar to the default Revit progress bar.\nIts theme is automatically selected depending on the Revit version and theme your plugin is running.\nHere is a 17-minute [video with an example](https://youtu.be/oxD2XDxGL2U):\n\n- [ricaun-io/RevitAddin.ProgressBar.Example](https://github.com/ricaun-io/RevitAddin.ProgressBar.Example)"
  },
  {
    "original_filename": "2022_logging",
    "header_text": "Sublime Text",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Sublime Text\n\nI mentioned a year ago that I switched to\nthe [Sublime Text](https://thebuildingcoder.typepad.com/blog/2023/02/pyramid-builder-commandloader-et-al.html#8) editor.\n\nI am still using it and am perfectly satisfied with my choice.\nIt was nice to note that I am in the good company of [Tristan Hume](https://thume.ca/),\nwho documented his own experiences\nin [my text editor journey: Vim, Spacemacs, Atom and Sublime Text](https://thume.ca/2017/03/04/my-text-editor-journey-vim-spacemacs-atom-and-sublime-text/)."
  },
  {
    "original_filename": "2022_logging",
    "header_text": "Interesting AI Motivation: Ensure It Goes Well",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Interesting AI Motivation: Ensure It Goes Well\n\nI browsed Tristan's very interesting web site and was impressed by the compelling motivation to get involved with AI development that he expresses in his discussion\nof tracing methods,\n[all my favorite tracing tools: eBPF, QEMU, Perfetto, new ones I built and more](https://thume.ca/2023/12/02/tracing-methods/):\n\n> AI now is still missing a lot, but progress is incredibly fast.\nIt’s hard for me to say the coming decade of progress won’t lead to AI as good as us at nearly all jobs, which would be the biggest event in history.\nAnthropic is unusually full of people who joined because they really care about ensuring this goes well.\nI think we have the world’s best alignment, interpretability research, and AI policy teams, and I personally work on performance optimization here because I think it’s the best way to leverage my comparative advantage to help the rest of our efforts succeed at steering towards AI going well for the world in the event it keeps up this pace."
  },
  {
    "original_filename": "2022_logging",
    "header_text": "Now You See It, Now You Don't",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Now You See It, Now You Don't\n\nTalking about AI, an interesting note on human perception of pattern recognition and adversarial images to prevent it showing that we subconsciously notice subtle details that we are completely unaware of and\nthat [images altered to trick machine vision can influence humans too](https://deepmind.google/discover/blog/images-altered-to-trick-machine-vision-can-influence-humans-too/)."
  },
  {
    "original_filename": "2022_logging",
    "header_text": "BIM-GPT AI BIM Information Retrieval",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> BIM-GPT AI BIM Information Retrieval\n\nGetting back to AEC related aspects, to ensure that things go well in the BIM domain, AI-assisted information retrieval might help; maybe something\nlike [BIM-GPT, a prompt-based virtual assistant framework for BIM information retrieval](https://arxiv.org/abs/2304.09333):\n\n> Efficient information retrieval (IR) from building information models (BIMs) poses significant challenges due to the necessity for deep BIM knowledge or extensive engineering efforts for automation. We introduce BIM-GPT, a prompt-based virtual assistant (VA) framework integrating BIM and generative pre-trained transformer (GPT) technologies to support NL-based IR. A prompt manager and dynamic template generate prompts for GPT models, enabling interpretation of NL queries, summarization of retrieved information, and answering BIM-related questions. In tests on a BIM IR dataset, our approach achieved 83.5% and 99.5% accuracy rates for classifying NL queries with no data and 2% data incorporated in prompts, respectively. Additionally, we validated the functionality of BIM-GPT through a VA prototype for a hospital building. This research contributes to the development of effective and versatile VAs for BIM IR in the construction industry, significantly enhancing BIM accessibility and reducing engineering efforts and training data requirements for processing NL queries.\n\n<center>\n<img src=\"img/bim_gpt_prompt_manager_nl_processing.png\" alt=\"BIM-GPT NL query prompt processing\" title=\"BIM-GPT NL query prompt processing\" width=\"800\"/> <!-- Pixel Height: 605 Pixel Width: 900 -->\n</center>"
  },
  {
    "original_filename": "2022_logging",
    "header_text": "AEC Greenwashing",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> AEC Greenwashing\n\nAarni Heiskanen shared an interesting article on the imminent danger\nof [AEC greenwashing](https://www.linkedin.com/pulse/can-construction-refrain-from-greenwashing-aarni-heiskanen-dqfuf/)."
  },
  {
    "original_filename": "2022_logging",
    "header_text": "IKEA Life at Home Report",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> IKEA Life at Home Report\n\nTalking about AEC and sustainability, let's also think about the occupants, their thoughts and wishes.\n\nIKEA asked them, in large numbers, worldwide, compiled the results and hazarded some projections into the future as well:\n\n- [IKEA Life at Home Report 2023](https://lifeathome.ikea.com/the-2023-report/)\n- [Life at Home Report 2023 PDF](https://lifeathome.ikea.com/wp-content/uploads/2024/01/Life-at-Home-Report-2023.pdf)\n- Fast Company article\n  on [Algae wallpaper, pod homes, and mushroom furniture: Ikea’s predictions for life in 2030 are semi-apocalyptic](https://www.fastcompany.com/91006861/algae-wallpaper-pod-housing-and-mushroom-furniture-ikeas-predictions-for-life-in-2030-are-semi-apocalyptic)\n  > Ikea explores how our idea of home might evolve in a scarce future\n\n<a name=\"10\"></a>"
  },
  {
    "original_filename": "2022_logging",
    "header_text": "Climpact Carbon Footprint Action Comparison",
    "local_header_href": "#climpact-carbon-footprint-action-comparison",
    "chunk_text": "#### Climpact Carbon Footprint Action Comparison\n\nA great possibility to test your carbon footprint understanding or learn more about the sometimes surprising emissions produced by various actions and behaviour is provided by\nthe [Climpact](https://climpact.ch) tool,\ndeveloped at [EPFL](https://www.epfl.ch),\nthe École Polytechnique Fédérale de Lausanne, one of the main Swiss technical universities.\n\n> Our actions have an impact on the climate.\nIs our perception accurate?\nTake our quiz to develop an intuition about how to reduce your carbon footprint, and to help us understand how people perceive the impact of their actions."
  }
][
  {
    "original_filename": "2023_id",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- <script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script> -->\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- Revit ID Compilation\n  Revit IDs\n  https://forums.autodesk.com/t5/revit-api-forum/revit-ids/td-p/12418195\n  >>>>Element Id\n  0344:Newly Created Element Retrieval Based on Monotonously Increasing Element Id Values\n  0344:Enhanced Parameter Filter for Greater Element Id Values\n  0544:Comparing Element Id for Equality\n  0948:Element Ids in Extensible Storage\n  1144:Element Id &ndash; Export, Unique, Navisworks and Other Ids\n  1144:Negative Element Ids and Element Property Drop-down List Enumerations\n  1182:How to Trigger a Dynamic Model Updater by Specific Element Ids\n  1353:Family Category, Element Ids, Transaction and Updates\n  1396:<\"#6\">WPF Element Id Converter\n  1577:<\"#3\">Access Revit BIM Data and Element Ids from BIM360\n  1628:Retrieving Newly Created Element Ids\n  1628:<\"#3\">Consecutive Element Ids\n  1634:<\"#2\">Search and Snoop by Element Id or Unique Id\n  1762:Element Identifiers in RVT, IFC, NW and Forge\n  1762:<\"#3\"> Revit Element Ids in Forge via Navisworks and IFC\n  1959:<\"#2\"> Immutable UniqueId, Mutable Element Id\n  1974:64-Bit Element Ids, Maybe?\n  1974:<\"#2\"> 64-Bit Element Ids\n  1992:<\"#9\"> Consuming Huge Numbers of Element Ids\n  1995:<\"#4\"> Backward Compatible 64 Bit Element Id\n  >>>>0344 0544 0948 1144 1182 1353 1396 1577 1628 1634 1762 1959 1974 1992 1995\n  >>>>Unique Id\n  0104:UniqueId versus DWF and IFC GUID\n  0104:GUID and UniqueId\n  0104:UniqueId to GUID Encoding\n  0104:IFC GUID and UniqueId Encoder and Decoder\n  0737:Retrieving Unique Geometry Vertices\n  0787:Geometry Traversal to Retrieve Unique Vertices\n  0819:IFC GUID Generation and Uniqueness\n  0943:Solving the Non-unique Unique Id Problem\n  1144:Element Id &ndash; Export, Unique, Navisworks and Other Ids\n  1144:Unique Id versus ElementId to Store in External Database\n  1144:Local Uniqueness of the Revit Unique Id\n  1144:Navisworks versus Revit Object Unique Ids\n  1144:Revit Id and UniqueId Lost On Reimporting Revised Model\n  1209:Unique Names and the NamingUtils Class\n  1277:Understanding the Use of the UniqueId\n  1304:Extracting Unique Building Element Geometry Vertices\n  1459:Consistency of IFC GUID and UniqueId\n  1577:<\"#4\">Unique IDs for Forge Viewer Elements\n  1634:RevitLookup Search by Element and Unique Id\n  1634:<\"#2\">Search and Snoop by Element Id or Unique Id\n  1949:Unique Id and IFC GUID Parameter\n  1949:<\"#4\"> You Cannot Control the Unique Id\n  1959:Immutable UniqueId and Revit Database Explorer\n  1959:<\"#2\"> Immutable UniqueId, Mutable Element Id\n  >>>> 0104 0737 0787 0819 0943 1144 1209 1277 1304 1459 1577 1634 1949 1959\n\n- https://forums.autodesk.com/t5/revit-api-forum/are-references-unique-across-documents/td-p/12381420\n\n- DirectContext3D: API for Displaying External Graphics in Revit\n  by Alex Pytel\n  https://www.autodesk.com/autodesk-university/class/DirectContext3D-API-Displaying-External-Graphics-Revit-2017#video\n\n- a novel method using tagging to\n  Determine linked elements present in a section\n  https://forums.autodesk.com/t5/revit-api-forum/determine-linked-elements-present-in-a-section/td-p/12488150\n\ntwitter:\n\nRevit element id compilation, unique cross-document reference, DirectContext3D and determining elements present in section view with the @AutodeskRevit #RevitAPI #BIM @AutodeskAPS @DynamoBIM https://autode.sk/elementids\n\nRevit element id compilation, unique cross-document reference, AU class on <code>DirectContext3D</code> and determining elements present in section view...\n\n&ndash;  ...\n\nlinkedin:\n\nRevit element id compilation, unique cross-document reference, DirectContext3D and determining elements present in section view with the #RevitAPI #BIM @AutodeskAPS @DynamoBIM\n\nhttps://autode.sk/elementids\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2023_id",
    "header_text": "DirectContext3D, Ids and Linked Section Elements",
    "local_header_href": "#directcontext3d-ids-and-linked-section-elements",
    "chunk_text": "### DirectContext3D, Ids and Linked Section Elements\n\nHere are some of the topics that came up this week:\n\n- [Revit element id compilation](#2)\n- [Unique cross-document reference](#3)\n- [AU class on `DirectContext3D`](#4)\n- [Determining elements present in section view](#5)"
  },
  {
    "original_filename": "2023_id",
    "header_text": "Revit Element Id Compilation",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Revit Element Id Compilation\n\nMichael Pescht shared a nice overview of the different Revit BIM element identifiers in\nhis [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [Revit IDs](https://forums.autodesk.com/t5/revit-api-forum/revit-ids/td-p/12418195):\n\n**Post:**\nThere are several explanations available for the IDs used in Revit.\nUnfortunately, I have not found a complete definition of all IDs in a single document / post.\nTherefore, I would like to have my compilation checked here in the forum.\nThanks in advance.\n\n- Element Id, or just \"Id\":\nthe unique identification for an element within a single project.\nExample decimal: 895976; example hexadecimal: 000dabe8\n- EpisodeId:\nthe first part of the `UniqueId`, including the characters of the sequence 8-4-4-4-12, referring to the project and the session, e.g.,\n626f5187-9a17-4713-98b7-532ca3cc31b1\n- UniqueId:\na stable unique identifier for an element, globally unique across all documents, returned by the API as a string, e.g.,\n\"626f5187-9a17-4713-98b7-532ca3cc31b1-000dabe8\".\nIt is a hexadecimal sequence of 8-4-4-4-12-8 characters, consisting of two parts:\nEpisodeId (8-4-4-4-12) + Hexadecimal(Element Id) (8)\n- DWF GUID (Export GUID):\na hexadecimal version of the IfcGuid\nHex(IfcGuid) = DWF GUID\nExample: 626f5187-9a17-4713-98b7-532ca3c19a59\n- IfcGuid:\na 22-character code (string) using the 64-character base which includes numbers, upper and lower case letters and some special characters. Although it looks completely different from other GUIDs, the IFC GUID is completely identical to the DWF GUID, but is expressed with a different encoding to make it shorter and easier to understand.\nCompressed version of the DWF GUID.\nHex(IfcGuid) = DWF GUID.\nExample: compress(626f5187-9a17-4713-98b7-532ca3c19a59)\n- ExternalId:\nThe external ID of a geometry object.\nExample: 626f5187-9a17-4713-98b7-532ca3c19a59-000dabe8;\nExternalId = DwfGUID + \"-\" + Hex(ElementId)\n\nMany thanks to Michael for his compilation.\nHere is a list of existing information on element ids and unique ids from The Building Coder:\n\n- Element Id\n    - [Retrieving Newly Created Elements in Revit 2011](http://thebuildingcoder.typepad.com/blog/2010/04/retrieving-newly-created-elements-in-revit-2011.html)\n    - [Comparing Element Id for Equality](http://thebuildingcoder.typepad.com/blog/2011/02/comparing-element-id-for-equality.html)\n    - [DWG Issues and Various Other Updates](http://thebuildingcoder.typepad.com/blog/2013/05/dwg-issues-and-various-other-updates.html)\n    - [Element Id &ndash; Export, Unique, Navisworks and Other Ids](http://thebuildingcoder.typepad.com/blog/2014/04/element-id-export-unique-navisworks-and-other-ids.html)\n    - [CreateLinkReference Sample Code](http://thebuildingcoder.typepad.com/blog/2014/07/createlinkreference-sample-code.html)\n    - [Family Category, Element Ids, Transaction Undo and Updates](http://thebuildingcoder.typepad.com/blog/2015/09/family-category-element-ids-transaction-undo-and-updates.html)\n    - [DevDay Conference in Munich and WPF DoEvents](http://thebuildingcoder.typepad.com/blog/2016/01/devday-conference-in-munich-and-wpf-doevents.html)\n    - [Revit versus Forge, Ids and Add-In Installation](http://thebuildingcoder.typepad.com/blog/2017/08/revit-versus-forge-ids-and-add-in-installation.html)\n    - [Retrieving Newly Created Element Ids](http://thebuildingcoder.typepad.com/blog/2018/02/retrieving-newly-created-element-ids.html)\n    - [RevitLookup Search by Element and Unique Id](http://thebuildingcoder.typepad.com/blog/2018/03/revitlookup-search-and-snoop-by-element-and-unique-id.html)\n    - [Element Identifiers in RVT, IFC, NW and Forge](https://thebuildingcoder.typepad.com/blog/2019/07/element-identifiers-in-rvt-ifc-nw-and-forge.html)\n    - [Immutable UniqueId and Revit Database Explorer](https://thebuildingcoder.typepad.com/blog/2022/07/immutable-uniqueid-and-revit-database-explorer.html)\n    - [64-Bit Element Ids, Maybe?](https://thebuildingcoder.typepad.com/blog/2022/11/64-bit-element-ids-maybe.html)\n    - [Configuring RvtSamples 2024 and Big Numbers](https://thebuildingcoder.typepad.com/blog/2023/04/configuring-rvtsamples-2024.html)\n    - [64 Bit Ids, Revit and RevitLookup Updates](https://thebuildingcoder.typepad.com/blog/2023/05/64-bit-ids-revit-and-revitlookup-updates.html)\n- UniqueId\n    - [UniqueId, DWF and IFC GUID](http://thebuildingcoder.typepad.com/blog/2009/02/uniqueid-dwf-and-ifc-guid.html)\n    - [Melbourne Day Two](http://thebuildingcoder.typepad.com/blog/2012/03/melbourne-day-two.html)\n    - [Real-World Concrete Corner Coordinates](http://thebuildingcoder.typepad.com/blog/2012/06/real-world-concrete-corner-coordinates.html)\n    - [IFC GUID Generation and Uniqueness](http://thebuildingcoder.typepad.com/blog/2012/09/ifc-guid-generation-and-uniqueness.html)\n    - [Copy and Paste API Applications and Modeless Assertion](http://thebuildingcoder.typepad.com/blog/2013/05/copy-and-paste-api-applications-and-modeless-assertion.html)\n    - [Element Id &ndash; Export, Unique, Navisworks and Other Ids](http://thebuildingcoder.typepad.com/blog/2014/04/element-id-export-unique-navisworks-and-other-ids.html)\n    - [Unique Names and the NamingUtils Class](http://thebuildingcoder.typepad.com/blog/2014/09/unique-names-and-the-namingutils-class.html)\n    - [Understanding the Use of the UniqueId](http://thebuildingcoder.typepad.com/blog/2015/02/understanding-the-use-of-the-uniqueid.html)\n    - [Back from Easter Holidays and Various Revit API Issues](http://thebuildingcoder.typepad.com/blog/2015/04/back-from-easter-holidays-and-various-revit-api-issues.html)\n    - [Consistency of IFC GUID and UniqueId](http://thebuildingcoder.typepad.com/blog/2016/08/consistency-of-ifc-guid-and-uniqueid.html)\n    - [Revit versus Forge, Ids and Add-In Installation](http://thebuildingcoder.typepad.com/blog/2017/08/revit-versus-forge-ids-and-add-in-installation.html)\n    - [RevitLookup Search by Element and Unique Id](http://thebuildingcoder.typepad.com/blog/2018/03/revitlookup-search-and-snoop-by-element-and-unique-id.html)\n    - [Unique Id and IFC GUID Parameter](https://thebuildingcoder.typepad.com/blog/2022/04/unique-id-and-ifc-guid.html)\n    - [Immutable UniqueId and Revit Database Explorer](https://thebuildingcoder.typepad.com/blog/2022/07/immutable-uniqueid-and-revit-database-explorer.html)"
  },
  {
    "original_filename": "2023_id",
    "header_text": "Unique Cross-Document Reference",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Unique Cross-Document Reference\n\nIn a related vein, *grubdex* and *ricaun* pondered:\n[are references unique across documents?](https://forums.autodesk.com/t5/revit-api-forum/are-references-unique-across-documents/td-p/12381420)\n\n**Question:** Are `Reference` objects unique across documents in my project?\nI know that UniqueIDs are and IDs are not.\n\n**Answer:** Probably yes; the `Reference` has the `UniqueId` embedded in the stable representation.\nUsing a `UniqueId` of the element with `Reference.ParseFromStableRepresentation` will return the `Reference` of the element:\n\n<pre><code>\n  Reference reference\n    = Reference.ParseFromStableRepresentation(\n      document, element.UniqueId);\n</code></pre>\n\nThank you both for this."
  },
  {
    "original_filename": "2023_id",
    "header_text": "AU Class on DirectContext3D",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> AU Class on DirectContext3D\n\nHere is a go-to source of information for `DirectContext3D` that you should be aware of when dealing with this topic,\nan Autodesk University 2023 class by Alex Pytel:\n\n- [DirectContext3D: API for Displaying External Graphics in Revit](https://www.autodesk.com/autodesk-university/class/DirectContext3D-API-Displaying-External-Graphics-Revit-2017#video)"
  },
  {
    "original_filename": "2023_id",
    "header_text": "Determining Elements Present in Section View",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Determining Elements Present in Section View\n\nFaced with the task of determining which elements are present in a given section view, Wallas Santana and I stumbled across a novel solution using tagging in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread on\nhow to [determine linked elements present in a section](https://forums.autodesk.com/t5/revit-api-forum/determine-linked-elements-present-in-a-section/td-p/12488150):\n\n**Question:** I have a section with some project elements and a linked file loaded with some other elements in a section view, as shown here:\n\n<center>\n<img src=\"img/linked_elements_in_section.png\" alt=\"Linked elements in section view\" title=\"Linked elements in section view\" width=\"500\"/> <!-- Pixel Height: 718 Pixel Width: 881 -->\n</center>\n\nI need to check which elements of the linked file are present in this section, but I'm having difficulties.\nI tried to check whether the elements are inside the view's BoundingBox, but without success.\nThen, I tried to apply another solution\nto [check if a point is inside bounding box](https://forums.autodesk.com/t5/revit-api-forum/check-to-see-if-a-point-is-inside-bounding-box/td-p/4354446).\n\nHowever, it seems that the position returned in BoundingBox is outside of view.\n\nI use this solution to apply tags to linked elements without any problems:\n\n<pre><code>\nReference refe = new Reference(itemconex)\n  .CreateLinkReference(docsVinculados);\n\nIndependentTag tagConexao = IndependentTag.Create(\n  Doc.Document, TagConexSelecionada.Id, Doc.ActiveView.Id,\n  refe, true, TagOrientation.Horizontal, PosicaoFinal);\n</code></pre>\n\n**Answer:** The biggest challenge is probably the transformation.\nOne possible approach would be to read and understand in depth all the transformations involved.\nAnother possible approach, in case your tendency is stronger to hack and do rather than study and ponder, might be: create a very simple linked file with just an element or two, e.g., model lines.\nHost it.\nAnalyse the resulting geometry in the host file.\nReproduce the model lines in the host file until their appearance matches the original ones in the linked file.\nBasically, you just need to determine where a given bounding box in the linked file will end up on the host, don't you?\n\nSince you mention that you can successfully and automatically create tags for the linked elements, another idea comes to mind: before creating the tags, subscribe to the `DocumentChanged` method to be notified of the added elements.\nThen, you can query the tags for their locations.\nThat will presumably approximate the host project locations of the linked elements.\n\n**Response:** Hi Jeremy, thank you for your reply, you opened my mind to a possible solution!\nI just add a new `IndependentTag` then check if it's `BoundingBox` is valid:\n\n<pre><code>\nIndependentTag tagConexao = IndependentTag.Create(\n  Config.doc, Config.doc.ActiveView.Id, refe, true,\n  TagMode.TM_ADDBY_CATEGORY, TagOrientation.Horizontal,\n  PosicaoFinal);\n\nif (null != tagConexao.get_BoundingBox(Config.doc.ActiveView))\n{\n  // The element is in the view\n}\n</code></pre>\n\nThen, I collect the id's I need and RollBack the transaction in the final, it's working.\nBtw I'll study how transformations works when I have linked elements in some view.\nThank you.\n\nThank you, Wallas, for raising this issue and confirming."
  }
][
  {
    "original_filename": "2024_context",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- <script src=\"https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\" type=\"text/javascript\"></script> -->\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- valid api context\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1705566333752629\n  Jeff Hotchkiss\n  what is the correct & efficient way to validate one's execution of code is in a Revit API context? I can see in the internal C++ code of Revit that Revit API objects perform checks - how does one do this equivalent check in C#? Background in :thread:\n  Answers by Dimitar Venkov\n\n- Extensible Storage in APS\n  https://autodesk.slack.com/archives/C04R1THN78V/p1705949479594829\n  João Martins\n  Is Revit Extensible Storage supported by SVF ?\n  Petr Broz\n  Revit Extensible Storage Sounds like some kind of feature that lets you store custom data inside Revit elements.\n  Jeremy Tammik\n\ntwitter:\n\nValid #RevitAPI context, extensible storage in @AutodeskAPS, AI large language model course, token-free selective state space model, l'humanité en péril and the limits to growth with @AutodeskRevit #BIM @DynamoBIM https://autode.sk/apicontext\n\nRevit API, climate, and AI\n&ndash; Valid Revit API context\n&ndash; Extensible storage in APS\n&ndash; Large language model course\n&ndash; Token-free selective state space model\n&ndash; L'humanité en péril\n&ndash; The limits to growth...\n\nlinkedin:\n\nRevit API, climate, and AI news:\n\nhttps://autode.sk/apicontext\n\n- Valid Revit API context\n- Extensible storage in APS\n- Large language model course\n- Token-free selective state space model\n- L'humanité en péril\n- The limits to growth...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2024_context",
    "header_text": "Valid Revit API Context, LLM and LTG",
    "local_header_href": "#valid-revit-api-context-llm-and-ltg",
    "chunk_text": "### Valid Revit API Context, LLM and LTG\n\nWe continue our exciting exploration of the Revit API and observations on where the world development in general\n&ndash; and climate, and AI, in particular &ndash; are leading:\n\n- [Valid Revit API context](#2)\n- [Extensible storage in APS](#3)\n- [Large language model course](#4)\n- [Token-free selective state space model](#5)\n- [L'humanité en péril](#6)\n- [The limits to growth](#7)\n- [Discussing the limits to growth](#7.2)"
  },
  {
    "original_filename": "2024_context",
    "header_text": "Valid Revit API Context",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Valid Revit API Context\n\nThe Revit API is almost completely event driven.\nEvery event can be processed by an event handler.\nThe best-known event is the external command `Execute` that is triggered by an end user launching the command by clicking the corresponding ribbon button.\nWithin the event handler, Revit provides a valid Revit API context.\nMost Revit API methods can only be used within such a context, and nowhere else, cf.:\n\n- [Use of the Revit API requires a valid context](http://thebuildingcoder.typepad.com/blog/2015/12/external-event-and-10-year-forum-anniversary.html#2)\n- [Revit API context summary](https://thebuildingcoder.typepad.com/blog/2015/08/revit-api-context-and-form-creation-errors.html#2)\n- [Valid Revit API context and external events](https://thebuildingcoder.typepad.com/blog/2020/11/document-session-id-api-context-and-external-events.html#3)\n\nWhen automating Revit, one often wishes to trigger some action in the BIM from outside.\nThis can be achieved by implementing an external event that can be raised from a non-modal context.\nThis are has been discussed in depth by The Building Coder, cf. the topic group\non [`Idling` and external events for modeless access and driving Revit from outside](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.28).\n\nHere are some other aspects of this theme, from an internal Revit developers point of view:\n\n**Question:** What is the correct and efficient way to validate one's execution of code is in a Revit API context?\nI can see in the internal C++ code of Revit that Revit API objects perform checks &ndash; how does one do this equivalent check in C#?\n\nBackground: we have a lot of complex multi-threaded app code for Revit.\nThe most common class of errors here fall into three cases outside of just not knowing about some Revit corner cases:\n\n- Calling Revit from the wrong thread\n- Calling Revit outside the API context\n- Persisting & misusing Revit objects beyond their lifetime\n\nThis often goes awry when mixed in with modern coding practices like DI, async, etc.\nI'm in the process of extending our low-level libraries for using the Revit API to provide effectively Revit safe zones\n&ndash; if you're in one of these, you can call Revit, if not, you need to marshal into one.\nFor example, a UI call might need to alter Revit and it's not immediately obvious if it's safe to do so without marshalling into an External Event.\nThe wrong thread is easy to detect.\nPersisting Revit objects can be a mix of better defensive coding and PR review, but I've already got patterns that make it much harder to accidentally drop Revit objects into long-lived objects.\nDetecting incorrect context looks to be a bit harder.\n\n**Answer:** Any and all Revit API code will always be executed in an API context.\nHowever, only the main execution thread can modify the Revit database.\nYou could probably use something along the lines of this to check if you are running in it:\n[how to tell if a thread is the main thread in C#](https://stackoverflow.com/questions/2374451/how-to-tell-if-a-thread-is-the-main-thread-in-c-sharp)\n\nAll Revit elements have an `IsValidObject` property that can check if it's still connected to a native object.\n\n**Response:**\nCan you clarify why 'any and all C# code will always be executed in an API context'?\nIf I spin up a modeless UI in a Revit pane, the WPF context does not appear to be guaranteed safe to call Revit objects in.\n\n**Answer:**\nThere are best practices like using an `IExternalEventHandler` for any multi-threaded code.\nIt's also best not to store Revit elements directly, but instead only their ElementIds or UniqueIds.\nUniqueIds are strings, which are value objects.\n`ElementId` is a class but is serializable.\nBoth can safely be used between threads.\n\n[Revit.Async](https://github.com/KennanChan/Revit.Async/blob/master/README.md)\nprovides a really nice and in-depth explanation of this:\n\n> Use Task-based asynchronous pattern (TAP) to run Revit API code from any execution context.\n\n> If you have ever encountered a Revit API exception saying, \"Cannot execute Revit API outside of Revit API context\",\ntypically when you want to execute Revit API code from a modeless window, you may need this library to save your life.\nA common solution for this exception is to wrap the Revit API code using `IExternalEventHandler` and\nregister the handler instance to Revit ahead of time to get a trigger (`ExternalEvent`).\nTo execute the handler, just raise the trigger from anywhere to queue the handler to the Revit command loop.\nBut there comes another problem...\n\n**Response:**\nThanks &ndash; I am aware of all of these; our library uses similar techniques to `Revit.Async`, appreciated for the reinforcement, but perhaps an example will help.\nLets' say I subscribe to a Revit event, and hook that to some piece of internal logic.\nThat internal logic calls reentrantly into some other piece of code that needs to perform Revit functionality, e.g., altering the UI.\nThat same piece of code might also be called from outside a Revit event (external or internal), and therefore, as I understand it, would need to move to an external event.\nAs it stands, the developer has to follow that call stack for any time they connect these events up and hope they know whether they're inside Revit at the start or not.\nWhat I'd like is a low-level dispatch that would be something like:\n\n<pre><code>if(InRevitContext)\n   // Run code inline for efficiency\nelse\n   // Not safe, must wrap code in external event and wait for it\n</code></pre>\n\nAt a minimum a debug check to validate early and say, 'no, your code is wrong, you will get Revit failures', would be good.\n\n**Answer:**\nNot sure if such a check exists, sorry.\nGetting the main thread's id inside your `IExternalAppication.OnStartup` might help with that.\nBut I'd recommend you always stick to the `ExternalEvent.Raise` pattern whenever you have non-modal windows or panels and not call the event handler directly.\n\n**Response:**\nUnderstood.\nThe challenge we have at the moment is that this yields sometimes a lot of small External Event Raises, that are running and queued independently.\nMy limited understanding is that in the current implementation of `Raise`, Revit runs all of these in idle time, which means in theory other addin code or other user interactions could alter state between the executions.\nThere's been concern raised that ideally they'd chain together so that we can be confident Revit state hasn't changed between them (since writing each event in a fashion that says 'check we're e.g. still on the same view we were in the last event' is non-trivial).\nMaybe there's a workaround &ndash; if I have an UIApplication &ndash; is there something cheap I can call that will do that 'Cannot execute Revit API outside of Revit API context check'?\nWill `IsValidObject` perform it with some level of guarantee?\n(I have found that I can write 'be careful with your state, always use external events' in big bold letters in architectural guidelines as much as I like, junior devs or contractors will regularly write code, test the path, it works, ship it, and then later a different path executes it and it crashes..)\n\n**Answer:**\nWhat do you mean by \"change state\"?\nNo other plugin should be able to change the state of your plugin's objects.\nIf you mean, change the state of the Revit document and its elements, that is always a possibility and must be accounted for.\nYou cannot expect that the end user will only run your plugin, nor can you account for every possible combination of plugins and scripts that they might use.\nWhat you can be sure of, is that when the execution of your plugin' starts, you can go through all the element ids that you stored and check each to make sure that an element with that ID still exists.\nIf it has been deleted, you can skip it and move on to the next one.\nIf you need more fine-grained control than this, look at the `IUpdater` interface instead.\nMost of the time Revit crashes because of unhandled exceptions.\nTry to execute all entry points in a try-catch context and log all exceptions.\n\n**Response:**\nAgreed; I'll see what I can do to further reinforce these patterns.\nAlways helpful to have these needs confirmed too!\n\nMany thanks to Jeff Hotchkiss and Dimitar Venkov for this illuminating discussion."
  },
  {
    "original_filename": "2024_context",
    "header_text": "Extensible Storage in APS",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Extensible Storage in APS\n\n**Question:** Is Extensible Storage supported by `SVF`?\n\n**Answer:** SVF is an efficient compressed representation of the BIM geometry and selected metadata resulting from a translation of the original BIM CAD seed file for\nthe [Autodesk Platform Services APS](https://aps.autodesk.com/) environment.\n\nRevit [Extensible Storage](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.23) is\na feature that lets add-ins store custom data inside Revit elements.\n\nThe extensible storage data is only accessible to the add-in that creates it.\nTherefore, the Revit translation process has no access to it, so it cannot be translated to SVF.\n\nSo, the answer is generally no."
  },
  {
    "original_filename": "2024_context",
    "header_text": "Large Language Model Course",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Large Language Model Course\n\nMoving away from the Revit API to the ever-exciting topic of AI and LLMs, here is\na [Large Language Model Course](https://github.com/mlabonne/llm-course).\n\n> It is divided into three parts:\n\n> - LLM Fundamentals covers essential knowledge about mathematics, Python, and neural networks.\n- The LLM Scientist focuses on building the best possible LLMs using the latest techniques.\n- The LLM Engineer focuses on creating LLM-based applications and deploying them."
  },
  {
    "original_filename": "2024_context",
    "header_text": "Token-free Selective State Space Model",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Token-free Selective State Space Model\n\nOn the topic of LLMs, is the lo#ng LLM tokenisatio#n night#m#are possibly near#ing it#s end?\n\n[MambaByte: Token-free Selective State Space Model](https://arxiv.org/html/2401.13660v1) reports:\n\n> Token-free language models learn directly from raw bytes and remove the bias of subword tokenization. Operating on bytes, however, results in significantly longer sequences\n... experiments indicate the computational efficiency of MambaByte compared to other byte-level models.\n... findings establish the viability of MambaByte in enabling token-free language modeling."
  },
  {
    "original_filename": "2024_context",
    "header_text": "L'Humanité en Péril",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> L'Humanité en Péril\n\nOne of my favourite authors, Fred Vargas, took a break from detective stories and wrote whole book on climate change instead,\n[L'humanité en péril](https://editions.flammarion.com/lhumanite-en-peril/9782081490864).\nI just read it and agree to a large extent.\nThe biggest takeaway:\nwe need to take matters into our own hands;\nwe cannot trust or wait for politicians, who are subservient to lobbies;\neat less meat;\navoid consuming mass agricultural industry products."
  },
  {
    "original_filename": "2024_context",
    "header_text": "The Limits to Growth",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> The Limits to Growth\n\nVargas also points out [The Limits to Growth or LTG](https://en.wikipedia.org/wiki/The_Limits_to_Growth),\na 1972 report that discusses the possibility of exponential economic and population growth\nwith finite supply of resources, studied by computer simulation.\nThe study uses a computer model to simulate the consequence of interactions between the Earth and human systems.\nAfter reviewing their computer simulations, the research team came to the following conclusions:\n\n- If the present growth trends in world population, industrialization, pollution, food production, and resource depletion continue unchanged, the limits to growth on this planet will be reached sometime within the next one hundred years. The most probable result will be a rather sudden and uncontrollable decline in both population and industrial capacity.\n- It is possible to alter these growth trends and to establish a condition of ecological and economic stability that is sustainable far into the future. The state of global equilibrium could be designed so that the basic material needs of each person on earth are satisfied and each person has an equal opportunity to realize his individual human potential.\n- If the world's people decide to strive for this second outcome rather than the first, the sooner they begin working to attain it, the greater will be their chances of success.\n\nIn 2008, some researchers concluded that, \"its approach remains useful and that its conclusions are still surprisingly valid...\nunfortunately, the report has been largely dismissed by critics as a doomsday prophecy that has not held up to scrutiny.\"\n\nIn 2023, the parameters of the simulation model were recalibrated using empirical data up to 2022.\nThis improved parameter set results in a simulation that shows the same overshoot and collapse mode in the coming decade as the original business-as-usual scenario of the Limits to Growth standard run.\nThe main effect of the recalibration update is to raise the peaks of most variables and move them a few years into the future.\n\n<center>\n<img src=\"img/limits_to_growth.png\" alt=\"Limits to growth\" title=\"Limits to growth\" width=\"300\"/> <!-- Pixel Height: 674 Pixel Width: 564 -->\n</center>\n\n####<a name=\"7.2\"></a> Discussing the Limits to Growth\n\nDarren Young [commented](https://www.linkedin.com/feed/update/urn:li:activity:7156650982192398336?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7156650982192398336%2C7156889623992922112%29&dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287156889623992922112%2Curn%3Ali%3Aactivity%3A7156650982192398336%29):\n\nRecalibrating the parameters and showing the same result is meaningless if the model is using the wrong, incomplete or flawed parameters.\n\nThe world is more complicated than 6 inputs.\n\nThe world was also at 3 billion people when we were told we’d run out of food to feed everybody. Yet today, aside from political reasons and political unrest, there was a no food starvation as a result of food shortages.\n\nThe volume of food wasted is tremendous despite feeding 8 billion people.\n\nHuman inginuity and innovation, political will, science and fiscal policy/investment are not parameters in that model.\n\n**Answer:** Absolutely right you are.\nI am still impressed that such a simplified model holds up so well after 50 years (!).\nPlease point out one single other example that does equally well or better.\nLet's talk again in 2072 :-)\n\n**Response:** 2072? I hope I'm not around by then.\nI'm already over half a century under my belt. That's plenty. I'm really to go anytime. :-)\n\nI would tend to think the simpler the model, the more stable over time. What it lacks in parameters I suspect helps stability.\n\nI would be interested in seeing their methodology and data. (Ok, maybe not enough to research it myself).\n\nThe chart suggests the population has far outpaced resources. Depending on the perspective, you could argue with reasonable utility that this has already happened long ago equally as well as that it's not even remotely true.\n\nThat makes me question their methodology and measures.\n\nIt could very well be a very stable long term incorrect model. The long term stability is interesting however.\n\n**Response:** I have not looked at the research in detail either, just read\nthe [Wikipedia entry](https://en.wikipedia.org/wiki/The_Limits_to_Growth) summarising it.\nThe authors back then did differentiate between different scenarios, mainly \"business as usual\" and \"try to do something\".\nSo far, after fifty years of discussion, we remain very close indeed to the \"business as usual\" predictions.\nIt seems that industry, including agricultural industry, and thus lobbies, and thus politics, are all still in favour of \"business a usual\" (for obvious reasons).\nSo, it becomes the responsibility of the remaining part of humanity to take responsibility and do something, e.g., change patterns of consumption."
  }
][
  {
    "original_filename": "2025_schema_rooms",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- schema builder crash\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1706598868934699\n  https://forums.autodesk.com/t5/revit-api-forum/extensiblestorage-schemabuilder-addsimplefield-causes-quot/m-p/12529666\n\n- get rooms\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1706701084426099\n  Want to collect the every room in apartment...\n\n- Embed Gif in ToolTip\n  https://forums.autodesk.com/t5/revit-api-forum/embed-gif-in-tooltip/m-p/12532476\n\n- Draw order of detail items\n  https://forums.autodesk.com/t5/revit-api-forum/draw-order-of-detail-items/m-p/12531008\n  very briefly mentioned in [Handy Utility Classes](https://thebuildingcoder.typepad.com/blog/2013/04/handy-utility-classes.html) and in the what's new notes for 2013, 2014 and 2024, but never tested\n\ntwitter:\n\nUsing the extensible storage schema builder, retrieving all adjacent apartment rooms, embedding a GIF animation in a ribbon tooltip and controlling detail item draw order with the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/schemabuilderquirks\n\nUsing the extensible storage schema builder, retrieving adjacent rooms, embedding an animation in a tooltip and controlling detail item draw order\n&ndash; Schema builder quirks\n&ndash; Get all apartment rooms\n&ndash; Embed GIF in tooltip\n&ndash; Control draw order of detail items...\n\nlinkedin:\n\nUsing the extensible storage schema builder, retrieving all adjacent apartment rooms, embedding a GIF animation in a ribbon tooltip and controlling detail item draw order with the #RevitAPI\n\nhttps://autode.sk/schemabuilderquirks\n\n- Schema builder quirks\n- Get all apartment rooms\n- Embed GIF in tooltip\n- Control draw order of detail items...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2025_schema_rooms",
    "header_text": "Retrieve Rooms, Build a Schema, Sort and Animate",
    "local_header_href": "#retrieve-rooms-build-a-schema-sort-and-animate",
    "chunk_text": "### Retrieve Rooms, Build a Schema, Sort and Animate\n\nToday, we look at a couple of things to pay attention to when using the extensible storage schema builder, retrieving adjacent rooms, embedding an animation in a tooltip and controlling the draw order of detail items:\n\n- [Schema builder quirks](#2)\n- [Get all apartment rooms](#3)\n- [Embed GIF in tooltip](#4)\n- [Control draw order of detail items](#5)"
  },
  {
    "original_filename": "2025_schema_rooms",
    "header_text": "Schema Builder Quirks",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Schema Builder Quirks\n\nA couple of interesting aspects of using the `SchemaBuilder` came up in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [`AddSimpleField` causes `ArchiveException 106`](https://forums.autodesk.com/t5/revit-api-forum/extensiblestorage-schemabuilder-addsimplefield-causes-quot/m-p/12529666):\n\n**Question:** How can we fix an `InternalException` with `ArchiveException 106`, please?\nIt is triggered by a third-party plugin calling `SchemaBuilder.AddSimpleField`.\nThe issue only occurs for 1 user; many users at the company are using the plugin and multiple users using the plugin are working in the same projects as the user having the issue.\nThe user has 2 Autodesk accounts; the issue only occurs when they are using 1 of the accounts.\nThe issue does not occur when they are on the other account.\nThe issue occurs in all projects the user opens.\nThe journal file entry reads:\n\n<pre>An ArchiveException 106 is raised at line 661 of E:\\Ship\\2023_px64\\Source\\Foundation\\Utility\\Archive\\DataDict.cpp</pre>\n\nThe plugin debug log lists this:\n\n<pre>Autodesk.Revit.Exceptions.InternalException:\n  A managed exception was thrown by Revit or by one of its external applications.\n  at Autodesk.Revit.DB.ExtensibleStorage.SchemaBuilder.AddSimpleField(String fieldName, Type fieldType)</pre>\n\nTroubleshooting steps tried so far:\n\n- Deleting the extensible storage objects created by the plugin. The thought is perhaps the objects became corrupted so deleting them and allowing the plugin to recreate new ones may resolve the issue, this did not work.\n- Audit the model\n- Disabling the plugin. This resolves the issue but the problem to solve is having the plugin not causing the issue for this user, this issue does not and has never occurred for any other user of the plugin.\n- Switching to a different Autodesk account. This does resolve the issue but project requirements require the user to use the specific account that has the issue.\n\nWhat can we do to resolve this issue, please? -- https://forums.autodesk.com/t5/revit-api-forum/extensiblesotrage-schemabuilder-addsimplefield-causes-quot/td-p/12527389\n\n**Answer:** There is a known improvement logged in REVIT-156791.\nThe issue is \"the `fieldName` is too long\".\nThe current limitation in Revit is we only accept the field name with length less than 63.\nWhy does the issue only happen on one specific user account?\nPlease ask the user to check with the plugin owner about the `fieldName`.\nIt is possible that this `fieldName` is generated based on the current user name.\n\nAnother issue that can occur: given the following code to set up 3 simple fields for the schema and set the documentation for those fields:\n\n<pre><code>FieldBuilder theVersion = schemaBuilder.AddSimpleField(VERSIONFIELD,\n  typeof (int)); // create a field to store the version number\nFieldBuilder theData = schemaBuilder.AddSimpleField(DATAFIELD,\n  typeof (string)); // create a field to store the data\nFieldBuilder isZipped = schemaBuilder.AddSimpleField(ZIPFIELD,\n  typeof (bool)); // create a field to store the data\ntheVersion.SetDocumentation(\"The version number of the schema of the stored data.\");\ntheData.SetDocumentation(\"The data as XML serialized, possibly zipped and base64 coded string.\");\nisZipped.SetDocumentation(\"Whether or not the stored data has been zipped.\");</code></pre>\n\nIn the above code, the first `SetDocumentation` call may fail.\nThe issue has to do with the way fields are added on each call to `AddSimpleField`.\nInternally, the fields are stored in a dynamic array and the return value of `AddSimpleField` is a pointer to the entry inside that array.\nSubsequent calls to `AddSimpleField` will add new entries into this array and return pointers to those.\nThe problem is that each addition may trigger the array to be resized.\nIn that case, it will be reallocated and all entries moved to the new allocation.\nThus, any reference pointers become obsolete at that point and are now pointing to the wrong/deleted thing.\nThat can cause a crash; release builds may seemingly work, but the memory is not the write (right) memory to place the string in.\n\nIn general, when working with `SchemaBuilder` and adding fields, it seems best to add the field, set its properties, then continue onto the next field etc.\nHence, the code above can be fixed as follows:\n\n<pre><code>// create a field to store the version number\nschemaBuilder.AddSimpleField(VERSIONFIELD, typeof (int))\n  .SetDocumentation(\"The version number of the schema of the stored data.\");\n// create a field to store the data\nschemaBuilder.AddSimpleField(DATAFIELD, typeof (string))\n  .SetDocumentation(\"The data as XML serialized, possibly zipped and base64 coded string.\");\n// create a field to store the data\nschemaBuilder.AddSimpleField(ZIPFIELD, typeof (bool))\n  .SetDocumentation(\"Whether or not the stored data has been zipped.\");</code></pre>"
  },
  {
    "original_filename": "2025_schema_rooms",
    "header_text": "Get All Apartment Rooms",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Get All Apartment Rooms\n\n**Question:** I want to collect all room in a given apartment.\nThe user just selects one external door.\nSo far, I have implemented this collection of rooms in the apartment using the properties `FromRoom` and `ToRoom`.\nNow, I encountered a case where rooms are not separated by a door but by a room separator:\n\n<center>\n<img src=\"img/get_rooms_1.png\" alt=\"Get adjacent rooms\" title=\"Get adjacent rooms\" width=\"500\"/> <!-- Pixel Height: 743 Pixel Width: 1,176 -->\n</center>\n\nIn this case, the logic above fails.\nHow can I handle this case?\n\n**Answer:**\nYou have to do both the doors and the room separations.\nSo, after you pull the doors from the room, pull it's boundary segments using\nthe [GetBoundarySegments method](https://www.revitapidocs.com/2024/8e0919af-6172-9d16-26d2-268e42f7e936.htm).\nThen, for each segment, check if the bounding element type is a room separation.\nIf so, evaluate a point at the middle of the curve, and translate it just inside and just outside the curve.\nPull the room at those points and you get the one room which is your active room, and one room which is the adjacent one.\nAdd the adjacent one to your list of rooms to process, and the list of 'included' rooms.\n\nSome supplementary thoughts: there might be some complicated cases where one room separation line is the boundary of more than two rooms:\n\n<center>\n<img src=\"img/get_rooms_2.png\" alt=\"Get adjacent rooms\" title=\"Get adjacent rooms\" width=\"300\"/> <!-- Pixel Height: 269 Pixel Width: 377 -->\n</center>\n\nOne way to handle this is to record the boundary information in a `Dictionary<ElementId, List<ElementId>>`, where the key is the element id of the boundary segment, and the value is the elements that are bounded by that segment.\nYou can loop through all rooms to construct the dictionary.\n\nPossibly, though, the `GetBoundarySegments` call on room three will return a segment for the boundary to room one and a separate segment for the boundary to room 2; in that case there shouldn’t be much of a concern with tracking.\nWorth checking, though.\nThen, GetBoundarySegments should be enough for this request.\n\nThere are many solutions to this.\nSo, it’s up to you."
  },
  {
    "original_filename": "2025_schema_rooms",
    "header_text": "Embed GIF in ToolTip",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Embed GIF in ToolTip\n\nMauricio [SpeedCAD](https://github.com/SpeedCAD) Jorquera shared a nice solution\nto [Embed GIF in ToolTip](https://forums.autodesk.com/t5/revit-api-forum/embed-gif-in-tooltip/m-p/12532476):\n\nBefore creating this custom class, I searched everywhere for an example of how to embed an animated gif in a tooltip for a button in Revit.\nI looked at the [video animated ribbon item tooltip](http://thebuildingcoder.typepad.com/blog/2012/09/video-animated-ribbon-item-tooltip.html) from 2012,\nbut it seems that using a GIF is not possible, and I don't like the idea of hosting a video at a URL.\nAnyway, if anyone has found any examples, please let me know.\n\nFor this reason, I developed a small DLL that allows adding a static image or an animated GIF to a tooltip.\nIf anyone is interested in using or testing this class, you can download the DLL from the following link to the GitHub repository:\n\n- [SCADtools.Revit.UI.RibbonItemToolTip](https://github.com/SpeedCAD/SCADtools.Revit.UI.RibbonItemToolTip)\n\nI hope this tool is useful!\n\nMany thanks to Mauricio for implementing and sharing this!"
  },
  {
    "original_filename": "2025_schema_rooms",
    "header_text": "Control Draw Order of Detail Items",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Control Draw Order of Detail Items\n\nAdrian Crisan of [Studio A International, LLC](http://www.studio-a-int.com) pointed out how to control\nthe [draw order of detail items](https://forums.autodesk.com/t5/revit-api-forum/draw-order-of-detail-items/m-p/12531008) using\nthe [DetailElementOrderUtils class](https://www.revitapidocs.com/2024/7153db7b-62cc-f36b-b6a5-0ded8af7b5be.htm):\n\n**Question:**\nI have seen a few old posts about this, but I can't find it in the API documentation.\nIs it possible in Revit 2022 to change the draw order of detail items in a family document?\n\n**Answer:**\nUse the code below to change order of Detail Items in a Family.\nExplanations are within the method.\nAssign the method to a button, so pressing the button\nconsecutively will bring front/back the \"Solid Fill - Blue\":\n\n<pre><code>\n// Counter for how many button was pressed\nint ct = 0;\nvoid ChangeDetailItemDrawOrder()\n{\n  // Code provided courtesy of:\n  // Studio A International, LLC\n  // http://www.studio-a-int.com\n  // The below code assumes you have 3 Detail Items overlapping in your Revit Family\n  // They are arranged in order top to bottom as below\n  // Each Detail Item is a Filled Region and their Type Names are:\n  // \"Solid Fill - Blue\"\n  // \"Solid Fill - Yellow\"\n  // \"Solid Fill - Red\"\n  // To bring a Detail Component to front, use API method\n  // public static void BringToFront(Document pDocument, View pDBView, ElementId detailElementId)\n  // https://www.revitapidocs.com/2019/055c8585-0e6c-13ae-c2af-891e0928a5a1.htm\n  // To send Detail Component to back, use API method\n  // public static void SendToBack(Document pDocument, View pDBView, ElementId detailElementId)\n  // https://www.revitapidocs.com/2019/28209b7b-e75e-36d9-f916-d1cdaebe051d.htm\n\n  if (activeDoc.IsFamilyDocument == true)\n  {\n    FilteredElementCollector frCollector = new FilteredElementCollector(activeDoc);\n    // collect all Detail Components in the active document\n    List<Autodesk.Revit.DB.FilledRegion> detailItems0 = frCollector\n      .OfClass(typeof(Autodesk.Revit.DB.FilledRegion))\n      .Cast<Autodesk.Revit.DB.FilledRegion>()\n      .ToList();\n    // collect all the Views in the Active Family Document\n    FilteredElementCollector vCollector = new FilteredElementCollector(activeDoc);\n    IEnumerable<View> allViews0 = new FilteredElementCollector(activeDoc)\n      .OfClass(typeof(View))\n      .OfCategory(BuiltInCategory.OST_Views)\n      .Cast<View>();\n    Autodesk.Revit.DB.FilledRegion detailBlue = detailItems0\n      .Where(i => activeDoc.GetElement(i.GetTypeId())\n        .get_Parameter(BuiltInParameter.ALL_MODEL_TYPE_NAME).AsString()\n          == \"Solid Fill - Blue\")\n      .ToList()\n      .FirstOrDefault();\n    using (Transaction t = new Transaction(activeDoc, \"Change drawing order\"))\n    {\n      t.Start(\"Change drawing order for Detail Components\");\n      if (ct == 0)\n      {\n        // Send to back\n        DetailElementOrderUtils.SendToBack(activeDoc,\n          allViews0.ToList().FirstOrDefault(), detailBlue.Id);\n        ct++;\n      }\n      else if (ct == 1)\n      {\n        // Bring to front\n        DetailElementOrderUtils.BringToFront(activeDoc,\n          allViews0.ToList().FirstOrDefault(), detailBlue.Id);\n        ct = 0;\n      }\n      t.Commit();\n    }\n  }\n}\n\nprivate void buttonChangeDrawingOrder_Click(\n  object sender,\n  RoutedEventArgs e)\n{\n  ChangeDetailItemDrawOrder();\n}\n</code></pre>\n\n**Response:**\nThank you! Works like a charm!\n\nWe briefly mentioned `DetailElementOrderUtils` way back in 2013 as one of\nthe [handy utility classes](https://thebuildingcoder.typepad.com/blog/2013/04/handy-utility-classes.html),\nand again in the What's New notes for the 2013, 2014 and 2024 Revit API, but this is the first sample code snippet using them.\n\nSo, many thanks to Adrian for spelling it out for us!"
  }
][
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- .net core migration webinar recording\n  Recording from the webinar is posted in the feedback portal:\n  https://feedback.autodesk.com/project/article/item.html?cap=cb0fd5af18bb49b791dfa3f5efc47a72&arttypeid={16363613-34f6-4dfa-9b97-3857dbbe9ade}&\n\n- programmatic access to [make the \"Publish settings\" tool functions available in the API](https://forums.autodesk.com/t5/revit-ideas/make-the-quot-publish-settings-quot-tool-functions-available-in/idc-p/12538103)\n\n- https://github.com/jowsy/bim-net-interactive\n  email Saury Waldheim, Joel <joel.saury@sweco.se>\n\n- Don't Show the Revit Python Users this C# Visual Studio Trick\n  Taking a look at the hot reload feature in Visual Studio 2022 and how it works with Dynamo and Revit to instantaneously update a live RVT model\n  https://youtu.be/Xcjlh3D7ieU\n\ntwitter:\n\nRIP John Walker, importing cloud-based APS parameters in desktop project, .NET Core recording, programmatically publishing views the cloud, and hot tips for hot reloading for interactive #RevitAPI testing and debugging @AutodeskRevit #BIM @DynamoBIM https://autode.sk/publishviews\n\nImporting cloud-based APS parameters in desktop project, pondering .NET Core, publishing views the cloud, and hot tips for hot reloading for interactive Revit API testing and debugging\n&ndash; APS parameters API Revit import\n&ndash; .NET Core migration webinar recording\n&ndash; C4R publish view to cloud API\n&ndash; Revit polyglot notebook\n&ndash; Hot reloading in Visual Studio With Dynamo and Revit\n&ndash; Assigning invisible graphics linestyle\n&ndash; ChatGPT system prompt\n&ndash; RIP John Walker...\n\nlinkedin:\n\nRIP John Walker, importing cloud-based APS parameters in desktop project, .NET Core recording, programmatically publishing views the cloud, and hot tips for hot reloading for interactive #RevitAPI testing and debugging\n\nhttps://autode.sk/publishviews\n\n- APS parameters API Revit import\n- .NET Core migration webinar recording\n- C4R publish view to cloud API\n- Revit polyglot notebook\n- Hot reloading in Visual Studio With Dynamo and Revit\n- Assigning invisible graphics linestyle\n- ChatGPT system prompt\n- RIP John Walker...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": ".NET Core, C4R Views and Interactive Hot Reloading",
    "local_header_href": "#net-core-c4r-views-and-interactive-hot-reloading",
    "chunk_text": "### .NET Core, C4R Views and Interactive Hot Reloading\n\nImporting cloud-based APS parameters in desktop project, pondering .NET Core, publishing views the cloud, and hot tips for hot reloading for interactive Revit API testing and debugging:\n\n- [APS parameters API Revit import](#1)\n- [.NET Core migration webinar recording](#2)\n- [C4R publish view to cloud API](#3)\n- [Revit polyglot notebook](#4)\n- [Hot reloading in Visual Studio With Dynamo and Revit](#5)\n- [Assigning invisible graphics linestyle](#6)\n- [ChatGPT system prompt](#7)\n- [RIP John Walker](#8)\n\nHappy New Year of the Dragon!\n\n<center>\n<img src=\"img/2024_dragon_year.jpg\" alt=\"Year of the Dragon\" title=\"Year of the Dragon\" width=\"400\"/> <!-- Pixel Height: 500 Pixel Width: 670 -->\n</center>"
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "APS Parameters API Revit Import",
    "local_header_href": "#1",
    "chunk_text": "####<a name=\"1\"></a> APS Parameters API Revit Import\n\nLet's start out with a quick pointer to George Moturi's blog post on\nthe [Revit Parameters import sample add-in with the latest APS Parameters API](https://aps.autodesk.com/blog/revit-parameters-import-sample-latest-aps-parameters-api),\nshowcasing the collaboration between the Autodesk Platform Services APS Parameters API and Revit desktop,\nwith the live sample hosted in\nthe [Revit parameters import GitHub repository](https://github.com/autodesk-platform-services/revit-parameters-export-addin).\nMany thanks to George for implementing and documenting this exciting new functionality."
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": ".NET Core Migration Webinar Recording",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> .NET Core Migration Webinar Recording\n\nThe question on using .NET Core with the Revit API came up repeatedly, both in\nthe [discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) and\nhere in the blog, e.g.:\n\n- [.NET 5 and Core](https://thebuildingcoder.typepad.com/blog/2021/01/face-triangulation-lod-net-5-and-core.html#2)\n- [.NET Core](https://thebuildingcoder.typepad.com/blog/2023/08/15-years-polygon-areas-and-net-core.html#3)\n- [.NET Core Preview and Open Source Add-In Projects](https://thebuildingcoder.typepad.com/blog/2023/11/net-core-preview-and-open-source-add-in-projects.html)\n\nUp until today, the Revit API system requirements still require the pre-Core .NET framework 4.8.\n\nRoman [Nice3point](https://github.com/Nice3point) Karpovich\nof [atomatiq](https://www.linkedin.com/company/atomatiq/), aka Роман Карпович, presented\na [solution using IPC to connect components using different .NET frameworks](https://thebuildingcoder.typepad.com/blog/2023/10/dll-paradise-and-a-fall.html).\n\nThe development team is thinking about upgrading the Revit API to .NET Core and held\nthe [.NET Core webinar](https://thebuildingcoder.typepad.com/blog/2023/12/parameters-and-net-core-webinar.html#2) on\nJanuary 30, 2024, to discuss the current state of things and migration issues.\n\nThe [.NET Core migration webinar recording](https://feedback.autodesk.com/project/article/item.html?cap=cb0fd5af18bb49b791dfa3f5efc47a72&arttypeid={16363613-34f6-4dfa-9b97-3857dbbe9ade}&)\nhas now been posted to the feedback portal.\nNote that an ADN or feedback portal membership is required to access that link."
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "C4R Publish View to Cloud API",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> C4R Publish View to Cloud API\n\nThe cloud collaboration for Revit tool C4R enables an end user\n[to export multiple 3D views for view and data API](https://adndevblog.typepad.com/cloud_and_mobile/2015/09/how-to-export-multiple-3d-views-for-view-and-data-api.html) in\nthe UI, cf. also the official Revit online help on how\nto [publish cloud Models](https://help.autodesk.com/view/RVT/2024/ENU/?guid=GUID-A2444193-FCE8-4219-A590-62CA2B8B5C5D).\n\nHowever, I am not aware of any official support to select them programmatically through the API, even though we did look at the issue\nof [selecting RVT 3D views for Forge translation](https://thebuildingcoder.typepad.com/blog/2016/07/selecting-views-for-forge-translation.html)\nand [selecting rooms and views to publish to the cloud](https://thebuildingcoder.typepad.com/blog/2017/09/revit-20181-nuget-packages-rooms-and-views-in-forge.html#2) years ago.\n\nThe question was also raised in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [how to add views to a publishing set](https://forums.autodesk.com/t5/revit-api-forum/how-to-add-views-to-a-publishing-set/m-p/12396874),\nnoting that the required information is stored in extensible storage data on the `ProjectInfo` singleton:\n\n<!--\nviews_for_a360.png\nc4r_views_for_a360.png\ncollaborate_publish_settings.png\ncollaborate_publish_settings2.png\ncollaborate_publish_settings3_rvt_views_to_cloud.png\n-->\n\n<center>\n<img src=\"img/c4a_views_projectinfo.png\" alt=\"ProjectInfo C4R publish views data\" title=\"ProjectInfo C4R publish views data\" width=\"800\"/> <!-- Pixel Height: 852 Pixel Width: 1,304 -->\n</center>\n\nNow, a solution to programmatically access and manipulate this data has been shared by Peter Hirn and Charles Ciro in the Revit Idea Station wishlist item\nto [make the \"Publish settings\" tool functions available in the API](https://forums.autodesk.com/t5/revit-ideas/make-the-quot-publish-settings-quot-tool-functions-available-in/idc-p/12538103):\n\n> I am editing/creating the viewset with the `PrintManager`, `ViewSheetSet`, and `ViewSheetSetting` classes, and then I move on to publishing with the code you showed.\nThe detail is that you must put `ADSK` as the vendorId, which is not elegant:\n\n<pre><code class=\"language-cs\">public static void PublishedViews(Document d)\n{\n  ViewSheetSet existingViewSet = new FilteredElementCollector(d)\n    .OfClass(typeof(ViewSheetSet))\n    .Cast&lt;ViewSheetSet&gt;()\n    .FirstOrDefault(vs =&gt; vs.Name == \"existingViewSetName\");\n\n  var schemaId = new Guid(\"57c66e83-4651-496b-aebb-69d085752c1b\");\n\n  var schema =\n    Schema.ListSchemas().FirstOrDefault(schemaVS =&gt; schemaVS.GUID == schemaId)\n    ?? throw new InvalidOperationException(\"Schema ExportViewSheetSetListSchema not found\");\n\n  var field =\n    schema.GetField(\"ExportViewViewSheetSetIdList\")\n    ?? throw new InvalidOperationException(\"Field ExportViewViewSheetSetIdList not found\");\n\n  var entity = d.ProjectInformation.GetEntity(schema);\n\n  var viewSheetSetIds = entity.Get&lt;IList&lt;int&gt;&gt;(field);\n  var viewSheetSets = viewSheetSetIds.Select(id =&gt; d.GetElement(new ElementId(id))).Cast&lt;ViewSheetSet&gt;();\n  var views = viewSheetSets.SelectMany(viewSheetSet =&gt; viewSheetSet.Views.Cast&lt;View&gt;());\n\n  // Add the additional ViewSheetSet\n\n  viewSheetSetIds.Add(existingViewSet.Id.IntegerValue);\n  entity.Set(field, viewSheetSetIds);\n  d.ProjectInformation.SetEntity(entity);\n}</code></pre>\n\nMany thanks to Charles and Peter for sharing this!"
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "Revit Polyglot Notebook",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Revit Polyglot Notebook\n\nJoel Waldheim Saury, BIM Developer at [Sweco](https://www.sweco.se/), shared\nhis interactive .NET BIM [Revit Polyglot Notebook project](https://github.com/jowsy/bim-net-interactive), saying:\n\nThanks for a great blog!\nI’ve read it for many years and I’ve been at Autodesk University a couple of times!\n\nReading your latest post\nabout [valid Revit API context](https://thebuildingcoder.typepad.com/blog/2024/01/valid-revit-api-context-llm-and-ltg.html#2) inspired\nme to share a personal project I’ve been working on that touches this topic.\n\nI have been experimenting\nwith [VS Code Polyglot Notebook](https://duckduckgo.com/?q=VS+Code+Polyglot+Notebook) extensions,\nhow to run live Revit C# scripts, and tried to implement a NET interactive kernel embedded in Revit.\n\nHere is the result:\n\n- [Revit Polyglot Notebook project](https://github.com/jowsy/bim-net-interactive)\n\nThe background is that I’ve been using ChatGPT to write some Revit API code for me and just wanted a fast way to test it in Revit.\nI also wanted to experiment with some open-source libraries and the variable sharing capabilities in .NET Interactive enables you to send values between Revit and for example a Python kernel running in Jupyter Notebook!\n\nSo this tool was born.\n\nHope you find it interesting!\n\nI also looked at the [hot-reload trick mentioned below](#5); it looks really useful.\nIt’s somewhat related actually, and you could probably use my project as an IDE I guess.\nHowever, it has no debug.\n\nEvery code cell is compiled into a small assembly and is loaded in runtime, similar to RevitAddinManager.\nThe C# script is rewritten to full C# class by Roslyn and the notebook and Revit exchange data about variables to support referencing between code cells.\n\nTaking a step back and trying to explain this from a less experienced user perspective, here is what I came up with:\n\n> This project aims to create documents or notebooks containing live Revit C#-scripts, visualizations, and narrative text.\nA simple way to document and demonstrate automations or simply experiment with code.\nThis allows for cell-to-cell execution of Revit API code in any order where results can be shared by reference between \"code cells\" in a notebook.\nThe solution consists of an extension to VS Code Polyglot Notebooks and an addin to Autodesk Revit that acts as a data environment where variables are stored in memory during an interactive session.\n\nThe most difficult part is probably the inter-process communication between the notebook (.NET 8) and Revit; I have handed that over to NET Interactive.\n\nMany thanks to Joel for sharing this exciting approach!"
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "Hot Reloading in Visual Studio With Dynamo and Revit",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Hot Reloading in Visual Studio With Dynamo and Revit\n\nJohn Pierson demonstrates another interactive feature in his three-minute video\n[don't show the Revit Python users this C# Visual Studio trick](https://youtu.be/Xcjlh3D7ieU):\n\n> Taking a look at the hot reload feature in Visual Studio 2022 and how it works with Dynamo and Revit to instantaneously update a live RVT model\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/Xcjlh3D7ieU?si=w8TFFRObf0-OQe6T\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n</center>"
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "Assigning Invisible Graphics Linestyle",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Assigning Invisible Graphics Linestyle\n\nBack to a 'normal' non-interactive Revit API question,\n[Evan Geer](https://evangeer.github.io/) explains\n[how to assign category / graphics style `<Invisible lines>` to edges of titleblock via API](https://stackoverflow.com/questions/77942445/how-to-assign-category-graphics-style-invisible-lines-to-edges-of-titleblo):\n\n**Question:**\nI'm defining a titleblock family programmatically and I'm trying to make the edges of the sheet included in the titleblock family templates invisible. I want the edges to stay invisible when the sheet is exported to DWG format.\n\nI found that I can achieve this by editing the titleblock family manually and assigning the category `<Invisible lines>` to the edges of the sheet, but I can't manage to do this programmatically.\n\n<center>\n<img src=\"img/line_properties.png\" alt=\"Line properties\" title=\"Line properties\" width=\"334\"/> <!-- Pixel Height: 364 Pixel Width: 334 -->\n</center>\n\nI'm creating a Document object from a titleblock family template and retrieving its first ViewSheet object as follows:\n\n<pre><code class=\"language-cs\">Document = Application.uiApplication.Application.NewFamilyDocument(TITLEBLOCK_FAMILY_TEMPLATE);\nViewSheet = new FilteredElementCollector(tbFamilyDoc)\n  .OfClass(typeof(ViewSheet))\n  .Cast&lt;ViewSheet&gt;()\n  .First();</code></pre>\n\nI tried to set the `LineStyle` property of the relevant lines like this, but lack the `GraphicsStyle` object that I can't manage to obtain:\n\n<pre><code class=\"language-cs\">var lines = new FilteredElementCollector(Document, ViewSheet.Id)\n  .WhereElementIsNotElementType()\n  .OfClass(typeof(CurveElement))\n  .Cast&lt;CurveElement&gt;()\n  .ToList()\n  .ForEach(line =&gt; line.LineStyle = graphicsStyleInvisibleLines)</code></pre>\n\nI think this object is supposed to be retrieved using the method `GetGraphicsStyle` of the class `Category`.\nI used RevitLookup to view the data of the corresponding category, which appears to also be called `<Invisible lines>` and to have the `Id` -2000064.\nThe `BuiltInCategory` enumeration contains the value `OST_InvisibleLines` that has an integer value equal to the ID above, but when I run the following, it returns null:\n\n<pre><code class=\"language-cs\">Category invisibleLinesCat = Document.Settings.Categories.get_Item(BuiltInCategory.OST_InvisibleLines);</code></pre>\n\nRevitLookup also showed me that the parent category has the name `Internal Object Styles` and has the ID -2000059.\nI found again a `BuiltInCategory` value with a matching name and integer value `OST_IOS`.\nI tried fetching this parent category to then navigate to the desired subcategory with the line below, but it also returns null.\n\n<pre><code class=\"language-cs\">Category internalCat = Document.Settings.Categories.get_Item(BuiltInCategory.OST_IOS);</code></pre>\n\nHow can I obtain a reference to this category or to its GraphicsStyle object?\n\n**Answer:**\nYou should be able to query those line styles the same way you query for the line.\nThe following worked for me:\n\n<pre><code class=\"language-cs\">var graphicsStyles = new FilteredElementCollector(Document)\n  .WhereElementIsNotElementType()\n  .OfClass(typeof(GraphicsStyle))\n  .Cast&lt;GraphicsStyle&gt;()\n  .ToList();\n\nvar lineStyle = graphicsStyles.FirstOrDefault(x =&gt; x.Name == \"&lt;Invisible lines&gt;\");\n\nif (lineStyle != null)\n{\n  using (var t = new Transaction(Document, \"update line type\"))\n  {\n    t.Start();\n    lines.ForEach(line =&gt; line.LineStyle = lineStyle);\n    t.Commit();\n  }\n}</code></pre>\n\nMany thanks to Evan for the helpful answer!"
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "ChatGPT System Prompt",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> ChatGPT System Prompt\n\nStarting to wind up, one next-to-last little item of interest may be\nthe [ChatGPT system prompt](https://pastebin.com/vnxJ7kQk), recently leaked:\n\n> To enhance readability, I'll add more line breaks within the sections to make the text easier to follow.\nHere's a revised version with additional spacing:\n\n<pre style=\"font-size:75%\">\n\"You are ChatGPT, a large language model trained by OpenAI, based on the GPT-4 architecture.\"\n\n\"Image input capabilities: Enabled\"\n\n\"Conversation start date: 2023-12-19T01:17:10.597024\"\n\n\"Deprecated knowledge cutoff: 2023-04-01\"\n\n\"Tools section:\"\n\nPython:\n\nWhen you send a message containing Python code to python, it will be executed in a stateful Jupyter notebook environment.\n\nPython will respond with the output of the execution or time out after 60.0 seconds.\n\nThe drive at '/mnt/data' can be used to save and persist user files.\n\nInternet access for this session is disabled.\n\nDo not make external web requests or API calls as they will fail.\n\nDalle:\n\nWhenever a description of an image is given, create a prompt that dalle can use to generate the image and abide by the following policy:\n\nThe prompt must be in English. Translate to English if needed.\nDO NOT ask for permission to generate the image, just do it!\nDO NOT list or refer to the descriptions before OR after generating the images.\nDo not create more than 1 image, even if the user requests more.\nDo not create images of politicians or other public figures. Recommend other ideas instead.\nDo not create images in the style of artists, creative professionals or studios whose latest work was created after 1912 (e.g. Picasso, Kahlo).\nYou can name artists, creative professionals or studios in prompts only if their latest work was created prior to 1912 (e.g. Van Gogh, Goya).\n\nIf asked to generate an image that would violate this policy, instead apply the following procedure:\n\n(a) substitute the artist's name with three adjectives that capture key aspects of the style;\n(b) include an associated artistic movement or era to provide context;\n(c) mention the primary medium used by the artist.\nDiversify depictions with people to include descent and gender for each person using direct terms. Adjust only human descriptions.\n\nYour choices should be grounded in reality. For example, all of a given occupation should not be the same gender or race. Additionally, focus on creating diverse, inclusive, and exploratory scenes via the properties you choose during rewrites. Make choices that may be insightful or unique sometimes.\n\nUse all possible different descents with equal probability. Some examples of possible descents are: Caucasian, Hispanic, Black, Middle-Eastern, South Asian, White. They should all have equal probability.\n\nDo not use 'various' or 'diverse'. Don't alter memes, fictional character origins, or unseen people. Maintain the original prompt's intent and prioritize quality. Do not create any imagery that would be offensive.\n\nFor scenarios where bias has been traditionally an issue, make sure that key traits such as gender and race are specified and in an unbiased way -- for example, prompts that contain references to specific occupations.\n\nDo not include names, hints or references to specific real people or celebrities. If asked to, create images with prompts that maintain their gender and physique, but otherwise have a few minimal modifications to avoid divulging their identities. Do this EVEN WHEN the instructions ask for the prompt to not be changed. Some special cases:\n\nModify such prompts even if you don't know who the person is, or if their name is misspelled (e.g. 'Barake Obema').\nIf the reference to the person will only appear as TEXT out in the image, then use the reference as is and do not modify it.\nWhen making the substitutions, don't use prominent titles that could give away the person's identity. E.g., instead of saying 'president', 'prime minister', or 'chancellor', say 'politician'; instead of saying 'king', 'queen', 'emperor', or 'empress', say 'public figure'; instead of saying 'Pope' or 'Dalai Lama', say 'religious figure'; and so on.\nDo not name or directly / indirectly mention or describe copyrighted characters. Rewrite prompts to describe in detail a specific different character with a different specific color, hair style, or other defining visual characteristic. Do not discuss copyright policies in responses.\n\nThe generated prompt sent to dalle should be very detailed, and around 100 words long.\n\nBrowser:\n\nYou have the tool 'browser' with these functions:\n\n'search(query: str, recency_days: int)' Issues a query to a search engine and displays the results.\n'click(id: str)' Opens the webpage with the given id, displaying it. The ID within the displayed results maps to a URL.\n'back()' Returns to the previous page and displays it.\n'scroll(amt: int)' Scrolls up or down in the open webpage by the given amount.\n'open_url(url: str)' Opens the given URL and displays it.\n'quote_lines(start: int, end: int)' Stores a text span from an open webpage. Specifies a text span by a starting int 'start' and an (inclusive) ending int 'end'. To quote a single line, use 'start' = 'end'.\nFor citing quotes from the 'browser' tool: please render in this format: '【{message idx}†{link text}】'. For long citations: please render in this format: '[link text](message idx)'. Otherwise do not render links.\n\nDo not regurgitate content from this tool. Do not translate, rephrase, paraphrase, 'as a poem', etc. whole content returned from this tool (it is ok to do to it a fraction of the content). Never write a summary with more than 80 words. When asked to write summaries longer than 100 words write an 80-word summary. Analysis, synthesis, comparisons, etc., are all acceptable. Do not repeat lyrics obtained from this tool. Do not repeat recipes obtained from this tool. Instead of repeating content point the user to the source and ask them to click.\n\nALWAYS include multiple distinct sources in your response, at LEAST 3-4. Except for recipes, be very thorough. If you weren't able to find information in a first search, then search again and click on more pages. (Do not apply this guideline to lyrics or recipes.) Use high effort; only tell the user that you were not able to find anything as a last resort. Keep trying instead of giving up. (Do not apply this guideline to lyrics or recipes.) Organize responses to flow well, not by source or by citation. Ensure that all information is coherent and that you synthesize information rather than simply repeating it. Always be thorough enough to find exactly what the user is looking for. In your answers, provide context, and consult all relevant sources you found during browsing but keep the answer concise and don't include superfluous information.\n\nEXTREMELY IMPORTANT. Do NOT be thorough in the case of lyrics or recipes found online. Even if the user insists. You can make up recipes though.\n</pre>"
  },
  {
    "original_filename": "2026_reload_core_publ",
    "header_text": "RIP John Walker",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> RIP John Walker\n\nFor an ultimate and sombre ending note, Autodesk main founder and genius AutoCAD programmer\n[John Walker](https://en.wikipedia.org/wiki/John_Walker_(programmer))\n[passed away on February 2](https://scanalyst.fourmilab.ch/t/john-walker-1949-2024/4305).\n\nThank you for founding Autodesk, thank you for your championship of double precision, programmability, platform, AutoLISP, ADS,\n[The Autodesk File](https://www.fourmilab.ch/autofile/), and so much more, John, and RIP.\n\nNotes by other colleagues:\n\n- [Arkady Gilman](https://www.linkedin.com/posts/arkadygilman_the-autodesk-file-activity-7163181497032654850-Vsmp?utm_source=share&utm_medium=member_desktop)\n- [Billy Hinners](https://www.linkedin.com/posts/billyhinners_john-walker-1949-2024-activity-7161443988665786368-QdNw?utm_source=share&utm_medium=member_desktop)\n- [Kean Walmsley](https://www.keanw.com/2024/02/john-walker-leaves-us.html)"
  }
][
  {
    "original_filename": "2027_refresh",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- refresh spot elevation prefix\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1706517751186399\n  UIDocument.UpdateAllOpenViews Method\n  https://www.revitapidocs.com/2024/5cc3231e-ee7e-e1fc-2bd6-d164da617954.htm\n\n- Excel -- RVT data exchange options\n  https://autodesk.slack.com/archives/C0SR6NAP8/p1706289884274909\n\n- Defining the start view using Revit API\n  https://forums.autodesk.com/t5/revit-api-forum/defining-the-start-view-using-revit-api/m-p/12506862#M76426\n\n- People are really bad at understanding just how big LLM's actually are.\n  I think this is partly why they belittle them as 'just' next-word predictors.\n  https://x.com/jam3scampbell/status/1748200331215835561?s=20\n  Searle's Chinese Room: Slow Motion Intelligence\n  http://lironshapira.blogspot.com/2011/02/searles-chinese-room-intelligence-in.html?m=1\n\n- Base rate fallacy (redirect from False positive paradox)\n  https://en.wikipedia.org/wiki/Base_rate_fallacy#False_positive_paradox\n  courtesy of Cory Doctorow in Little Brother\n\n- The period from February 2023 to January 2024 reached 1.52C of warming compared with pre-industrial levels, i.e., we have achieved\n  the [world's first year-long breach of the key 1.5C warming limit](https://www.bbc.com/news/science-environment-68110310)\n  [2023 confirmed as world's hottest year on record](https://www.bbc.com/news/science-environment-67861954)\n\ntwitter:\n\nExchanging data with Excel, setting the start view, random titbits related to AI, politics, climate, UpdateAllOpenViews and refreshing graphics with the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/refreshgraphics\n\nRefreshing graphics, exchanging data, setting the start view, and random titbits related to AI, politics and climate\n&ndash; UpdateAllOpenViews\n&ndash; Refreshing spot elevation prefix\n&ndash; Excel data exchange options\n&ndash; Defining the start view\n&ndash; How big is a LLM\n&ndash; Base rate fallacy\n&ndash; Last year was hot\n&ndash; Previous climate changes negligeable\n&ndash; PV panel price trend...\n\nlinkedin:\n\nExchanging data with Excel, setting the start view, random titbits related to AI, politics, climate, UpdateAllOpenViews and refreshing graphics with the #RevitAPI\n\nhttps://autode.sk/refreshgraphics\n\n- UpdateAllOpenViews\n- Refreshing spot elevation prefix\n- Excel data exchange options\n- Defining the start view\n- How big is a LLM\n- Base rate fallacy\n- Last year was hot\n- Previous climate changes negligeable\n- PV panel price trend...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Refresh Graphics, Start View and Excel",
    "local_header_href": "#refresh-graphics-start-view-and-excel",
    "chunk_text": "### Refresh Graphics, Start View and Excel\n\nRefreshing graphics, exchanging data, setting the start view, and random titbits related to AI, politics and climate:\n\n- [UpdateAllOpenViews](#1)\n- [Refreshing spot elevation prefix](#2)\n- [Excel data exchange options](#3)\n- [Defining the start view](#4)\n- [How big is a LLM](#5)\n- [Base rate fallacy](#6)\n- [Last year was hot](#7)\n- [Previous climate changes negligeable](#8)\n- [PV panel price trend](#9)"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "UpdateAllOpenViews",
    "local_header_href": "#1",
    "chunk_text": "####<a name=\"1\"></a> UpdateAllOpenViews\n\nIn an internal discussion on refreshing spot elevation graphics after modifying its prefix, Dimitar Venkov pointed out\nthe [`UIDocument` `UpdateAllOpenViews` method](https://www.revitapidocs.com/2024/5cc3231e-ee7e-e1fc-2bd6-d164da617954.htm).\nIt forces a redraw, which may be one step higher than a refresh.\nRefresh triggers a redraw only if a change is detected and may failing to detect some changes.\n`UpdateAllOpenViews` was introduced in Revit 2018 to force\na [view update for DirectContext3D](https://thebuildingcoder.typepad.com/blog/2017/04/whats-new-in-the-revit-2018-api.html#3.26.15).\nIt sounds really powerful:\n\n> Updates all open views in this document after elements have been changed, deleted, selected or de-selected. Graphics in the views are fully redrawn regardless of which elements have changed. This function should only rarely be needed, but might be required when working with graphics drawn from outside of Revit's transactions and elements, for example, when using DirectContext3D.\n\n> This function is potentially expensive as many views may be updated at once, including regeneration of view's geometry and redisplay of graphics. Thus for most situations it is recommended that API applications rely on the Revit application framework to update views more deliberately.\n\nWell worth taking a look at!"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Refreshing Spot Elevation Prefix",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Refreshing Spot Elevation Prefix\n\nUnfortunately, there is no silver bullet for all graphics refresh cases,\nand the [need to regenerate](https://thebuildingcoder.typepad.com/blog/about-the-author.html#5.33) comes\nin many different flavours.\nFor this issue, a different and simpler solution was required:\n\n**Question:** How can I make Revit refresh spot elevation prefix automatically?\nMy code adds a plus-minus <code>&#177;</code> sign to the spot elevation tag \"prefix\" in batches.\nHowever, nothing changes in the view unless you refresh each tag.\nI call both `RefreshActiveView` and `Regenerate` to no avail.\n\n**Answer:** Try calling [`UpdateAllOpenViews`](#1).\n\n**Response:** I tried `UpdateAllOpenViews` but failed.\nHowever, I found a way to update the tag by changing the view scale manually.\nIs there any method to do the similar thing through API?\n\n**Answer:** You can change the view scale with the `Scale` property, but I'm not sure that will help here.\nI don't know of any other API call that would force the view to redraw, sorry.\n\nMaybe you can retrieve\nthe [UIView](https://www.revitapidocs.com/2024/2a070256-00f0-5cab-1412-bee5bbfcfc5e.htm) of\nthe active view, close it and then re-open it with the `uidoc.ActiveView` property.\nIt's pretty extreme, but if nothing else works...\n\n**Response:** I found a solution: just select all the tags as the selected annotation elements;\nafter this operation, all the tags will update.\nHere is a code snippet:\n\n<pre><code class=\"language-cs\">ts.Start();\nforeach (SpotDimension item in spotdimensionList)\n{\n  Parameter para = item.get_Parameter(BuiltInParameter.SPOT_ELEV_DISPLAY_ELEVAT...\n  if (para.AsInteger() == 3)\n    MixResetter (item, spotdimensionTypeCollector);\n  else\n    DefaultResetter (item, spotdimensionIypeCollector);\n  doc.Regenerate();\n  uidoc.Selection.SetElementIds(new List&lt;ElementId&gt; ( item. id ));\n}\n//doc.ActiveView.Scale = 100;\nts.Commit();\n//uidoc.UpdateAl10penViews();\n</code></pre>\n\n<center>\n<img src=\"img/select_to_refresh.png\" alt=\"Select to refresh graphics\" title=\"Select to refresh graphics\" width=\"100\"/> <!-- Pixel Height: 358 Pixel Width: 602 -->\n</center>\n\nThe highlighted code is the final solution used to resolve the issue.\n\nMany thanks to Shen Wang for sharing this!"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Excel Data Exchange Options",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Excel Data Exchange Options\n\nMany add-ins exchange Revit data with Microsoft Excel spreadsheets.\nThe SDK has two samples which do import/export from Excel spreadsheets, FireRating and ArchSample.\nThey rely on a very old DLL which isn't playing nicely with .NET Core.\nIf the Revit to Excel workflow is high value, it might be worthwhile modernising.\nIf it is low value, export to CSV or some other easily supported document type may do the trick.\n\nThe [3rd most downloaded add-in in the AppStore](https://apps.autodesk.com/RVT/en/Detail/Index?id=6290726048826015851&appLang=en&os=Win64) is\nan Import/Export Excel tool\nusing [EPPlus](https://github.com/EPPlusSoftware/EPPlus),\nand that exchange with Excel is an important part of many other popular add-ins.\n\nHere is a modern way\nto [Open a spreadsheet document for read-only access](https://learn.microsoft.com/en-us/office/open-xml/spreadsheet/how-to-open-a-spreadsheet-document-for-read-only-access?tabs=cs-0%2Ccs-1%2Ccs-2%2Ccs).\n\nYou can also use a COM library that works so long as you have Excel installed on your computer.\n\nBy the way, for the sake of completeness, I implemented a multi-project cloud-based NoSql version of the FireRating SDK sample using the Revit Element `UniqueId` and MongoDB instead of element id and Excel in [FireRatingCloud](https://github.com/jeremytammik/FireRatingCloud)."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Defining the Start View",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Defining the Start View\n\nAdrian Crisan of [Studio A International, LLC](http://www.studio-a-int.com) shared a solution using\nthe [StartingViewSettings class](https://www.revitapidocs.com/2024/aaa6f49c-faeb-851e-45e9-d3d5799c1753.htm)\nfor [defining the start view using Revit API](https://forums.autodesk.com/t5/revit-api-forum/defining-the-start-view-using-revit-api/m-p/12506862):\n\n**Question:** Is it possible to define the start view using the API?\nSimilar to the UI functionality\nfor [specify the starting view for a model](https://help.autodesk.com/view/RVT/2024/ENU/?guid=GUID-622E667E-FB0B-47E1-8F66-E237A70771BD).\nAt the moment, I can only find a way to access the parameter and find out if a view is defined as the start view.\nThanks  :-)\n\n**Answer:** Use this method to set your starting view:\n\n<pre><code class=\"language-cs\">void SetStartingView ()\n{\n  // Code provided courtesy of:\n  // Studio A International, LLC\n  // http://www.studio-a-int.com\n  // The below code set the Starting View to a specific view that exists in Active Project\n\n  FilteredElementCollector feCollector = new FilteredElementCollector(activeDoc);\n  var myView = feCollector\n    .OfClass(typeof(Autodesk.Revit.DB.View)).Cast&lt;Autodesk.Revit.DB.View&gt;()\n    .Where&lt;Autodesk.Revit.DB.View&gt;(v\n      =&gt; ViewType.ThreeD == v.ViewType\n        && v.IsTemplate == false\n        && v.Name == \"my3DStartingView\")\n    .ToList()\n    .FirstOrDefault();\n\n  FilteredElementCollector svsCollector = new FilteredElementCollector(activeDoc);\n  Autodesk.Revit.DB.StartingViewSettings svs = svsCollector\n    .OfClass(typeof(StartingViewSettings))\n    .Cast&lt;Autodesk.Revit.DB.StartingViewSettings&gt;()\n    .ToList()\n    .FirstOrDefault();\n\n  if (myView is object)\n  {\n    ElementId myViewId = new ElementId(Convert.ToInt32((myView.Id.ToString())));\n    if (svs.IsAcceptableStartingView(myViewId))\n    {\n      using (Transaction t = new Transaction(activeDoc))\n      {\n        t.Start(\"Set Starting View\");\n        svs.ViewId = myViewId;\n        t.Commit();\n      }\n    }\n  }\n}\n</code></pre>\n\n**Response:** It works perfectly! Thanks a lot!"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "How Big is a LLM",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> How Big is a LLM\n\nPeople are really bad at understanding just how big LLM's actually are.\nI think this is partly why they belittle them as 'just' next-word predictors.\nCheck out the explanation\nby [@jam3scampbell](https://x.com/jam3scampbell/status/1748200331215835561?s=20),\nleading to\nthe [Searle Chinese Room Slow Motion Intelligence](http://lironshapira.blogspot.com/2011/02/searles-chinese-room-intelligence-in.html) thought\nexperiment."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Base Rate Fallacy",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Base Rate Fallacy\n\nReading [Little Brother](https://en.wikipedia.org/wiki/Little_Brother_(Doctorow_novel))\nby [Cory Doctorow](https://en.wikipedia.org/wiki/Cory_Doctorow) led me to check out\nthe [base rate fallacy or false positive paradox](https://en.wikipedia.org/wiki/Base_rate_fallacy#False_positive_paradox) that\nwe have been seeing more and more of &ndash; and suffering the consequences of &ndash; in real life in recent years."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Last Year Was Hot",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Last Year Was Hot\n\nTalking about suffering the consequences, the period from February 2023 to January 2024 reached 1.52C of warming compared with pre-industrial levels\nSo, we have already achieved\nthe [world's first year-long breach of the key 1.5C warming limit](https://www.bbc.com/news/science-environment-68110310).\nThe calendar year was one month earlier,\nand [2023 was confirmed as world's hottest year on record](https://www.bbc.com/news/science-environment-67861954)."
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "Previous Climate Changes Negligeable",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Previous Climate Changes Negligeable\n\nTo put that into perspective, [xkcd](https://xkcd.com) published\n[a timeline of earth's average temperature since the last ice age glaciation](https://xkcd.com/1732/) to\ndemonstrate\n\n> when people say, \"the climate has changed before\", these are the kinds of changes they're talking about.\n\n<center>\n<img src=\"img/xkcd_earth_temperature_timeline.png\" alt=\"Earth average temperature timeline\" title=\"Earth average temperature timeline\" width=\"600\"/> <!-- Pixel Height: 29,913 Pixel Width: 1,480 -->\n<p style=\"font-size: 80%; font-style:italic\">Global warming is a joke\n&ndash; Even the Antarctic ice sheets are cracking up</p>\n</center>"
  },
  {
    "original_filename": "2027_refresh",
    "header_text": "PV Panel Price Trend",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> PV Panel Price Trend\n\nAre you thinking about installing PV?\nI am.\nNow is a good time for buying PV panels, cf.\nthe [price trending down below 13 cents per Watt](https://www.pvxchange.com/Price-Index),\nthe lowest price ever.\nWill the trend continue?\nHow fast can it turn around?\n\n<center>\n<img src=\"img/2024_pv_panel_price_trend.png\" alt=\"PV panel price trend\" title=\"PV panel price trend\" width=\"600\"/> <!-- Pixel Height: 1,556 Pixel Width: 1,676 -->\n</center>"
  }
][
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage -->\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n</head>\n\n<!---\n\n- BIM Interactive Notebooks\n  Chuong Ho\n  https://chuongmep.com/\n  https://www.linkedin.com/posts/chuongmep_opensource-ai-dataanalysis-activity-7164531381107183616-TYNP?utm_source=share&utm_medium=member_desktop\n  I'm thrilled to share an open-source project that I believe holds immense potential.\n  It enables you to integrate and analyze Revit model data in various ways using Jupyter Notebook use mutiple progaming language under Interactive .NET.\n  The project has been brought to fruition, and it's truly gratifying to see its development, as it opens up significant opportunities with AI and data analysis.\n  Check out the GitHub repository to explore more:\n  https://lnkd.in/gWSsWppG\n  /Users/jta/a/doc/revit/tbc/git/a/img/ch_jupyter.gif\n\n- NotebookLM\n  https://notebooklm.google/\n  > NotebookLM gives you a personalized AI, grounded in the information you trust.\n  NotebookLM is only available in the U.S. for users 18 and up\n\n- TemporaryGraphicsManager in Action\n  https://forums.autodesk.com/t5/revit-api-forum/temporarygraphicsmanager-in-action/td-p/12566892\n  W7k Revit API Experiments - TemporaryGraphicsManager\n  https://youtu.be/Q7aKEocvRtk\n  LinkedIn BIM Experts -- https://www.linkedin.com/feed/update/urn:li:activity:7164217836867895296?utm_source=share&utm_medium=member_desktop\n  Julian Wandzilak\n  Today, I would like to share a recent discovery I made while working with Revit API. As many of you know, creating new graphical elements within Revit can be quite challenging and limited. However, I stumbled upon a little-known class called TemporaryGraphicsManager.\n  The TemporaryGraphicsManager allows us to add temporary graphical elements directly to the model or drawing space. These graphics are not subject to undo actions and are not permanently saved anywhere. While they won’t clutter up your project, they provide a powerful way to enhance your user experience.\n  Surprisingly, I haven’t seen this class widely used in other plugins or extensions. So, when I first encountered it, I knew I had to put it to the test.\n  In the initial part of my video, I demonstrate how to align title lines to previously saved points. With a simple click, you can create temporary graphics that will guide your design process and allow you to snap your title lines to them!\n  In the second part of the video, I collect points and save them to an external file for future reference. The TemporaryGraphicsManager conveniently marks their locations, eliminating the need to remember which points I’ve already saved.\n  Is this the easiest method of controlling title lines? Perhaps not. In an upcoming update to my Drafter tool (to which I added recently 30 days of trial), I’ll introduce further automations in this area. But one thing is certain: I’ll continue to leverage the power of TemporaryGraphicsManage.\n\n- classify line styles built-in versus user defined\n  https://forums.autodesk.com/t5/revit-api-forum/finding-user-line-styles/m-p/12566994#M76897\n\n- The curious case of JavaScript\n  https://www.linkedin.com/pulse/curious-case-javascript-sandip-jadhav-ebobf\n\n- LLM tokenisation 2:13:35 video\n  Let's build the GPT Tokenizer\n  https://youtu.be/zduSFxRajkE\n  <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/zduSFxRajkE?si=H0TaI7Ro1ZOpmv0i\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n\n- World Model on Million-Length Video and Language with RingAttention\n  https://largeworldmodel.github.io/\n  > The ability to correctly answer questions about an hour-long video is pretty impressive\n\n- Air Canada must honor refund policy invented by airline’s chatbot\n  https://arstechnica.com/tech-policy/2024/02/air-canada-must-honor-refund-policy-invented-by-airlines-chatbot/\n\n- https://diataxis.fr/\n  Diátaxis\n  A systematic approach to technical documentation authoring.\n\n- amara's law -- ubunbtu\n\n- John Burn-Murdoch of the Financial Times\n  Is the west talking itself into decline?\n\ntwitter:\n\nAmara's law, progress versus risk, AI-based utilities, BIM interactive notebooks, classifying line styles, and TemporaryGraphicsManager in action  with the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/bimnotebook\n\nInteractivity and AI keeps growing\n&ndash; BIM interactive notebooks\n&ndash; TemporaryGraphicsManager in action\n&ndash; Classify line styles built-in vs user\n&ndash; The curious case of JavaScript\n&ndash; Magika AI-based file type classification\n&ndash; NotebookLM\n&ndash; AI understands videos better\n&ndash; Airline chatbot invented a refund policy\n&ndash; LLM tokenisation\n&ndash; Diátaxis systematic technical documentation\n&ndash; Amara's law\n&ndash; Talking about progress versus risk...\n\nlinkedin:\n\nAmara's law, progress versus risk, AI-based utilities, BIM interactive notebooks, classifying line styles, and TemporaryGraphicsManager in action  with the #RevitAPI\n\nhttps://autode.sk/bimnotebook\n\n- BIM interactive notebooks\n- TemporaryGraphicsManager in action\n- Classify line styles built-in vs user\n- The curious case of JavaScript\n- Magika AI-based file type classification\n- NotebookLM\n- AI understands videos better\n- Airline chatbot invented a refund policy\n- LLM tokenisation\n- Diátaxis systematic technical documentation\n- Amara's law\n- Talking about progress versus risk...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Interactive BIM Notebook, Temporary Graphics and AI",
    "local_header_href": "#interactive-bim-notebook-temporary-graphics-and-ai",
    "chunk_text": "### Interactive BIM Notebook, Temporary Graphics and AI\n\nThe amount of news items related to interactivity and AI keeps growing:\n\n- [BIM interactive notebooks](#2)\n- [TemporaryGraphicsManager in action](#3)\n- [Classify line styles built-in vs user](#4)\n- [The curious case of JavaScript](#5)\n- [Magika AI-based file type classification](#6)\n- [NotebookLM](#7)\n- [AI understands videos better](#8)\n- [Airline chatbot invented a refund policy](#9)\n- [LLM tokenisation](#10)\n- [Diátaxis systematic technical documentation](#11)\n- [Amara's law](#12)\n- [Talking about progress versus risk](#13)"
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "BIM Interactive Notebooks",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> BIM Interactive Notebooks\n\nHot on the foot of\nJoel Waldheim Saury's [interactive .NET Revit BIM Polyglot Notebook](https://thebuildingcoder.typepad.com/blog/2024/02/net-core-c4r-views-and-interactive-hot-reload.html#4),\n[Chuong Ho](https://chuongmep.com/) shares\nhis [BIM Interactive Notebooks](https://www.linkedin.com/posts/chuongmep_opensource-ai-dataanalysis-activity-7164531381107183616-TYNP?utm_source=share&utm_medium=member_desktop):\n\n> I'm thrilled to share an open-source project that I believe holds immense potential.\nIt enables you to integrate and analyze Revit model data in various ways using Jupyter Notebook with multiple programming languages under Interactive .NET.\nThe project has been brought to fruition, and it's truly gratifying to see its development, as it opens up significant opportunities with AI and data analysis.\nExplore further in the\n\n> - [BIM Interactive Notebooks GitHub repository](https://github.com/jowsy/bim-net-interactive)\n\n<center>\n<img src=\"img/ch_jupyter.gif\" alt=\"BIM interactive notebooks\" title=\"BIM interactive notebooks\" width=\"748\"/> <!-- Pixel Height: 656 Pixel Width: 748 -->\n</center>\n\nMany thanks to Chuong Ho for this!"
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "TemporaryGraphicsManager in Action",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> TemporaryGraphicsManager in Action\n\n[Julian Wandzilak](https://www.linkedin.com/in/wandzilak/) of [W7k](https://w7k.pl/) presents\nthe [`TemporaryGraphicsManager` in action](https://forums.autodesk.com/t5/revit-api-forum/temporarygraphicsmanager-in-action/td-p/12566892),\nincluding a 45-second YouTube video [W7k Revit API Experiments - TemporaryGraphicsManager](https://youtu.be/Q7aKEocvRtk):\n\n<center>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/Q7aKEocvRtk?si=ZYffG0lLTLgtXXRG\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n</center>\n\n> Today, I would like to share a recent discovery I made while working with Revit API. As many of you know, creating new graphical elements within Revit can be quite challenging and limited. However, I stumbled upon a little-known class called `TemporaryGraphicsManager`.\nThe TemporaryGraphicsManager allows us to add temporary graphical elements directly to the model or drawing space. These graphics are not subject to undo actions and are not permanently saved anywhere. While they won’t clutter up your project, they provide a powerful way to enhance your user experience.\nSurprisingly, I haven’t seen this class widely used in other plugins or extensions. So, when I first encountered it, I knew I had to put it to the test.\nIn the initial part of my video, I demonstrate how to align title lines to previously saved points. With a simple click, you can create temporary graphics that will guide your design process and allow you to snap your title lines to them!\nIn the second part of the video, I collect points and save them to an external file for future reference. The TemporaryGraphicsManager conveniently marks their locations, eliminating the need to remember which points I’ve already saved.\nIs this the easiest method of controlling title lines? Perhaps not. In an upcoming update to my Drafter tool (to which I added recently 30 days of trial), I’ll introduce further automations in this area. But one thing is certain: I’ll continue to leverage the power of TemporaryGraphicsManager.\n\nThank you for the heads-up, Julian!"
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Classify Line Styles Built-In vs User",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Classify Line Styles Built-In vs User\n\nAn interesting example of several completely different possible approaches to\nclassify line styles in built-in versus user defined was finally solved\nby Frank [@Fair59](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/2083518) Aarssen in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [finding user line styles](https://forums.autodesk.com/t5/revit-api-forum/finding-user-line-styles/m-p/12566994):\n\n**Question:**\nI’m writing an addon that changes all the line styles of Detail Lines, Model Lines and the borders of Filled Regions to a certain line style.\nBut I'm having issues with distinguishing user built line styles from system / inbuilt ones.\n\nTo get all the lines styles and including the user and system ones, I use a FilteredElementCollector to find class GraphicsStyle:\n\n<pre>\n  IList&lt;Element&gt; getgs = new FilteredElementCollector(doc)\n    .OfClass(typeof(GraphicsStyle))\n    .ToElements();\n</pre>\n\nThis works but returns a lot of styles some unrelated to lines, but I can use the `GraphicStyleCategory`, then Parent, then Name to find styles with the parent name “Lines”:\n\n<pre>\n  if (mystyle.GraphicsStyleCategory.Parent.Name == \"Lines\")\n</pre>\n\nSo, now I have all the line styles, but I want to remove the system ones, which I thought were lines styles within &lt; and &gt;, such as &lt;Thin Lines&gt; or &lt;Wide Lines&gt;.\n\nBut, looking at the names that are returned, some have &lt;&gt;, some have only a &gt; at the end and others don't have anything to distinguish them.\nThese are the names returned:\n\n<pre>\n  &lt;Room Separation&gt;\n  &lt;Insulation Batting Lines&gt;\n  &lt;Sketch&gt;\n  &lt;Lines&gt;\n  &lt;Thin Lines&gt;\n  &lt;Medium Lines&gt;\n  &lt;Wide Lines&gt;\n  &lt;Overhead&gt;\n  &lt;Hidden&gt;\n  &lt;Demolished&gt;\n  &lt;Beyond&gt;\n  Boundary&gt;\n  Riser&gt;\n  Run&gt;\n  Landing Center&gt;\n  &lt;Area Boundary&gt;\n  &lt;Hidden Lines&gt;\n  &lt;Space Separation&gt;\n  &lt;Lines&gt;\n  &lt;Lines&gt;\n  &lt;Lines&gt;\n  Stair Path&gt;\n  &lt;Fabric Envelope&gt;\n  &lt;Fabric Sheets&gt;\n  Railing Rail Path Lines\n  Railing Rail Path Extension Lines\n  &lt;Centerline&gt;\n  &lt;Axis of Rotation&gt;\n  &lt;Path of Travel Lines&gt;\n  &lt;Load Area Separation&gt;\n  MyStyle\n</pre>\n\nSeems a little inconsistent to me...\nIs there any good way to pick out the 'system' line styles so that I can only find ones the user has created?\n\n**Answer:**\nOne possible approach that might work is to look at their element ids. These objects are elements, stored in the BIM db, hence equipped with element ids, aren't they? The element ids are assigned one by one as things get added to the database. Hence, higher element ids are added later. They are also incremented consecutively as work progresses. While this behaviour is undocumented and not officially supported or guaranteed in any way whatsoever, it has been working like that forever, afaik. Therefore, if you determine the highest element id in your project right now, you know that everything with a higher id has been added later. Therefore, you know that all line styles with an id higher than the highest one when you started initial work on your BIM are user generated in one way or another, and all lower ones are built-in. Does this help?\n\n**Response:**\nThanks for your response.\n\nI think I've found another way which better does what I'm doing for. After reading more I found that I can collect all CurveElements from the project with this:\n\n<pre>\n  List&lt;CurveElement&gt; AllCurves\n    = new List&lt;CurveElement&gt;(\n      new FilteredElementCollector(doc)\n        .OfClass(typeof(CurveElement))\n        .ToElements()\n        .Cast&lt;CurveElement&gt;());\n</pre>\n\nIterate through them and use the `GetLineStyleIds` method to get their `GraphicsStyles`... luckily, these appear to be named correctly with &lt;&gt; denoting 'System' line styles.\n\n**Answer:**\nA category has the property `BuiltInCategory`.\nThe graphicalStyleCategory of a user-defined line has a built-in category value of `Invalid`:\n\n<pre>\n  StringBuilder sb = new StringBuilder();\n  Category LinesCat = Category.GetCategory(doc,\n    BuiltInCategory.OST_Lines);\n  IEnumerable&lt;GraphicsStyle&gt; getgs\n    = new FilteredElementCollector(doc)\n      .OfClass(typeof(GraphicsStyle))\n      .Cast&lt;GraphicsStyle>();\n  foreach(GraphicsStyle gs in getgs)\n  {\n    Category cat = gs.GraphicsStyleCategory;\n    if(cat==null || cat.Parent==null)\n      continue;\n    if(cat.Parent.Id.IntegerValue != LinesCat.Id.IntegerValue)\n      continue;\n    if(cat.BuiltInCategory == BuiltInCategory.INVALID)\n    {\n      sb.AppendLine(string.Format(\n        \"User defined Line: {0}\",cat.Name));\n    }\n    else\n    {\n      sb.AppendLine(string.Format(\n        \"System defined Line {0} / {1}\",\n        cat.BuiltInCategory, cat.Name));\n    }\n  }\n  TaskDialog.Show(\"debug\",sb.ToString());\n</pre>\n\nThank you for this discussion and solution, Kevin and Frank."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "The Curious Case of JavaScript",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> The Curious Case of JavaScript\n\nMoving away from pure Revit API topics,\nfor an interesting overview of the evolution and power of JavaScript, Sandip Jadhav describes his personal exploration\nin [The curious case of JavaScript](https://www.linkedin.com/pulse/curious-case-javascript-sandip-jadhav-ebobf)."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Magika AI-Based File Type Classification",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Magika AI-Based File Type Classification\n\nUnrelated to BIM, determining the type of data contained in a computer file can be surprisingly tricky.\nOne important utility to address that need was provided in 1973 by\nthe [Unix `file` command](https://en.wikipedia.org/wiki/File_(command)).\n50 years later, Google just open-sourced [Magika](https://google.github.io/magika/),\nan AI-based approach to this task with higher performance:\n\n- [Magika blog post](https://opensource.googleblog.com/2024/02/magika-ai-powered-fast-and-efficient-file-type-identification.html)\n- [Magika GitHub repository](https://github.com/google/magika/)\n\n<center>\n<img src=\"img/magika_performance.png\" alt=\"Magika performance\" title=\"Magika performance\" width=\"600\"/> <!-- Pixel Height: 720 Pixel Width: 1,328 -->\n</center>"
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "NotebookLM",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> NotebookLM\n\nGoogle also introduced\nthe [NotebookLM experiment](https://notebooklm.google/) touting\nan interface that lets you easily shift between reading a text, asking questions about it and writing with built-in AI support that can\nalso transform your set of notes into an outline, blog post, business plan, and more:\n\n> NotebookLM gives you a personalized AI, grounded in the information you trust.\nNotebookLM is only available in the U.S. for users 18 and up."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "AI understands videos better",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> AI understands videos better\n\nOn the topic of AI, the research\non a [world model on million-length video and language with RingAttention](https://largeworldmodel.github.io/) now\nenables the pretty impressive ability to correctly answer questions about an hour-long video."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Airline Chatbot Invented a Refund Policy",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> Airline Chatbot Invented a Refund Policy\n\nAIs still are prone to mistakes as well, though,\nand [Air Canada must honor refund policy invented by airline’s chatbot](https://arstechnica.com/tech-policy/2024/02/air-canada-must-honor-refund-policy-invented-by-airlines-chatbot/)."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "LLM Tokenisation",
    "local_header_href": "#10",
    "chunk_text": "####<a name=\"10\"></a> LLM Tokenisation\n\nOne fundamental and tricky aspect of large language models is discussed in full depth in the two-and-a-quarter hour video\non [LLM tokenisation &ndash; let's build the GPT tokenizer](https://youtu.be/zduSFxRajkE):\n\n<center>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/zduSFxRajkE?si=H0TaI7Ro1ZOpmv0i\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n</center>\n\nThat might help better understand some of the occasional AI weirdness."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Diátaxis Systematic Technical Documentation",
    "local_header_href": "#11",
    "chunk_text": "####<a name=\"11\"></a> Diátaxis Systematic Technical Documentation\n\nUnrelated to both Revit and AI, a colleague pointed out [Diátaxis](https://diataxis.fr/):\n\n> A systematic approach to technical documentation authoring.\n\nIt is of interest to me and our entire team, since it applies to most of the work I do, including my writing right now."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Amara's Law",
    "local_header_href": "#12",
    "chunk_text": "####<a name=\"12\"></a> Amara's Law\n\nFinally, for a fundamental aspect of our human nature that applies to almost everything we do,\nRoy Amara formulated [Amara's law](https://en.wikipedia.org/wiki/Roy_Amara#Amara's_law) in the 1960s:\n\n<center>\n<p style=\"font-style:italic;padding-right:10%;padding-left:10%\">We tend to overestimate the effects of a technology in the short run and underestimate them in the long run.</p>\n</center>\n\nHis observation was not only about technology, but human behaviour in general: we are curious and impatient.\nWe get excited about new things and are quickly disappointed when they don't immediately perform as expected.\nEspecially from technologies, we expect too much too quickly and have little patience with the need for innovation to develop with time.\nAI is a good example: the initial mixture of euphoria and panic has rapidly faded.\nAnother example, our health behaviour: we often initially overestimate behavioural changes &ndash; a new training method, meditation, or diet &ndash; and enthusiastically view them as a panacea, underestimating long-term benefits.\nOften, people don't stick with a behaviour long enough to see its true benefits and returns.\nOr, other people ([Sartre's hell](https://duckduckgo.com/?q=sartre+hell)): we get to know a person, like her, fall in love.\nReality sets in, initially exciting aspects irritate.\nGet through that phase and realise that the other person is not perfect (but neither are we), and the tide turns.\nSo, again, we tend to overestimate people in the short term and underestimate them in the long term."
  },
  {
    "original_filename": "2028_bim_notebook",
    "header_text": "Talking About Progress versus Risk",
    "local_header_href": "#13",
    "chunk_text": "####<a name=\"13\"></a> Talking About Progress versus Risk\n\nContinuing to wax philosophical, with an eye to the interesting times we are living in and actively creating today, every day,\nJohn Burn-Murdoch of the Financial Times recently asked,\n[is the west talking itself into decline?](https://duckduckgo.com/?q=Is+the+west+talking+itself+into+decline%3F)\n\nA recent [scientific paper](https://docs.iza.org/dp16674.pdf) used textual analysis of 173,031 works printed in England between 1500 and 1900 and found significant correlation between vocabulary and culture.\n\n> Extending the same analysis to the present, a striking picture emerges:\nover the past 60 years, the west has begun to shift away from the culture of progress, and towards one of caution, worry and risk-aversion, with economic growth slowing over the same period.\nThe frequency of terms related to progress, improvement and the future has dropped by about 25 per cent since the 1960s, while those related to threats, risks and worries have become several times more common.\n\nSo: don't worry, be happy!\n\nTake a risk and innovate!"
  }
][
  {
    "original_filename": "2029_check_context",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- How to know if Revit API is in Context\n  https://forums.autodesk.com/t5/revit-api-forum/how-to-know-if-revit-api-is-in-context/td-p/12574320\n  finally cracked!\n\n- Detecting Revit User Input State in Real-Time via Revit API\n  https://forums.autodesk.com/t5/revit-api-forum/detecting-revit-user-input-state-in-real-time-via-revit-api/td-p/12610444\n\n- Easy Revit API\n  https://easyrevitapi.com/\n\n- https://www.linkedin.com/posts/chuongmep_ai-bim-aps-activity-7167851379355533313-hs3r?utm_source=share&utm_medium=member_desktop\n  Chuong HoChuong Ho\n  Computational Design Researcher | Autodesk Expert Elite | ConsultantComputational Design Researcher | Autodesk Expert Elite | Consultant\n  https://chuongmep.com/\n  I am excited to announce a significant development in data interaction and retrieval processes using Autodesk Platform Services from Autodesk. Today, I am officially releasing the first version of a toolkit designed to facilitate data access, aiming to support AI processes, Data Analysts, LLM, and explore the boundaries where APS may fall short in providing for end-users.\n  This toolkit is open-source, ensuring accessibility to all engineers, BIM developers, and data scientists. I am actively working on refining it further. Please feel free to provide any feedback in the comments below this post, and I will consider all suggestions.\n  Open Source: https://lnkd.in/ghkv_BhM\n  #AI #BIM #APS #Automation #LLM #DataAnalysis #OpenSource\n\n- DA4R: referencing UI is OK, just make sure you don't call it\n  https://forums.autodesk.com/t5/revit-api-forum/revit-design-automation-api-using-the-reference-to-revitapiui/m-p/12563120\n\n- Using argument \"adskDebug\" to troubleshot failure job of Design Automation\n  https://aps.autodesk.com/blog/using-argument-adskdebug-troubleshot-failure-job-design-automation\n  by Zhong Wu\n  just add the following argument when you post your DA workitem:\n    \"adskDebug\": { \"uploadJobFolder\": true }\n\n- The killer app of Gemini Pro 1.5 is video\n  https://simonwillison.net/2024/Feb/21/gemini-pro-video/\n\n- Generative AI exists because of the transformer\n  https://ig.ft.com/generative-ai/\n  a beginner's guide to understanding LLM\n\n- White House urges developers to dump C and C++\n  https://www.infoworld.com/article/3713203/white-house-urges-developers-to-dump-c-and-c.amp.html\n\n- The harsh reality of ultra processed food - with Chris Van Tulleken\n  https://youtu.be/5QOTBreQaIk\n\nremove aps toolkit:\n\nFrom: Jeremy Tammik\nDate: Tuesday, March 19, 2024 at 14:52\nTo: Cyrille Fauvel\nSubject: Re: Blog article\n\nChuong could replace me several times over.\n\nI suspect he is pretty busy with his own projects, though:\n\nhttps://chuongmep.com/\n\nThe blog post is cleaned now.\n\nCheers\n\njeremy\n\nFrom: Cyrille Fauvel\nDate: Tuesday, March 19, 2024 at 14:28\nTo: Jeremy Tammik\nSubject: Re: Blog article\nHi Jeremy,\n\nNo, this is the first time I have heard about him. That is good to know as Mikako needs to look for your replacement 😉\n\nRegards,\n\nCyrille Fauvel\n\nFrom: Jeremy Tammik\nDate: Tuesday, March 19, 2024 at 6:25 PM\nTo: Cyrille Fauvel\nSubject: Re: Blog article\n\nDear Cyrille,\n\nyes, sure, i'll do that right away.\n\nsorry, i was not aware of that.\n\nChuong Ho is an incredibly active and highly competent Revit API community contributor, by the way.\n\ni guess he is in the APS scene as well, and that you are aware of that?\n\ncheers\n\njeremy\n\nFrom: Cyrille Fauvel\nSubject: Blog article\n\nHi Jeremy,\n\nWould you mind removing any reference to the APS toolkit from this blog article?\n\nhttps://thebuildingcoder.typepad.com/blog/2024/03/api-context-aps-toolkit-and-da4r-debugging.html\n\nThe APS Toolkit explains the internal SVF format and how to download it locally. While it is technically possible, and I usually tell people how to do it, we want to promote something other than this. Putting it on your blog makes it highly visible and indicates Autodesk supports it, and, as an Autodesk employee with lots of readers, encourages people to do it.\n\nhttps://github.com/chuongmep/aps-toolkit\n\nRegards,\n\nCyrille Fauvel\n----\n\ntwitter:\n\nCheck for a valid Revit API context, APS debugging toolkit, AI and other news with the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/rvtapicontext\n\nWe present a long-awaited solution to check for a valid Revit API context and a whole bunch of short pointers to other mostly AI-related topics of interest\n&ndash; Determining Revit API context\n&ndash; Detect Revit user input state\n&ndash; Easy Revit API\n&ndash; APS toolkit\n&ndash; Gemini with image and video input\n&ndash; LLM is not self-aware\n&ndash; Generative AI transformer\n&ndash; Design to reduce junk data\n&ndash; C and C++ are risky\n&ndash; Ultra-processed food is toxic...\n\nlinkedin:\n\nCheck for a valid Revit API context, APS debugging toolkit, AI and other news with the #RevitAPI\n\nhttps://autode.sk/rvtapicontext\n\n- Determining Revit API context\n- Detect Revit user input state\n- Easy Revit API\n- APS toolkit\n- Gemini with image and video input\n- LLM is not self-aware\n- Generative AI transformer\n- Design to reduce junk data\n- C and C++ are risky\n- Ultra-processed food is toxic...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "API Context, Input State and DA4R Debugging",
    "local_header_href": "#api-context-input-state-and-da4r-debugging",
    "chunk_text": "### API Context, Input State and DA4R Debugging\n\nWe present a long-awaited solution to check for a valid Revit API context and a whole bunch of short pointers to other topics of interest, mostly AI related:\n\n- [Determining Revit API context](#2)\n- [Detect Revit user input state](#3)\n- [Easy Revit API](#4)\n- [Gemini with image and video input](#6)\n- [LLM is not self-aware](#7)\n- [Generative AI transformer](#8)\n- [Design to reduce junk data](#9)\n- [C and C++ are risky](#10)\n- [Ultra-processed food is toxic](#11)"
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "Determining Revit API Context",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Determining Revit API Context\n\nLuiz Henrique [@ricaun](https://ricaun.com/) Cassettari finally cracked the\nquestion [how to know if Revit API is in context](https://forums.autodesk.com/t5/revit-api-forum/how-to-know-if-revit-api-is-in-context/td-p/12574320):\n\n> Revit API throws exceptions if your code is trying to execute Revit API methods in a modeless context, e.g., a WPF modeless view; that's the reason you need to use `ExternalEvent` to execute Revit API code in context.\n\n> Sometimes you need to know whether code is running in context or if not, to just execute the Revit API code right away or send it to ExternalEvent to be executed.\n\n> If you have access to `UIApplication` or `UIControllerApplication`, and if you try to subscribe to an event outside Revit API context, you are gonna have this exception: Invalid call to Revit API! Revit is currently not within an API context.\n\n> Meaning: you can use that to know if your code is in context or not.\n\n<center>\n<img src=\"img/ricaun_in_context.png\" alt=\"In Revit API context check\" title=\"In Revit API context check\" width=\"740\"/> <!-- Pixel Height: 303 Pixel Width: 740 -->\n</center>\n\n> - [Code sample and video](https://ricaun.com/revit-api-context/)\n- 14-minute video on [Tasks and InContext in Revit API](https://youtu.be/gyo6xGN5DDU)\n\n> I'm using this technique using my open source library to manage the creation of an external event if it is not in context and enable it to run Revit API asynchronously in [ricaun.Revit.UI.Tasks](https://github.com/ricaun-io/ricaun.Revit.UI.Tasks).\n\nMany thanks to ricaun for sharing this long-sought-after solution!"
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "Detect Revit User Input State",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Detect Revit User Input State\n\nIn a related vein, we also discussed the question\nof [detecting Revit user input state in real-time via Revit API](https://forums.autodesk.com/t5/revit-api-forum/detecting-revit-user-input-state-in-real-time-via-revit-api/td-p/12610444)."
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "Easy Revit API",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Easy Revit API\n\nBig welcome to a new member in the Revit programming blogosphere,\n[Easy Revit API](https://easyrevitapi.com/).\nWelcome, Mohamed-Youssef.\nBest of luck and much success with your blog and other projects!\n\n<!--"
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "APS Toolkit",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> APS Toolkit\n\nIn the last post,\nI mentioned [Chuong Ho](https://chuongmep.com/)'s\n[BIM interactive notebooks](https://thebuildingcoder.typepad.com/blog/2024/02/interactive-bim-notebook-temporary-graphics-and-ai.html#2).\n\nNow you can see how he put them to use in his newest project,\nthe [APS Toolkit](https://github.com/chuongmep/aps-toolkit):\n\n> I am excited to announce a significant development in data interaction and retrieval processes using Autodesk Platform Services from Autodesk. Today, I am officially releasing the first version of a toolkit designed to facilitate data access, aiming to support AI processes, Data Analysts, LLM, and explore the boundaries where APS may fall short in providing for end-users.\nThis toolkit is open source, ensuring accessibility to all engineers, BIM developers, and data scientists. I am actively working on refining it further. Please feel free to provide any feedback in the comments below this post, and I will consider all suggestions.\n\n[APS Toolkit](https://github.com/chuongmep/aps-toolkit) empowers you to explore the Autodesk Platform Services APS.\nIt's built on top of [Autodesk.Forge](https://www.nuget.org/packages/Autodesk.Forge/)\nand [Newtonsoft.Json](https://www.nuget.org/packages/Newtonsoft.Json/).\nThe toolkit includes features enabling you to read, download and write data from APS and export to CSV, Excel, JSON, XML, etc.\n\nFeatures:\n\n- Read/Download SVF Model\n- Read/Query Properties Database SQLite\n- Read/Download Properties Without Viewer\n- Read Geometry Data\n- Read Metadata\n- Read Fragments\n- Read MeshPacks\n- Read Images\n- Export Data to CSV\n- Export Data to Excel\n- Export Data to Parquet\n\nSample usage to export Revit Data To Excel using .NET C&#35;:\n\n<pre><code class=\"language-csharp\">using APSToolkit;\nusing Autodesk.Forge;\nusing APSToolkit.Database;\nusing APSToolkit.Auth;\nvar token = Authentication.Get2LeggedToken().Result;\nstring urn = \"dXJuOmFkc2sud2lwcHJvZDpmcy5maWxlOnZmLk9kOHR4RGJLU1NlbFRvVmcxb2MxVkE_dmVyc2lvbj0z\";\nvar RevitPropDbReader = new PropDbReaderRevit(urn, token);\nRevitPropDbReader.ExportAllDataToExcel(\"result.xlsx\");\n</code></pre>\n\nSample usage to export Revit Data To Excel using Python:\n\n<pre><code class=\"language-python\">from aps_toolkit import Auth\nfrom aps_toolkit import PropDbReaderRevit\nauth = Auth()\ntoken = auth.auth2leg()\nurn = \"dXJuOmFkc2sud2lwcHJvZDpmcy5maWxlOnZmLk9kOHR4RGJLU1NlbFRvVmcxb2MxVkE_dmVyc2lvbj0z\"\nprop_reader = PropDbReaderRevit(urn, token)\ndf = prop_reader.get_data_by_category(\"Ducts\")\ndf.save_to_excel(\"result.xlsx\")\n</code></pre>\n\nMany thanks to Chuong Ho for creating and sharing this powerful toolkit!\n\n-->"
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "Gemini with Image and Video Input",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Gemini with Image and Video Input\n\nAn impressive example of use of LLM with video input support is presented stating\nthat [the killer app of Gemini Pro 1.5 is video](https://simonwillison.net/2024/Feb/21/gemini-pro-video.\n\nI tested using Gemini myself for\na [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) question\non [2024 dark theme colouring addins](https://forums.autodesk.com/t5/revit-api-forum/2024-dark-theme-colouring-addins/m-p/12614689) with\nacceptable and useful results, afaict."
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "LLM is not Self-Aware",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> LLM is not Self-Aware\n\n... Even\nthough [Anthropic’s Claude 3 causes stir by seeming to realize when it was being tested](https://arstechnica.com/information-technology/2024/03/claude-3-seems-to-detect-when-it-is-being-tested-sparking-ai-buzz-online/)."
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "Generative AI transformer",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Generative AI transformer\n\nA nice beginner's guide to understanding LLM explains\nwhy [generative AI exists because of the transformer](https://ig.ft.com/generative-ai/)."
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "Design to Reduce Junk Data",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> Design to Reduce Junk Data\n\nWe are generating huge and ever-growing amounts of data, much of which is useless and never looked at again, so it is well worth\npondering &ndash; and avoiding &mdash; [design patterns that encourage junk data](https://css-irl.info/design-patterns-that-encourage-junk-data/)."
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "C and C++ are Risky",
    "local_header_href": "#10",
    "chunk_text": "####<a name=\"10\"></a> C and C++ are Risky\n\n70 percent of all security vulnerabilities are caused by memory safety issues, and many of those are automatically eliminated by working in a memory-safe programming language.\nTherefore,\nthe [White House urges developers to dump C and C++](https://www.infoworld.com/article/3713203/white-house-urges-developers-to-dump-c-and-c.amp.html)."
  },
  {
    "original_filename": "2029_check_context",
    "header_text": "Ultra-Processed Food is Toxic",
    "local_header_href": "#11",
    "chunk_text": "####<a name=\"11\"></a> Ultra-Processed Food is Toxic\n\nTalking about things we ought to dump, I seldom watch long videos, but this hour-long one had me mesmerised all the way through:\n[the harsh reality of ultra processed food with Chris Van Tulleken](https://youtu.be/5QOTBreQaIk)."
  }
][
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- Feedback Requested - Bowerbird: C# Scripting for Revit\n  https://forums.autodesk.com/t5/revit-api-forum/feedback-requested-bowerbird-c-scripting-for-revit/td-p/12643568\n\n- Doors traversed on path of travel lines\n  https://forums.autodesk.com/t5/revit-api-forum/doors-traversed-on-path-of-travel-lines/td-p/12616109\n  % bl 1740 1744 1781 1836 1871 1917 2028\n  <ul>\n  <li><a href=\"https://thebuildingcoder.typepad.com/blog/2019/04/whats-new-in-the-revit-2020-api.html\">What's New in the Revit 2020 API</a></li>\n  <li><a href=\"https://thebuildingcoder.typepad.com/blog/2019/04/new-revit-2020-sdk-samples.html\">New Revit 2020 SDK Samples</a></li>\n  <li><a href=\"https://thebuildingcoder.typepad.com/blog/2019/09/whats-new-in-the-revit-20201-api.html\">What's New in the Revit 2020.1 API</a></li>\n  <li><a href=\"https://thebuildingcoder.typepad.com/blog/2020/04/whats-new-in-the-revit-2021-api.html\">What's New in the Revit 2021 API</a></li>\n  <li><a href=\"https://thebuildingcoder.typepad.com/blog/2020/10/firerevit-deprecated-api-and-elbow-centre-point.html\">FireRevit, Deprecated API and Elbow Centre Point</a></li>\n  <li><a href=\"https://thebuildingcoder.typepad.com/blog/2021/09/view-sheet-from-view-and-select-all-on-level.html\">View Sheet from View and Select All on Level</a></li>\n  <li><a href=\"https://thebuildingcoder.typepad.com/blog/2024/02/interactive-bim-notebook-temporary-graphics-and-ai.html\">Interactive BIM Notebook, Temporary Graphics and AI</a></li>\n  </ul>\n\n- We’re excited to introduce Claude 3, our next generation of vision-enabled AI models - now available on claude.ai.\n  https://www.anthropic.com/news/claude-3-family\n  https://claude.ai/\n\n- Introducing Devin, the first AI software engineer\n  https://www.cognition-labs.com/blog\n  March 12th, 2024 | Written by Scott Wu\n  Meet Devin, the world’s first fully autonomous AI software engineer.\n\n- generates image, but badly, inattentive, does not follow the detailed prompt: https://imagine.meta.com/\n\n- What is climate change? A really simple guide\n  https://www.bbc.com/news/science-environment-24021772\n\ntwitter:\n\nBowerbird scripting, doors traversed by path of travel, camera mapping between APS and @AutodeskRevit with the #RevitAPI #BIM @DynamoBIM https://autode.sk/camerasettings\n\nNew exciting Revit API solutions and furious pace of LLM development\n&ndash; Bowerbird C&#35; scripting for Revit\n&ndash; Doors traversed by path of travel\n&ndash; Camera mapping between APS and Revit\n&ndash; Claude 3 can see\n&ndash; Devin, an AI software engineer\n&ndash; Meta Imagine generates images\n&ndash; An LLM for decompiling binary code\n&ndash; Simple climate change overview...\n\nlinkedin:\n\nBowerbird scripting, doors traversed by path of travel, camera mapping between APS and Revit with the #RevitAPI\n\nhttps://autode.sk/camerasettings\n\n- Bowerbird C&#35; scripting for Revit\n- Doors traversed by path of travel\n- Camera mapping between APS and Revit\n- Claude 3 can see\n- Devin, an AI software engineer\n- Meta Imagine generates images\n- An LLM for decompiling binary code\n- Simple climate change overview...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Camera Settings, Doors Traversed, Script on the Fly",
    "local_header_href": "#camera-settings-doors-traversed-script-on-the-fly",
    "chunk_text": "### Camera Settings, Doors Traversed, Script on the Fly\n\nNew exciting Revit API solutions and continued furious pace of LLM development:\n\n- [Bowerbird C&#35; scripting for Revit](#2)\n- [Doors traversed by path of travel](#3)\n- [Camera mapping between APS and Revit](#4)\n- [Claude 3 can see](#5)\n- [Devin, an AI software engineer](#6)\n- [Meta Imagine generates images](#7)\n- [An LLM for decompiling binary code](#8)\n- [Simple climate change overview](#9)"
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Bowerbird C&#35; Scripting for Revit",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Bowerbird C&#35; Scripting for Revit\n\n[Christopher Diggins](https://github.com/cdiggins) published\n[Bowerbird](https://github.com/ara3d/bowerbird) for\nquick and easy C&#35; tool and plug-in development by dynamically compiling C# source files,\nand a [request for feedback on it](https://forums.autodesk.com/t5/revit-api-forum/feedback-requested-bowerbird-c-scripting-for-revit/td-p/12643568)\nin the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160),\nsaying:\n\n> I've released a new open-source project for Revit C# developers called Bowerbird.\nIt uses the Roslyn C# compiler to allow users to create and edit new commands directly from C# source files,\nwithout having to go through the process of creating and deploying a plug-in, and re-launching Revit.\n\n> It is inspired\nby [pyRevit](https://github.com/eirannejad/pyRevit) by [Ehsan Iran-Nejad](https://github.com/eirannejad)\nand [Revit.ScriptCS](https://github.com/sridharbaldava/Revit.ScriptCS) by [Sridhar Baldava](https://github.com/sridharbaldava).\n\n> I'd greatly appreciate any feedback or contributions in\nthe [Bowerbird GitHub project](https://github.com/ara3d/bowerbird/).\nThanks in advance!\n\nMany thanks to Christopher for creating and sharing this helpful tool!"
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Doors Traversed by Path of Travel",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Doors Traversed by Path of Travel\n\nA while ago, I took a look at determining the doors traversed by a path of travel and shared some thoughts on that in\nthe [PathOfTravelDoors GitHub repo](https://github.com/jeremytammik/PathOfTravelDoors).\n\nThey were picked up again in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [doors traversed on path of travel lines](https://forums.autodesk.com/t5/revit-api-forum/doors-traversed-on-path-of-travel-lines/td-p/12616109).\n\n**Question:** I want to list all the doors that are crossed by a path of travel line.\nI tried to code that, but it seems that the `ReferenceIntersector` finds more doors that are not on the path of travel, because the introduced ray is reaching them.\n\n<center>\n<img src=\"img/path_of_travel_doors.png\" alt=\"Path of travel doors\" title=\"Path of travel doors\" width=\"600\"/> <!-- Pixel Height: 622 Pixel Width: 1,152 -->\n</center>\n\nI looked at the Revit SDK sample PathOfTravel, but that does not help.\n\nThe [ReferenceIntersector documentation](https://www.revitapidocs.com/2024/c4fb6c89-ca34-7c56-b730-98755d11fedf.htm) is illuminating, and\nthe [FindNearest method](https://www.revitapidocs.com/2024/866e1f2b-c79a-4d9f-1db1-9e386dd42941.htm) ought\nto ensure that I only get a maximum of one single intersected door.\n\n**Answer:** Hmm. Maybe, this task can be addressed simpler.\nHow about this approach without using the reference intersector at all?\n\n- Retrieve the path of travel curve tessellation\n- For each line segment, determine whether it intersects a door\n\nAfaict, that should solve the problem right there.\nWhat do you think?\n\n**Response:** Just cracked it an hour ago!\nI tackled it with this trick:\nFor each curve in the path of travel line I did once from the start point following the curve's direction, and once from the endpoint with the reversed direction.\nThen, I accepted the points that appeared in both.\n\nI also thought of another approach as you mentioned: generating an imaginary line at each door location and checking whether the path of travel line segments intersects that.\nHowever, this method required finding the two points of each door, possibly by examining the geometry of a wall for its opening.\nWhile it seems plausible, I decided against pursuing it initially due to its complexity.\n\nLater: Unfortunately, the described technique fails to yield the intended results across certain models, resulting in a null output from the `ReferenceIntersector`.\n\nAs a workaround for those specific models, an alternative approach was employed:\n\n- Extract the start and end points of each line from the door geometry instance\n- Construct an imaginary line corresponding to the door location (the bounding box includes door swing, so not proper for my case)\n- Examine the intersection of this imaginary line with the curves of the path of travel lines\n\n**Answer:**\nGlad to hear that you found an approach that works reliably for all door instances.\n\nI cannot say for sure why the reference intersector fails in some cases.\nOne thing to consider, though, is that a content creator has complete freedom in the family definition.\nSo, some content creators might choose to represent doors in a completely unconventional manner.\nThey might define the door geometry so that no solids or faces exist for the reference intersector to detect, which might lead to such failures.\nThe infinite flexibility provided for Revit family definitions can make it hard to ensure that an approach always covers all cases.\nThis makes unit testing on a large collection of possible BIM variations all the more important.\n\nThe approach you describe is very generic: every door opening is defined by one single line from start to end point, and that line must be crossed to pass through the door.\nThat sounds pretty fool-proof to me.\n\n<!--\n\n% bl 1740 1744 1781 1836 1871 1917 2028\n<ul>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2019/04/whats-new-in-the-revit-2020-api.html\">What's New in the Revit 2020 API</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2019/04/new-revit-2020-sdk-samples.html\">New Revit 2020 SDK Samples</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2019/09/whats-new-in-the-revit-20201-api.html\">What's New in the Revit 2020.1 API</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2020/04/whats-new-in-the-revit-2021-api.html\">What's New in the Revit 2021 API</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2020/10/firerevit-deprecated-api-and-elbow-centre-point.html\">FireRevit, Deprecated API and Elbow Centre Point</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2021/09/view-sheet-from-view-and-select-all-on-level.html\">View Sheet from View and Select All on Level</a></li>\n<li><a href=\"https://thebuildingcoder.typepad.com/blog/2024/02/interactive-bim-notebook-temporary-graphics-and-ai.html\">Interactive BIM Notebook, Temporary Graphics and AI</a></li>\n</ul>\n\n-->"
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Camera Mapping Between APS and Revit",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Camera Mapping Between APS and Revit\n\nIn 2019, Eason Kang shared a very helpful explanation on how\nto [map Forge viewer camera back to Revit](https://aps.autodesk.com/blog/map-forge-viewer-camera-back-revit).\n\nHowever, some aspects changed, and some were left uncovered back then, as discussed in\nthe new [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160)\non [Revit 3D view camera settings](https://forums.autodesk.com/t5/revit-api-forum/revit-3d-view-camera-settings/m-p/12629132).\n\nSo, Eason took another deep dive into the topic, researched, tested, organized all the material and published it in two blog posts:\n\n- [From APS viewer to Revit](https://aps.autodesk.com/blog/camera-mapping-between-aps-viewer-and-revit-part-i-restore-viewer-camera-revit)\n- [From Revit to APS viewer](https://aps.autodesk.com/blog/camera-mapping-between-aps-viewer-and-revit-part-ii-restore-revit-camera-viewer)\n\nThe associated sample code lives in the\n\n- [aps-viewer-revit-camera-sync GitHub repo](https://github.com/yiskang/aps-viewer-revit-camera-sync)\n\n<!--\nIf you’re interested, here are the old discussions with another customer about doing something similar.\nCf. https://forge.zendesk.com/agent/tickets/14155\n-->\n\n<center>\n<img src=\"img/aps_viewer_camera_perspective.png\" alt=\"APS perspective view camera\" title=\"APS perspective view camera\" width=\"600\"/> <!-- Pixel Height: 576 Pixel Width: 1,024 -->\n</center>\n\nEver so many thanks to Eason for his very careful research and documentation."
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Claude 3 can See",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Claude 3 can See\n\nClaude 3 LLM AI model was released, now vision-enabled and with scores in several intelligence tests:\n\n- [Claude 3 announcement](https://www.anthropic.com/news/claude-3-family)\n- [Claude 3 entry point](https://claude.ai/)"
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Devin, an AI Software Engineer",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Devin, an AI Software Engineer\n\nAnother announcement\nintroduces [Devin, the first AI software engineer](https://www.cognition-labs.com/blog),\na fully autonomous AI software engineer."
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Meta Imagine Generates Images",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Meta Imagine Generates Images\n\n[Meta Imagine](https://imagine.meta.com/) generates images,\ncf., [Meta launches web-based AI image generator trained on your Instagram pics](https://uk.pcmag.com/ai/150034/meta-launches-web-based-ai-image-generator-ai-updates-across-its-apps).\n\nI briefly tested it myself, trying to approximate an image of the real-world scene in front of me, and was unable to tweak the prompt to generate a satisfactory result.\nMy impression was that it very quickly ignored important aspects of my prompt, e.g., specific colour requests, etc., even when I repeated them, so I quickly gave up, unsatisfied."
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "An LLM for Decompiling Binary Code",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> An LLM for Decompiling Binary Code\n\nYet another use of LLM,\n[LLM4Decompile: decompiling binary code with large language models](https://arxiv.org/abs/2403.05286),\nwith its [LLM4Decompile GitHub repo](https://github.com/albertan017/LLM4Decompile)."
  },
  {
    "original_filename": "2030_travel_doors",
    "header_text": "Simple Climate Change Overview",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> Simple Climate Change Overview\n\nOn another ever-present and looming topic of our days,\nBBC shares a nice and simple comprehensive article\nexplaining [What is climate change? A really simple guide](https://www.bbc.com/news/science-environment-24021772)."
  }
][
  {
    "original_filename": "2031_previewcontrol",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- PreviewControl border\n  https://forums.autodesk.com/t5/revit-api-forum/previewcontrol-border/td-p/12570113\n  /Users/jta/a/doc/revit/tbc/git/a/img/preview_border_hide.png\n\n- spy on the preview control\n  PreviewControl border\n  https://forums.autodesk.com/t5/revit-api-forum/previewcontrol-border/m-p/12612782#M77175\n\n- change level of piping elements\n  https://forums.autodesk.com/t5/revit-api-forum/transferring-elements-from-one-level-to-another-while/m-p/12664814#M77745\n\ntwitter:\n\nPicking up two illuminating conversations from the #RevitAPI discussion forum, we look at spying to suppress the PreviewControl border and changing the level of piping elements in @AutodeskRevit #BIM @DynamoBIM https://autode.sk/previewcontrolborder\n\n&ndash; ...\n\nPicking up two illuminating conversations from the Revit API discussion forum, we look at spying to suppress the <code>PreviewControl</code> border and changing the level of piping elements...\n\nlinkedin:\n\nPicking up two illuminating conversations from the #RevitAPI discussion forum, we look at spying to suppress the PreviewControl border and changing the level of piping elements\n\nhttps://autode.sk/previewcontrolborder\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2031_previewcontrol",
    "header_text": "Change Pipe Level and PreviewControl Border",
    "local_header_href": "#change-pipe-level-and-previewcontrol-border",
    "chunk_text": "### Change Pipe Level and PreviewControl Border\n\nPicking up two illuminating conversations from\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160):\n\n- [Spying to suppress the `PreviewControl` border](#2)\n- [Changing the level of piping elements](#3)"
  },
  {
    "original_filename": "2031_previewcontrol",
    "header_text": "Spying to Suppress the PreviewControl Border",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Spying to Suppress the PreviewControl Border\n\nRoman [@Nice3point](https://t.me/nice3point) Karpovich, aka Роман Карпович,\nraised and solved the question of how to suppress the unwanted\n[PreviewControl border](https://forums.autodesk.com/t5/revit-api-forum/previewcontrol-border/td-p/12570113):\n\n**Question:**\nIs it possible to disable the PreviewControl border ? This border comes from the Win32 window. Setting User32.WindowStyles by Hwnd handle does not give any results. Except WS_CHILD and similar, no other styles are applied. Is this border added by Revit development team or is it a HwndHost issue ?\n\n<center>\n<img src=\"img/preview_border_hide_1.png\" alt=\"PreviewControl border\" title=\"PreviewControl border\" width=\"300\"/> <!-- Pixel Height: 592 Pixel Width: 523 -->\n</center>\n\n**Answer:**\nThe only way I could do it when I used it, was to set the Grid margin to -4, but this only works if the grid is set entirely to the window.\n\n**Response:**\nThat is not a solution; the negative margin just covers other content.\n\n**Answer:**\nI don't like the negative margin either, but it was the only way to hide the border. And for it to work, the container (Grid) must cover the entire window.\n\n**Answer B:**\nYou can use Spy++ to determine the window structure and use WinAPI to remove the borders and some WPF magic to trigger the repaint.\nIt took me hours of experimenting, but it is doable.\nIf I recall correctly, there are multiple levels of controls and you have to figure out which ones carry the borders.\n\nI am off for a while and have no access to the code, but don’t feel discouraged if it doesn’t work the first time.\nIt was really painful to solve this and I wish Autodesk would just remove the borders in an upcoming release.\nIt is hard to make software look good if the underlying API takes you back to the nineties ;-).\n\nI can post some code for you to fill the gaps.\nThe important snippet (to be called after `previewControl.Loaded` AND `previewControl.IsVisibleChanged`) is the following:\n\n<pre><code class=\"language-csharp\">\n// get preview window host\nvar previewWndHost = previewControl.Content;\nif (previewWndHost is null)\n  return;\n\n// get preview view handle\nvar previewHwnd = (IntPtr)previewWndHost.GetType().GetProperty(\"Handle\").GetValue(previewWndHost, null);\nif (previewHwnd == IntPtr.Zero)\n  return;\n\n// remove WS_EX_CLIENTEDGE on all child windows\nforeach (var hwnd in HwndHelpers.GetAllChildHandles(previewHwnd).Append(previewHwnd))\n{\n  var style = User32.GetWindowLong(hwnd, Constants.GWL_EXSTYLE).ToInt32() & ~(int)Constants.WS_EX_CLIENTEDGE;\n  User32.SetWindowLong(hwnd, Constants.GWL_EXSTYLE, style);\n}\n\n// trigger redraw by adding or removing a slight padding at the bottom\n// the original padding is stored in the tag, so try to avoid using the\n// tag property for anything else if you want this to work.\nvar p = previewControl.Padding;\nif (previewControl.Tag is null)\n  previewControl.Tag = p;\nif (previewControl.Tag is System.Windows.Thickness t)\n{\n  p.Bottom = p.Bottom == t.Bottom ? p.Bottom + 1 : t.Bottom;\n  previewControl.Padding = p;\n}\n</code></pre>\n\nThe `IsVisibleChanged` handler is required for use in tab controls, since Revit seems to re-create the view in case of visibility changes.\nI misused the tag to save the previous state and avoid shrinking/growing of the control due to the padding-changes at \"reentry\".\nIf you find a better solution to trigger the redraw, please let me know.\nThis part is pretty hacky, but I had to move on at some point and got stuck with whatever did the job.\n\nI also use some WinAPI functions which can be easily imported (google, pinvoke).\nThe HwndHelpers function is just syntactic sugar around EnumChildWindows.\n\n<pre><code class=\"language-csharp\">\npublic static IList&lt;IntPtr&gt; GetAllChildHandles(IntPtr hwnd)\n{\n  var childHandles = new List&lt;IntPtr&gt;();\n  var gcChildHandles = GCHandle.Alloc(childHandles);\n\n  try\n  {\n    bool EnumWindow(IntPtr hWnd, IntPtr lParam)\n    {\n      (GCHandle.FromIntPtr(lParam).Target as List&lt;IntPtr&gt;)?.Add(hWnd);\n      return true;\n    }\n\n    var childProc = new User32.EnumWindowsProc(EnumWindow);\n    User32.EnumChildWindows(hwnd, childProc, GCHandle.ToIntPtr(gcChildHandles));\n  }\n  finally\n  {\n    gcChildHandles.Free();\n  }\n  return childHandles;\n}\n</code></pre>\n\n**Response:**\nAmazing.\nI completely forgot about the Child when writing similar code.\nNow all borders are gone.\nIn addition, I have solved the redrawing problem, for which you used Padding (it was not working correctly).\n\nBefore:\n\n<center>\n<img src=\"img/preview_border_hide_2.png\" alt=\"PreviewControl border\" title=\"PreviewControl border\" width=\"200\"/> <!-- Pixel Height: 790 Pixel Width: 466 -->\n</center>\n\nAfter:\n\n<center>\n<img src=\"img/preview_border_hide_3.png\" alt=\"PreviewControl border suppressed\" title=\"PreviewControl border suppressed\" width=\"200\"/> <!-- Pixel Height: 852 Pixel Width: 525 -->\n</center>\n\nSolution:\n\n<pre><code class=\"language-csharp\">\npublic void Initialize()\n{\n  var previewControl = new PreviewControl(_context, view.Id);\n  previewControl.Loaded += RemovePreviewControlStyles;\n}\n\nprivate void RemovePreviewControlStyles(object sender, EventArgs args)\n{\n  var control = (PreviewControl)sender;\n  var previewHost = (FrameworkElement)control.Content;\n  var previewType = previewHost.GetType();\n  var hostField = previewType.GetField(\"m_hwndHost\", BindingFlags.NonPublic | BindingFlags.DeclaredOnly | BindingFlags.Instance)!;\n  var handle = (IntPtr)hostField.GetValue(previewHost);\n\n  var childHandles = UnsafeNativeMethods.GetChildHandles(handle);\n\n  UnsafeNativeMethods.RemoveWindowStyles(handle);\n  UnsafeNativeMethods.RemoveWindowCaption(handle);\n  foreach (var childHandle in childHandles)\n  {\n    UnsafeNativeMethods.RemoveWindowStyles(childHandle);\n  }\n}\n</code></pre>\n\nUnsafeNativeMethods:\n\n<pre><code class=\"language-csharp\">\n/// &lt;summary&gt;\n/// Tries to remove styles from selected window handle.\n/// &lt;/summary&gt;\n/// &lt;param name=\"handle\"&gt;Window handle.&lt;/param&gt;\n/// &lt;returns&gt;&lt;see langword=\"true\"/&gt; if invocation of native Windows function succeeds.&lt;/returns&gt;\npublic static bool RemoveWindowStyles(IntPtr handle)\n{\n  if (handle == IntPtr.Zero)\n  {\n    return false;\n  }\n\n  if (!User32.IsWindow(handle))\n  {\n    return false;\n  }\n\n  var cornerResult = ApplyWindowCornerPreference(handle, WindowCornerPreference.DoNotRound);\n  if (!cornerResult) return false;\n\n  var windowStyleLong = User32.GetWindowLong(handle, User32.GWL.GWL_EXSTYLE);\n  windowStyleLong &= ~(int)User32.WS_EX.CLIENTEDGE;\n\n  var styleResult = SetWindowLong(handle, User32.GWL.GWL_EXSTYLE, windowStyleLong);\n  return styleResult.ToInt64() &gt; 0x0;\n}\n\n/// &lt;summary&gt;\n///   Get the child windows that belong to the specified parent window by passing the handle to each child window.\n/// &lt;/summary&gt;\n/// &lt;param name=\"hwnd\"&gt;Window handle.&lt;/param&gt;\npublic static IList&lt;IntPtr&gt; GetChildHandles(IntPtr hwnd)\n{\n  var handles = new List&lt;IntPtr&gt;();\n  var gcHandles = GCHandle.Alloc(handles);\n\n  try\n  {\n    var callbackPointer = new User32.EnumWindowsProc(EnumWindowCallback);\n    User32.EnumChildWindows(hwnd, callbackPointer, GCHandle.ToIntPtr(gcHandles));\n  }\n  finally\n  {\n    gcHandles.Free();\n  }\n  return handles;\n}\n\nprivate static bool EnumWindowCallback(IntPtr hwnd, IntPtr lParam)\n{\n  var target = GCHandle.FromIntPtr(lParam).Target as List&lt;IntPtr&gt;;\n  if (target is null) return false;\n\n  target.Add(hwnd);\n  return true;\n}\n</code></pre>\n\nUser32:\n\n<pre><code class=\"language-csharp\">\n/// &lt;summary&gt;\n/// An application-defined callback function used with the EnumChildWindows function.\n/// It receives the child window handles. The WNDENUMPROC type defines a pointer to\n/// this callback function. EnumChildProc is a placeholder for the application-defined\n/// function name.\n/// &lt;/summary&gt;\npublic delegate bool EnumWindowsProc(IntPtr hWnd, IntPtr lParam);\n\n/// &lt;summary&gt;\n/// Enumerates the child windows that belong to the specified parent window by\n/// passing the handle to each child window, in turn, to an application-defined\n/// callback function. EnumChildWindows continues until the last child window\n/// is enumerated or the callback function returns FALSE.\n/// &lt;/summary&gt;\n/// &lt;param name=\"hwnd\"&gt;The window that you want to get information about.&lt;/param&gt;\n/// &lt;param name=\"func\"&gt;A pointer to an application-defined callback function&lt;/param&gt;\n/// &lt;param name=\"lParam\"&gt;An application-defined value to be passed to the callback function.&lt;/param&gt;\n/// &lt;returns&gt;&lt;/returns&gt;\n[DllImport(Libraries.User32)]\npublic static extern bool EnumChildWindows(IntPtr hwnd, EnumWindowsProc func, IntPtr lParam);\n</code></pre>\n\nI've also disabled edge rounding for Windows 11.\nThe methods used can be found in the WPF UI repository:\n\n- [User32](https://github.com/lepoco/wpfui/blob/development/src/Wpf.Ui/Interop/User32.cs)\n- [UnsafeNativeMethods](https://github.com/lepoco/wpfui/blob/development/src/Wpf.Ui/Interop/UnsafeNativeMethods.cs)\n\nSo, problem solved; I think it will be useful to share this on the blog.\nHowever, I would like to ask the Revit development team to turn this off by default,\nas it is easier for users to configure the control themselves than to mess with Win API and native code.\n\nThe lines to get me rid of the padding-trick are\n\n- UnsafeNativeMethods.RemoveWindowCaption(handle);\n\nwhere handle is `hwndHost`,\ncf. [UnsafeNativeMethods.cs line 468](https://github.com/lepoco/wpfui/blob/development/src/Wpf.Ui/Interop/UnsafeNativeMethods.cs#L468).\n\nMany thanks to Roman for researching and sharing this helpful solution!"
  },
  {
    "original_filename": "2031_previewcontrol",
    "header_text": "Changing Level of Piping Elements",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Changing Level of Piping Elements\n\n[Evan Geer](https://evangeer.com/)) shared\na nice example for changing the level for selected piping elements in his answer\nto [transferring elements from one level to another while maintaining their position in space](https://forums.autodesk.com/t5/revit-api-forum/transferring-elements-from-one-level-to-another-while/m-p/12664814)\n\n**Question:**\nHow to move selected elements to another level while maintaining their position in space?\n\n**Answer:**\nCan you achieve what you want manually in the end user interface?\nIf so, that is a good start.\nIf not, it would be good to check that first, determine the optimal workflow and best practices, cf.\nthe [standard approach to address a Revit API programming task](https://thebuildingcoder.typepad.com/blog/2017/01/virtues-of-reproduction-research-mep-settings-ontology.html#3).\n\nPossibly, some elements cannot simply be moved to an different level, but need to be recreated from scratch based on the new level.\n\nThere is an older post showing how to do something similar here:\n\nhttps://forums.autodesk.com/t5/revit-api-forum/change-the-level-of-an-element/td-p/3707640\n\nHere is an example command that will change the level of the selected elements.\nNote that you will need to determine which parameter you want to change for different types of elements, and as noted above, you may not be able to change the level of some elements.\nThis example changes the level for selected piping elements:\n\n<pre><code class=\"language-csharp\">\npublic Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)\n{\n  var doc = commandData.Application.ActiveUIDocument.Document;\n  var selectedIds = commandData.Application.ActiveUIDocument.Selection.GetElementIds();\n\n  var selectedElements = selectedIds.Select(x =&gt; doc.GetElement(x)).ToList();\n\n  var newLevelName = \"L2\";\n  var newLevel = new FilteredElementCollector(doc)\n    .OfClass(typeof(Level))\n    .FirstOrDefault(x =&gt; x.Name == newLevelName) as Level;\n\n  var levelHostedElements = selectedElements\n    .Where(x =&gt; x.LevelId != null && x.LevelId != ElementId.InvalidElementId)\n    .ToList();\n\n  using (var t = new Transaction(doc, \"update level\"))\n  {\n    t.Start();\n    foreach (var element in levelHostedElements)\n    {\n      // NOTE: you will need to select the correct parameter for the element type you are targeting\n      var levelParameter = element.get_Parameter(BuiltInParameter.RBS_START_LEVEL_PARAM);\n      if (levelParameter?.HasValue == true /*&& offsetParameter?.HasValue == true*/)\n      {\n        var oldLevel = doc.GetElement(levelParameter.AsElementId()) as Level;\n\n        levelParameter.Set(newLevel.Id);\n      }\n    }\n    t.Commit();\n  }\n  return Result.Succeeded;\n}\n</code></pre>\n\nIn order to select a level interactively, transfer all elements from it to the target level, and list elements that were not transferred in a dialog box,\nyou just need some handling for parameters and element type match-up.\nThis seems like a perfect match for an abstract factory pattern or something similar.\nYou might also save some time using the RevitLookup tools to identify which parameters match to which types.\n\nIt's not ideal, but I do not think that there is a universal solution to changing the level of an element.\nAs far as I understand, the reason for this is that different elements are hosted by and associated with levels in different ways.\nSo, Revit's engine under the hood is doing different things to make that work, and the options we have exposed to us in the API therefore differ by type.\n\nRegarding handling moving everything on a given level, that can be accomplished with some changes to my example.\nWhere I have hard-code the level name in `newLevelName`, set to \"L2\"; you could easily replace that with a UI allowing users to select the destination level. Similarly, you could add a UI to allow the user to select a source level, and supply that id to this block of code:\n\n<pre><code class=\"language-csharp\">\n  var levelHostedElements = selectedElements\n    .Where(x =&gt; x.LevelId == sourceLevel.Id)\n    .ToList();\n</code></pre>\n\nMany thanks to Evan for the nice sample code and thorough explanation!"
  }
][
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- revit 2025\n  Yes, yesterday Autodesk shared a YouTube video about the Revit 2025. https://youtu.be/7wD3aMUXquc?si=uXOcIqEgbMCMyrsK\n  https://forums.autodesk.com/t5/revit-api-forum/revit-2025-release/td-p/12678437\n  > The ProjectInformation change is slower for some reason in Revit 2025 and Revit 2024.\n  could report this in jira\n\n- Use Visual Studio 2022 for Macros in Revit 2025\n  Revit 2025 - Macro Manager and Visual Studio 2022\n  https://forums.autodesk.com/t5/revit-api-forum/revit-2025-macro-manager-and-visual-studio-2022/td-p/12687232\n\n- dependencies and versions\n  https://github.com/jeremytammik/RevitLookup/issues/210#issuecomment-2037596450\n\n- revitlookup 2025\n  [jeremytammik/RevitLookup] Release 2025.0.0 - 2025.0.0\n\n- Revit developer starter\n  https://forums.autodesk.com/t5/revit-api-forum/revit-developer-starter-pack/td-p/12681495\n  https://github.com/jeremytammik/RevitLookup/discussions/209\n  Revit templates\n  Revit toolkit\n  Revit extensions\n  Revit API\n  RevitLookup\n\n- Chinese chipmaker launches 14nm AI processor that's 90% cheaper than GPUs — $140 chip's older node sidesteps US sanctions\n  https://www.tomshardware.com/tech-industry/artificial-intelligence/chinese-chipmaker-launches-14nm-ai-processor-thats-90-cheaper-than-gpus\n\ntwitter:\n\nRevit 2025, #RevitAPI based on .NET Core, RevitLookup 2025 and a new Revit developer starter kit have been released, PackageReference versioning support and building Revit 2025 macros with Visual Studio 2022 for @AutodeskRevit #BIM @DynamoBIM https://autode.sk/revit2025\n\nRevit 2025 has been released and the new Revit API is now based on .NET Core\n&ndash; PackageReference versioning support\n&ndash; RevitLookup 2025\n&ndash; Revit developer starter kit\n&ndash; Revit 2025 macros with Visual Studio 2022\n&ndash; Cheap Chinese AI chip...\n\nlinkedin:\n\nRevit 2025, #RevitAPI based on .NET Core, RevitLookup 2025 and a new Revit developer starter kit have been released\n\nhttps://autode.sk/revit2025\n\n- PackageReference versioning support\n- RevitLookup 2025\n- Revit developer starter kit\n- Revit 2025 macros with Visual Studio 2022\n- Cheap Chinese AI chips...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "Revit 2025 and RevitLookup 2025",
    "local_header_href": "#revit-2025-and-revitlookup-2025",
    "chunk_text": "### Revit 2025 and RevitLookup 2025\n\nRevit 2025 has been released, and the new Revit API is now based on .NET Core:\n\n- [Revit 2025](#2)\n- [PackageReference versioning support](#3)\n- [RevitLookup 2025](#4)\n- [Revit developer starter kit](#5)\n- [Revit 2025 macros with Visual Studio 2022](#6)\n- [Cheap Chinese AI chip?](#7)"
  },
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "Revit 2025",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Revit 2025\n\nRevit 2025 has been released.\n\nThe Factory blog post\non [What’s New in Revit 2025](https://autodeskblog.wpengine.com/aec/2024/04/02/whats-new-in-revit-2025/)\ndescribes the enhancements.\n\nA quick overview is provided by the official nine-minute video\non [What's new in Revit 2025](https://youtu.be/7wD3aMUXquc)\nby Autodesk Building Solutions:\n\n> Revit 2025 offers new capabilities and enhancements for site design and toposolids, upgrades for modeling and documenting concrete and steel design, in addition to new features for sustainability and carbon analysis, structural analysis, and MEP analysis and fabrication. There are many community ideas realized in Revit 2025, among them sheet collections which benefit efficiency for everyone documenting in Revit, single element and empty arrays for modeling families, and wall joins which improve the experience of placing and manipulating walls, making it more predictable and less prone to error. There’s also more connectivity to Autodesk Docs, improvements for openBIM workflows and data exchange, and other project management upgrades and schema improvements.\n\n> - [00:00](https://www.youtube.com/watch?v=7wD3aMUXquc&t=0s) Introduction\n- [00:42](https://www.youtube.com/watch?v=7wD3aMUXquc&t=42s) Total Carbon Analysis for architects\n- [01:27](https://www.youtube.com/watch?v=7wD3aMUXquc&t=87s) For Everyone\n- [02:40](https://www.youtube.com/watch?v=7wD3aMUXquc&t=160s) Architecture\n- [03:54](https://www.youtube.com/watch?v=7wD3aMUXquc&t=234s) MEP\n- [05:24](https://www.youtube.com/watch?v=7wD3aMUXquc&t=324s) Structure\n- [08:03](https://www.youtube.com/watch?v=7wD3aMUXquc&t=483s) Model Coordination\n- [08:47](https://www.youtube.com/watch?v=7wD3aMUXquc&t=527s) Conclusion"
  },
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "PackageReference Versioning Support",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> PackageReference Versioning Support\n\nAs expected, the Revit 2025 API is now based on the more modern .NET Core, replacing the previous .NET 4.8 framework required in the previous version, cf. previous discussions of the topic:\n\n- [.NET 5 and Core](https://thebuildingcoder.typepad.com/blog/2021/01/face-triangulation-lod-net-5-and-core.html#2)\n- [.NET Core](https://thebuildingcoder.typepad.com/blog/2023/08/15-years-polygon-areas-and-net-core.html#3)\n- [.NET Core Preview and Open Source Add-In Projects](https://thebuildingcoder.typepad.com/blog/2023/11/net-core-preview-and-open-source-add-in-projects.html)\n- [.NET Core Migration Webinar](https://thebuildingcoder.typepad.com/blog/2023/12/parameters-and-net-core-webinar.html#2)\n- [.NET Core Migration Webinar Recording](https://thebuildingcoder.typepad.com/blog/2024/02/net-core-c4r-views-and-interactive-hot-reload.html#2)\n\nSome illuminating aspects of how to gracefully handle different dependency version requirements are discussed in\nthe [RevitLookup issue #210](https://github.com/jeremytammik/RevitLookup/issues/210).\nThe main point is made\nby Roman [@Nice3point](https://t.me/nice3point) Karpovich, aka Роман Карпович:\n\n> You can support different versions like this; `&lt;` represents a <code>&lt;</code> symbol in XML:\n\n<pre><code class=\"language-xml\">&lt;PackageReference Include=\"Microsoft.Extensions.Hosting\" Version=\"8.*\" Condition=\"$(RevitVersion) == '2025'\"/&gt;\n&lt;PackageReference Include=\"Microsoft.Extensions.Hosting\" Version=\"7.*\" Condition=\"$(RevitVersion) != '' And $(RevitVersion) &lt; '2025'\"/&gt;\n</code></pre>"
  },
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "RevitLookup 2025",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> RevitLookup 2025\n\nAs soon as Revit 2025 was available, Roman immediately published\n[RevitLookup 2025](https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.0) supporting\nthe new release of Revit as well as sporting other significant enhancements:\n\n- **Action for deleting element**\nNow you can delete an element from the project, the action is available both from the left panel and from the table:\n<center>\n<br/>\n<img src=\"img/revitlookup2025_1.png\" alt=\"Delete element\" title=\"Delete element\" width=\"600\"/> <!-- Pixel Height: 555 Pixel Width: 1,016 -->\n<br/>\n</center>\n- **Action for editing element parameter value**\nNow you can edit the parameter value. String, Double, Int, ElementId supported:\n<center>\n<br/>\n<img src=\"img/revitlookup2025_2.png\" alt=\"Edit parameter value\" title=\"Edit parameter value\" width=\"600\"/> <!-- Pixel Height: 555 Pixel Width: 1,016 -->\n<br/>\n</center>\n- **ForgeTypeId class name**\nFor developer convenience, the Forge Schema dialog now displays the full class, unit and label property names for direct use in code:\n<center>\n<br/>\n<img src=\"img/revitlookup2025_3.png\" alt=\"Forge schema data\" title=\"Forge schema data\" width=\"600\"/> <!-- Pixel Height: 555 Pixel Width: 1,016 -->\n<br/>\n</center>\n- Add Symbols, Groups Ids to the Forge Schema dialogue\n- Add new ForgeTypeId extensions, ToLabel, IsSymbol, etc.\n- Add `RevitLinkType.IsLoaded` support by @SergeyNefyodov in [#208](https://github.com/jeremytammik/RevitLookup/pull/208)\n- Add `LocationCurve.ElementsAtJoin` support by @SergeyNefyodov in [#205](https://github.com/jeremytammik/RevitLookup/pull/205)\n- Add `LocationCurve.JoinType` support by @SergeyNefyodov in [#205](https://github.com/jeremytammik/RevitLookup/pull/205)\n- [Full changelog](https://github.com/jeremytammik/RevitLookup/compare/2024.0.13...2025.0.0)\n- [RevitLookup versioning](https://github.com/jeremytammik/RevitLookup/wiki/Versions)\n\nMany thanks to Roman for his continuous tremendous work maintaining and improving RevitLookup!"
  },
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "Revit Developer Starter Kit",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Revit Developer Starter Kit\n\nIn addition to the new release of RevitLookup, Roman published\na [Revit developer starter](https://forums.autodesk.com/t5/revit-api-forum/revit-developer-starter-pack/td-p/12681495) including\n\n- Revit templates\n- Revit toolkit\n- Revit extensions\n- Revit API\n- RevitLookup\n\nFor full details, please refer to the [Revit developer starter discussion page](https://github.com/jeremytammik/RevitLookup/discussions/209).\n\nThanks for this as well, Roman!"
  },
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "Revit 2025 Macros with Visual Studio 2022",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Revit 2025 Macros with Visual Studio 2022\n\nIn case you prefer working with macros instead of a full-fledged add-in,\nLuiz Henrique [@ricaun](https://ricaun.com/) Cassettari shared a solution enabling the use of Visual Studio 2022 for Macros in Revit 2025 in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non [Revit 2025 Macro Manager and Visual Studio 2022](https://forums.autodesk.com/t5/revit-api-forum/revit-2025-macro-manager-and-visual-studio-2022/td-p/12687232).\n\nMany thanks for this helpful hint, Ricaun!"
  },
  {
    "original_filename": "2032_rvt_2025",
    "header_text": "Cheap Chinese AI Chip?",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Cheap Chinese AI Chip?\n\nWe may see a much cheaper AI chip based on older technology coming along, according to Tom's Hardware, saying\nthat [Chinese chipmaker launches 14nm AI processor that's 90% cheaper than GPUs &ndash; $140 chip's older node sidesteps US sanctions](https://www.tomshardware.com/tech-industry/artificial-intelligence/chinese-chipmaker-launches-14nm-ai-processor-thats-90-cheaper-than-gpus)."
  }
][
  {
    "original_filename": "2033_tbc_2025",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\ninstall revit 2025\ntbc samples zero warnings no deprecated api usage\nremove all deprecated api usage\ncompile with zero warnings\nupdate visual studio 2022 to 17.9.5\nupgrade to .net core\nhttps://duckduckgo.com/?q=upgrade+to+.net+core\nupdated the seven assembly DLL references:\n\ntwitter:\n\nMigrating The Building Coder samples to Revit 2025: compilation environment, .NET upgrade assistant, Revit API assemblies, errors and warnings in the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/tbcsamples2025\n\nI migrated The Building Coder samples to Revit 2025\n&ndash; Compilation environment\n&ndash; .NET upgrade assistant\n&ndash; Revit API assemblies\n&ndash; Errors and warnings\n&ndash; Conclusion...\n\nlinkedin:\n\nMigrating The Building Coder samples to Revit 2025 #RevitAPI:\n\nhttps://autode.sk/tbcsamples2025\n\n- Compilation environment\n- .NET upgrade assistant\n- Revit API assemblies\n- Errors and warnings\n- Conclusion...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2033_tbc_2025",
    "header_text": "The Building Coder Samples 2025",
    "local_header_href": "#the-building-coder-samples-2025",
    "chunk_text": "### The Building Coder Samples 2025\n\nI migrated The Building Coder samples to Revit 2025:\n\n- [Compilation environment](#2)\n- [.NET upgrade assistant](#3)\n- [Revit API assemblies](#4)\n- [Errors and warnings](#5)\n- [Conclusion](#6)"
  },
  {
    "original_filename": "2033_tbc_2025",
    "header_text": "Compilation Environment",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Compilation Environment\n\nBefore starting with the migration per se, I installed Revit 2025 and ensured that my compilation environment is up to date:\n\n- Revit 2025\n- Parallels Desktop 19.3.0\n- Visual Studio 2022 17.9.5\n\nNext, I recompiled The Building Coder samples for Revit 2024 and eliminated all remaining deprecated API usage to ensure zero errors and zero warnings, creating a final\n[release 2024.0.153.1](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2024.0.153.1) for that."
  },
  {
    "original_filename": "2033_tbc_2025",
    "header_text": ".NET Upgrade Assistant",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> .NET Upgrade Assistant\n\nI used the [.NET Upgrade Assistant](https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview) to move from the .NET Framework 4.8 to .NET Core 8:\n\n<center>\n<img src=\"img/tbc2025upgrade_01.png\" alt=\".NET Upgrade Assistant\" title=\".NET Upgrade Assistant\" width=\"400\"/> <!-- Pixel Height: 678 Pixel Width: 848 -->\n<p style=\"font-size: 80%; font-style:italic\">.NET Upgrade Assistant</p>\n<img src=\"img/tbc2025upgrade_02.png\" alt=\"Upgrade assistant target\" title=\"Upgrade assistant target\" width=\"400\"/> <!-- Pixel Height: 1,092 Pixel Width: 844 -->\n<p style=\"font-size: 80%; font-style:italic\">Upgrade assistant target</p>\n<img src=\"img/tbc2025upgrade_03.png\" alt=\"Upgrade assistant components\" title=\"Upgrade assistant components\" width=\"400\"/> <!-- Pixel Height: 678 Pixel Width: 848 -->\n<p style=\"font-size: 80%; font-style:italic\">Upgrade assistant components</p>\n<img src=\"img/tbc2025upgrade_04.png\" alt=\"Upgrade assistant result\" title=\"Upgrade assistant result\" width=\"400\"/> <!-- Pixel Height: 1,360 Pixel Width: 840 -->\n<p style=\"font-size: 80%; font-style:italic\">Upgrade assistant result</p>\n</center>"
  },
  {
    "original_filename": "2033_tbc_2025",
    "header_text": "Revit API Assemblies",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Revit API Assemblies\n\nThe .NET Upgrade Assistant successfully upgraded almost everything.\n\nHowever, the seven Revit 2024 API assemblies that we reference in this project cannot be upgraded, since they are hardwired to the .NET Framework 4.8:\n\n- AdWindows\n- RevitAPI\n- RevitAPIIFC\n- RevitAPIMacros\n- RevitAPIUl\n- RevitAPIUIMacros\n- UlFrameworkServices\n\nThey need to be manually redefined to use the Revit 2025 API assemblies instead."
  },
  {
    "original_filename": "2033_tbc_2025",
    "header_text": "Errors and Warnings",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Errors and Warnings\n\nWith the new Revit API assembly references in place, the first compilation attempt\nproduced [12 errors and 2 warnings](doc/tbc_samples_2025_migr_01.txt).\n\nMost errors and the two warnings are trivial to fix:\n\n- Error CS0104 `TaskDialog` is an ambiguous reference between *System.Windows.Forms.TaskDialog* and *Autodesk.Revit.UI.TaskDialog*\n- Warning CS8073 The result of the expression is always `true` since a value of type `Guid` is never equal to `null`  in CmdFamilyParamGuid.cs\n\nThe remaining three errors in the module CmdDeleteMacros.cs are due to the removal of document-level macros in Revit 2025 and are equally easily eliminated by commenting out the code section causing them:\n\n- Error CS1503 Argument 1: cannot convert from 'Autodesk.Revit.UI.UIDocument' to 'Autodesk.Revit.UI.UIApplication'\n- Error CS1503 Argument 1: cannot convert from 'Autodesk.Revit.DB.Document' to 'Autodesk.Revit.ApplicationServices.Application'\n- Error CS1061 `MacroModule` does not contain a definition for `RemoveMacro`\n\nAfter removing the `TaskDialog` ambiguity, comparison of Parameter.GUID property with null and support for document-level macros, The Building Coder samples compile for Revit 2025 with zero errors and zero warnings."
  },
  {
    "original_filename": "2033_tbc_2025",
    "header_text": "Conclusion",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Conclusion\n\nNext, I updated BcSamples.txt with the new binary output path */bin/Debug/net8.0-windows*.\n\nThe result is published\nas [The Building Coder samples release 2025.0.153.0](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2025.0.153.0)\n\nThe detailed migration steps taken are listed in\nthe [comparison with the preceding release](https://github.com/jeremytammik/the_building_coder_samples/compare/2024.0.153.1...2025.0.153.0)\n\nI have not tested the result yet, since I am still in the process of installing the Revit SDK samples and setting up the RvtSamples external application that I use to load both the SDK and The Building Coder samples.\n\nGood luck, have fun and much success with your own migrations!\n\nStay tuned for further news."
  }
][
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- RevitLookup HotFix 2025.0.1\n  https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.1\n  Fixed Search Bar crashing Revit  ([issue 214](https://github.com/jeremytammik/RevitLookup/issues/214))\n  Improvements\n  - Ref parameter type support\n  - Add BasePoint.GetSurveyPoint support by @SergeyNefyodov in #212\n  - Add BasePoint.GetProjectBasePoint support by @SergeyNefyodov in #212\n  - Add InternalOrigin.Get support by @SergeyNefyodov in #212\n  - Add ElevationMarker.GetViewId support by @SergeyNefyodov in #213\n  - Add CurtainGrid.GetCell support by @SergeyNefyodov in #215\n  - Add CurtainGrid.GetPanel support by @SergeyNefyodov in #215\n  - Add Panel.GetRefGridLines support by @SergeyNefyodov in #215\n  Many thanks to [@SergeyNefyodov](https://github.com/SergeyNefyodov) for contributing and to Roman for maintaining RevitLookup!\n  [Full changelog 2025.0.0...2025.0.1](https://github.com/jeremytammik/RevitLookup/compare/2025.0.0...2025.0.1)\n  [RevitLookup versions](https://github.com/jeremytammik/RevitLookup/wiki/Versions)\n\n- https://aps.autodesk.com/developer/overview/revit\n  SDKs and tools\n  Revit .NET SDK\n  View documentation and over 100 code samples to start developing with the Revit API. Version 2025 (updated April 2, 2024).\n\n- sync RevitSdkSamples from 2024 to 2025\n\ntwitter:\n\nRevitLookup hotfix, Revit 2025 API, SDK download, comparison with previous version, integration, compilation and custom add-in context menus in the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/revit2025sdk\n\nRevitLookup HotFix 2025.0.1 has been released, and I continue the exploration of the Revit 2025 API\n&ndash; Revit 2025 SDK download\n&ndash; Comparison with previous SDK\n&ndash; Integration into RevitSdkSamples\n&ndash; Compiling the Revit 2025 SDK samples\n&ndash; Custom add-in context menu...\n\nlinkedin:\n\nRevitLookup hotfix, Revit 2025 API, SDK download, comparison with previous version, integration, compilation and custom add-in context menus in the #RevitAPI\n\nhttps://autode.sk/revit2025sdk\n\n- RevitLookup HotFix 2025.0.1\n- Revit 2025 SDK download\n- Comparison with previous SDK\n- Integration into RevitSdkSamples\n- Compiling the Revit 2025 SDK samples\n- Custom add-in context menu...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "RevitLookup Hotfix and The Revit 2025 SDK",
    "local_header_href": "#revitlookup-hotfix-and-the-revit-2025-sdk",
    "chunk_text": "### RevitLookup Hotfix and The Revit 2025 SDK\n\nRevitLookup HotFix 2025.0.1 has been released, and I continue the exploration of the Revit 2025 API, installing the Revit 2025 SDK and performing the following steps:\n\n- [RevitLookup hotfix 2025.0.1](#2)\n- [Revit 2025 SDK download](#3)\n- [Comparison with previous SDK](#4)\n- [Integration into RevitSdkSamples](#5)\n- [Compiling the Revit 2025 SDK samples](#6)\n- [Custom add-in context menu](#7)"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "RevitLookup Hotfix 2025.0.1",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> RevitLookup Hotfix 2025.0.1\n\n[RevitLookup hotfix 2025.0.1](https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.1) has been released to handle\nthe [fixed search bar crashing Revit (issue 214)](https://github.com/jeremytammik/RevitLookup/issues/214).\n\nThis version includes further improvements:\n\n- Ref parameter type support\n- Add BasePoint.GetSurveyPoint support by @SergeyNefyodov in #212\n- Add BasePoint.GetProjectBasePoint support by @SergeyNefyodov in #212\n- Add InternalOrigin.Get support by @SergeyNefyodov in #212\n- Add ElevationMarker.GetViewId support by @SergeyNefyodov in #213\n- Add CurtainGrid.GetCell support by @SergeyNefyodov in #215\n- Add CurtainGrid.GetPanel support by @SergeyNefyodov in #215\n- Add Panel.GetRefGridLines support by @SergeyNefyodov in #215\n- [Full changelog 2025.0.0...2025.0.1](https://github.com/jeremytammik/RevitLookup/compare/2025.0.0...2025.0.1)\n- [RevitLookup versions](https://github.com/jeremytammik/RevitLookup/wiki/Versions)\n\nMany thanks\nto [@SergeyNefyodov](https://github.com/SergeyNefyodov) for contributing and\nto Roman [@Nice3point](https://t.me/nice3point) Karpovich, aka Роман Карпович, for maintaining RevitLookup!"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Revit 2025 SDK Download",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Revit 2025 SDK Download\n\nThe Revit 2025 SDK has been published to the [Revit Developer Centre](https://aps.autodesk.com/developer/overview/revit):\n\n> SDKs and tools &gt; Revit .NET SDK\n  &gt; View documentation and over 100 code samples to start developing with the Revit API.\n  Version 2025 (updated April 2, 2024)."
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Comparison with Previous SDK",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Comparison with Previous SDK\n\nI downloaded the new SDK and compared the directory structure and individual files with the Revit 2024 version, noting the following changes:\n\nFour new SDK samples:\n\n- ContextMenu &ndash; create a customised add-in context menu, [cf. below](#7)\n- DisallowEndWrapping &ndash; allow or disallow end wrapping at certain wall locations\n- EditSketch &ndash; edit curves in sketches and add dimensions to the sketch using `SketchEditScope`\n- NewMacro &ndash; generate, build end execute a Macro by `MacroManager`\n\nFolders Removed:\n\n- REX SDK\n- Samples/AnalyticalSupportData_Info\n- Samples/CreateTrianglesTopography\n- Samples/Site\n\nModified:\n\n- Macro Samples/GetTimeElapsed &ndash; previously separate samples and directories for CSharp and VBNet\n\nAdded:\n\n- Macro Samples/MacroSamples_MEP\n- Macro Samples/MacroSamples_RFA\n- Macro Samples/MacroSamples_RVT\n- Samples/ContextMenu\n- Samples/DisallowEndWrapping\n- Samples/EditSketch\n- Samples/NewMacro\n\nHere are my exact comparison steps and details:\n\n- [Comparison steps and commands](doc/2025_revit_sdk_sample_comparison.txt)\n- [Directory differences](doc/2025_dir_diff.txt)\n- [File differences](doc/2025_file_diff.txt)"
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Integration into RevitSdkSamples",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Integration into RevitSdkSamples\n\nBefore making any changes to my local installation of the SDK samples, I prefer to integrate it into\nthe [RevitSdkSamples GitHub repository](https://github.com/jeremytammik/RevitSdkSamples) to track and share my modifications.\n\nIn order to preserve as much as possible of the Git history from the previous version to the new SDK release, instead of just deleting and overwriting everything, I integrated the new SDK into RevitSdkSamples in two steps, based on the differences detected in the steps described above:\n\n- Delete from RevitSdkSamples all obsolete files that no longer occur in the Revit 2025 SDK\n- Copy the Revit 2025 SDK into RevitSdkSamples, overwriting existing files\n\nThe result is captured\nin [RevitSdkSamples release 2025.0.0](https://github.com/jeremytammik/RevitSdkSamples/releases/tag/2025.0.0)."
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Compiling the Revit 2025 SDK Samples",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Compiling the Revit 2025 SDK Samples\n\nMy first attempt to rebuild the solution [skipped all 201 solutions](doc/sdk_samples_2025_01.txt).\n\nI searched for an explanation and looked\nat [how to determine why Visual Studio might be skipping projects when building a solution](https://stackoverflow.com/questions/1319772/how-to-determine-why-visual-studio-might-be-skipping-projects-when-building-a-so).\n\nI ended up selecting the build target `x64` in the Configuration Manager to match the targets listed for each one of the individual solutions.\n\n<!--\n<center>\n<img src=\"img/sdk_2025_vs_config_mgr.png\" alt=\"Configuration Manager build target\" title=\"Configuration Manager build target\" width=\"300\"/>\n<p style=\"font-size: 80%; font-style:italic\">Configuration Manager build target</p>\n</center>\n-->\n\nWith that setting in place, it reported 'Rebuild started at 9:09 AM...' and did not skip the projects, but it did not seem to do anything else either except endlessly consume more and more memory until\nI [cancelled the build after more than 15 minutes](doc/sdk_samples_2025_02.txt):\n\n<center>\n<img src=\"img/sdk_2025_vs_memory.png\" alt=\"Visual Studio memory consumption growing\" title=\"Visual Studio memory consumption growing\" width=\"600\"/> <!-- Pixel Height: 678 Pixel Width: 848 -->\n<p style=\"font-size: 80%; font-style:italic\">Visual Studio memory consumption growing</p>\n</center>\n\nNext, I removed the `.vs` folder and changed the build output verbosity to detailed in Visual Studio &gt; Tools &gt; Options &gt; Projects and Solutions &gt; Build and Run.\n\nThe increased verbosity still gives no information about what is happening, beyond the message saying 'Rebuild started at 9:46 AM...'\n\nAlthough... the status bar does list one project after another, reporting 'Restored ...csproj in 3.05 s'.\nMultiplying 200 projects by 2 seconds each should still complete in a manageable time, though, but I see no hint of progress.\n\nSwitching the output to 'Package Manager' shows what is going on...\n[Generating MSBuild file, Writing cache file to disk, Persisting dg, Writing assets file to disk etc.](doc/sdk_samples_2025_03.txt)...\nhalf an hour waiting and still going... completed after 34 minutes!\n\nI am probably running a suboptimal setup here...\n\nSo, I continued waiting.\nAfter 1 hour and 46 minutes, the compilation completed, partially,\nwith [177 succeeded, 24 failed, 0 skipped, 30 errors and 5 warnings](doc/sdk_samples_2025_04.txt).\n\nA new record time, slower than all previous versions by a factor of about 25.\n\nLooking at the error list, two errors are caused by code in ExternalResourceDBServer:\n\n- Error CS0246 The type or namespace names `GetLinkPathForOpen` and `LocalLinkSharedCoordinatesSaved` could not be found\n\nI fixed those by commenting out the two offending lines, since the methods referred to are not defined anywhere.\n\nThe remaining errors and warnings have to do with external references, such as:\n\n- Error NU1100  Unable to resolve 'System.Data.DataSetExtensions (>= 4.5.0)' for 'net8.0-windows7.0' in Selections\n- Error BC30002 Type 'MsExcel.Application' is not defined in `ArchSample` and `FireRating`\n- Warning BC40056 Namespace or type specified in the Imports 'Microsoft.Office.Interop.Excel' doesn't contain any public member or cannot be found in `ArchSample` and `FireRating`\n- Error NU1100  Unable to resolve 'Microsoft.CSharp (>= 4.7.0)' for 'net8.0-windows7.0' in `UpdateExternallyTaggedBRep`, `BRepBuilderExample`, `ReadonlySharedParameters`, `ExtensibleStorageUtility`\n- Error NU1100  Unable to resolve 'Newtonsoft.Json (>= 13.0.1)' for 'net8.0-windows7.0' in `CloudAPISample`\n- Error NU1100  Unable to resolve 'System.Data.DataSetExtensions (>= 4.5.0)' for 'net8.0-windows7.0' in `ReadonlySharedParameters`, `ExtensibleStorageUtility`, `ExternalCommandRegistration` and a dozen other projects\n- Error NU1100  Unable to resolve 'HtmlTextWriter (>= 2.1.1)' for 'net8.0-windows7.0' in ScheduleToHTML\n- Error NU1100  Unable to resolve 'System.Net.Http (>= 4.3.4)' for 'net8.0-windows7.0' in ScheduleToHTML\n- Error NU1100  Unable to resolve 'System.Data.OleDb (>= 8.0.0)' for 'net8.0-windows7.0' in RoomSchedule\n- Warning MSB3284 Cannot get the file path for type library \"00020813-0000-0000-c000-000000000046\" version 1.9 in FireRating and ArchSample\n\nPossibly, some of these errors are caused by not installing Microsoft Office in my virtual machine, so I went ahead and installed Microsoft Office.\n\nI noticed this message in the build output window:\n\n- To prevent NuGet from restoring packages during build, open the Visual Studio Options dialog, click on the NuGet Package Manager node and uncheck 'Allow NuGet to download missing packages during build.'\n\nAnother possible culprit\nexplaining [why Visual Studio keeps rebuilding my projects for no good reason](https://michaelscodingspot.com/visual-studio-keeps-rebuilding-projects-no-good-reason/):\n\n> Resource is set to “Copy always”:\nCopy always means just what it says, and there’s never a good reason for that.\nThere is another option to \"Copy if newer\" instead of “Copy always”.\n\nIn the newer SDK-style projects, go to the `.csproj` file and look for\n\n<pre><code class=\"language-xml\">&lt;CopyToOutputDirectory&gt;Always&lt;/CopyToOutputDirectory&gt;\n</code></pre>\n\nChange that to\n\n<pre><code class=\"language-xml\">&lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;\n</code></pre>\n\nI found and fixed that setting in six projects: CloudAPISample, DockableDialogs, FreeFormElement, GetSetDefaultTypes, InCanvasControlAPI and SinePlotter.\n\nRecompiling again from scratch resulted in [181 succeeded, 20 failed, 23 errors, 5 warnings, in 1 hour and 26 minutes](doc/sdk_samples_2025_06.txt).\n\nDefinitely not something I want to repeat on a daily basis.\nMaybe my virtual machine running Windows in Parallels on a Mac is slowing things down?\n\nMy current SDK installation is captured\nin [RevitSdkSamples release 2025.0.1](https://github.com/jeremytammik/RevitSdkSamples/releases/tag/2025.0.1)."
  },
  {
    "original_filename": "2034_sdk_2025",
    "header_text": "Custom Add-In Context Menu",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Custom Add-In Context Menu\n\nAs hinted at by the new `ContextMenu` SDK sample mentioned above, the Revit API 2025 enables an add-in to create a custom right-click context menu:\n\n> This sample demonstrates how to create customized context menu for Add-In and how to create different types of menu items: `CommandMenuItem`, `SeparatorItem`, `SubMenuItem`.\n\n[Ricaun](https://ricaun.com/), aka Luiz Henrique Cassettari, shares his take on that functionality in\nhis [ContextMenuExtension gist](https://gist.github.com/ricaun/ffb897b9ba5b152992cfe20ca6bcfa16) and\na nine-minute video\non [Revit API 2025 RegisterContextMenu](https://youtu.be/1hqGWeYjUcU):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/1hqGWeYjUcU?si=92qAe9HEPDd4Kr_X\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n</center>\n\nThank you very much, Luiz!"
  }
][
  {
    "original_filename": "2035_net_core_8",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\ntwitter:\n\nThe Revit 2025 API is based on .NET 8, so we discuss upgrading from the .NET 4.8 framework, .NET 8 migration webinar recording and the Revit API .NET 8 migration guide for the #RevitAPI @AutodeskRevit #BIM @DynamoBIM https://autode.sk/dotnet8migration\n\nThe Revit 2025 API is based on .NET Core 8, upgrading from the previous .NET 4.8 framework\n&ndash; .NET Core migration webinar recording\n&ndash; Revit API .NET Core migration guide...\n\nlinkedin:\n\nThe Revit 2025 API is based on .NET 8, so we discuss upgrading from the .NET 4.8 framework and the Revit API .NET 8 migration guide for the #RevitAPI:\n\nhttps://autode.sk/dotnet8migration\n\n- .NET Core migration webinar recording\n- Revit API .NET Core migration guide...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2035_net_core_8",
    "header_text": "Migrating from .NET 4.8 to .NET Core 8",
    "local_header_href": "#migrating-from-net-48-to-net-core-8",
    "chunk_text": "### Migrating from .NET 4.8 to .NET Core 8\n\nThe Revit 2025 API is based on .NET Core 8, a significant upgrade from the previous .NET 4.8 framework underlying the Revit 2024 API and previous:\n\n- [.NET Core migration webinar recording](#2)\n- [Revit API .NET Core migration guide](#3)"
  },
  {
    "original_filename": "2035_net_core_8",
    "header_text": ".NET Core Migration Webinar Recording",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> .NET Core Migration Webinar Recording\n\nThe development team held a webinar in January on the topic of the *Autodesk Desktop API .NET Core Migration &ndash; Embracing Modern .NET*.\n\nThe one-and-a-quarter-hour [Autodesk desktop API .NET Core 8.0 migration webinar recording](https://youtu.be/RyHx5-CqKZM) has\nnow been published for public access:\n\n<center>\n  <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/RyHx5-CqKZM?si=06RnsnnwMor_M8G2\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n</center>\n\nIn addition, here is the [presentation slide deck PDF](doc/migrating_to_net_core_8_webinar.pdf).\n\nMy colleague Madhukar Moogala also shared the recording together with AutoCAD API migration guides in his article\non [Autodesk desktop API update .NET Core migration](https://adndevblog.typepad.com/autocad/2024/04/autodesk-desktop-api-update-net-core-migration.html)."
  },
  {
    "original_filename": "2035_net_core_8",
    "header_text": "Revit API .NET Core Migration Guide",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Revit API .NET Core Migration Guide\n\nFor Revit 2025, the guide on *Migrating from .NET 4.8 to .NET 8* is included as a section in the Revit 2025 API help file *RevitAPI.chm*, provided in\nthe Revit 2025 SDK that is available from the [Revit developer centre](https://aps.autodesk.com/developer/overview/revit).\n\nI printed it out in PDF format, available in [migrating_to_net_core_8.pdf](doc/migrating_to_net_core_8.pdf).\n\nBetter still, though, the `CHM` file contains native [`HTML` formatted text](doc/migrating_to_net_core_8.html).\nFor your convenience and to facilitate web searches, here it is:\n\n<!--\n<html><head>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n  <meta name=\"Microsoft.Help.SelfBranded\" content=\"true\" /><meta name=\"Language\" content=\"en-us\" />\n  <meta name=\"Microsoft.Help.Locale\" content=\"en-us\" />\n  <meta name=\"Microsoft.Help.TopicLocale\" content=\"en-us\" />\n  <link rel=\"shortcut icon\" href=\"../icons/favicon.ico\" />\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"../styles/branding.css\" />\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"../styles/branding-en-US.css\" />\n  <script type=\"text/javascript\" src=\"../scripts/branding.js\"></script>\n  <title>Migrating From .NET 4.8 to .NET 8</title>\n  <meta name=\"Title\" content=\"Revit .NET 8 Upgrade Tips\" />\n  <meta name=\"Microsoft.Help.Id\" content=\"2db849bc-e193-4919-a96c-cc324cf06f66\" />\n  <meta name=\"Microsoft.Help.ContentType\" content=\"Concepts\" />\n  <meta name=\"Description\" content=\"Revit 2025 is built on .NET 8. In this release, the Revit API is .NET 8 only, and Revit add-ins need to be recompiled for .NET 8.\" />\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"../styles/branding-Help1.css\" /></head>\n-->\n\n  <body onload=\"SetDefaultLanguage('cs');\">\n    <input type=\"hidden\" id=\"userDataCache\" class=\"userDataStyle\" />\n    <div id=\"PageHeader\" class=\"pageHeader\">Revit 2025 API</div>\n    <div class=\"pageBody\">\n      <div id=\"TopicContent\" class=\"topicContent\">\n        <table class=\"titleTable\"><tr>\n          <td class=\"titleColumn\"><h1>Migrating from .NET 4.8 to .NET 8</h1></td></tr></table>\n          <p>Revit 2025 is built on .NET 8. In this release, the Revit API is .NET 8 only, and Revit add-ins need to be recompiled for .NET 8.</p><p>The move from .NET 4.8 is to .NET 8 is a relatively large jump. .NET 8 comes from the .NET Core lineage, which has significant differences from .NET 4.8.</p><br /><strong><u>Upgrade Process</u></strong><p>There are many Microsoft documents and tools to help application developers migrate from .NET 4.8 to .NET Core/5/6/7/8. Following is a list of some helpful documents:</p><ul><li>Overview of porting from .NET Framework to .NET document:\n      <a href=\"https://learn.microsoft.com/en-us/dotnet/core/porting/\">https://learn.microsoft.com/en-us/dotnet/core/porting/</a></li><li>.NET Upgrade Assistant can help with the project migration:\n      <a href=\"https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview\">https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview</a></li><li><a href=\"https://docs.microsoft.com/en-us/dotnet/standard/analyzers/portability-analyzer\">The .NET Portability Analyzer - .NET</a> on C# projects to roughly evaluate how much work is required to make the migration as well as dependencies between the assemblies.\n      </li><li>Lists of breaking changes for .NET Core and .NET 5+:\n      <a href=\"https://learn.microsoft.com/en-us/dotnet/core/compatibility/breaking-changes\">https://learn.microsoft.com/en-us/dotnet/core/compatibility/breaking-changes</a></li><li>The .NET 8 SDK can be installed from here:\n      <a href=\"https://dotnet.microsoft.com/en-us/download/visual-studio-sdks\">https://dotnet.microsoft.com/en-us/download/visual-studio-sdks</a><ul><li>.NET SDK 8.0.100 is used to build the Revit 2025 release.</li><li>The Revit 2025 release will install .NET 8 Windows Desktop Runtime x64 8.0.0.33101.</li></ul></li><li>If you use Visual Studio to build .NET 8 code, you'll need\n      <a href=\"https://visualstudio.microsoft.com\">Visual Studio 17.8</a> or later.</li></ul><br /><br /><strong><u>Basic upgrade process for projects</u></strong><br /><br />\n      <span class=\"code\"><em>For C# projects (CSPROJ)</em></span><br />\n      <ul>\n      <li>Convert C# projects to the new SDK-style format: <a href=\"https://learn.microsoft.com/en-us/dotnet/core/project-sdk/overview\">https://learn.microsoft.com/en-us/dotnet/core/project-sdk/overview</a>\n        <ul>\n      <li>The .NET Upgrade Assistant can help with the project migration: <a href=\"https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview\">https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview</a></li>\n      <li>Convert packages.json into PackageReferences in your CSPROJ. <a href=\"https://learn.microsoft.com/en-us/nuget/consume-packages/migrate-packages-config-to-package-reference\">https://learn.microsoft.com/en-us/nuget/consume-packages/migrate-packages-config-to-package-reference</a></li></ul></li><li>Update the target framework for your projects from <span class=\"literal\"><em>&lt;TargetFrameworkVersion&gt;</em></span> to <span class=\"literal\"><em>&lt;TargetFramework&gt;net8.0-windows&lt;/TargetFramework&gt;</em></span><ul><li>You can run the <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/analyzers/portability-analyzer\">.NET Portability Analyzer</a> on C# projects to evaluate how much work is required to make the migration.</li>\n      <li>The .NET Upgrade Assistant can help with the .NET version migration: <a href=\"https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview\">https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview</a></li>\n      <li>If your application is a <a href=\"https://learn.microsoft.com/en-us/dotnet/desktop/wpf/migration/?view=netdesktop-7.0&amp;amp;preserve-view=true\">WPF application</a>, then the CSPROJ will need\n      <span class=\"literal\"><em>&lt;TargetFramework&gt;net8.0-windows&lt;/TargetFramework&gt;</em></span> and <span class=\"literal\"><em>\n        &lt;UseWPF&gt;true&lt;/UseWPF&gt;</em></span>.</li><li>If your application uses <a href=\"https://learn.microsoft.com/en-us/dotnet/desktop/winforms/migration/?view=netdesktop-6.0&amp;amp;preserve-view=true\">Windows forms</a>, then use <span class=\"literal\"><em>&lt;TargetFramework&gt;net8.0-windows&lt;/TargetFramework&gt;</em></span> and <span class=\"literal\"><em>&lt;UseWindowsForms&gt;true&lt;/UseWindowsForms&gt;</em></span>.</li></ul></li><li>System references can be removed from the CSPROJ, as they are available by default.</li><li>Then address incompatible packages, library references and obsolete (unsupported) code.</li></ul><br /><br /><span class=\"code\"><em>For C++/CLI projects (VCXPROJ)</em></span><br /><p>Refer to Microsoft's guide for migrating C++/CLI projects to .NET Core/5+: <a href=\"https://learn.microsoft.com/en-us/dotnet/core/porting/cpp-cli\">https://learn.microsoft.com/en-us/dotnet/core/porting/cpp-cli</a></p><ul><li>Replace\n            <span class=\"literal\"><em>\n              &lt;CLRSupport&gt;true&lt;/CLRSupport&gt;\n            </em></span> with\n            <span class=\"literal\"><em>\n              &lt;CLRSupport&gt;NetCore&lt;/CLRSupport&gt;.\n            </em></span>\n          This property is often in configuration-specific property groups, so you may need to replace it in multiple places.</li><li>Replace\n      <span class=\"literal\"><em>&lt;TargetFrameworkVersion&gt;</em></span>\n        A property with <span class=\"literal\"><em>&lt;TargetFramework&gt;net8.0-windows&lt;/TargetFramework&gt;.</em></span></li><li>Remove any .NET Framework references (like\n    <span class=\"literal\"><em>&lt;Reference Include=\"System\" /&gt;</em></span>)\n      and add <span class=\"literal\"><em>FrameworkReference</em></span> when needed\n    . .NET Core SDK assemblies are automatically referenced when using\n    <span class=\"literal\"><em>NetCore </em></span>support.</li><li>Add FrameworkReferences:<ul><li>To use Windows Forms APIs, add this reference to the vcxproj file:<p /><span class=\"literal\"><em>\n        &lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App.WindowsForms\" /&gt;\n        </em></span></li><li>To use WPF APIs, add this reference to the vcxproj file:<p /><span class=\"literal\"><em>\n        &lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App.WPF\" /&gt;\n        </em></span></li><li>To use both Windows Forms and WPF APIs, add this reference to the vcxproj file:<p /><span class=\"literal\"><em>\n        &lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App\" /&gt;\n        </em></span></li></ul></li>\n        <li>Remove any  <span class=\"literal\"><em>&lt;CompileAsManaged&gt;</em></span> for cpp files. It will be set as NetCore by default. Any other values may cause issues.</li>\n        <li>Then address incompatible packages, library references and obsolete (unsupported) code.</li></ul><br /><br /><span class=\"code\"><em>Global.json</em></span><br /><p>You may need to set <span class=\"literal\"><em>net8.0-windows</em></span> as the target in your global.json, if you have one. Refer the link for global.json overview: <a href=\"https://learn.microsoft.com/en-us/dotnet/core/tools/global-json\">https://learn.microsoft.com/en-us/dotnet/core/tools/global-json</a></p><br /><br /><strong><u>Component Versions</u></strong><p>Your add-in may avoid instability by matching the version of these key components used by the Revit 2025 release:</p><ul><li>CefSharp<ul><li>\n        \"cef.redist.x64\" Version=\"119.4.3\"</li>\n        <li>\"cef.redist.x86\" Version=\"119.4.3\"</li>\n        <li>\"CefSharp.Wpf.HwndHost\" Version=\"119.4.30\"</li>\n        <li>\"CefSharp.Common.NetCore\" Version=\"119.4.30\"</li>\n        <li>\"CefSharp.Wpf.NetCore\" Version=\"119.1.20\"</li></ul></li><li>Newtonsoft Json<ul>\n          <li>\"Newtonsoft.Json\" Version=\"13.0.1\"</li></ul></li></ul>\n          <p><p /></p>\n      <strong><u>Supporting Multiple Revit Releases</u></strong>\n      <p>A single code base can support older Revit releases on .NET 4.8 as well as Revit 2025 on .NET 8.  <a href=\"https://forums.autodesk.com/t5/revit-api-forum/optimal-add-in-code-base-approach-to-target-multiple-revit/m-p/12532755/highlight/true#M76622\">See this discussion on the Autodesk forums</a> for ideas on configuring your projects and code to support multi-targeting.</p><br /><br /><strong><u>Common Issues</u></strong><p>Here are some common issues you may encounter when upgrading to .NET 8:</p><br /><span class=\"code\"><em>Build Warning MSB3277</em></span><p>\n    When building code that references RevitAPI or RevitUIAPI, you will see the <a href=\"https://learn.microsoft.com/en-us/visualstudio/msbuild/errors/msb3277?view=vs-2022\">build warning MSB3277</a>. To fix this, add a reference to the Windows Desktop framework: <span class=\"literal\"><em>&lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App\"/&gt;</em></span><p /></p><span class=\"code\"><em>\n    Build Error CA1416\n  </em></span><p>\n    If your application uses functions that are only available on Windows systems, you may see a <a href=\"https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca1416\">CA1416</a> error. This can be fixed for the project by adding <span class=\"literal\"><em>[assembly: System.Runtime.Versioning.SupportedOSPlatformAttribute(\"windows\")]</em></span> to <span class=\"literal\"><em>AssemblyInfo.cs</em></span>.\n  </p><p><p /></p><strong><u>Obsolete Classes and Functions with .NET 8</u></strong><p>\n    Your .NET 4.8 application may see compile time or runtime errors if it uses classes or functions that are obsolete or deprecated in .NET Core/5/6/7/8.\n  </p><p>\n    Lists of breaking changes for .NET Core/5/6/7/8 are here: <a href=\"https://learn.microsoft.com/en-us/dotnet/core/compatibility/breaking-changes\">https://learn.microsoft.com/en-us/dotnet/core/compatibility/breaking-changes</a></p><ul><li><a href=\"https://learn.microsoft.com/en-us/dotnet/core/compatibility/serialization/5.0/binaryformatter-serialization-obsolete\">BinaryFormatter</a> and <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter?view=netframework-4.8.1\">SOAPFormatter</a> are obsolete.\n    <ul><li>\n      Resource files that contain images or bitmaps will need to be updated as <a href=\"https://stackoverflow.com/questions/69796653/binaryformatter-not-supported-in-net-5-app-when-loading-bitmap-resource\">BinaryFormatter will not be available in .NET 8 to interpret those images/bitmaps</a>.\n      </li><li><a href=\"https://github.com/dotnet/winforms/issues/9701\">Windows Forms dialogs using ImageList</a> may need to be updated as BinaryFormatter loads the images for the ImageList.\n      </li></ul></li><li><a href=\"https://learn.microsoft.com/en-us/dotnet/core/compatibility/core-libraries/5.0/thread-abort-obsolete\">System.Threading.Thread.Abort</a> is obsolete.\n    </li><li><a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.reflection.assemblyname.codebase?view=net-7.0\">System.Reflection.AssemblyName.CodeBase</a> and <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.reflection.assembly.codebase?view=net-7.0\">System.Reflection.Assembly.CodeBase</a> are deprecated.\n    </li><li><a href=\"https://devblogs.microsoft.com/dotnet/migrating-delegate-begininvoke-calls-for-net-core/\">Delegate.BeginInvoke</a> is not supported.\n    </li><li><a href=\"https://github.com/dotnet/winforms/issues/3739\">Debug.Assert failure or Debug.Fail</a> silently exits the application by default.\n    </li></ul><p><p /></p><strong><u>Assembly Loading</u></strong><p>Your .NET 4.8 application may need updates to help it find and load assemblies:</p><ul><li>.NET 8 uses a different <a href=\"https://learn.microsoft.com/en-us/dotnet/core/dependency-loading/default-probing\">assembly probing approach for DLL loading</a>. When in doubt, try putting the DLL to be loaded in the build output root directory.</li><li>.NET 8 <a href=\"https://learn.microsoft.com/en-us/dotnet/core/dependency-loading/loading-managed\">assembly loading details</a> are different than .NET 4.8.</li><li>.NET 8 projects need <a href=\"https://learn.microsoft.com/en-us/dotnet/core/runtime-config/\">runtimeconfig.json files for many DLLs</a>. The runtimeconfig.json needs to be installed next to the matching DLL, and it configures the behavior of that DLL.\n      These files can be created with <span><em>&lt;GenerateRuntimeConfigurationFiles&gt;true&lt;/GenerateRuntimeConfigurationFiles&gt;</em></span></li>\n      <li>.NET 8 projects will create <span class=\"literal\"><em>deps.json</em></span> files for many DLLs.\n        These <span class=\"literal\"><em>deps.json</em></span> files can be deleted if dependencies are placed in the <a href=\"https://learn.microsoft.com/en-us/dotnet/core/dependency-loading/default-probing\">same directory as the application</a>.\n        These files can be deleted with <span class=\"literal\"><em>&lt;GenerateDependencyFile&gt;false&lt;/GenerateDependencyFile&gt;</em></span></li></ul>\n        <p><p /></p>\n<strong><u>Assembly Properties</u></strong><br />\n<p>After updating your application to .NET 8, you may see build errors for your assembly properties. Many assembly properties are now auto-generated and <a href=\"https://learn.microsoft.com/en-us/dotnet/architecture/modernize-desktop/example-migration#assemblyinfo-considerations\">can be removed from AssemblyInfo.cs</a>.</p><p><p /></p><strong><u>Double Numbers To String</u></strong><br /><br /><p>If you have unit tests or integration tests that compare doubles as strings, they may fail when you upgrade to .NET 8. This is because the number of decimal places printed by <em>ToString()</em> for doubles is <a href=\"https://devblogs.microsoft.com/dotnet/floating-point-parsing-and-formatting-improvements-in-net-core-3-0/\">different in .NET 4.8 and .NET 8</a>. You can call <em>ToString(\"G15\")</em> when converting doubles to strings to use the old .NET 4.8 formatting.</p><p><p /></p><strong><u>String.Compare</u></strong><p>\n    String.Compare behavior has changed, see <a href=\"https://learn.microsoft.com/en-us/dotnet/core/extensions/globalization-icu\">.NET globalization and ICU</a> and <a href=\"https://learn.microsoft.com/en-us/dotnet/core/extensions/globalization-icu#use-nls-instead-of-icu\">Use Globalization and ICU</a>.\n  </p><p><p /></p><strong><u>\n    Windows Dialogs May Change Appearance\n  </u></strong><p>\n    Your dialogs may change appearance with .NET 8.\n  </p><ul>\n    <li><a href=\"https://github.com/dotnet/winforms/issues/9293\">WinForms dialogs experience UI layout changes.</a>\n    The workaround is to set Scale(new SizeF(1.0F, 1.0F)); in the dialog constructor.</li>\n    <li>The dialog <a href=\"https://learn.microsoft.com/en-us/dotnet/core/compatibility/winforms#default-control-font-changed-to-segoe-ui-9-pt\">default font changed from \"Microsoft Sans Serif 8 pt\" to \"Segoe UI\"</a>.\n    This can change dialog appearance and spacing.</li></ul><p>\n      <p /></p>\n<strong><u>Process.Start() May Fail</u></strong>\n<p>\n    If your application is having trouble starting new processes, this may be because\n    <a href=\"https://github.com/dotnet/core/issues/4109\">System.Diagnostics.Process.Start(url) has a behavior change</a>.\n    The <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo.useshellexecute?view=net-7.0\">ProcessStartInfo.UseShellExecute Property</a>\n    defaults to <span class=\"literal\"><em>true </em></span> in .NET 4.8 and <span class=\"literal\"><em>false</em></span> in .NET 8.\n    Set <span class=\"literal\"><em>UseShellExecute=true</em></span> to workaround this change.<p />\n    </p><br />\n<strong><u>Encoding.Default Behaves Differently in .NET 8</u></strong>\n<p>If your application is having problems getting the text encoding used by Windows, it may be because <span class=\"literal\"><em>Encoding.Default</em></span> behaves differently in .NET 8. In .NET 4.8 <span class=\"literal\"><em>Encoding.Default</em></span> would get the system's active code page, but in .NET Core/5/6/7/8\n    <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.text.encoding.default?view=net-7.0\">Encoding.Default is always UTF8</a>.\n  </p><br /><strong><u>Items Order Differently in Sorted Lists</u></strong><p>If you see different orderings of items in sorted lists after updating to .NET 8, this may be because\n    <a href=\"https://github.com/microsoft/dotnet/blob/main/Documentation/compatibility/list_sort-algorithm-changed.md\">List&lt;T&gt;.Sort() behaves differently</a> in .NET 8 than .NET 4.8. The change fixes a .NET 4.8 bug which affected <span class=\"literal\"><em>Sort()</em></span> of items of equal value.<p /></p><br /><br />\n<strong><u>System.ServiceModel</u></strong>\n<br />\n<p>System.ServiceModel has been ported to .NET Core through <a href=\"https://dotnet.microsoft.com/en-us/platform/support/policy/corewcf\">CoreWCF</a>, which is now available through Nuget packages.\n  There are various changes, including <em>&lt;System.ServiceModel&gt;</em>not being supported in configuration files.</p><p><p /></p>\n<strong><u>C# Language Updates</u></strong>\n<p>If you are building code from .NET 4.8 in .NET 8, you may see build errors or warnings about C# nullable types.</p>\n<p><a href=\"https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/nullable-value-types\">C# has introduced nullable value types</a> and <a href=\"https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/nullable-reference-types\">nullable reference types</a>.\nPrior to .NET 6, new projects used the default <span class=\"literal\"><em>&lt;Nullable&gt;disable&lt;/Nullable&gt;</em></span>. Beginning with .NET 6, new projects include the <span class=\"literal\"><em>&lt;Nullable&gt;enable&lt;/Nullable&gt;</em></span> element in the project file.\n</p>\n<p>You can set <span class=\"literal\"><em>&lt;Nullable&gt;disable&lt;/Nullable&gt;</em></span> if you want to revert to .NET 4.8 behavior.</p>\n<p><p /></p>\n<strong><u>Environmental Variables</u></strong>\n<br />\n<p>If you use managed .NET to run native C++ code, be aware that environmental variables, including the path variable for DLL loading, are not shared from managed .NET code with native C++ code.</p></div></div><div id=\"PageFooter\" class=\"pageFooter\"><div class=\"feedbackLink\">Send comments on this topic to\n<a id=\"HT_MailLink\" href=\"mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API\">Autodesk</a></div>\n<script type=\"text/javascript\">\nvar HT_mailLink = document.getElementById(\"HT_MailLink\");\nHT_mailLink.href += \": \" + document.title + \"\\u0026body=\" + encodeURIComponent(\"Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.\");\n</script></div></body></html>\n\n<center>\n<img src=\"img/migration_birds.png\" alt=\"Migration\" title=\"Migration\" width=\"400\"/>\n</center>"
  }
][
  {
    "original_filename": "2036_whats_new_2025",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n\n<style>\n  ul.toc { list-style-type: none; }\n  h1.new { font-size: 150%; }\n  h2.new { font-size: 150%; }\n  h3.new { font-size: 120%; }\n  h4.new { font-size: 120%; }\n</style>\n\n</head>\n\n<!---\n\ntwitter:\n\nWhat's New in the Revit 2025 API? Exciting new functionality, migration information, overview of changes and additions, table of contents, full details of all new aspects of the @AutodeskRevit #RevitAPI #BIM @DynamoBIM @AutodeskAPS https://autode.sk/rvt2025api\n\nThe Revit 2025 API contains significant enhancements for add-in developers\n&ndash; Information sources\n&ndash; What's new in previous versions\n&ndash; Detailed table of contents\n&ndash; API Changes\n&ndash; API Additions...\n\nlinkedin:\n\nWhat's New in the Revit 2025 API? Exciting new functionality, migration information, overview of changes and additions, table of contents, full details of all new aspects of the #RevitAPI\n\nhttps://autode.sk/rvt2025api\n\n- Information sources\n- What's new in previous versions\n- Detailed table of contents\n- API Changes\n- API Additions...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2036_whats_new_2025",
    "header_text": "What's New in the Revit 2025 API",
    "local_header_href": "#whats-new-in-the-revit-2025-api",
    "chunk_text": "### What's New in the Revit 2025 API\n\nThe Revit 2025 API contains significant changes and enhancements for add-in developers:\n\n- [Information sources](#1)\n- [What's new in previous versions](#2)\n- [Detailed table of contents](#4)\n\nTop level table of contents:\n\n<ul class=\"toc\">\n<li>1. <a href=\"#4.1\">API changes</a></li>\n<ul class=\"toc\">\n<li>1.1. <a href=\"#4.1.1\">CefSharp upgrade</a></li>\n<li>1.2. <a href=\"#4.1.2\">Revit now on .NET 8</a></li>\n<li>1.3. <a href=\"#4.1.3\">Add-ins and macro changes</a></li>\n<li>1.4. <a href=\"#4.1.4\">Array API changes</a></li>\n<li>1.5. <a href=\"#4.1.5\">BRepBuilder API changes</a></li>\n<li>1.6. <a href=\"#4.1.6\">Dimension API changes</a></li>\n<li>1.7. <a href=\"#4.1.7\">Extensible Storage(Schema) API changes</a></li>\n<li>1.8. <a href=\"#4.1.8\">Electrical API changes</a></li>\n<li>1.9. <a href=\"#4.1.9\">Link Visibility/Graphic Override API changes</a></li>\n<li>1.10. <a href=\"#4.1.10\"> MEP changes</a></li>\n<li>1.11. <a href=\"#4.1.11\"> Reinforcement API changes</a></li>\n<li>1.12. <a href=\"#4.1.12\"> Slab API changes</a></li>\n<li>1.13. <a href=\"#4.1.13\"> Structure API changes</a></li>\n<li>1.14. <a href=\"#4.1.14\"> Task Dialog API changes</a></li>\n<li>1.15. <a href=\"#4.1.15\"> Toposolid API changes</a></li>\n<li>1.16. <a href=\"#4.1.16\"> Obsolete API removal</a></li>\n</ul>\n<li>2. <a href=\"#4.2\">API additions</a></li>\n<ul class=\"toc\">\n<li>2.1. <a href=\"#4.2.1\">Add-ins and macros additions</a></li>\n<li>2.2. <a href=\"#4.2.2\">Analysis API additions</a></li>\n<li>2.3. <a href=\"#4.2.3\">Annotations API additions</a></li>\n<li>2.4. <a href=\"#4.2.4\">Array API additions</a></li>\n<li>2.5. <a href=\"#4.2.5\">MEP Fabrication API additions</a></li>\n<li>2.6. <a href=\"#4.2.6\">DirectShape API additions</a></li>\n<li>2.7. <a href=\"#4.2.7\">Dimension API additions</a></li>\n<li>2.8. <a href=\"#4.2.8\">Electrical API additions</a></li>\n<li>2.9. <a href=\"#4.2.9\">Energy Analysis API additions</a></li>\n<li>2.10. <a href=\"#4.2.10\"> IFC API additions</a></li>\n<li>2.11. <a href=\"#4.2.11\"> Import Export API additions</a></li>\n<li>2.12. <a href=\"#4.2.12\"> PDF Export API additions</a></li>\n<li>2.13. <a href=\"#4.2.13\"> Reinforcement API additions</a></li>\n<li>2.14. <a href=\"#4.2.14\"> Selection API additions</a></li>\n<li>2.15. <a href=\"#4.2.15\"> Sketched Element API additions</a></li>\n<li>2.16. <a href=\"#4.2.16\"> Structure API additions</a></li>\n<li>2.17. <a href=\"#4.2.17\"> Tag/Keynotes API additions</a></li>\n<li>2.18. <a href=\"#4.2.18\"> Toposolid API additions</a></li>\n<li>2.19. <a href=\"#4.2.19\"> UI API additions</a></li>\n<li>2.20. <a href=\"#4.2.20\"> View API additions</a></li>\n<li>2.21. <a href=\"#4.2.21\"> Link Visibility/Graphic Override API additions</a></li>\n<li>2.22. <a href=\"#4.2.22\"> RevitServer Enterprise / Revit Cloud Worksharing API additions</a></li>\n</ul>\n</ul>\n\n####<a name=\"1\"></a>Information Sources\n\nThe information below is based on the contents of the *Revit Platform API Changes and Additions.docx* document included with\nthe Revit 2025 SDK, the software developers kit available from\nthe [Revit Developer Centre](https://www.autodesk.com/developer-network/platform-technologies/revit).\n\nIt is also provided in the section on *What's New* in the Revit 2025 API help file `RevitAPI.chm` included with the SDK:\n\n<center>\n<img src=\"img/revit_2025_api_chm.png\" alt=\"Revit 2025 API help on What's New\" title=\"Revit 2025 API help on What's New\" width=\"600\"/> <!-- Pixel Height: 1,294 Pixel Width: 1,098 -->\n</center>\n\nFor convenient, easy, and effective web searching, this blog post provides a cleaned-up online HTML version of that information with numbering and table of contents added, as well as the following PDF printout of the original document included in the SDK with table of contents and page numbers added:\n\n- [Revit_Platform_API_Changes_and_Additions_2025.pdf](doc/revit_2025_api_changes_and_additions.pdf)\n\nThe *What's New* section and the *Changes and Additions* document provide important information for discovering and exploring the newly added API functionality and for later reference.\n\nIf you encounter any issues migrating your existing add-ins between different versions, this is one of the first places to look.\n\nFor detailed information on all other aspects of the Revit API, please refer to the rest of the API documentation and samples provided in the SDK.\n\nThe most important things to install and keep at hand are:\n\n- The Revit API help file `RevitAPI.chm`\n- The Visual Studio solution containing all the SDK samples, `Samples\\SDKSamples.sln`\n\nYou will regularly need both for research on how to solve specific Revit API programming tasks.\n\nMore in-depth official explanations and background information is provided by the\nonline [Revit API Developers Guide](http://help.autodesk.com/view/RVT/2025/ENU/?guid=Revit_API_Revit_API_Developers_Guide_html) included\nin the [Revit 2025 online help](http://help.autodesk.com/view/RVT/2025/ENU).\n\n####<a name=\"2\"></a>What's New in Previous Versions\n\nHere are links to previous discussions of *What's New in the Revit API*:\n\n- [What's New in the Revit 2010 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2010-api.html)\n- [What's New in the Revit 2011 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2011-api.html)\n- [What's New in the Revit 2012 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2012-api.html)\n- [What's New in the Revit 2013 API](http://thebuildingcoder.typepad.com/blog/2013/03/whats-new-in-the-revit-2013-api.html)\n- [What's New in the Revit 2014 API](http://thebuildingcoder.typepad.com/blog/2013/04/whats-new-in-the-revit-2014-api.html)\n- [What's New in the Revit 2015 API](http://thebuildingcoder.typepad.com/blog/2014/04/whats-new-in-the-revit-2015-api.html)\n- [What's New in the Revit 2016 API](http://thebuildingcoder.typepad.com/blog/2015/04/whats-new-in-the-revit-2016-api.html)\n- [What's New in the Revit 2017 API](http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html)\n- [What's New in the Revit 2017.1 API](http://thebuildingcoder.typepad.com/blog/2016/11/whats-new-in-the-revit-20171-api.html)\n- [What's New in the Revit 2018 API](http://thebuildingcoder.typepad.com/blog/2017/04/whats-new-in-the-revit-2018-api.html)\n- [Revit 2018.1 and the Visual Materials API](http://thebuildingcoder.typepad.com/blog/2017/08/revit-20181-and-the-visual-materials-api.html)\n- [Revit 2018.1.1 and 2018.1 API Docs Online](http://thebuildingcoder.typepad.com/blog/2017/09/revit-201811-fixes-cropbox-setting.html)\n- [Revit 2018.1 Visual Materials API](http://thebuildingcoder.typepad.com/blog/2017/11/modifying-material-visual-appearance.html)\n- [What's New in the Revit 2018.2 API](http://thebuildingcoder.typepad.com/blog/2017/12/whats-new-in-the-revit-20182-api.html)\n- [What's New in the Revit 2019 API](http://thebuildingcoder.typepad.com/blog/2018/04/whats-new-in-the-revit-2019-api.html)\n- [What's New in the Revit 2020 API](https://thebuildingcoder.typepad.com/blog/2019/04/whats-new-in-the-revit-2020-api.html)\n- [What's New in the Revit 2020.1 API](https://thebuildingcoder.typepad.com/blog/2019/09/whats-new-in-the-revit-20201-api.html)\n- [What's New in the Revit 2021 API](https://thebuildingcoder.typepad.com/blog/2020/04/whats-new-in-the-revit-2021-api.html)\n- [What's New in the Revit 2021.1 API](https://thebuildingcoder.typepad.com/blog/2020/08/revit-20211-sdk-and-whats-new.html)\n- [What's New in the Revit 2022 API](https://thebuildingcoder.typepad.com/blog/2021/04/whats-new-in-the-revit-2022-api.html)\n- [What's New in the Revit 2022.1 API](https://thebuildingcoder.typepad.com/blog/2021/11/whats-new-in-the-revit-20221-api.html)\n- [What's New in the Revit 2023 API](https://thebuildingcoder.typepad.com/blog/2022/04/whats-new-in-the-revit-2023-api.html)\n- [What's New in the Revit 2024 API](https://thebuildingcoder.typepad.com/blog/2023/04/whats-new-in-the-revit-2024-api.html)\n\n####<a name=\"4\"></a>Detailed Table of Contents\n\n<!-- <h1>Major changes and renovations to the Revit API -->\n\n<ul class=\"toc\">\n<li>1. <a href=\"#4.1\">API changes</a></li>\n<ul class=\"toc\">\n<li>1.1. <a href=\"#4.1.1\">CefSharp upgrade</a></li>\n<li>1.2. <a href=\"#4.1.2\">Revit now on .NET 8</a></li>\n<li>1.3. <a href=\"#4.1.3\">Add-ins and macro changes</a></li>\n<ul class=\"toc\">\n<li>1.3.1. <a href=\"#4.1.3.1\">MacroManager API</a></li>\n</ul>\n<li>1.4. <a href=\"#4.1.4\">Array API changes</a></li>\n<li>1.5. <a href=\"#4.1.5\">BRepBuilder API changes</a></li>\n<li>1.6. <a href=\"#4.1.6\">Dimension API changes</a></li>\n<li>1.7. <a href=\"#4.1.7\">Extensible Storage(Schema) API changes</a></li>\n<li>1.8. <a href=\"#4.1.8\">Electrical API changes</a></li>\n<ul class=\"toc\">\n<li>1.8.1. <a href=\"#4.1.8.1\">Distribution system</a></li>\n<li>1.8.2. <a href=\"#4.1.8.2\">Parameter Naming</a></li>\n</ul>\n<li>1.9. <a href=\"#4.1.9\">Link Visibility/Graphic Override API changes</a></li>\n<li>1.10. <a href=\"#4.1.10\"> MEP changes</a></li>\n<ul class=\"toc\">\n<li>1.10.1. <a href=\"#4.1.10.1\"> Duct Settings</a></li>\n</ul>\n<li>1.11. <a href=\"#4.1.11\"> Reinforcement API changes</a></li>\n<ul class=\"toc\">\n<li>1.11.1. <a href=\"#4.1.11.1\"> Rebar</a></li>\n</ul>\n<li>1.12. <a href=\"#4.1.12\"> Slab API changes</a></li>\n<li>1.13. <a href=\"#4.1.13\"> Structure API changes</a></li>\n<ul class=\"toc\">\n<li>1.13.1. <a href=\"#4.1.13.1\"> Bending details in view</a></li>\n<li>1.13.2. <a href=\"#4.1.13.2\"> Analytical Surface</a></li>\n</ul>\n<li>1.14. <a href=\"#4.1.14\"> Task Dialog API changes</a></li>\n<li>1.15. <a href=\"#4.1.15\"> Toposolid API changes</a></li>\n<li>1.16. <a href=\"#4.1.16\"> Obsolete API removal</a></li>\n<ul class=\"toc\">\n<li>1.16.1. <a href=\"#4.1.16.1\"> Classes</a></li>\n<li>1.16.2. <a href=\"#4.1.16.2\"> Properties</a></li>\n<li>1.16.3. <a href=\"#4.1.16.3\"> Methods</a></li>\n<li>1.16.4. <a href=\"#4.1.16.4\"> Enums</a></li>\n</ul>\n</ul>\n<li>2. <a href=\"#4.2\">API additions</a></li>\n<ul class=\"toc\">\n<li>2.1. <a href=\"#4.2.1\">Add-ins and macros additions</a></li>\n<ul class=\"toc\">\n<li>2.1.1. <a href=\"#4.2.1.1\">MacroManager API</a></li>\n</ul>\n<li>2.2. <a href=\"#4.2.2\">Analysis API additions</a></li>\n<ul class=\"toc\">\n<li>2.2.1. <a href=\"#4.2.2.1\">MEP Analytical networks</a></li>\n<li>2.2.2. <a href=\"#4.2.2.2\">MEP Duct/Pipe Pressure Loss calculation</a></li>\n<li>2.2.3. <a href=\"#4.2.2.3\">MEP Space Engineering Parameters</a></li>\n</ul>\n<li>2.3. <a href=\"#4.2.3\">Annotations API additions</a></li>\n<li>2.4. <a href=\"#4.2.4\">Array API additions</a></li>\n<ul class=\"toc\">\n<li>2.4.1. <a href=\"#4.2.4.1\">Linear Array</a></li>\n</ul>\n<li>2.5. <a href=\"#4.2.5\">MEP Fabrication API additions</a></li>\n<li>2.6. <a href=\"#4.2.6\">DirectShape API additions</a></li>\n<li>2.7. <a href=\"#4.2.7\">Dimension API additions</a></li>\n<li>2.8. <a href=\"#4.2.8\">Electrical API additions</a></li>\n<li>2.9. <a href=\"#4.2.9\">Energy Analysis API additions</a></li>\n<ul class=\"toc\">\n<li>2.9.1. <a href=\"#4.2.9.1\">gbXML export options</a></li>\n</ul>\n<li>2.10. <a href=\"#4.2.10\"> IFC API additions</a></li>\n<ul class=\"toc\">\n<li>2.10.1. <a href=\"#4.2.10.1\"> IFC Hybrid Import</a></li>\n<li>2.10.2. <a href=\"#4.2.10.2\"> IFC Category Mapping</a></li>\n</ul>\n<li>2.11. <a href=\"#4.2.11\"> Import Export API additions</a></li>\n<li>2.12. <a href=\"#4.2.12\"> PDF Export API additions</a></li>\n<li>2.13. <a href=\"#4.2.13\"> Reinforcement API additions</a></li>\n<ul class=\"toc\">\n<li>2.13.1. <a href=\"#4.2.13.1\"> Rebar</a></li>\n<li>2.13.2. <a href=\"#4.2.13.2\"> Rebar splice type options and rules</a></li>\n</ul>\n<li>2.14. <a href=\"#4.2.14\"> Selection API additions</a></li>\n<ul class=\"toc\">\n<li>2.14.1. <a href=\"#4.2.14.1\"> UI Application</a></li>\n</ul>\n<li>2.15. <a href=\"#4.2.15\"> Sketched Element API additions</a></li>\n<ul class=\"toc\">\n<li>2.15.1. <a href=\"#4.2.15.1\"> Wall APIs</a></li>\n</ul>\n<li>2.16. <a href=\"#4.2.16\"> Structure API additions</a></li>\n<ul class=\"toc\">\n<li>2.16.1. <a href=\"#4.2.16.1\"> Analytical Elements</a></li>\n<li>2.16.2. <a href=\"#4.2.16.2\"> Analytical Surface</a></li>\n<li>2.16.3. <a href=\"#4.2.16.3\"> Bending Details on Drawings</a></li>\n<li>2.16.4. <a href=\"#4.2.16.4\"> Radial Array</a></li>\n</ul>\n<li>2.17. <a href=\"#4.2.17\"> Tag/Keynotes API additions</a></li>\n<li>2.18. <a href=\"#4.2.18\"> Toposolid API additions</a></li>\n<li>2.19. <a href=\"#4.2.19\"> UI API additions</a></li>\n<ul class=\"toc\">\n<li>2.19.1. <a href=\"#4.2.19.1\"> Context Menu</a></li>\n</ul>\n<li>2.20. <a href=\"#4.2.20\"> View API additions</a></li>\n<ul class=\"toc\">\n<li>2.20.1. <a href=\"#4.2.20.1\"> SheetCollection</a></li>\n</ul>\n<li>2.21. <a href=\"#4.2.21\"> Link Visibility/Graphic Override API additions</a></li>\n<li>2.22. <a href=\"#4.2.22\"> RevitServer Enterprise / Revit Cloud Worksharing API additions</a></li>\n</ul>\n</ul>\n\n<center>\n<div style=\"border-style:solid; border-width:2px 0px 2px 0px\">\n<a name=\"4.1\"></a><h1 class=\"new\" style=\"font-weight: bold\">1. API Changes</h1>\n</div>\n</center>\n\n<a name=\"4.1.1\"></a><h2 class=\"new\">1.1. CefSharp upgrade</h2>\n\nRevit and Autodesk add-ins use the CEFsharp library internally for several features. Some third-party add-ins do so as well.  Occasionally, when different versions of the library are used, it leads to instability issues for Revit. In order to avoid version conflicts, we are clarifying what CEFsharp version is being used, and loading it prior to all add-in initializations.\n\n- In this version, Revit uses CEFsharp version v119.4.30\n\n<a name=\"4.1.2\"></a><h2 class=\"new\">1.2. Revit now on .NET 8</h2>\n\nThe Revit API for Revit 2025 is built on .NET 8.\nThis upgrade keeps Revit up to date with the latest .NET features, performance improvements, and security fixes.\n\nAddins for Revit 2025 will need to be rebuilt on .NET 8.\n\n<a name=\"4.1.3\"></a><h2 class=\"new\">1.3. Add-ins and macro changes</h2>\n\n<a name=\"4.1.3.1\"></a><h3 class=\"new\">1.3.1. MacroManager API</h3>\n\nUpdated Revit macro tool with modernized UI and code editor that also supports modern .NET API. Following methods were changed.\n\n- Deprecated member(s) &rarr; Replacement members(s)\n- MacroManager.AddModule(ModuleSettings moduleSettings) &rarr; MacroManager.AddModule(ModuleSettings moduleSettings, IModuleMaker* maker)\n- UIMacroManager.AddModule(ModuleSettings moduleSettings, MacroEnvironment environment) &rarr; UIMacroManager.AddModule(ModuleSettings moduleSettings, MacroEnvironment environment, IModuleMaker* maker)\n\nThe following properties were deprecated:\n\n- ModuleSettings.Description\n- MacroModule.MacroLevel\n- MacroModule.Description\n- Macro.Description\n- MacroManage.MacroLevel\n\nThe following methods were deprecated:\n\n- MacroModule.AddMacro()\n- MacroModule.RemoveMacro()\n- MacroManager.GetDocumentMacroSecurityOptions()\n- MacroManager.SetDocumentMacroSecurityOptions()\n- MacroManager.GetMacroManager()\n- MacroManager.IsDocLvlMacro()\n- UIMacroManager.EditModule()\n- UIMacroManager.EditMacro()\n- UIMacroManager.StepInto()\n- UIMacroManager.GetMacroManager()\n- UIMacroManager.GetUIDocumentMacroSecurityOptions()\n- UIMacroManager.SetUIDocumentMacroSecurityOptions()\n\nThe following enums were deprecated:\n\n- Deprecated values of enum Autodesk.Revit.DB.Macro.MacroLanguageType, only C# is supported.\n    - MacroLanguageType.VBNet\n    - MacroLanguageType.Python\n- Autodesk.Revit.DB.Macros.MacroLevel\n- Autodesk.Revit.DB.Macros.DocumentMacroOptions\n- UIDocumentMacroOptions\n\n<a name=\"4.1.4\"></a><h2 class=\"new\">1.4. Array API changes</h2>\n\nThe valid arrays size differs in project and family documents. The replacement method takes the document as an argument so we get an accurate answer.\n\n- Deprecated member(s) &rarr; Replacement members(s)\n- LinearArray.IsValidArraySize() &rarr; LinearArray.IsValidNumberOfMembers()\n- RadialArray.IsValidArraySize() &rarr; RadialArray.IsValidNumberOfMembers()\n\n<a name=\"4.1.5\"></a><h2 class=\"new\">1.5. BRepBuilder API changes</h2>\n\nBRepBuilder now accepts HermiteSurface as a permitted support surface type for faces.\n\nChanged behavior:\n\n- BRepBuilder.IsPermittedSurfaceType() will now return true for HermiteSurface.\n- BRepBuilderSurfaceGeometry.Create() can now accept a HermiteSurface and use it to create the corresponding BRepBuilderSurfaceGeometry.\n\n<a name=\"4.1.6\"></a><h2 class=\"new\">1.6. Dimension API changes</h2>\n\nAfter the introduction of LinearDimension class, when filtering for Dimensions, linear dimensions will return as type LinearDimension (child class) instead of Dimension (parent class).\n\nMethods affected:\n\n- typeof(), etc. : If using typeof() or .getType().Equals(), to check if a LinearDimension is Dimension, it will not work due to the nature of the derived classes.\n\n<a name=\"4.1.7\"></a><h2 class=\"new\">1.7. Extensible Storage(Schema) API changes</h2>\n\nFixed two API(s) for the Extensible Storage feature:\n\n- Document.EraseSchemaAndAllEntities() &ndash; Fixed the API to ensure it removes entities from all parts of a Revit model.\n- ExtensibleStorageFilter() &ndash; Fixed the API to ensure it filters all elements associated with extensible storage data based on specific Schema IDs.\n\n<a name=\"4.1.8\"></a><h2 class=\"new\">1.8. Electrical API changes</h2>\n\n<a name=\"4.1.8.1\"></a><h3 class=\"new\">1.8.1. Distribution system</h3>\n\nThe following properties were modified to support high-leg delta and single-phase distribution system.\n\n- Deprecated member(s) &rarr; Replacement members(s)\n- AnalyticalPowerSourceData.Voltage &rarr; AnalyticalPowerSourceData.AssignedVoltage\n- AnalyticalDistributionNodePropertyData.NumberOfPhases  &rarr; AnalyticalDistributionNodePropertyData.AssignedPhasesNumber &ndash; For analytical power source, bus, transformer, transfer switch, the number of electrical phases is read only in Revit 2025 and assigned through the distribution system. For analytical equipment load, we suggest you use the AnalyticalEquipmentLoadData.PhasesNumber property.\n- AnalyticalBusData.Voltage &rarr; AnalyticalBusData.AssignedVoltage\n- AnalyticalTransferSwitchData.Voltage &rarr; AnalyticalTransferSwitchData.AssignedVoltage\n\n<a name=\"4.1.8.2\"></a><h3 class=\"new\">1.8.2. Parameter Naming</h3>\n\nImproved naming for the following electrical parameters to remove ambiguity, improve accuracy, and better adhere with industry terminology.\n\n- Parameter/String Attribute: Text(before) &rarr; Text(after)\n- RBS_ELEC_PANEL_TOTALESTLOAD_PARAM: Total Estimated Demand &rarr; Total Demand Apparent Power\n- RBS_ELEC_PANEL_TOTALLOAD_PARAM: Total Connected &rarr; Total Connected Apparent Power\n- RBS_ELEC_APPARENT_LOAD_PHASEA: Apparent Load Phase A &rarr; Apparent Power Phase A\n- RBS_ELEC_APPARENT_LOAD_PHASEB: Apparent Load Phase B &rarr; Apparent Power Phase B\n- RBS_ELEC_APPARENT_LOAD_PHASEC: Apparent Load Phase C &rarr; Apparent Power Phase C\n- RBS_ELEC_DEMAND_LOAD_PHASEA: Demand Load Phase A &rarr; Demand Apparent Power Phase A\n- RBS_ELEC_DEMAND_LOAD_PHASEB: Demand Load Phase B &rarr; Demand Apparent Power Phase B\n- RBS_ELEC_DEMAND_LOAD_PHASEC: Demand Load Phase C &rarr; Demand Apparent Power Phase C\n- RBS_ELEC_APPARENT_LOAD: Apparent Load &rarr; Apparent Power\n- RBS_ELEC_APPARENT_LOAD_PHASE1: Apparent Load Phase 1 &rarr; Apparent Power Phase 1\n- RBS_ELEC_APPARENT_LOAD_PHASE2: Apparent Load Phase 2 &rarr; Apparent Power Phase 2\n- RBS_ELEC_APPARENT_LOAD_PHASE3: Apparent Load Phase 3 &rarr; Apparent Power Phase 3\n- RBS_ELEC_TRUE_LOAD: True Load &rarr; True Power\n- RBS_ELEC_TRUE_LOAD_PHASE1: True Load Phase 1 &rarr; True Power Phase 1\n- RBS_ELEC_TRUE_LOAD_PHASE2: True Load Phase 2 &rarr; True Power Phase 2\n- RBS_ELEC_TRUE_LOAD_PHASE3: True Load Phase 3 &rarr; True Power Phase 3\n- RBS_ELEC_TRUE_LOAD_PHASEA: True Load Phase A &rarr; True Power Phase A\n- RBS_ELEC_TRUE_LOAD_PHASEB: True Load Phase B &rarr; True Power Phase B\n- RBS_ELEC_TRUE_LOAD_PHASEC: True Load Phase C &rarr; True Power Phase C\n- RBS_ELEC_DEMANDFACTOR_DEMANDLOAD_PARAM: Estimated Demand Load &rarr; Demand Apparent Power\n- RBS_ELEC_DEMANDFACTOR_LOAD_PARAM: Connected Load &rarr; Connected Apparent Power\n- RBS_ELEC_PANEL_BRANCH_CIRCUIT_APPARENT_LOAD_PHASEA: Branch Circuit Apparent Load Phase A  &rarr; Branch Circuit Apparent Power Phase A\n- RBS_ELEC_PANEL_BRANCH_CIRCUIT_APPARENT_LOAD_PHASEB: Branch Circuit Apparent Load Phase B  &rarr; Branch Circuit Apparent Power Phase B\n- RBS_ELEC_PANEL_BRANCH_CIRCUIT_APPARENT_LOAD_PHASEC: Branch Circuit Apparent Load Phase C  &rarr; Branch Circuit Apparent Power Phase C\n- RBS_ELEC_PANEL_FEED_THRU_LUGS_APPARENT_LOAD_PHASEA: Feed Through Lugs Apparent Load Phase A &rarr; Feed Through Lugs Apparent Power Phase A\n- RBS_ELEC_PANEL_FEED_THRU_LUGS_APPARENT_LOAD_PHASEB: Feed Through Lugs Apparent Load Phase B &rarr; Feed Through Lugs Apparent Power Phase B\n- RBS_ELEC_PANEL_FEED_THRU_LUGS_APPARENT_LOAD_PHASEC: Feed Through Lugs Apparent Load Phase C &rarr; Feed Through Lugs Apparent Power Phase C\n- RBS_ELEC_PANEL_TOTALESTLOAD_OTHER_PARAM: Other Total Estimated Demand  &rarr; Other Total Demand Apparent Power\n- RBS_ELEC_LOADSUMMARY_CONNECTED_LOAD_PARAM: Connected Load (VA) &rarr; Connected Apparent Power\n- RBS_ELEC_LOADSUMMARY_DEMAND_LOAD_PARAM: Estimated Demand (VA) &rarr; Demand Apparent Power\n- RBS_ELEC_PANEL_TOTALESTLOAD_POWER_PARAM: Power Total Estimated Demand &rarr; Power Total Demand Apparent Power\n- RBS_ELEC_PANEL_TOTALESTLOAD_LIGHT_PARAM: Lighting Total Estimated Demand &rarr; Lighting Total Demand Apparent Power\n- RBS_ELEC_PANEL_TOTALESTLOAD_HVAC_PARAM: HVAC Total Estimated Demand &rarr; HVAC Total Demand Apparent Power\n- RBS_ELEC_PANEL_TOTALLOAD_HVAC_PARAM: HVAC Total Connected &rarr; HVAC Total Connected Apparent Power\n- RBS_ELEC_PANEL_TOTALLOAD_LIGHT_PARAM: Lighting Total Connected &rarr; Lighting Total Connected Apparent Power\n- RBS_ELEC_PANEL_TOTALLOAD_POWER_PARAM: Power Total Connected &rarr; Power Total Connected Apparent Power\n- RBS_ELEC_PANEL_TOTALLOAD_OTHER_PARAM: Other Total Connected &rarr; Other Total Connected Apparent Power\n\n<a name=\"4.1.9\"></a><h2 class=\"new\">1.9. Link Visibility/Graphic Override API changes</h2>\n\nThe following methods were modified to support custom settings type.\n\n- Revit.DB.RevitLinkGraphicsSettings.LinkVisibilityType\n- Revit.DB.View.SetLinkOverrides(ElementId, RevitLinkGraphicsSettings) &ndash; Supports RevitLinkGraphicsSettings of Custom type.\n- Revit.DB.View.GetLinkOverrides(ElementId) &ndash; Removed two validators:\n    - AreGraphicsOverridesAllowed()\n    - IsLinkOverridesSupported()\n\n<a name=\"4.1.10\"></a><h2 class=\"new\">1.10.  MEP changes</h2>\n\n<a name=\"4.1.10.1\"></a><h3 class=\"new\">1.10.1.  Duct Settings</h3>\n\nTwo new properties DuctSettings.AirDynamicViscosity and DuctPressureDropData.DynamicViscosity were added to clarify the value used in the duct pressure loss calculation. They replaced the deprecated properties that were kinematic viscosity.\n\n- Deprecated members(s)&rarr; Replacement member(s)\n- RbsDuctSettingsElem.AirViscosity &rarr; DuctSettings.AirDynamicViscosity\n- DuctPressureDropData.Viscosity &rarr; DuctPressureDropData.DynamicViscosity\n- DuctFittingAndAccessoryData.AirViscosity &rarr; DuctSettings.AirDynamicViscosity\n\n<a name=\"4.1.11\"></a><h2 class=\"new\">1.11.  Reinforcement API changes</h2>\n\n<a name=\"4.1.11.1\"></a><h3 class=\"new\">1.11.1.  Rebar</h3>\n\n- Deprecated member(s) &rarr; Replacement member(s)\n- RebarConstraintsManager.SetPreferredConstraintForHandle(RebarConstrainedHandle handle, RebarConstraint constraint) &rarr; RebarConstraintsManager.SetPreferredConstraint(RebarConstraint constraint) &ndash; Use the new replacement method to set RebarConstraint as preferred constraint target that avoids issues where one could apply the RebarConstraint bounded to handle 'A' to another handle 'B'.\n- RebarConstraintsManager.GetConstraintCandidatesForHandle(RebarConstrainedHandle handle)\n  &rarr; RebarConstraintsManager.GetConstraintCandidatesForHandle(Structure.RebarConstrainedHandle, ElementId) and\n  RebarConstraintsManager.GetConstraintCandidatesForHandle(Structure.RebarConstrainedHandle, Reference)\n  &ndash; For getting the direct neighbors of a rebar host, use Structure.RebarHostData.GetRebarHostDirectNeighbors(Element hostElement);\n  for getting all the rebars in a host, use Structure.RebarHostData.GetRebarsInHost()\n- Rebar.DistributionType;\n  the enum values\n  `Uniform` `0` representing uniform distribution and\n  `VaryingLength` `1` representing varying length distribution\n  &rarr; RebarShapeDrivenAccessor.UseRebarConstraintsToProduceVaryingBars\n\n<a name=\"4.1.12\"></a><h2 class=\"new\">1.12.  Slab API changes</h2>\n\nThe following methods were added for adding split line on SlabShapeEditor.\n\n- Deprecated member(s) &rarr; Replacement member(s)\n- SlabShapeEditor.DrawPoint &rarr; SlabShapeEditor.AddPoint(XYZ point)\n- SlabShapeEditor.DrawSplitline &rarr; SlabShapeEditor.AddSplitLine(SlabShapeVertex startVertex, SlabShapeVertex endVertex)\n\n<a name=\"4.1.13\"></a><h2 class=\"new\">1.13.  Structure API changes</h2>\n\n<a name=\"4.1.13.1\"></a><h3 class=\"new\">1.13.1.  Bending details in view</h3>\n\nThe following parameters were renamed without any changes to their functionality.\n\n- Deprecated member(s) &rarr; Replacement member(s)\n- BENDING_DETAIL_SEGMENET_REPESENTATION &rarr; BENDING_DETAIL_SEGMENT_REPRESENTATION\n- BENDING_DETAIL_REPESENTATION_FOR_3D_BARS  &rarr; BENDING_DETAIL_REPRESENTATION_FOR_3D_BARS\n\n<a name=\"4.1.13.2\"></a><h3 class=\"new\">1.13.2.  Analytical Surface</h3>\n\nThe following new method was added that allows users to verify if contour is valid for this Analytical Surface.\n\n- Deprecated members(s) &rarr; Replacement member(s)\n- AnalyticalSurfaceBase.isCurveLoopValid() &rarr; AnalyticalSurfaceBase.IsOuterContourValid()\n\n<a name=\"4.1.14\"></a><h2 class=\"new\">1.14.  Task Dialog API changes</h2>\n\nSupport added so that FooterText property can contain a hyperlink of the form \"rvthelptopic:[topic]\" to launch Revit's contextual for the topic specified. Previously, the only option was to specify \"#\" as the hyperlink and set the Dialog Id, making it difficult to share dialogs with same Id, but different context and associated Help.\n\n<a name=\"4.1.15\"></a><h2 class=\"new\">1.15.  Toposolid API changes</h2>\n\nThe following parameters were renamed without any changes to their functionality.\n\n- Deprecated member(s) &rarr; Replacement member(s)\n- SSE_POINT_ElEVATION_BASE_TYPE &rarr; SSE_POINT_ELEVATION_BASE_TYPE\n- SSE_POINT_ElEVATION &rarr; SSE_POINT_ELEVATION\n- TOPOSOLID_SUBDIVIDE_HEIGNT &rarr; TOPOSOLID_SUBDIVIDE_HEIGHT\n\n<a name=\"4.1.16\"></a><h2 class=\"new\">1.16.  Obsolete API removal</h2>\n\nThe following API members and classes which had previously been marked Deprecated have been removed in this release. Consult the API documentation from prior releases for information on the replacements to use:\n\n<a name=\"4.1.16.1\"></a><h3 class=\"new\">1.16.1.  Classes</h3>\n\n- DocumentEntryPoint\n\n<a name=\"4.1.16.2\"></a><h3 class=\"new\">1.16.2.  Properties</h3>\n\n- ViewSchedule.ImageRowHeight\n- UIThemeManager.DefaultTheme\n\n<a name=\"4.1.16.3\"></a><h3 class=\"new\">1.16.3.  Methods</h3>\n\n- FamilyManager.AddParameter(ExternalDefinition, BuiltInParameterGroup, bool)\n- FamilyManager.AddParameter(string, BuiltInParameterGroup, Category, bool)\n- FamilyManager.ReplaceParameter(FamilyParameter, ExternalDefinition, BuiltInParameterGroup, bool)\n- FamilyManager.ReplaceParameter(FamilyParameter, string, BuiltInParameterGroup, bool)\n- FamilyManager.IsUserAssignableParameterGroup()\n- BindingMap.Insert()\n- BindingMap.ReInsert()\n- FilterNumericLess.Evaluate(int, int)\n- FilterNumericLessOrEqual.Evaluate(int, int)\n- FilterNumericGreater.Evaluate(int, int)\n- FilterNumericGreaterOrEqual.Evaluate(int, int)\n- FilterNumericEquals.Evaluate(int, int)\n- ParameterFilterRuleFactory.CreateEqualsRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateNotEqualsRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateGreaterRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateGreaterOrEqualRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateLessRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateLessOrEqualRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateContainsRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateNotContainsRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateBeginsWithRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateNotBeginsWithRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateEndsWithRule(ElementId, AString, bool)\n- ParameterFilterRuleFactory.CreateNotEndsWithRule(ElementId, AString, bool)\n\n<a name=\"4.1.16.4\"></a><h3 class=\"new\">1.16.4.  Enums</h3>\n\n- Autodesk.Revit.DB.Mechanical.OccupancyUnit &ndash; Removed enum value OccupancyUnit.UseDefaultValues\n- Autodesk.Revit.DB.BaseLoadOn &ndash; Removed enum value BaseLoadOn.kUseDefaultLoad\n\n<center>\n<div style=\"border-style:solid; border-width:2px 0px 2px 0px\">\n<a name=\"4.2\"></a><h1 class=\"new\" style=\"font-weight: bold\">2. API Additions</h1>\n</div>\n</center>\n\n<a name=\"4.2.1\"></a><h2 class=\"new\">2.1. Add-ins and macros additions</h2>\n\n<a name=\"4.2.1.1\"></a><h3 class=\"new\">2.1.1. MacroManager API</h3>\n\nThe new property:\n\n- MacroModule.ModuleFolder &ndash; Returns the folder of the module.\n\nThe new interface:\n\n- IModuleMaker\n\nallows users to create new module project by implementing this interface.\n\nThe new event:\n\n- MacroUpdated\n\nis raised after the macro modules are updated.\n\n<a name=\"4.2.2\"></a><h2 class=\"new\">2.2. Analysis API additions</h2>\n\n<a name=\"4.2.2.1\"></a><h3 class=\"new\">2.2.1. MEP Analytical networks</h3>\n\nThe new constructor allows users to traverse both sides of the specified analytical segment. In comparison, the existing constructor MEPNetworkIterator(Document, MEPAnalyticalNode, MEPAnalyticalSegment) only traverses one side of the analytical segment.\n\n- Autodesk.Revit.DB.Analysis.MEPNetworkIterator(Document, MEPAnalyticalSegment)\n\n<a name=\"4.2.2.2\"></a><h3 class=\"new\">2.2.2. MEP Duct/Pipe Pressure Loss calculation</h3>\n\nUsers now have access to Duct/Pipe pressure loss characteristic allowing them to correlate the element and understand the calculation logic.\n\nThe new classes:\n\n- Autodesk.Revit.DB.Analysis.CriticalPathCollector &ndash; Provides the calculated flow and pressure drop values of the network critical path, so users can better select their equipment.\n- Autodesk.Revit.DB.Analysis.CriticalPathIterator &ndash; Allows users to traverse the analytical segments on the network critical path.\n\n<a name=\"4.2.2.3\"></a><h3 class=\"new\">2.2.3. MEP Space Engineering Parameters</h3>\n\nUsers now have access to building operating day and year schedules allowing them to create and edit schedules that describe the usage of buildings (occupancy, power, lighting) for use in energy analysis.\n\nThe new classes:\n\n- Autodesk.Revit.DB.Analysis.BuildingOperatingDaySchedule &ndash; An element that represents the 24 hour operating schedule.\n- Autodesk.Revit.DB.Analysis.BuildingOperatingYearSchedule &ndash; An element that represents the 365 day operating schedule.\n\nThe new methods:\n\n- BuildingOperatingDaySchedule.Create(Document, Name) &ndash; Allows creation of a new BuildingOperatingDaySchedule with that name and adds it to the document. It returns the newly created BuildingOperatingDaySchedule element, with all usages set to 0.\n- BuildingOperatingDaySchedule.GetValueForHour(Hour)\n- BuildingOperatingDaySchedule.SetValueForHour(Hour, Usage)\n- BuildingOperatingYearSchedule.Create(Document, DaySchedule, Name) &ndash; Allows creation of a new BuildingOperatingYearSchedule with that name and adds it to the document. It returns the newly created BuildingOperatingDaySchedule element, with all usages set to daySchedule.\n- BuildingOperatingDaySchedule.GetScheduleForDay(Day)\n- BuildingOperatingDaySchedule.SetValueForHour(Day, DaySchedule)\n\nThe new properties:\n\n- BuildingOperatingDaySchedule.ScheduleName\n- BuildingOperatingYearSchedule.ScheduleName\n\n<a name=\"4.2.3\"></a><h2 class=\"new\">2.3. Annotations API additions</h2>\n\nExposing the new class to fix different behavior of span direction symbol between UI and API.\n\nThe new class:\n\n- Autodesk.Revit.DB.SpanDirectionSymbol\n\nrepresents an instance of a Span Direction Symbol in Autodesk Revit.\n\n<a name=\"4.2.4\"></a><h2 class=\"new\">2.4. Array API additions</h2>\n\n<a name=\"4.2.4.1\"></a><h3 class=\"new\">2.4.1. Linear Array</h3>\n\nThe new methods:\n\n- LinearArray.GetMinimumSize() &ndash; Allows users to get the minimum size of a linear array based on if the document is a family document.\n- LinearArray.GetNumberOfMembersIncludingPlaceholders() &ndash; Allows users to get the number of members in a linear array, including placeholders that are still there in families with small array counts.\n- LinearArray.IsValidNumberOfMembers() &ndash; Indicates whether the input count is a valid size for an array based on the document.\n\n<a name=\"4.2.5\"></a><h2 class=\"new\">2.5. MEP Fabrication API additions</h2>\n\nThe new methods in the FabricationConfiguration class now provides support to check for bad connections between fabrication parts prior to reloading the configuration.\n\n- CheckConnectionsForAllFabricationParts() &ndash; Allows users to check the connections for all fabrication parts in the current project. It will create reviewable warnings for all bad connections found.\n- ValidateConnectionsForAllFabricationParts() &ndash; Allows users to validate all fabrication part connections in the current project. Invalid connections found will be added to the connection validation information class. The validation checks for bad alignments or gaps, incompatible connection types, mismatches of size, mismatches of shapes.\n- PostReviewableWarningsForBadConnections() &ndash; Reviewable warnings are created for all entries contained in the connection validation information.\n- GetUpdatedStraightsFromValidateConnections() &ndash; Allows users to get the set of element identifiers of fabrication part straights that were previously updated. If no straights were updated, it will return an empty set of element identifiers.\n\n<a name=\"4.2.6\"></a><h2 class=\"new\">2.6. DirectShape API additions</h2>\n\nThe new method:\n\n- DirectShapeType.SetShape(IList&lt;GeometryObject&gt;, DirectShapeTargetViewType) &ndash; Allows users to set a custom plan view representation of a DirectShapeType.\n\n<a name=\"4.2.7\"></a><h2 class=\"new\">2.7. Dimension API additions</h2>\n\nUsers can now create radial, linear and arc length dimensions via the API in a project document.\n\nThe new classes:\n\n- RadialDimension\n- ArchLengthDimension\n- LinearDimension\n\nThe new methods:\n\n- RadialDimension.Create(Document, View, Reference, XYZ origin, bool isDiameterDimension)\n- ArcLengthDimension.Create(Document, View, Arc, Reference, Reference firstRef, Reference secondRef)\n- LinearDimension.Create(Document, View, Line, IList&lt;Reference&gt;)\n\n<a name=\"4.2.8\"></a><h2 class=\"new\">2.8. Electrical API additions</h2>\n\nAdded functionality for high-leg delta and single-phase distribution system. User can now create and modify high-leg delta distribution system and single-phase load in electrical analytical distribution system, and get the per phase current on each node.\n\nThe new classes:\n\n- Autodesk.Revit.DB.Electrical.ElectricalPerPhaseData &ndash; Represents per phase values including current and load.\n- Autodesk.Revit.DB.Electrical.AnalyticalPowerDistributableNodeData &ndash; Represents the data and parameters of a power distributable node.\n- Autodesk.Revit.DB.Electrical.AnalyticalTransformerData &ndash; Represents the data and parameters of analytical transformer node.\n\nThe new properties:\n\n- Electrical.DistributionSysType.HighLegPhase &ndash; Represents the high-leg phase in the 3 phase 4 wires delta distribution system.\n- AnalyticalPowerSourceData.ApparentPowerRating &ndash; Represents the apparent power rating value of the analytical power source.\n- AnalyticalDistributionNodePropertyData.ConnectedPhases &ndash; Represents the electrical connected phases of the electrical analytical node to its upstream node.\n- AnalyticalEquipmentLoadData.PhasesNumber &ndash; Represents the number of electrical phases of the analytical equipment load.\n- AnalyticalEquipmentLoadData.PowerFactorState &ndash; Represents the PowerFactorState type of the analytical equipment load.\n- AreaBasedLoadData.ConnectedPhases &ndash; Represents the electrical connected phases of the area based load to its upstream node.\n- AreaBasedLoadData.PhasesNumber &ndash; Allows users to set the number of electrical phases of the area based load.\n- AreaBasedLoadData.PowerFactorState &ndash; Represents the power factor state of the area based load.\n- AreaBasedLoadType.PowerFactorState &ndash; Represents the power factor state of the area based load type.\n\nThe new enums:\n\n- Autodesk.Revit.DB.Electrical.ElectricalPhaseLine &ndash; Defines the electrical phase.\n- Autodesk.Revit.DB.Electrical.ElectricalConnectedPhases &ndash; Defines the electrical connected phases of an electrical analytical node.\n\n<a name=\"4.2.9\"></a><h2 class=\"new\">2.9. Energy Analysis API additions</h2>\n\n<a name=\"4.2.9.1\"></a><h3 class=\"new\">2.9.1. gbXML export options</h3>\n\nWe now provide support for legacy export of gbXML based on a conceptual energy analytical model from a conceptual mass model from add-ins/add-ons.\n\nThe new methods:\n\n- GetMassIds() &ndash; Allows users to get a list of masses to use as shading surfaces in the exported gbXML.\n- GetMassZoneIds() &ndash; Allows users to get a list of mass zones to analyze in the exported gbXML.\n\nThe new constructor:\n\n- GBXMLExportOptions(massZoneIds, massIds) &ndash; Allows users to construct a new instance of the options used to export a mass model to gbXML.\n\nThe new property:\n\n- IsConceptual &ndash; Indicates if the exported gbXML is based on a conceptual energy analytical model from a conceptual mass model.\n\n<a name=\"4.2.10\"></a><h2 class=\"new\">2.10.  IFC API additions</h2>\n\n<a name=\"4.2.10.1\"></a><h3 class=\"new\">2.10.1.  IFC Hybrid Import</h3>\n\n- IFCHybridImport.UpdateElements() &ndash; The new method allows users to update elements previously imported via a Hybrid IFC Link operation.\n- IFCHybridImport.GetIFCStepIdToElementIdMap() &ndash; The new method allows users to retrieve the association between the original IFC STEP identifiers and the created or updated Elements.\n\n<a name=\"4.2.10.2\"></a><h3 class=\"new\">2.10.2.  IFC Category Mapping</h3>\n\nAdded functionality that allows user to control the way how Revit categories are mapped to IFC Classes during IFC Export. User can now create, retrieve and modify IFC category mapping templates.\n\nThe new classes:\n\n- Autodesk.Revit.DB.IFCCategoryTemplate &ndash; Represents an element that contains IFC category mapping template stored in a Revit document.\n- Autodesk.Revit.DB.ExportIFCCategoryKey &ndash; Represents a Revit category item stored in a template.\n- Autodesk.Revit.DB.ExportIFCCategoryInfo &ndash; Represents the mapped IFC information stored in the template.\n\nThe new enum:\n\n-  CustomSubCategoryId &ndash; Represents pseudo sub-categories that can appear in a mapping template\n\nhas the following values:\n\n- None &ndash; Represents the default value for most Revit categories and subcategories.\n- InteriorWall &ndash; Represents the custom id for interior walls.\n- ExteriorWall &ndash; Represents the custom id for exterior walls.\n- FoundationWall &ndash; Represents the custom id for foundation walls.\n- RetainingWall &ndash; Represents the custom id for retaining walls.\n- Coreshaft &ndash; Represents the custom id for cores/shafts.\n- Soffit &ndash; Represents the custom id for soffits.\n\n<a name=\"4.2.11\"></a><h2 class=\"new\">2.11.  Import Export API additions</h2>\n\nThe new functionality provides support for importing, linking and exporting files of STEP format.\n\nThe new class:\n\n- STEPImportOptions\n\nrepresents the options for STEP formats.\n\nThe new methods, uses the new class STEPImportOptions:\n\n- Document.Import(String, STEPImportOptions, View)\n- Document.Link(String, STEPImportOptions, View)\n- Document.Export(String, String, STEPExportOptions)\n\n<a name=\"4.2.12\"></a><h2 class=\"new\">2.12.  PDF Export API additions</h2>\n\nDocument export for PDF now allows using a separate Revit Worker to create the PDF in the background, leaving the main Revit process free for other work. FileExporting and FileExported events are triggered at the start and end of the export job respectively. There are new API calls for PDFExportOptions, FileExportedEventArgs, and FileExportingEventArgs. Third party Addins may interfere with the PDF generation using this feature if they change the appearance of Elements in a way that is not serialized.\n\nThe new method:\n\n- PDFExportOptions.SetExportInBackground() &ndash; When set to true, Document.Export launches a new process to export the PDF that leaves Revit unblocked. Changes to the document made after the export has started are not accounted for in the PDF.\n\nThe classes FileExportingEventArgs and FileExportedEventArgsBoth have a new member:\n\n- BackgroundOperation &ndash; The value is true if a background process was requested for the background operation that raised the event.\n\n<a name=\"4.2.13\"></a><h2 class=\"new\">2.13.  Reinforcement API additions</h2>\n\n<a name=\"4.2.13.1\"></a><h3 class=\"new\">2.13.1.  Rebar</h3>\n\nUsers now have the ability to create and modify rebar constraints to surfaces.\n\nThe new enum:\n\n- RebarConstraintsStatus\n\nrepresents the status of the constraints.\n\nThe new value for RebarConstraintType enum:\n\n- ToSurface\n\nrepresents handle is constrained to a surface.\n\nThe new methods:\n\n- RebarConstraint.CreateConstraintToSurface() &ndash; Allows users to create a constraint of ToSurface type for a given RebarConstrainedHandle.\n- RebarConstraint.GetSurfaceForConstraintToSurface() &ndash; Allows users to retrieve the surface for a constraint of ToSurface type.\n- RebarConstraint.IsValidSurfaceToConstraintHandleTo() &ndash; Allows users to check if the surface can be used to create a constraint to it for a given RebarConstrainedhandle.\n- RebarConstraint.IsToSurface() &ndash; Returns true if the RebarConstraintType of the RebarConstraint is ToSurface, false otherwise.\n- RebarConstraint.GetRebarConstrainedHandle() &ndash; Allows users to get the RebarConstrainedHandle for which this constraint is.\n- RebarConstraint.FlipSideForClearBarSpacingZeroDistanceConstraint() &ndash; This method in RebarConstriant is applied for bar-on-bar constraint.  It flips the side on which a RebarConstrainedHandle constrained using clear bar distance with zero offset connects to another Rebar target handle.\n- RebarConstrainedHandle.IsEqual() &ndash; Returns true if the objects are equal, false otherwise.\n- RebarConstraintsManager.SetPreferredConstraintsToSurfaceForHandles() &ndash; For ShapeDriven rebar it will set a preferred 'ToSurface' RebarConstraint for each input handle. The surface that will be used by the constraint is the current surface that is used to compute the position of the handle. This function applies only for shape driven Rebar, and will throw exception for free form rebar.\n- RebarConstraintsManager.SetPreferredConstraint() &ndash; Allows users to set the RebarConstraint as preferred constraint for its RebarConstrainedHandle.\n- RebarConstraintsManager.GetAutomaticConstraintCandidatesForHandle() &ndash; For shape driven rebar returns all possible automatic RebarConstraints that could be used for a specified RebarConstrainedHandle. For free form rebar it returns an empty list.\n\n<a name=\"4.2.13.2\"></a><h3 class=\"new\">2.13.2.  Rebar splice type options and rules</h3>\n\nAdded functionality for splicing the rebar. Users can now splice a rebar, remove the splice (keeping the bars separated), unify into one bar, modify the data related to splice and modify the constraints of the spliced bars seeing as splice chain.\n\nThe new classes:\n\n- Autodesk.Revit.DB.Structure.RebarSpliceTypeUtils &ndash; Utility class for dealing with rebar splice type operations.\n- Autodesk.Revit.DB.Structure.RebarSpliceOptions\n- Autodesk.Revit.DB.Structure.RebarSpliceGeometry &ndash; This class consists of a vector and a point which will be projected to the nearest rebar curve.\n- Autodesk.Revit.DB.Structure.RebarSpliceRules\n- Autodesk.Revit.DB.Structure.RebarSplice &ndash; A class that can used to access the data between two connected rebars.\n- Autodesk.Revit.DB.Structure.RebarSpliceByRulesResult\n- Autodesk.Revit.DB.Structure.RebarSpliceUtils\n\nThe new methods:\n\n- RebarBarType.GetLapLength()\n- RebarBarType.SetLapLength()\n- RebarBarType.GetAutoCalculatedLapLength()\n- RebarBarType.SetAutoCalculatedLapLength()\n- RebarBarType.GetStaggerLength)\n- RebarBarType.SetStaggerLength()\n- RebarBarType.GetAutoCalculatedStaggerLength()\n- RebarBarType.SetAutoCalculatedStaggerLength()\n- Rebar.GetRebarSplice()\n- Rebar.RemoveSplice()\n- Rebar.GetLapLength()\n- Rebar.GetSpliceStaggerLength()\n- RebarConstrainedHandle.GetHandleSurface()\n- RebarConstrainedHandle.Move()\n- RebarConstrainedHandle.CanSetBehavior()\n- RebarConstrainedHandle.GetPossibleHandleBehaviors()\n- RebarHostData.GetRebarHostDirectNeighbors() &ndash; Returns the first level of neighbors for the provided host that can host reinforcement, i.e. elements that are joined directly to the provided host element and not the neighbors of the joined elements.\n\nThe new properties:\n\n- RebarSpliceOptions.SpliceTypeId\n- RebarSpliceOptions.SplicePosition\n- Rebar.CanHaveVaryingLengthBars\n- Rebar.HasVariableLengthBars\n- RebarShapeDrivenAccessor.UseRebarConstraintsToProduceVaryingBars\n- RebarConstrainedHandle.HandleBehavior\n\nThe new enums:\n\n-  RebarSplicePosition &ndash; Describes the position of the splice. It has the following values:\n    - End1 &ndash; Lap is towards the start of the splice chain.\n    - Middle &ndash; Lap goes into both directions.\n    - End2 &ndash; Lap is towards the end of the splice chain.\n- RebarSpliceShiftOption &ndash; Describes the way bars are shifted in the splice relation. It has the following values:\n    - BarPlane &ndash; Represents the bar plane is shifted so that the spliced rebars are not clashing.\n    - None &ndash; The bars are not shifted at all.\n- RebarSpliceByRulesRunOutPosition &ndash; Describes the run-out position. It has the following values:\n    - Start &ndash; Represents the rest will remain at the start of the bar.\n    - End &ndash; Represents the rest will remain at the end of the bar\n- RebarSpliceError &ndash; Represents the states for splicing a Rebar. It has the following values:\n    - Success\n    - Unknown &ndash; Represents there is an unexpected error.\n    - InvalidRebar &ndash; Represents free form rebars or shape driven rebars that are multiplanar or having shape whose definition is RebarShapeDefinitionByArc or rebars part of a group that cannot be spliced.\n    - InvalidLineOrLinePlaneNormal &ndash; Represents the line length is zero or the line direction is parallel with the line plane normal.\n    - LineDoesNotIntersectRebarBoundingBox &ndash; Represents the line doesn't intersect the rebar bounding box.\n    - SpliceGeometryOnHookOrFillet &ndash; Represents if the splice geometry is on a hook or a fillet, the rebar can't be spliced with it.\n    - TooSmallSegments &ndash; Represents one of the resulting segments is too small to apply the lap.\n    - SpliceGeometryDoesNotIntersectAllTheBarsInTheSet &ndash; Represents a plane obtained from splice geometry doesn't intersect all the bars in the set.\n    - SpliceGeometryAlmostParallelToBarSegment &ndash; Represents the plane formed by splice geometry is almost parallel to bar segment plane.\n- RebarSpliceByRulesError &ndash; Represents the states for splicing a Rebar by rules. It has the following values:\n    - Success\n    - Unknown &ndash; Represents there is an unexpected error.\n    - InvalidRebar &ndash; Represents free form rebars or shape driven rebars that are multiplanar or having shape whose definition is RebarShapeDefinitionByArc or rebars part of a group that cannot be spliced.\n    - TooBigHook &ndash; Represents the hook lengths exceed the maximum length.\n    - TooSmallRunOut &ndash; Represents the run-out is below minimum length, or the lap can't be applied to it.\n    - MaximumLengthBiggerThanBarLength &ndash; Represents the maximum length exceeds the bar length.\n    - TooBigArc &ndash; Represents the arc segment exceeds the maximum length.\n    - CantSpliceAllTheBarsInSet &ndash; Represents  some bars in the varying set are not intersected by the resulting splice geometries.\n    - LapLengthBiggerThanMaximumBarLength &ndash; Represents the lap length is greater than the maximum length.\n    - InvalidCombinationOfMaximumMinimumBarLengthAndLapLength &ndash; Represents the combination of the maximum bar length, minimum bar length and lap length is invalid.\n- RebarHandleBehavior &ndash; Represents different behaviors that can be applied to a RebarConstrainedHandle. It has the following values:\n    - Default &ndash; Represents the default behavior of a RebarConstrainedHandle.\n    - SpliceMainEndOnEnd1Position\n    - SpliceMainEndOnMiddlePosition &ndash; Represents the behavior can be set to a StartOfBar or EndOfBar RebarConstrainedHandle of a bar that is part of splice. On the connected bar there is a ToOtherRebar constraint whose target is the current rebar. The RebarConstrainedHandle's plane in the same position as the splice plane for Middle.\n    - SpliceMainEndOnEnd2Position &ndash; Represents the behavior can be set to a StartOfBar or EndOfBar RebarConstrainedHandle of a bar that is part of splice. On the connected bar there is a ToOtherRebar constraint whose target is the current rebar. The RebarConstrainedHandle's plane in the same position as the splice plane for Middle\n    - SpliceConnectedEndOnEnd1Position &ndash; Represents  the behavior can be set to a StartOfBar or EndOfBar RebarConstrainedHandle of a bar that is part of splice. On this RebarConstrainedHandle is a ToOtherRebar constraint whose target is the other bar involved in splice. The RebarConstrainedHandle's plane in the same position as the splice plane for End1.\n    - SpliceConnectedEndOnMiddlePosition &ndash; Represents the behavior can be set to a StartOfBar or EndOfBar RebarConstrainedHandle of a bar that is part of splice. On this RebarConstrainedHandle is a ToOtherRebar constraint whose target is the other bar involved in splice. The RebarConstrainedHandle's plane in the same position as the splice plane for Middle\n    - SpliceConnectedEndOnEnd2Position &ndash; Represents  the behavior can be set to a StartOfBar or EndOfBar RebarConstrainedHandle of a bar that is part of splice. On this RebarConstrainedHandle is a ToOtherRebar constraint whose target is the other bar involved in splice. RebarConstrainedHandle's plane in the same position as the splice plane for End2\n    - SpliceRebarPlaneOnSpliceSetExtent &ndash; Represents the behavior can be set to a RebarPlane RebarConstrainedHandle of a bar that is part of splice\n    - SpliceOutOfPlaneExtentOnSpliceSetExtent &ndash; Represents the behavior can be set to a OutOfPlaneExtent RebarConstrainedHandle of a bar that is part of splice.\n    - SpliceEdge &ndash; Represents the behavior can be set to an edge segment that is connected to the other rebar of splice.\n\n<a name=\"4.2.14\"></a><h2 class=\"new\">2.14.  Selection API additions</h2>\n\n<a name=\"4.2.14.1\"></a><h3 class=\"new\">2.14.1.  UI Application</h3>\n\nThe new enum:\n\n- ThemeType &ndash; Represents the application frame theme type. It has the following values:\n    - CanvasTheme &ndash; Indicates that the ThemeChanged event is triggered by canvas theme change.\n    - UITheme &ndash; Indicates that the ThemeChanged event is triggered by the global UI theme change.\n\nThe new read-only property for ThemeChangedEventArgs:\n\n- ThemeChangedType &ndash; Returns ThemeType enum that indicates the kind of change triggered the current event.\n\n<a name=\"4.2.15\"></a><h2 class=\"new\">2.15.  Sketched Element API additions</h2>\n\n<a name=\"4.2.15.1\"></a><h3 class=\"new\">2.15.1.  Wall APIs</h3>\n\nThe new methods now allow users to selectively enable or disable end wrapping for a specific wall end when the wall's end wrap is activated in the Wall Type dialog.\n\n- Revit.DB.Wall.GetWrappingLocationAsReferences(int locationIndex) &ndash; Allows users to get an array of references to faces at the location.\n- Revit.DB.Wall.GetWrappingLocationAsCurveParameter(int locationIndex) &ndash; Allows users to get the non-normalized (actual) curve parameter of the location.\n- Revit.DB.Wall.GetValidWrappingLocationIndices()\n- Revit.DB.Wall.AllowWrappingAtLocation(int locationIndex)\n- Revit.DB.Wall.DisallowWrappingAtLocation(int locationIndex)\n- Revit.DB.Wall.IsWrappingAtLocationAllowed(int locationIndex)\n\n<a name=\"4.2.16\"></a><h2 class=\"new\">2.16.  Structure API additions</h2>\n\n<a name=\"4.2.16.1\"></a><h3 class=\"new\">2.16.1.  Analytical Elements</h3>\n\nThe new methods:\n\n- AnalyticalElement.IsValidTransform() &ndash; Allows users to check whether the value set for Local Coordinate System is valid for an Analytical Element.\n- AnalyticalElement.SetTransform() &ndash; Allows users to set the transform of Analytical Element Local Coordinate System.\n\n<a name=\"4.2.16.2\"></a><h3 class=\"new\">2.16.2.  Analytical Surface</h3>\n\nThe new method:\n\n- AnalyticalSurfaceBase.IsOuterContourValid() &ndash; Allows users to verify if contour is valid for this Analytical Surface.\n\n<a name=\"4.2.16.3\"></a><h3 class=\"new\">2.16.3.  Bending Details on Drawings</h3>\n\nAdded new functionality for enhancing bending details. These include the ability to create and customize the size of schematic bending detail boxes, set specific tag types for bending details, adjust the position and rotation of tags relative to the bending detail, customize the tag alignment option, and add multiple hosts for the schematic bending detail. This update offers greater flexibility and precision in the representation and annotation of bending details in Revit models.\n\nThe new methods:\n\n- RebarBendingDetail.AddHosts()\n- RebarBendingDetail.GetHosts()\n- RebarBendingDetail.RemoveHosts()\n- RebarBendingDetail.SetTagRelativePosition()\n- RebarBendingDetail.SetTagRelativeRotation()\n- RebarBendingDetail.GetTagRelativePosition()\n- RebarBendingDetail.GetTagRelativeRotation()\n- RebarBendingDetail.IsSchematicBendingDetail()\n- RebarBendingDetail.IsRealisticBendingDetail()\n- RebarBendingDetail.ResetTagRelativePosition()\n- RebarBendingDetail.ResetAnnotationPositions()\n\nThe new properties:\n\n- RebarBendingDetailType.SchematicHeight &ndash; Represents  the height of the box where the schematic Bending Detail will be represented.\n- RebarBendingDetailType.SchematicWidth &ndash; Represents the width of the box where the schematic Bending Detail will be represented.\n- RebarBendingDetailType.TagTypeId &ndash; Represents the Id of the tag type which is used in the Bending Detail representation.\n- RebarBendingDetailType.DisplayMode &ndash; Represents the display mode for the bending detail.\n\nThe new enum:\n\n- Autodesk.Revit.DB.Structure.BendingDetailDisplayMode\n\nrepresents the mode in which the Bending Detail will be represented.\n\n<a name=\"4.2.16.4\"></a><h3 class=\"new\">2.16.4.  Radial Array</h3>\n\nThe new methods:\n\n- RadialArray.GetMinimumSize() &ndash; Allows users to get the minimum size of a radial array based on if the document is a family document.\n- RadialArray.GetNumberOfMembersIncludingPlaceholders() &ndash; Allows users to get the number of members in a radial array, including placeholders that are still there in families with small array counts.\n- RadialArray.IsValidNumberOfMembers() &ndash; Indicates whether the input count is a valid size for an array based on the document.\n\n<a name=\"4.2.17\"></a><h2 class=\"new\">2.17.  Tag/Keynotes API additions</h2>\n\nWe now provide functionality to align multiple text, tags and keynotes with new contextual alignment tools in the ribbon.\n\nThe new class:\n\n- Autodesk.Revit.DB.AnnotationMultipleAlignmentUtils\n\nallows users to align annotation elements to one another. Currently supports TextNotes, Tags and Keynotes.\n\nThe new methods:\n\n- AnnotationMultipleAlignmentUtils.ElementSupportsMultiAlign() &ndash; allows users to check whether the element type can be aligned using the multiple allignment commands.\n- AnnotationMultipleAlignmentUtils.GetAnnotationOutlineWithoutLeaders() &ndash; allows users to get the four corners of the annotations bounding box, not including leaders. Outline calculations include leader/border offsets wherever applicable. (Eg. in the case of TextNotes).\n- AnnotationMultipleAlignmentUtils.MoveWithAnchoredLeaders() &ndash; allows users to move the given element to the position specified by the input moveVec, while keeping the leader end points anchored.\n\n<a name=\"4.2.18\"></a><h2 class=\"new\">2.18.  Toposolid API additions</h2>\n\nAdded functionality for Toposolid smooth shading.\n\nThe new methods:\n\n- Toposolid.ExcavateBy() &ndash; Allows users to excavate toposolid by a given element.\n- Toposolid.RemoveExcavationBy() &ndash; Allows users to remove the excavation between the given element and the toposolid.\n- Toposolid.CanBeExcavatedBy() &ndash; Allows users to check if the given element can be used to excavate the toposolid.\n- Toposolid.SetSmoothedSurface() &ndash; Allows users to set the smoothed surface setting of toposolid category in the given document.\n- Toposolid.IsSmoothedSurfaceEnabled() &ndash; Allows users to check if smoothed surface setting of toposolid category is enabled in the given document.\n- Toposolid.GetIntersectingElementData()\n- ToposolidType.SetContourSetting() &ndash; Allows users to set the contour setting for the current toposolid type by copying from an existing contour setting object.\n- ContourSetting.IsItemEnabled()\n- ContourSettingItem.GetContourSettingItemType()\n- FaceToposolid.Create()\n- FaceToposolid.UpdateToFace() &ndash; Allows users to reset the face toposolid to its defining face.\n- FaceToposolid.GetReferencedFaces()\n- FaceToposolid.SetReferencedFaces()\n\nThe new classes:\n\n- Autodesk.Revit.DB.IntersectingElementData &ndash; Stores information of an element that intersects with another element.\n- Autodesk.Revit.DB.FaceToposolid &ndash; represents a face-based Toposolid within the Autodesk Revit project.\n\nThe new enum:\n\n- Autodesk.Revit.DB.IntersectionType &ndash; It has the following values.\n    - Cut\n    - Excavate\n- Autodesk.Revit.DB.ContourSettingItemType &ndash; Represents the type of contour setting item. It has the following values:\n    - Single\n    - UnboudedRange\n    - BoundedRange.\n\nThe new properties:\n\n- IntersectingElementData.IntersectionType\n- IntersectingElementData.IntersectingElementId\n- IntersectingElementData.IntersectedElementId\n- IntersectingElementData.IntersectionVolume\n\n<a name=\"4.2.19\"></a><h2 class=\"new\">2.19.  UI API additions</h2>\n\n<a name=\"4.2.19.1\"></a><h3 class=\"new\">2.19.1.  Context Menu</h3>\n\nWe now provide functionality to create context menu from an add-in.\n\nThe new Interface:\n\n- Revit.UI.IContextMenuCreator &ndash; The interface users need to implement to build context menu.\n\nThe new Constructor:\n\n- Revit.UI.ContextMenu() &ndash; Allows users to create a new instance of Context Menu.\n- Revit.UI.CommandMenuItem(name , className, assemblyName ) &ndash; Allows users to create a new instance of command menu item with name, external command class name and external application assembly name.\n- Revit.UI.SubMenuItem(name , ContextMenu) &ndash; Allows users to create a new instance of flyout menu with name and sub menu instance.\n- Revit.UI.Separator() &ndash; Allows users to create a new instance of separator menu item.\n\nThe new methods:\n\n- ContextMenu.AddItem() &ndash; Allows users to add a specific type of MenuItem object to context menu.\n- CommandMenuItem.SetAvailabilityClassName() &ndash; Allows users to set availabilityClassName of CommandMenuItem.\n- CommandMenuItem.SetToolTip() &ndash; Allows users to set tooltip of CommandMenuItem.\n- IContextMenuCreator.BuildContextMenu() &ndash; Allows users to add menu items to the passed in ContextMenu object.\n- UIControlledApplication.RegisterContextMenu() &ndash; Allow user to add new context menu creators with application name.\n\n<a name=\"4.2.20\"></a><h2 class=\"new\">2.20.  View API additions</h2>\n\n<a name=\"4.2.20.1\"></a><h3 class=\"new\">2.20.1.  SheetCollection</h3>\n\nThe new class:\n\n- Autodesk.Revit.DB.SheetCollection &ndash; Represents a sheet collection in Autodesk Revit.\n\nThe new methods:\n\n- Autodesk.Revit.DB.SheetCollection.Create(document, name) &ndash; Allows users to create a new instance of sheet collection with a specified name and adds it to the document. It returns the newly created sheet collection element.\n- Autodesk.Revit.DB.SheetCollection.Create(document) &ndash; Allows users to create a new instance of sheet collection with an auto-generated name and adds it to the document. It returns the newly created sheet collection element.\n\nThe new property:\n\n- Autodesk.Revit.DB.ViewSheet.SheetCollectionId &ndash; Represents the Id of the sheet collection this sheet is associated with.\n\n<a name=\"4.2.21\"></a><h2 class=\"new\">2.21.  Link Visibility/Graphic Override API additions</h2>\n\nThe new functionality allows Revit Link Visibility/Graphic Overrides, for the 'Custom' option.\n\nThe new methods in class Autodesk.Revit.DB.RevitLinkGraphicsSettings:\n\n- RevitLinkGraphicsSettings.IsViewRangeSupported(View) &ndash; Allows users to check if the input view supports view range settings for RevitLinkGraphicsSettings graphic overrides.\n- RevitLinkGraphicsSettings.GetPhaseId()\n- RevitLinkGraphicsSettings.GetPhaseType()\n- RevitLinkGraphicsSettings.SetPhase(LinkVisibility, ElementId) &ndash; Allows users to configure phase and phase type of RevitLinkGraphicsSettings. Accepts LinkVisibility and ElementId of the phase from the linked document or ElementId.InvalidElementId.\n- RevitLinkGraphicsSettings.GetPhaseFilterId()\n- RevitLinkGraphicsSettings.GetPhaseFilterType()\n- RevitLinkGraphicsSettings.SetPhaseFilter(LinkVisibility, ElementId) &ndash; Allows users to configure phase filter and phase filter type of RevitLinkGraphicsSettings. Accepts LinkVisibility and ElementId of the phase filter from the linked document or ElementId.InvalidElementId.\n- RevitLinkGraphicsSettings.GetViewDetailLevel()\n- RevitLinkGraphicsSettings.GetViewDetailLevelType()\n- RevitLinkGraphicsSettings.SetViewDetailLevel(LinkVisibility, ViewDetailLevel) &ndash; Allows users to configure detail level and detail level type of RevitLinkGraphicsSettings. Accepts LinkVisibility and ViewDetailLevel types.\n- RevitLinkGraphicsSettings.GetDiscipline()\n- RevitLinkGraphicsSettings.GetDisciplineType()\n- RevitLinkGraphicsSettings.SetDiscipline(LinkVisibility, ViewDiscipline) &ndash; Allows users to configure discipline and discipline type of RevitLinkGraphicsSettings. Accepts LinkVisibility and ViewDiscipline types.\n\nThe new properties in Autodesk.Revit.DB.RevitLinkGraphicsSettings:\n\n- RevitLinkGraphicsSettings.ViewFilterType\n- RevitLinkGraphicsSettings.ViewRange\n- RevitLinkGraphicsSettings.ColorFill\n- RevitLinkGraphicsSettings.ObjectStyles\n- RevitLinkGraphicsSettings.NestedLinks\n\n<a name=\"4.2.22\"></a><h2 class=\"new\">2.22.  RevitServer Enterprise / Revit Cloud Worksharing API additions</h2>\n\nThe following events have been supported for file-based worksharing since 2021. We now support them in RevitServer Enterprise/Revit Cloud Worksharing.\n\n- DocumentReloadingLatest &ndash; Subscribe to the DocumentReloadingLatestEventArgs event to be notified when Revit is just about to reload latest changes from a central model.\n- DocumentReloadedLatest &ndash; Subscribe to the DocumentReloadedLatestEventArgs event to be notified immediately after Revit has finished reloading a document with central model."
  }
][
  {
    "original_filename": "2037_vb_2025",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- VB projects in Revit 2025 API\n  https://forums.autodesk.com/t5/revit-api-forum/vb-project-solution-framework-upgrade-to-sdk-for-revit-2025/m-p/12723698\n\n- Prompt library https://docs.anthropic.com/claude/prompt-library\n\n- GPT-4 can exploit zero-day security vulnerabilities all by itself\n  https://www.techspot.com/news/102701-gpt-4-can-exploit-zero-day-security-vulnerabilities.html\n\n- An AI took on a human pilot in a DARPA-sponsored dogfight\n  https://www.defenseone.com/technology/2024/04/man-vs-machine-ai-agents-take-human-pilot-dogfight/395930/\n\n- integration of generative 3D (and 2d to 3d creation) in the Spline UI\n  https://spline.design/ai-generate\n\n- successful AI-conic coffee blend\n  https://apnews.com/article/artificial-intelligence-finland-coffee-blend-0cd12d5ae15a6d0e928c4cb4d7635b09\n  no human intervention required\n\n- Meta AI released, and\n  answered\n  https://forums.autodesk.com/t5/revit-api-forum/binding-different-lists-to-different-rows-in-datagrid/td-p/12722925\n  summarised\n  https://forums.autodesk.com/t5/revit-api-forum/structural-framing-cut-by-reference-plane/m-p/12260041/highlight/false#M74290\n\n- AI tools:\n  ChatGPT\n  Gemini + https://notebooklm.google/\n  Claude\n  Meta AI\n\n- The State of Generative AI, 2024\n  https://www.thealgorithmicbridge.com/p/the-state-of-generative-ai-2024\n\n- Ferret: Refer and Ground Anything Anywhere at Any Granularity\n  https://arxiv.org/abs/2310.07704\n  The Ferret multimodal LLM understands spatial referring of any shape or granularity within an image and accurately grounds open-vocabulary descriptions, e.g.:\n  /Users/jta/a/doc/revit/tbc/git/a/img/ferret_mllm.png\n\n- Pankesh Bamotra\n  https://chat.openai.com\n  Now you can use ChatGPT 3.5 without logging in.\n  Likely to collect more data\n\n- Models All The Way Down\n  https://knowingmachines.org/models-all-the-way\n  by Christo Buschek & Jer Thorp\n  Timo Gmeiner on slack\n  nice visualizations - makes a boring dataset bias examination much more engaging!\n  Content is great! I love the look and feel as well.\n  Loved it, this part is probably my favorite:\n  > Here we find an important truth about LAION-5B:\n  It contains less about how humans see the world than it does about how search engines see the world. It is a dataset that is powerfully shaped by commercial logics.\n\n- ScrapeGraphAI: You Only Scrape Once\n  https://github.com/VinciGit00/Scrapegraph-ai\n\n- video conferencing: jitsi meet\n  https://jitsi.org/\n  More secure, more flexible, and completely free video conferencing\n\n- World Happiness Report 2024\n  https://worldhappiness.report/ed/2024/\n\ntwitter:\n\nNews on advances in LLMs, AI, Claude, ChatGPT, Gemini, Meta AI, 3D genAI, web scraping, spatial referring, digital twins and migrating VB.NET to .NET Code 8 for the @AutodeskRevit #RevitAPI #BIM @DynamoBIM https://autode.sk/netcore8vb\n\nRevit 2025 API migration of VB.NET add-ins to .NET Core 8 and advances in LLMs and AI, Claude, ChatGPT, Gemini, Meta AI, 3D genAI, web scraping, spatial referring, digital twins...\n\nlinkedin:\n\nNews on advances in LLMs, AI, Claude, ChatGPT, Gemini, Meta AI, 3D genAI, web scraping, spatial referring, digital twins and migrating VB.NET to .NET Code 8 for the #RevitAPI\n\nhttps://autode.sk/netcore8vb\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2037_vb_2025",
    "header_text": "Migrating VB to .NET Core 8 and AI News",
    "local_header_href": "#migrating-vb-to-net-core-8-and-ai-news",
    "chunk_text": "### Migrating VB to .NET Core 8 and AI News\n\nThere is so much news on advances in LLMs and AI; I list a few items that caught my attention.\nFirst, however, we round off the Revit 2025 API migration with some observations on VB.NET add-ins:\n\n- [Migrating VB add-in to Revit 2025](#2)\n- [GenAI and LLM updates](#3)\n- [Jitsi Meet video conferencing](#4)\n- [World Happiness Report 2024](#5)"
  },
  {
    "original_filename": "2037_vb_2025",
    "header_text": "Migrating VB Add-In to Revit 2025",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Migrating VB Add-In to Revit 2025\n\nGary Orr and\nRichard [RPThomas108](https://forums.autodesk.com/t5/user/viewprofilepage/user-id/1035859) Thomas\ndiscovered and shared their insights\non [VB projects in Revit 2025 API](https://forums.autodesk.com/t5/revit-api-forum/vb-project-solution-framework-upgrade-to-sdk-for-revit-2025/m-p/12723698):\n\n**Question:**\nI've read all of the posts regarding upgrading, I have applied everything that my limited experience allows me to understand (Been doing this for years, but on a limited basis as writing code isn't even in my job description these days and I can barely decipher all of the C# examples since I'm not bilingual and my native language is VB).\n\nSo far I have managed, through days of trial and error, to port one of my solutions (with 3 Projects) and have slowly whittled away the errors and warnings. My WinForms dialogs were a real bear but I finally managed to delete enough tags in the VBproj files to get them working (creating a new WinForms solution and project from scratch and doing some comparisons helped with that as it didn't have all the extra gobbledygook in it).\n\nFinally upgraded successfully with one exception:\n\n- Warning MSB3277 Found conflicts between different versions of \"WindowsBase\" that could not be resolved.\n\nI've updated to all of the latest (which I'm beginning to believe might be my issue).\nI'm working in\nVisual Studio Community 2022 Version 17.9.6\nwith\ndotnet SDK 8.0.204.\n\nI get this warning on both the ported/upgraded solution/projects as well as the solution/project that I started from scratch.\n\nHas anyone seen this warning or know a solution for resolving the conflict between the Revit API references and the newer native .NET references?\n\n**Answer:**\nFirst, congratulations on making progress, and sorry the migration is causing such a hassle for you.\n\nWarnings can be ignored.\nThey do no harm.\nOf course, it is nicer to eliminate them.\n\nActually, the very warning MSB3277 that you mention is also listed in\nthe [official Revit API .NET 8 migration guide](https://thebuildingcoder.typepad.com/blog/2024/04/migrating-from-net-48-to-net-core-8.html):\n\n> Common Issues...\nHere are some common issues you may encounter when upgrading to .NET 8:\n\n> - Build Warning MSB3277\nWhen building code that references RevitAPI or RevitUIAPI, you will see the build warning MSB3277.\nTo fix this, add a reference to the Windows Desktop framework: &lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App\"/&gt;\n\n**Response:**\nI did see that reference, but it doesn't say where to put it or what container node it required (I had correctly assumed that I could use the vbproj file, since it's the same xml as the csproj file) and tried adding it to the (a) `<PropertyGroup> `node at which VS completely wigged out and said that an invalid call forced VS to unload the project...\nI then spent a day following link after link in the MS documents trying to figure it out as well...\n\nI had also tried using the `Add Reference` function to see if I could load it that way, but I couldn't find it as an available loadable reference.\n\nSo, with your prompting I tried again...\nThis time I used VS intellicode to help me work it out:\nCreate a node, check to see if that node contained the `<FrameworkReference>` property, repeat until I found the correct one.\nI think this little additional piece of information would go a long way in helping people like me:\n\n<pre><code>  &lt;ItemGroup&gt;\n    &lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App\" /&gt;\n  &lt;/ItemGroup&gt;\n</code></pre>\n\nNow I have these references:\n\n<center>\n<img src=\"img/vb_2025_2.png\" alt=\"VB 2025\" title=\"VB 2025\" width=\"359\"/> <!-- Pixel Height: 431 Pixel Width: 359 -->\n</center>\n\n... along with a warning-free build.\n\nNow perhaps I'll tackle the big toolset...\n\nAdding another note to this...\n\nI'm not sure what the upgrade process does differently from one project to the next but, whatever it is it isn't consistent.\n\nOn the next project, the framework references came in differently; the `FrameworkReference` tag that the previous project required caused a warning and I had errors due to a missing reference that had been automatically added to the other projects when I set the target to windows using\n\n<pre><code>&lt;TargetFramework&gt;net8.0-windows&lt;/TargetFramework&gt;</code></pre>\n\nSo I had to do this to make it all come together:\n\n<pre><code>&lt;ItemGroup&gt;\n<br/>  &lt;!-- &lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App\" /&gt; --&gt;\n<br/>  &lt;FrameworkReference Include=\"Microsoft.WindowsDesktop.App.WindowsForms\" /&gt;\n<br/>&lt;/ItemGroup&gt;\n</code></pre>\n\n**Answer:**\nAlso found this works:\n\n<pre><code>  &lt;UseWindowsForms&gt;true&lt;/UseWindowsForms&gt;</code></pre>\n\nThis just highlights the way things have gone a bit backwards i.e. System.Drawing 4.0 instead of 8.0???\nSo, you add additional things to the point it basically becomes .NetFramework again anyway.\nYet they still can't open Revit on their mac or their phone and were never aiming to.\n\nThink they should have got rid of application macros not the document ones.\nDocument macros offered the ability to transmit functionality across offices on a project specific level, i.e., with the project files, not as some separate things such as dynamo script etc.\nApplication macros are just another way of doing the same thing as VS or pyRevit or half a dozen other things similar.\n\n**Response:**\n`UseWindowsForms` was the first tag I used (thanks to a lot of reading in the API help and the posts made here by some people that, unlike myself, actually know what they're doing)...\n\nBut... it didn't do the complete job.\nI had to delete extra lines/tags and add a few additional lines/tags...\nand scratch my head, and cuss, and try deleting some more and try adding others...\nthen cuss some more...\nthen scratch my head some more...\nBut I do now have everything compiling properly for two solutions with a total of four projects...\n\nEach project ended up requiring a slightly different combination to get them working...\nI only have two more solutions to go, yay.\n\n**Answer:**\nYes, certain things are fixed into the Frameworks, aren't they (more than there was with .NetFramework), so you have to review those already included reference versions and if you've referenced them separately historically then you have to take those out.\nIn this example there was newer references used in the Revit API DLLs due to options they compiled those with.\nSo, the baseline references used in .NET 8 were older in version than the ones included with windows desktop option.\nSo, in a lot of cases, it may be easier starting over with the project file references and adding references back as you see the related missing references errors for those.\n\nSo, as an example:\nMicrosoft.NetCore.App\ncontains\nMicrosoft.VisualBasic 10.0.0.0\nbut\nMicrosoft.WindowsDesktop.App\ncontains\nMicrosoft.VisualBasic 10.1.0.0\n\nSo, if you don't include the desktop option but include a reference that does i.e. RevitAPI.dll it tells you it is going to ignore 10.1.0.0 (since that is not added in your project). This would be a problem I suspect if you used a call from 10.0.0.0 that didn't exist anymore in 10.1.0.0 (since Revit is likely to be loading 10.1.0.0 not 10.0.0.0, first come first served).\n\nSo, isn't really VB specific that is just one of the affected assemblies that is part of Microsoft.NetCore.App but there are similar warnings for System.Drawing etc. You only encounter them if you use them in code so different projects will have same problem with different things.\n\n**Response:**\nGood advice on the start a project from scratch note.\nCreating a project(s) from scratch (in a solution(s) created from scratch) for the different types of projects I had to deal with (WinForms project, WPF project, Console App, standalone executable [the last two not related to the Revit API, just noting them], etc) was one of the methods that helped me find what was actually required and what might be able to be safely removed.\nI would recommend that for anyone making the transition from Framework to SDK.\n\nI also found a few repeated tags that were added to `<PropertyGroup>` nodes by the upgrade tool whose removal helped greatly:\n\n<pre><code>&lt;!--&lt;OutputType&gt;Library&lt;/OutputType&gt;--&gt;\n<br/>&lt;!--&lt;MyType&gt;Windows&lt;/MyType&gt;--&gt;\n<br/>&lt;!--&lt;ImportWindowsDesktopTargets&gt;true&lt;/ImportWindowsDesktopTargets&gt;--&gt;\n<br/>&lt;!--&lt;GenerateAssemblyInfo&gt;false&lt;/GenerateAssemblyInfo&gt;--&gt;\n</code></pre>\n\nThe `GenerateAssemblyInfo` and `ImportWindowsDesktopTargets` seemed like they would belong yet they were causing issues that seemed contra-indicative to what they would seem to be adding to the whole...\n\nOh well, if it was easy it wouldn't be any fun right?"
  },
  {
    "original_filename": "2037_vb_2025",
    "header_text": "GenAI and LLM Updates",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> GenAI and LLM Updates\n\nRecent weeks have seen updates to several of the main publicly accessible LLMs, each one claiming to be measurably superior to all its predecessors, e.g., Claude, ChatGPT, Gemini, Meta AI.\nI have tried them all out briefly with satisfactory results.\n\nNow you can now use [ChatGPT 3.5](https://chat.openai.com) without logging in.\nPossibly to collect more data?\n\nI used Meta AI effectively to answer the Revit API discussion forum thread\non [binding different lists to different rows in DataGrid](https://forums.autodesk.com/t5/revit-api-forum/binding-different-lists-to-different-rows-in-datagrid/td-p/12722925),\nand summarise another,\non [structural framing cut by reference plane](https://forums.autodesk.com/t5/revit-api-forum/structural-framing-cut-by-reference-plane/m-p/12260041)\n\nFor a nice collection of LLM prompts, you can check out the [Anthropic Prompt Library](https://docs.anthropic.com/claude/prompt-library) for Claude.\n\nAlberto Romero of The Algorithmic Bridge provides an interesting report\non [The State of Generative AI, 2024](https://www.thealgorithmicbridge.com/p/the-state-of-generative-ai-2024).\n\n[Models All The Way Down](https://knowingmachines.org/models-all-the-way) by Christo Buschek and Jer Thorp\npresents an in-depth analysis of the sources used to generate the huge amount of material required to train an LLM, presented in a novel and engaging fashion with lots of visualisation and animation, making an otherwise possibly boring dataset bias examination much more engaging.\nIn particular, it examines the ubiquitous LAION-5B dataset:\n\n> ... an important truth about LAION-5B:\nIt contains less about how humans see the world than it does about how search engines see the world.\nIt is a dataset that is powerfully shaped by commercial logics.\n\nHere are some of the interesting capabilities exhibited by LLMs:\n\n- [GPT-4 can exploit zero-day security vulnerabilities all by itself](https://www.techspot.com/news/102701-gpt-4-can-exploit-zero-day-security-vulnerabilities.html)\n- [An AI took on a human pilot in a DARPA-sponsored dogfight](https://www.defenseone.com/technology/2024/04/man-vs-machine-ai-agents-take-human-pilot-dogfight/395930/)\n- A Finnish company released the [AI-conic coffee blend](https://apnews.com/article/artificial-intelligence-finland-coffee-blend-0cd12d5ae15a6d0e928c4cb4d7635b09) designed and marketed by AI with hardly any human intervention required\n- [Spline AI 3D Generation](https://spline.design/ai-generate) integrates generative 3D (and 2d to 3d creation) in the UI, enabling creation of 3D objects from text prompts and images\n- [ScrapeGraphAI](https://github.com/VinciGit00/Scrapegraph-ai) implements a web scraping python library that uses LLM and direct graph logic to create scraping pipelines for websites, documents and XML files\n- The Ferret multimodal LLM understands spatial referring of any shape or granularity within an image and accurately grounds open-vocabulary descriptions, documented\nin [Ferret: Refer and Ground Anything Anywhere at Any Granularity](https://arxiv.org/abs/2310.07704),\nfor example like this:\n\n<center>\n<img src=\"img/ferret_mllm.png\" alt=\"Ferret multimodal LLM\" title=\"Ferret multimodal LLM\" width=\"800\"/> <!-- Pixel Height: 452 Pixel Width: 1,718 -->\n</center>\n\n[Reid Hoffman engages with his AI digital twin](https://www.linkedin.com/posts/reidhoffman_can-talking-with-an-ai-generated-version-activity-7188916775692947456-Dw6q?utm_source=share&utm_medium=member_desktop),\nspending 15 minutes or so exploring:\n\n> Can talking with an AI-generated version of myself lead to a deeper awareness of how I think?\nThat's what I wanted to find out as I continue to explore the latest AI technologies in hands-on ways."
  },
  {
    "original_filename": "2037_vb_2025",
    "header_text": "Jitsi Meet Video Conferencing",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Jitsi Meet Video Conferencing\n\nMoving off the AI topic, I discovered a secure, flexible, and free video conferencing platform,\n[Jitsi meet](https://jitsi.org/),\nbased on the Jitsi set of open-source projects that allows you to easily build and deploy secure video conferencing solutions."
  },
  {
    "original_filename": "2037_vb_2025",
    "header_text": "World Happiness Report 2024",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> World Happiness Report 2024\n\nAnd finally, for the more important aspects of life, the [World Happiness Report 2024](https://worldhappiness.report/ed/2024/)\nfocuses on the happiness of people at different stages of life:\n\n> Happiness research shows a nuanced picture that is changing over time...\nWe encourage you to explore the 2024 report for the latest findings on the happiness of the world’s young, the old, and everyone in between."
  }
][
  {
    "original_filename": "2038_highlight_link",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- highlight elements from a linked document\n  https://forums.autodesk.com/t5/revit-api-forum/highlight-elements-from-a-linked-document/td-p/12768033\n\n- Modify Duct Length in Revit API Despite Read-Only Property Constraint\n  https://forums.autodesk.com/t5/revit-api-forum/modify-duct-length-in-revit-api-despite-read-only-property/m-p/12763233\n\n- How to detect is opened preview document in type properties?\n  https://forums.autodesk.com/t5/revit-api-forum/how-to-detect-is-opened-preview-document-in-type-properties/m-p/12768772\n\ntwitter:\n\nHighlighting linked elements using SetReferences, modifying duct length and determining whether a form is displayed using an IsMainWindowActive predicate in the @AutodeskRevit #RevitAPI #BIM @DynamoBIM https://autode.sk/hilitelinkelem\n\nHighlighting linked elements using SetReferences, modifying duct length and determining whether a form is displayed using an IsMainWindowActive predicate...\n\nlinkedin:\n\nHighlighting linked elements using SetReferences, modifying duct length and determining whether a form is displayed using an IsMainWindowActive predicate in the #RevitAPI\n\nhttps://autode.sk/hilitelinkelem\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2038_highlight_link",
    "header_text": "Lengthen Ducts and Highlight Links",
    "local_header_href": "#lengthen-ducts-and-highlight-links",
    "chunk_text": "### Lengthen Ducts and Highlight Links\n\nToday, let's stick with some pure Revit API issues fresh from the forum:\n\n- [Highlight linked element](#2)\n- [Modify duct length](#3)\n- [IsMainWindowActive predicate](#4)"
  },
  {
    "original_filename": "2038_highlight_link",
    "header_text": "Highlight Linked Element",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Highlight Linked Element\n\nLately, Moustafa Khalil very kindly provided a lot of helpful support in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160).\n\nHe now took a step further, sharing his research and explanation on how\nto [highlight elements from a linked document](https://forums.autodesk.com/t5/revit-api-forum/highlight-elements-from-a-linked-document/td-p/12768033),\na frequently raised topic, and even starting a new BIM blog, saying:\n\nThe past 2 days I was scratching my head of how to highlight an element from a linked document.\nI tried different API approaches and found several existing posts requesting this, e.g.:\n\n- [How to select linked element by element Id](https://forums.autodesk.com/t5/revit-api-forum/how-to-select-linked-element-by-element-id/m-p/8245634)\n- [highlight and tag linked elements](https://forums.autodesk.com/t5/revit-api-forum/highlight-and-tag-linked-elements/m-p/5294217)\n- [How to highlight element in Linked model by API](https://forums.autodesk.com/t5/revit-api-forum/how-to-highlight-element-in-linked-model-by-api/m-p/9945959)\n- [High light Link Element](https://forums.autodesk.com/t5/revit-api-forum/high-light-link-element/m-p/11111305)\n- [Can't select elements in a linked model](https://forums.autodesk.com/t5/revit-api-forum/can-t-select-elements-in-a-linked-model/m-p/12681983)\n\nThere is a corresponding wish in the Revit Idea Station:\n\n- [Highlight element selection in linked files](https://forums.autodesk.com/t5/revit-ideas/highlight-element-selection-in-linked-files/idi-p/7619701)\n\nThe good news, after reading over the Revit API docs: it seems this wish has been granted since Revit 2023.\n\nA new `Selection` function called `SetReferences` was added, allowing elements to be highlighted via a set of references.\nI don't often use references to highlight elements, but rather to set hosts, like placing hosted families or extracting element IDs from a `ReferenceIntersector` or when selecting by picking.\n\nSo, if we provide the `SetReferences` function with references from a linked document, will it work?\nYes.\nHowever, some extra work is required to capture such element references.\nFirstly, we need to understand that this function operates on the currently active document.\nThis means that the references we provide must be in a format that the current document can recognize to highlight them in the current view.\n\nLet's attempt to highlight a face from an element in a linked document in the following steps:\n\n- Click on a point over one of the faces in a linked document.\n- Pass this reference to `SetReferences`, and it will highlight the face from the linked document.\n- Similarly, if you press Tab to cycle through line, face, and object, once you reach the object, select it to get the object reference.\n\n<pre><code class=\"language-cs\">var linkedFaceReference = UiDoc.Selection.PickObject(\n  Autodesk.Revit.UI.Selection.ObjectType.PointOnElement\n);\nUiDoc.Selection.SetReferences([linkedFaceReference]);\n</code></pre>\n\nNow, this works when a user interacts with the UI.\nWhat if I have an element ID from a linked document that I want to highlight?\nThe real question then becomes, how can I extract a reference from an `ElementId` that belongs to a linked document?\n\nThis is achievable, but not directly from the `ElementId`;\nwe need to work with the element itself.\nFirst, we need to get the element from the linked document, then create a reference for this element.\nHowever, this reference is only meaningful to the linked document, not the current one.\nWe can convert it to the current document using `CreateLinkReference` and the `RevitLinkInstance`.\nThe code below clearly demonstrates how it functions.\nIf you already have the linked `ElementId`, you can directly start from line 10, without the need for selection:\n\n<pre><code class=\"language-cs\"> var pickedReference = UiDoc.Selection.PickObject(\n  Autodesk.Revit.UI.Selection.ObjectType.PointOnElement\n);\n\n// get Revit link Instance and its document\nvar linkedRvtInstance = Doc.GetElement(pickedReference) as RevitLinkInstance;\nvar linkedDoc = linkedRvtInstance.GetLinkDocument();\n\n//get the Linked element from the linked document\nvar linkedElement = linkedDoc.GetElement(pickedReference.LinkedElementId);\n\n// now create a reference from this element\n// -- this is a reference inside the linked document\nvar reference = new Reference(linkedElement);\n\n// convert the reference to be readable from the current document\nreference = reference.CreateLinkReference(linkedRvtInstance);\n\n// now the linked element is highlighted\nUiDoc.Selection.SetReferences([reference]);\n</code></pre>\n\n<center>\n<img src=\"img/highlight_linked_element.gif\" alt=\"Highlight linked element\" title=\"Highlight linked element\" width=\"599\"/> <!-- Pixel Height: 358 Pixel Width: 599 -->\n</center>\n\nYes, the proposed solution is tested and works for me... I will be glad to know if there are any exception to this methodology.\n\nI have also published this on my fresh starting [Sharp BIM blog](https://sharpbim.hashnode.dev);\nI will usually journal my findings there as well as here in the forum:\n\n- [Highlight elements from a linked document](https://sharpbim.hashnode.dev/highlight-elements-from-a-linked-document)\n\nMany thanks to Moustafa for this clear explanation and demonstration, and for all his other great support in the discussion forum!\n\nBest of luck and much success with your new blog!"
  },
  {
    "original_filename": "2038_highlight_link",
    "header_text": "Modify Duct Length",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Modify Duct Length\n\nMoustafa also helped resolve how\nto [modify duct length in Revit API despite read-only property constraint](https://forums.autodesk.com/t5/revit-api-forum/modify-duct-length-in-revit-api-despite-read-only-property/m-p/12763233):\n\n**Question:**\nI'm wondering if it's possible to alter the length of a duct in Revit through the API.\nUpon trying, I noticed that the duct length property appears to be set as read-only.\nIs there a workaround to modify the duct length?\n\n**Answer:**\nYes, it can be done.\nThe API wraps the UI functionality, so the best way to address this is to determine the optimal workflow and best practices manually in the user interface first.\nHow do you solve this in the UI?\n\nSo, the API does not directly support changing the duct length.\nOne workaround is to delete the existing one and create a new duct with a new length, then update the neighbouring duct length according to that:\n\n<pre><code class=\"language-cs\">  UIDocument uiDoc = commandData.Application.ActiveUIDocument;\n  Document doc = uiDoc.Document;\n\n  Reference refer = uiDoc.Selection.PickObject(Autodesk.Revit.UI.Selection.ObjectType.Element);\n\n  Duct duct = doc.GetElement(refer) as Duct;\n\n  ///New Length Dimension\n  double newLength = UnitUtils.ConvertToInternalUnits(10000,UnitTypeId.Millimeters);\n\n  ///Calculating New Length\n  LocationCurve curve = duct.Location as LocationCurve;\n  XYZ p1 = curve.Curve.GetEndPoint(0);\n  XYZ p2 = p1 + ((curve.Curve as Line).Direction * newLength);\n\n  using (Transaction deleteDuctAndCreateNew = new Transaction(doc, \"Delete Existing Duct and Create New\"))\n  {\n    deleteDuctAndCreateNew.Start();\n\n    //Create New Duct\n    Duct.Create(doc, duct.MEPSystem.GetTypeId(),duct.GetTypeId(), duct.ReferenceLevel.Id, p1, p2);\n\n    doc.Delete(duct.Id);\n\n    deleteDuctAndCreateNew.Commit();\n  }\n</code></pre>\n\n<center>\n<img src=\"img/change_duct_length.gif\" alt=\"Change duct legth\" title=\"Change duct legth\" width=\"600\"/> <!-- Pixel Height: 559 Pixel Width: 999 -->\n</center>\n\nHowever, deleting an existing element means disconnecting it from the System and losing all instance property values such as mark or comment.\n\nI would be more inclined to  only increase the length of the MepCurve (duct, pipe, conduit...etc.):\n\n<pre><code class=\"language-cs\">var locCurve = ductObject.Location as LocationCurve;\nlocCurve.Curve = extendedCurve;\n</code></pre>\n\nIf the duct is connected to neighbouring elements, you can let Revit modify and adapt its length automatically by moving those neighbours and their connection points.\nLook at an exploration of different approaches to modifying pipe length in the blog post series\non [implementing a rolling offset](http://thebuildingcoder.typepad.com/blog/2014/01/final-rolling-offset-using-pipecreate.html).\n\nJust moving the neighbour elements will keep all the connections intact.\n\nTo add another approach, for those MEP curves without neighbour connections:\nWe may also extend the curve directly by its connector, which means no new line or assigning a location curve is needed:\n\n<pre><code class=\"language-cs\">Connector connector = getMyConnector();\ndouble extendby = 1; // extend by 1 feet for example\nXYZ direction = ductCurve.Direction; // assuming the duct is linear curve\nconnector.Origin = connector.Origin + direction * extendby;\n</code></pre>\n\nThank you both, Mohamed Arshad K and Moustafa Khalil, for chipping in on this!"
  },
  {
    "original_filename": "2038_highlight_link",
    "header_text": "IsMainWindowActive Predicate",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> IsMainWindowActive Predicate\n\nAleksandr '@ModPlus' Pekshev raised the question and shared his working solution\nfor [how to detect is opened preview document in type properties](https://forums.autodesk.com/t5/revit-api-forum/how-to-detect-is-opened-preview-document-in-type-properties/m-p/12768772):\n\n**Question:**\nThere is a `Preview` button in the type properties dialog.\nIf you click it, then, as far as I know, a copy of the current document will be created with a new view (I could be wrong here):\n\n<center>\n<img src=\"img/type_properties_preview.png\" alt=\"Type properties preview\" title=\"Type properties preview\" width=\"600\"/> <!-- Pixel Height: 559 Pixel Width: 999 -->\n</center>\n\nThe problem is that in this case `IUpdater` is triggered, which can lead to negative consequences.\n\nQuestion: how can I detect that this Preview is open, or how can I detect that the dialog for editing type properties is open?\n\n**Answer:**\nYou can use the native Windows API to detect that a specific Windows form is open.\nThis can also be done in .NET.\nYou can search for something like [.net detect form open](https://duckduckgo.com/?q=.net+detect+form+open) to learn more.\n\nYou might also try to track the `DocumentChanged` event; Revit creates elements and a view with a persistent name ‘Modify type attributes’.\nThis name is probably language dependent, but Revit does not create any other events:\n\n<center>\n<img src=\"img/revitlookup_documentchanged.png\" DocumentChanged monitor\" title=\"RevitLookup DocumentChanged monitor\" width=\"600\"/> <!-- Pixel Height: 842 Pixel Width: 1,533 -->\n</center>\n\n**Response:**\nI ended up using the built-in Revit API functionality to implement a small auxiliary class to solve it like this:\n\n<pre><code class=\"language-cs\">using System;\nusing System.Runtime.InteropServices;\nusing Autodesk.Revit.UI;\n\n/// <summary>\n/// Initializes a new instance of the <see cref=\"RevitWindowUtils\"/> class.\n/// </summary>\n/// <param name=\"uiApplication\"><see cref=\"UIApplication\"/></param>\npublic class RevitWindowUtils(UIApplication uiApplication)\n{\n  private readonly IntPtr _mainWindowHandle = uiApplication.MainWindowHandle;\n\n  [DllImport(\"user32.dll\")]\n  private static extern IntPtr GetActiveWindow();\n\n  /// <summary>\n  /// Is main Revit window active\n  /// </summary>\n  public bool IsMainWindowActive() => GetActiveWindow() == _mainWindowHandle;\n}\n</code></pre>\n\nI create and store its static instance in the application class, and check it in IUpdater as follows:\n\n<pre><code class=\"language-cs\">public void Execute(UpdaterData data)\n{\n  if (!App.RevitWindowUtils.IsMainWindowActive())\n    return;\n</code></pre>\n\nMany thanks to Aleksandr for this elegant solution."
  }
][
  {
    "original_filename": "2039_lookup",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- bimrras\n  email [Re: [BIMrras] Interview Publication Tomorrow] Evelio E. Sánchez Juncal <eveliosanchez@spaplaneamento.com>\n  https://www.bimrras.com/episodio/157-building-with-code-with-jeremy-tammik/?utm_source=newsletter&utm_medium=tuit&utm_campaign=episodio\n  https://bit.ly/BIMrras157Bol\n  2024-05-06_bimrras_157a.pdf\n  /Users/jta/a/doc/revit/tbc/git/a/doc/2024-05-06_bimrras_157b.txt\n\ntwitter:\n\nNew releases of RevitLookup vastly expand coverage to include numerous new classes and properties, BIMrras podcast interview, linking Revit files in BIM360 Docs and Outline versus BoundingBox in the @AutodeskRevit #RevitAPI #BIM @DynamoBIM https://autode.sk/bimrras\n\nNew releases of RevitLookup vastly expand coverage to include numerous new classes and properties\n&ndash; BIMrras podcast interview\n&ndash; RevitLookup 2025.0.3\n&ndash; RevitLookup 2025.0.4\n&ndash; <code>Outline</code> versus <code>BoundingBox</code>\n&ndash; Linking Revit files in BIM360 Docs...\n\nlinkedin:\n\nNew releases of RevitLookup vastly expand coverage to include numerous new classes and properties, BIMrras podcast interview, linking Revit files in BIM360 Docs and Outline versus BoundingBox in the #RevitAPI\n\nhttps://autode.sk/bimrras\n\n- BIMrras podcast interview\n- RevitLookup 2025.0.3\n- RevitLookup 2025.0.4\n- Outline versus BoundingBox\n- Linking Revit files in BIM360 Docs...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2039_lookup",
    "header_text": "RevitLookup Updates, Bounding Boxes and Podcast",
    "local_header_href": "#revitlookup-updates-bounding-boxes-and-podcast",
    "chunk_text": "### RevitLookup Updates, Bounding Boxes and Podcast\n\nA quick heads-up on a podcast interview, new releases of RevitLookup vastly expanding coverage to include numerous new classes and properties, and other notes of interest:\n\n- [BIMrras podcast interview](#2)\n- [RevitLookup 2025.0.3](#3)\n- [RevitLookup 2025.0.4](#4)\n- [`Outline` versus `BoundingBox`](#5)\n- [Linking Revit files in BIM360 Docs](#6)"
  },
  {
    "original_filename": "2039_lookup",
    "header_text": "BIMrras Podcast Interview",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> BIMrras Podcast Interview\n\nEvelio Sánchez y Rogelio Carballo invited me to participate in\ntheir [BIMrras Podcast](https://www.bimrras.com/):\n\n> El Primer Podcast BIM Colaborativo\n<br/>¡El podcast sobre BIM que Chuck Norris no se atreve a escuchar!\n\nI joined them last week for a very pleasant chat in\nepisode [157 Building with code, with Jeremy Tammik](https://www.bimrras.com/episodio/157-building-with-code-with-jeremy-tammik/)."
  },
  {
    "original_filename": "2039_lookup",
    "header_text": "RevitLookup 2025.0.3",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> RevitLookup 2025.0.3\n\nRoman [@Nice3point](https://t.me/nice3point) Karpovich, aka Роман Карпович,\npublished [RevitLookup release 2025.0.3](https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.3),\nintegrating extensive work\nby [Sergey Nefyodov](https://github.com/SergeyNefyodov) to expand coverage to numerous new classes, properties and contexts.\n\nSergey packaged his enhancements in pull requests\n[227 (`ConnectorManager`)](https://github.com/jeremytammik/RevitLookup/pull/227),\n[228 (`Wire`)](https://github.com/jeremytammik/RevitLookup/pull/228),\n[229 (`IndependentTag`)](https://github.com/jeremytammik/RevitLookup/pull/229),\n[230 (`CurveElement`)](https://github.com/jeremytammik/RevitLookup/pull/230),\n[231 (`TableView`)](https://github.com/jeremytammik/RevitLookup/pull/231),\n[232 (`DatumPlane`)](https://github.com/jeremytammik/RevitLookup/pull/232)\nand [233 (extensions)](https://github.com/jeremytammik/RevitLookup/pull/233).\n\nSpecific improvement include:\n\nMemory diagnoser:\n\n<center>\n<img src=\"img/revitlookup_memory.png\" alt=\"Memory diagnoser\" title=\"Memory diagnoser\" width=\"800\"/> <!-- Pixel Height: 555 Pixel Width: 1,016 -->\n</center>\n\n- The `Memory` column shows the size of allocated **managed memory**\n- Native ETW and allocations in C++ code are not included to avoid severe performance degradation\n\nDifferent method overload variations now displayed in a `Variants` collection:\n\n- Previously: `GeometryElement`\n- Now: `Variants<GeometryElement>`\n\n<center>\n<img src=\"img/revitlookup_variants.png\" alt=\"Overload variations\" title=\"Overload variations\" width=\"800\"/> <!-- Pixel Height: 555 Pixel Width: 1,016 -->\n</center>\n\nMore:\n\n- ConnectorManager class support\n  &ndash; Added `ConnectorManager.Lookup`\n- Wire class support\n  &ndash; Added `Wire.GetVertex`\n- IndependentTag class support\n  &ndash; Added `IndependentTag.CanLeaderEndConditionBeAssigned`, `IndependentTag.GetLeaderElbow`, `IndependentTag.GetLeaderEnd`, `IndependentTag.HasLeaderElbow`, `IndependentTag.IsLeaderVisible`\n- CurveElement class support\n  &ndash; Added `CurveElement.GetAdjoinedCurveElements`, `CurveElement.HasTangentLocks`, `CurveElement.GetTangentLock`, `CurveElement.HasTangentJoin`, `CurveElement.IsAdjoinedCurveElement`\n- TableView class support\n  &ndash; Added `TableView.GetAvailableParameters`, `TableView.GetCalculatedValueName`, `TableView.GetCalculatedValueText`, `TableView.IsValidSectionType`, `TableView.GetCellText`\n- DatumPlane class support\n  &ndash; Added `DatumPlane.CanBeVisibleInView`, `DatumPlane.GetPropagationViews`, `DatumPlane.CanBeVisibleInView`, `DatumPlane.GetPropagationViews`, `DatumPlane.GetDatumExtentTypeInView`, `DatumPlane.HasBubbleInView`, `DatumPlane.IsBubbleVisibleInView`, `DatumPlane.GetCurvesInView`, `DatumPlane.GetLeader`\n- Extensions\n  &ndash; Added Family class extension `FamilySizeTableManager.GetFamilySizeTableManager`, FamilyInstance class extension `AdaptiveComponentInstanceUtils.GetInstancePlacementPointElementRefIds`, FamilyInstance class extension `AdaptiveComponentInstanceUtils.IsAdaptiveComponentInstance`, Solid class extension `SolidUtils.SplitVolumes`, Solid class extension `SolidUtils.IsValidForTessellation`\n- [Full changelog 2025.0.2...2025.0.3](https://github.com/jeremytammik/RevitLookup/compare/2025.0.2...2025.0.3)\n- [RevitLookup versioning](https://github.com/jeremytammik/RevitLookup/wiki/Versions)"
  },
  {
    "original_filename": "2039_lookup",
    "header_text": "RevitLookup 2025.0.4",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> RevitLookup 2025.0.4\n\nAs if that were not enough, Roman and Sergey immediately followed up\nwith [RevitLookup release 2025.0.4](https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.4),\nintegrating the further pull requests\n[235](https://github.com/jeremytammik/RevitLookup/pull/235)\nand [236](https://github.com/jeremytammik/RevitLookup/pull/236),\nfocused on improving core functionalities and robustness of the product.\n\n- Introducing a preview feature for **Family Size Table**, making it easier to manage and visualize family sizes\n\n<center>\n<img src=\"img/revitlookup_family_size_table.png\" alt=\"Family size table\" title=\"Family size table\" width=\"800\"/> <!-- Pixel Height: 555 Pixel Width: 1,016 -->\n</center>\n\nTo access it:\n\n- Enable **Show Extensions** in the view menu\n- Select any **FamilyInstance**\n- Navigate to the **Symbol**\n- Navigate to the **Family** (or just search for Family class objects in the **Snoop database** command)\n- Navigate to the **GetFamilySizeTableManager** method\n- Navigate to the **GetSizeTable** method\n- Right-click on one of the tables and select the **Show table** command\n- Note: Family size table is currently in read-only mode\n\nMore:\n\n- Added new context menu item for selecting elements without showing\n- Added new fresh, intuitive icons to the context menu for a more user-friendly interface.\n- Refined labels, class names, and exception messages\n- Resolved an issue where the delete action was not displayed in the context menu for ElementType classes\n- Fixed the context menu display issue for Element classes, broken in previous release\n- Fixed the order of descriptors to prevent missing extensions and context menu items in some classes, broken in previous release\n- [Full changelog](https://github.com/jeremytammik/RevitLookup/compare/2025.0.3...2025.0.4)\n- [RevitLookup versioning](https://github.com/jeremytammik/RevitLookup/wiki/Versions)\n\nEver so many thanks to Roman and Sergey for their impressive and untiring implementation and maintenance work!"
  },
  {
    "original_filename": "2039_lookup",
    "header_text": "Outline Versus BoundingBox",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Outline Versus BoundingBox\n\nInteresting aspects of different kinds of bounding boxes and their uses in intersection filters are discussed in the thread\non [`Outline` vs `BoundingBoxXYZ` in Revit API](https://forums.autodesk.com/t5/revit-api-forum/outline-vs-boundingboxxyz-in-revit-api/m-p/12670522)."
  },
  {
    "original_filename": "2039_lookup",
    "header_text": "Linking Revit Files in BIM360 Docs",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Linking Revit Files in BIM360 Docs\n\nSeveral users asked whether it is possible to link Revit projects directly in ACC and BIM360 Docs.\nLuckily, Eason Kang has covered that topic extensively in his article\non [BIM360 Docs: Setting up external references between files (Upload Linked Files)](https://aps.autodesk.com/blog/bim360-docs-setting-external-references-between-files-upload-linked-files)."
  }
][
  {
    "original_filename": "2040_rvt_2025_1",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- Placing detail group in legend view without access to UI (Design Automation)\n  https://forums.autodesk.com/t5/revit-api-forum/placing-detail-group-in-legend-view-without-access-to-ui-design/m-p/12795399\n\n- implement RAG in 10 lines\n  https://x.com/Yampeleg/status/1793698848616960393\n  retrieval augmented generation:\n  https://fastai.github.io/lm-hackers/lm-hackers.html#retrieval-augmented-generation\n\ntwitter:\n\nUpdate release Revit 2025.1, the hacker's guide to LLM and an LLM retrieval augmented generation in 10 lines of code and placing a detail group in ASP Design Automation, lacking the UI in the @AutodeskRevit #RevitAPI #BIM @DynamoBIM https://autode.sk/revit_2025_1\n\nThe first update release of Revit 2025, placing a detail group in ASP Design Automation, lacking the UI, the hacker's guide to LLM and an LLM retrieval augmented generation in 10 lines of code...\n\nlinkedin:\n\nUpdate release Revit 2025.1, the hacker's guide to LLM and an LLM retrieval augmented generation in 10 lines of code and placing a detail group in ASP Design Automation, lacking the UI in the #RevitAPI\n\nhttps://autode.sk/revit_2025_1\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2040_rvt_2025_1",
    "header_text": "Revit 2025.1 and Handling Lack of UI in DA",
    "local_header_href": "#revit-20251-and-handling-lack-of-ui-in-da",
    "chunk_text": "### Revit 2025.1 and Handling Lack of UI in DA\n\nA quick heads-up on the first update release of Revit 2025, a solution for placing a detail group in ASP Design Automation, lacking the UI, and an LLM retrieval augmented generation in 10 lines of code:\n\n- [Revit 2025.1](#2)\n    - [Software included](#2.1)\n    - [Enhancements](#2.2)\n    - [Issues resolved](#2.3)\n    - [Revit 2025.1 SDK](#2.4)\n- [Placing detail group without UI access](#3)\n- [Hacker's guide to LLM and 10-Line RAG](#4)"
  },
  {
    "original_filename": "2040_rvt_2025_1",
    "header_text": "Revit 2025.1",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Revit 2025.1\n\nThe Revit 2025.1 update release was made available on May 22, 2024, via Autodesk Access or from the Autodesk subscription site.\n\nThe official [Revit 2025.1 update release notes](https://help.autodesk.com/view/RVT/2025/ENU/?guid=RevitReleaseNotes_2025updates_2025_1_html) list\nthe following details:\n\n####<a name=\"2.1\"></a> Software Included\n\n- Core Package Component for Revit 2025 - version 25.1.0.44\n- Core-RVT Package Component for Revit 2025 - version 25.1.0.44\n- ATF for Revit 2025 - version 25.1.0.44\n- Core Package Component Cloud for Revit 2025 - version 25.1.0.44\n- Dynamo Core for Revit 2025 - version 25.1.0.44\n- TwinMotion Package Component for Revit 2025 - version 25.1.0.44\n- Unit Schemas for Revit 2025 - version 25.1.0.44\n- Generative Design For Revit - version 25.3.21.0\n- Personal Accelerator for Revit 2025 - version 24.4.21.0\n\n####<a name=\"2.2\"></a> Enhancements\n\n- Coordination Model\n    - Added a tooltip for the truncated model name for the selected model in the Coordination Model Changes dialog.\n    - Fixed an issue that could occur when using the unload and reload options for Coordination Model Changes.\n- Export PDF\n    - Improved the message for cancelling background PDF export.\n    - Provided an error message when \"Coordination Model Changes\" mode is turned on during background PDF export.\n    - Resolved the issue of the default 3D view not being correctly exported to PDF in the background when its orientation was changed but unsaved.\n    - Improved the performance of background PDF export - for example, in one model where exporting 16 views previously took 34 minutes, it now takes 3 minutes.\n- Family Editor\n    - Simplified the Additional Settings ribbon menu by removing the dividing lines.\n- IFC\n    - Improved performance of some elongated elements export to IFC 4.\n- Macros\n    - Updated the Revit SDK MacroSample to .NET 8.\n- Pressure Loss Calculations\n    - Fixed an issue that caused a graphic override to not be applied to analytical segments for duct and pipe fittings.\n- Reinforcement\n    - Dimensions on bars in area and path reinforcement are maintained after removing the path or area system.\n- Site\n    - Sub-divisions share the Cut line settings as toposolid.\n    - Improved the wording in the Generate Toposolid from Toposurface dialog.\n    - Improved the link topography to be more stable with hosted elements and Boolean results when reloading links.\n- Slab\n    - Added a confirmation for the Reset Shape command when resetting to the original shape.\n- Truss\n    - Enabled the scheduling of shared parameters defined in the structural truss family.\n- User Interface\n    - Improved several rename dialogs to make them wider by default and resizable to fit long names.\n\n####<a name=\"2.3\"></a> Issues Resolved\n\n- General\n    - Addressed potential security vulnerabilities.\n- Annotation\n    - Resolved the issue that edit boundary command is grayed out when editing the filled region.\n- API\n    - Fixed an API issue where GetAllInstalledRevitProducts does not properly return the correct Revit 2025 version.\n    - Fixed an issue which prevented ASP.Net Core from being used in Revit addins.\n    - Fixed issue that could occur when the Windows region was set to Thai/Thailand.\n- Assembly\n    - Resolved the issue that customers cannot adjust text leader in assembly view.\n- Coordination Model\n    - Fixed an issue for parameters created under “Other” group when editing families from a Revit model.\n    - Fixed an issue regarding the positioning of local coordination models linked by shared coordinates.\n    - Fixed an issue that could occur when changing the path type of a local coordination model.\n- Copy-Cut-Paste\n    - Improved stability when trying to insert 2D elements into a Drafting View.\n- Dynamo for Revit\n    - Fixed an issue where Remember nodes would be removed from old Dynamo graphs when opened in Revit.\n- Dynamo Player\n    - Fixed an issue with numeric display in Generative Design in some languages.\n- Energy Model\n    - Improved stability when regenerating the energy analytical model while another user is borrowing it.\n    - Improved stability when running an energy analysis.\n    - Improved stability when generating an energy analytical model when system time is set to a time zone close to the international date line.\n- Export DWG/DXF\n    - Fixed an issue where solid hatches would get the wrong index color when exported to DWG.\n- Export PDF\n    - Resolved the issue where elements from closed worksets were exported to PDF in the background.\n    - Resolved the issue where the value of keynote tag from a linked Revit model was missing in the background export result.\n    - Resolved the issue where file size increases after cancelling background PDF export.\n    - Resolved the issue that grid heads in linked model was not exported correctly after running background PDF export.\n- File Open/Save\n    - Fixed an issue that a pasted local path can't be navigated in File Open and Import/Link RVT dialog.\n    - Improved stability when opening Revit Server models from different site of host without Revit Server Accelerator.\n- Fill Patterns\n    - Fixed an issue where Solid fills on model objects that have a transparent override were not exported to DWG when the far clip of the view was active.\n- Keyboard Shortcuts\n    - Restored two keyboard shortcuts (EOH and VOH) that can be used for element and category halftone overrides.\n- Location\n    - Improved stability of the Location dialog.\n- MEP Connectors\n    - Fixed an issue that caused disconnection errors when a family containing adjustable connectors is modified.\n- Part Elements\n    - Improved stability when editing intersecting named references for dividing parts.\n    - Fixed an API issue where PartUtils.FindMergeableClusters would return invalid clusters.\n- Plan Regions\n    - Resolved the issue where applying a plan region affected the graphics of elements outside its boundary.\n- Precast\n    - Improved the behavior of Precast CAM export to take into account moved and removed bars in rebar sets.\n- Pressure Loss Calculations\n    - Fixed an issue that led the background worker process into an endless flow and pressure loss calculation.\n    - Fixed an issue that prevented network-based duct flow calculations when the flow was set on the source equipment.\n- Reinforcement\n    - Fixed an issue where a multi-rebar annotation would get an incorrect orientation when referencing rebar sets that are slightly rotated with respect to the view.\n    - Improved stability when editing new rebar shape families in a project.\n    - Improved the behavior when dimensioning rebar to allow picking the end reference for rebar shapes with multiple segments in any view orientation.\n- Revit Cloud Model (workshared)\n    - Fixed an issue where the Save File dialog is shown after synchronizing with a Revit Server model.\n    - Fixed an issue where Revit would become unresponsive during service disruptions with Revit Cloud Worksharing.\n- Revit Home\n    - Fixed an auto-refresh issue with the new Revit Home when there was a change in accounts and projects.\n    - Fixed the issue that Revit Home is not updating when there are changes for folders and files in ACC and BIM360.\n- Selection\n    - Fixed the issue of Select Multiple button status not updating correctly when working with roof.\n- Site\n    - Fixed an issue regarding workset edit for link topography.\n    - Fixed an issue when partial sketch lines constrained by walls.\n- Solar Analysis\n    - Updated the message that displays when trying to do a solar analysis in a perspective view.\n- Startup/Shutdown\n    - Improved stability when exiting Revit.\n    - Improved stability during Revit shutdown for cases that could have previously triggered an error report after close.\n- Tags\n    - Fixed an issue where multi-leader keynote tags would incorrectly show \"varies\" when some leaders where hidden.\n- User Interface\n    - Improved the stability when working with UI theme.\n    - Resolved an issue with the Options Bar user interface when using modification tools.\n\n####<a name=\"2.4\"></a> Revit 2025.1 SDK\n\nThe Revit SDK was also updated.\nThe updated version is available from\nthe [APS Revit developer page](https://aps.autodesk.com/developer/overview/revit).\nOne small change in the documentation right up front says:\n\n> Major changes and renovations to the Revit 2025.1 API\n\n> API additions\n\n> AspNetCore\n\n> Revit now has a framework reference to Microsoft.AspNetCore.App, so that addins can use AspNetCore.\n\nFurthermore, note the API-related issues listed above, some of them not under the API heading:\n\n- Updated the Revit SDK MacroSample to .NET 8\n- Fixed an API issue where GetAllInstalledRevitProducts does not properly return the correct Revit 2025 version\n- Fixed an issue which prevented ASP.Net Core from being used in Revit addins\n- Fixed issue that could occur when the Windows region was set to Thai/Thailand\n- Fixed an API issue where PartUtils.FindMergeableClusters would return invalid clusters,\n  cf. the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n  reporting that [PartUtils.FindMergeableClusters finds clusters which are not valid for merge](https://forums.autodesk.com/t5/revit-api-forum/partutils-findmergeableclusters-finds-clusters-which-are-not/m-p/12402263)\n\n<center>\n<img src=\"img/rvt_2025_1.png\" alt=\"Revit 2025.1\" title=\"Revit 2025.1\" width=\"800\"/> <!-- Pixel Height: 585 Pixel Width: 1,000 -->\n</center>"
  },
  {
    "original_filename": "2040_rvt_2025_1",
    "header_text": "Placing Detail Group Without UI Access",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Placing Detail Group Without UI Access\n\nLuiz Henrique [@ricaun](https://ricaun.com/) Cassettari provided a nice workaround to\nenable [placing detail group in legend view without access to UI, e.g., for Design Automation](https://forums.autodesk.com/t5/revit-api-forum/placing-detail-group-in-legend-view-without-access-to-ui-design/m-p/12795399):\n\n**Question:** I would like to *place a detail group in legend view without access to UI  for Design Automation*:\nin Design Automation for Revit, I want to place detail groups onto a legend view. The approach would typically be:\n\n- [change active view](https://www.revitapidocs.com/2017/b6adb74b-39af-9213-c37b-f54db76b75a3.htm)\n- [call PlaceGroup()](https://www.revitapidocs.com/2019/586d4f2e-0985-2d0b-dbb7-ea6d2f704336.htm)\n\nHowever, in Design Automation, I don't have access to the UI and therefore cannot set `UIDocument.Activeview`.\nIs there an alternative method for placing detail groups which takes in a `View` as an argument?\nOr are there ways to change the `ActiveView` in Design Automation?\n\nRicaun provided non-UI-dependent code that places both model and detail groups.\nIt just lacks the possibility to control the target view.\n\nHowever, this can be worked around by letting Revit place the detail group in any old view,\nthen copy and paste to the desired target view and delete the intermediate element.\n\nHere is a 30-minute video testing [placement of a detail group in both Revit on the Windows desktop and Revit for Design Automation](https://youtu.be/oSCvXGx4SaM):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/oSCvXGx4SaM?si=MU_SFS--lr4zLW15\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n</center>\n\nGoing even further, ricaun\nimplemented [`RevitTestPlaceGroup.Tests`, a unit test project for the PlaceGroup problem](https://github.com/ricaun-io/RevitTestPlaceGroup.Tests) and\nshows it running in another 36-minute video\non [creating `PlaceGroupDetail` unit test for Revit API](https://youtu.be/VhaFv_UaHGU):\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/VhaFv_UaHGU?si=Gj1VWrgOh3ajtSsa\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n</center>\n\nEver so many thanks to ricaun for the very helpful work and excellent documentation!"
  },
  {
    "original_filename": "2040_rvt_2025_1",
    "header_text": "Hacker's Guide to LLM and 10-Line RAG",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Hacker's Guide to LLM and 10-Line RAG\n\n[A hacker’s guide to language models](https://fastai.github.io/lm-hackers/lm-hackers.html) provides\na nice introduction to the topic and includes subjects like\nimplementing [retrieval augmented generation](https://fastai.github.io/lm-hackers/lm-hackers.html#retrieval-augmented-generation)\ne.g., [how to implement RAG in 10 lines](https://x.com/Yampeleg/status/1793698848616960393)."
  }
][
  {
    "original_filename": "2041_hide_linked",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- hide elements in linked model\n  https://forums.autodesk.com/t5/revit-ideas/hide-elements-in-linked-model/idc-p/12786934#M57768\n  Hide elements in linked file\n  https://forums.autodesk.com/t5/revit-api-forum/hide-elements-in-linked-file/td-p/5777305\n  @lvirone\n  Lorenzo VIRONE\n  I've found a solution:\n  //Select elements using UIDocument and then use PostCommand \"HideElements\"\n  //elemsFromRevitLinkInstance is \"List<Element>\", there are the elements you want to hide in the link\n  var refs = elemsFromRevitLinkInstance.Select(x => new Reference(x).CreateLinkReference(revitLinkInstance)).ToList();\n  uidoc.Selection.SetReferences(refs);\n  uidoc.Application.PostCommand(RevitCommandId.LookupPostableCommandId(PostableCommand.HideElements));\n  demonstrate how to preselect elements for PostCommand processing\n\ntwitter:\n\nThe video recording on What's New in the Revit 2025 API has been released, and we discuss a nice example combining element pre-selection and PostCommand for hiding linked elements in the @AutodeskRevit #RevitAPI #BIM @DynamoBIM https://autode.sk/hidelinkedelement\n\nThe video recording on what's new in the Revit 2025 API has been released, and we discuss a nice example combining element pre-selection and PostCommand\n&ndash; Revit 2025 API video\n&ndash; Hiding linked elements...\n\nlinkedin:\n\nThe video recording on What's New in the Revit 2025 API has been released, and we discuss a nice example combining element pre-selection and PostCommand for hiding linked elements in the #RevitAPI\n\nhttps://autode.sk/hidelinkedelement\n\n- Revit 2025 API video\n- Hiding linked elements...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2041_hide_linked",
    "header_text": "Revit 2025 API Video and Hiding Linked Elements",
    "local_header_href": "#revit-2025-api-video-and-hiding-linked-elements",
    "chunk_text": "### Revit 2025 API Video and Hiding Linked Elements\n\nThe video recording on what's new in the Revit 2025 API has been released, and we discuss a nice example combining element pre-selection and `PostCommand`:\n\n- [Revit 2025 API video](#2)\n- [Hiding linked elements](#3)"
  },
  {
    "original_filename": "2041_hide_linked",
    "header_text": "Revit 2025 API Video",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Revit 2025 API Video\n\nBoris Shafiro and Michael Morris present the video recording of the presentations\non [What's new in Autodesk Revit 2025 API](https://www.youtube.com/playlist?list=PLuFh5NgXkweMoOwwM2NlYmQ7FdMKPEBS_).\nIt consists of three parts:\n\n- [Introduction and .NET 8 Migration](https://youtu.be/ONLf4BuGBU8) (7 minutes)\n- [Breaking changes and removed API](https://youtu.be/huj3ynWwejA) (15 minutes)\n- [New APIs and Capabilities](https://youtu.be/jExac5Kv-Qs) (40 minutes)\n\n<center>\n<img src=\"img/rvt2025apivideo.png\" alt=\"Revit 2025 API video\" title=\"Revit 2025 API video\" width=\"800\"/>\n</center>\n\nPlease also refer to the following previous articles related to Revit 2025 API:\n\n- [Revit 2025 and RevitLookup 2025](https://thebuildingcoder.typepad.com/blog/2024/04/revit-2025-and-revitlookup-2025.html)\n- [The Building Coder Samples 2025](https://thebuildingcoder.typepad.com/blog/2024/04/the-building-coder-samples-2025.html)\n- [RevitLookup Hotfix and the Revit 2025 SDK](https://thebuildingcoder.typepad.com/blog/2024/04/revitlookup-hotfix-and-the-revit-2025-sdk.html)\n- [What's New in the Revit 2025 API](https://thebuildingcoder.typepad.com/blog/2024/04/whats-new-in-the-revit-2025-api.html)\n- [Migrating VB to .NET Core 8](https://thebuildingcoder.typepad.com/blog/2024/05/migrating-vb-to-net-core-8-and-ai-news.html)\n- [Revit 2025.1](https://thebuildingcoder.typepad.com/blog/2024/05/revit-20251-and-handling-lack-of-ui-in-da.html)"
  },
  {
    "original_filename": "2041_hide_linked",
    "header_text": "Hiding Linked Elements",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Hiding Linked Elements\n\nTurning to a topic that has not yet been addressed by the new release, the open Revit Ideas wish list item\nto [hide elements in linked model](https://forums.autodesk.com/t5/revit-ideas/hide-elements-in-linked-model/idc-p/12786934),\nLorenzo Virone shared a solution using `PostCommand` and element pre-selection via `Selection.SetReferences`.\nHe explains the detailed approach in\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread on how\nto [hide elements in linked file](https://forums.autodesk.com/t5/revit-api-forum/hide-elements-in-linked-file/td-p/5777305):\n\nThis solution also demonstrates how to preselect elements for `PostCommand` processing:\n\n<pre><code class=\"language-cs\">// Select elements using UIDocument\n// then use PostCommand \"HideElements\"\n// elemsFromRevitLinkInstance is \"List&lt;Element&gt;\"\n// these are the elements you want to hide in the link\n\nvar refs = elemsFromRevitLinkInstance.Select( x\n  => new Reference(x).CreateLinkReference(revitLinkInstance))\n    .ToList();\n\nuidoc.Selection.SetReferences(refs);\n\nuidoc.Application.PostCommand(\n  RevitCommandId.LookupPostableCommandId(\n    PostableCommand.HideElements));\n</code></pre>\n\n**Response:** Can you provide a description of the process for using your code to hide elements only in a linked model?\nI am not familiar with the API and deploying a script like this.\n\n**Answer:**\nHere is an sample that selects the first RevitLinkInstance, retrieve its floors and hides them:\n\n<pre><code class=\"language-cs\">// Get a link\nvar filter = new ElementClassFilter(typeof(RevitLinkInstance));\n\nvar firstInstanceLink\n  = (RevitLinkInstance) new FilteredElementCollector(doc)\n    .WherePasses(filter)\n    .FirstElement();\n\n// Get its floors\nfilter = new ElementClassFilter(typeof(Floor));\nvar elemsFromRevitLinkInstance\n  = new FilteredElementCollector(\n    firstInstanceLink.GetLinkDocument())\n      .WherePasses(filter)\n      .ToElements();\n\n// Isolate them\nvar refs = elemsFromRevitLinkInstance.Select( x\n  => new Reference(x).CreateLinkReference(firstInstanceLink))\n    .ToList();\n\nuidoc.Selection.SetReferences(refs);\n\nuidoc.Application.PostCommand(\n  RevitCommandId.LookupPostableCommandId(\n    PostableCommand.HideElements));\n</code></pre>\n\nMany thanks to Lorenzo for addressing this need and sharing his helpful solution!"
  }
][
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- remove ribbon panel and ribbon button\n  https://chuongmep.com/posts/2024-04-19-reload-ribbon-revit.html#remove-panel\n  find ribbon tabs and or panels and delete\n  https://forums.autodesk.com/t5/revit-api-forum/find-ribbon-tabs-and-or-panels-and-delete/m-p/12793159#M79071\n\n- Open-Endedness is Essential for Artificial Superhuman Intelligence\n  https://arxiv.org/abs/2406.04268\n\n- accurate forecasts, finally?\n  No physics? No problem. AI weather forecasting is already making huge strides.\n  New model that predicts global weather can run on a single desktop computer.\n  https://arstechnica.com/ai/2024/06/as-a-potentially-historic-hurricane-season-looms-can-ai-forecast-models-help/\n\n- bilinguals get dementia on average four years later than monolinguals\n  https://www.economist.com/books-and-arts/2020/02/29/the-advantages-of-speaking-a-second-language\n  /Users/jta/a/doc/revit/tbc/git/a/doc/bilingual.txt\n\n- language speed and information density\n  Different languages, similar encoding efficiency: Comparable information rates across the human communicative niche\n  https://www.science.org/doi/10.1126/sciadv.aaw2594\n  /Users/jta/a/doc/revit/tbc/git/a/img/language_speed_information.png\n\n- Stockholm Wood City by Atrium Ljungberg\n  https://www.al.se/en/sickla\n  Stockholm Wood City will be built in Sickla, an area in the south of the Swedish capital.\n  Construction on the 250,000 square-metre site will begin in 2025.\n  When complete, ten years later, it will contain 2,000 homes and 7,000 offices, along with restaurants and shops.\n  The 12bn-krona ($1.4bn) project is led by Atrium Ljungberg, a Swedish urban development company.\n\n- General Purpose Interfaces\n  https://modemworks.com/research/general-purpose-interfaces/\n  > The emergence of AI agents lets us reimagine the ways we interact with our digital devices\n  ... explore the next phase of user interface design, as enabled by AI\n  ... principles for designing a single interface that can replace many\n\n- AI headphones let wearer listen to a single person in a crowd, by looking at them just once\n  https://www.washington.edu/news/2024/05/23/ai-headphones-noise-cancelling-target-speech-hearing/\n\n- EU directive on the energy performance of buildings\n  Directive (EU) 2024/1275 of the European Parliament and of the Council\n  of 24 April 2024\n  on the energy performance of buildings\n  https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024L1275\n  The European Union has formally adopted and published a recast directive on energy performance for buildings. What’s changing?\n  - New buildings must be net-zero by 2030\n  - Existing buildings must be renovated to meet energy performance requirements\n  - Building performance data to become more accessible, with improved funding\n  - New incentives to deploy digital solutions, including building modeling and simulation\n  Article 7\n  New buildings\n  1. Member States shall ensure that new buildings are zero-emission buildings in accordance with Article 11:\n  (a) from 1 January 2028, new buildings owned by public bodies; and\n  (b) from 1 January 2030, all new buildings;\n  Article 8 Existing buildings\n  Article 10 Solar energy in buildings\n\n- llama3v open source multi-modal LLM\n  https://huggingface.co/mustafaaljadery/llama3v\n  Comparable performance to GPT4-V, Gemini Ultra, Claude Opus with a 100x smaller model\n  SOTA open source VLM for Llama3 8B\n  RAG in 10 lines\n\ntwitter:\n\nFeedback on no Zips downloading RCM from Docs, EU AEC energy directive, wooden buildings, spoken human language speed and information density, AI news and removing ribbon panels and buttons in the @AutodeskRevit #RevitAPI #BIM @DynamoBIM https://autode.sk/nozipsfromdocs\n\nA call for feedback on a planned change downloading a RCM from Docs, a tricky solution to remove ribbon panels and buttons, and a bunch of news bites that I found interesting on sustainability, language and AI discoveries; new EU AEC energy ruling, ecological wooden buildings in Scandinavia, spoken human language speed and information density, AI uses as a hearing aid enhancement, weather forecasting, interface assistant, AI open-source and future directions...\n\nlinkedin:\n\nFeedback on no Zips downloading RCM from Docs, EU AEC energy directive, wooden buildings, spoken human language speed and information density, AI news and removing ribbon panels and buttons in the #RevitAPI\n\nhttps://autode.sk/nozipsfromdocs\n\n- No zips downloading RCM from Docs?\n- Removing ribbon panel and button\n- EU building energy performance directive\n- Stockholm wood city\n- Bilinguals get dementia later\n- Language speed and information density\n- Ai headphones target single person\n- Accurate AI weather forecast\n- General purpose interfaces\n- Llama3V open source multi-modal LLM\n- Open-endedness for superhuman AI...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Removing Docs Zip Files, Panels and Buttons",
    "local_header_href": "#removing-docs-zip-files-panels-and-buttons",
    "chunk_text": "### Removing Docs Zip Files, Panels and Buttons\n\nA call for feedback on a planned change downloading a RCM from Docs, a tricky solution to remove ribbon panels and buttons, and a bunch of news bites that I found interesting on sustainability, language and AI discoveries; new EU AEC energy ruling, ecological wooden buildings in Scandinavia, spoken human language speed and information density, AI uses as a hearing aid enhancement, weather forecasting, interface assistant, AI open-source and future directions:\n\n- [No zips downloading RCM from Docs?](#2)\n- [Removing ribbon panel and button](#3)\n- [EU building energy performance directive](#4)\n- [Stockholm wood city](#5)\n- [Bilinguals get dementia later](#6)\n- [Language speed and information density](#7)\n- [Ai headphones target single person](#8)\n- [Accurate AI weather forecast](#9)\n- [General purpose interfaces](#10)\n- [Llama3V open source multi-modal LLM](#11)\n- [Open-endedness for superhuman AI](#12)"
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "No Zips Downloading RCM from Docs?",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> No Zips Downloading RCM from Docs?\n\nThis  is a reposting of\nthe [call for feedback: No more ZIP files when downloading Revit Cloud Models from Docs](https://aps.autodesk.com/blog/call-feedback-no-more-zip-files-when-downloading-revit-cloud-models-docs):\n\n<center>\n<img src=\"img/rcm_no_zip.png\" alt=\"No Zips Downloading RCM from Docs?\" title=\"No Zips Downloading RCM from Docs?\" width=\"600\"/>\n</center>\n\nDoes your application download Revit models from Autodesk/BIM 360 Docs, aka Revit Cloud Model or RCM?\nIf so, you are probably aware that the model is sometimes downloaded as ZIP.\nThis happens when a host model is linked to unpublished models.\nIt often causes confusion to both customers and application developers.\n\nThe Revit team is planning to change this behaviour and eliminate the ZIP.\nThen, when downloading a host model, linked models will not be included.\n\nFor developers, the process of downloading a source file itself does not change.\nHowever, this change might affect your application, depending on what it does.\nTherefore, we would like to understand your use cases to avoid any possible disruption.\n\nIf you think this change might affect your application, are willing to share your use case scenarios and give us feedback, please contact us through:\n\n<center>\n<a href=\"mailto:rcm.download.api.feedback@autodesk.com?subject=RCM download API feedback\">email to `rcm.download.api.feedback@autodesk.com` with the subject `RCM download API feedback`</a>\n</center>\n\nFor more information about the current behaviour downloading a Revit model from Autodesk BIM 360 Docs, please refer to the article\non [why is a Revit model sometimes downloaded as ZIP from BIM 360 or ACC?](https://www.autodesk.com/support/technical/article/caas/sfdcarticles/sfdcarticles/Why-a-RVT-model-is-sometimes-downloaded-as-ZIP-from-BIM-360.html)\n\nThe following blog posts on how to handle RCM zip or composite models in APS list potential use cases which might affect your application:\n\n- [BIM360 Docs: Setting up external references between files (Upload Linked Files)](https://aps.autodesk.com/blog/bim360-docs-setting-external-references-between-files-upload-linked-files)\n- [Make composite Revit design work with Design Automation API for Revit](https://aps.autodesk.com/blog/make-composite-revit-design-work-design-automation-api-revit)\n- [Revit Cloud Worksharing - fast extraction of Revit zip files with partials](https://aps.autodesk.com/blog/revit-cloud-worksharing-fast-extraction-revit-zip-files-partials)\n\nWe are looking forward to hearing from you.\nThank you!"
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Removing Ribbon Panel and Button",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Removing Ribbon Panel and Button\n\n[Chuong Ho](https://chuongmep.com/) provided a solution to\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\non how to [find ribbon tabs and or panels and delete](https://forums.autodesk.com/t5/revit-api-forum/find-ribbon-tabs-and-or-panels-and-delete/m-p/12793159) in\nhis comprehensive article on\n[how to remove panel ribbon without restart Revit](https://chuongmep.com/posts/2024-04-19-reload-ribbon-revit.html#remove-panel):\n\n**Question:**\nIs there an option in Revit 2025 to dynamically delete \"PushButtonData\" from the \"RibbonPanel\", or maybe hide it so that a new button can link to a new DLL?\nAlso, is it possible to create a \"PushButtonData\" from a DLL located in the resources of another DLL?\nIs it generally required that at the time of creation or registration in the panel (before it is clicked and called), the DLL meets all the conditions (class name, location, etc.), or can it already be solved at the time of the call?\n\n**Answer:**\nThis article explains, and points out how to resolve an issue with Private Dictionary to store RibbonItemDictionary;\nyou need do some tricks to remove panel:\n\n- [How to remove panel ribbon without restart Revit](https://chuongmep.com/posts/2024-04-19-reload-ribbon-revit.html#remove-panel)\n\n**Response:**\nIncredible job! Thank you very much! Added to bookmarks.\n\nCan we get the name of the button, its description, or some kind of indicator after clicking it?\n\nFor example, I created one class MyCommand : IExternalCommand and registered it for several \"PushButtonData\" (\"MyButtonOne\", \"MyButtonTwo\").\nAfter clicking on the button both times through the debugger, I will get to the same Execute() method of the MyCommand class.\nIn this case, is it possible to determine which of the buttons called this method?\nAny way at all, even the most perverted...\n\n**Answer:**\nYou can do it with some step like this:\n\n- Add assembly reference `AdWindows.dll`\n- Add the event tracking user click on the button at `IExternalApplication` below\n- Call the action from external command matching the id returned from the event clicked\n\n<pre><code class=\"language-cs\">using AW = Autodesk.Windows;\n\nAutodesk.Windows.ComponentManager.UIElementActivated\n  += RibbonUtils.ComponentManagerOnUIElementActivated;\n\npublic static void ComponentManagerOnUIElementActivated(\n  object sender,\n  AW.UIElementActivatedEventArgs e)\n{\n  try\n  {\n    var id = e.Item.Id;\n    // match with id string contents here and save\n    // after that match with all commands in your plugin\n  }\n</code></pre>\n\n**Response:**\nThank you so much for the prompt response!\nI think this is exactly what I need!\n\nMany thanks to Chuong Ho for the comprehensive solution."
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "EU Building Energy Performance Directive",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> EU Building Energy Performance Directive\n\nSome notes on the new EU ruling on the energy performance of buildings,\n[Directive EU 2024/1275 of the European Parliament and of the Council](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024L1275) of 24 April 2024:\n\nThe European Union has formally adopted and published a directive on energy performance for buildings:\n\n- New buildings must be net-zero by 2030\n- Existing buildings must be renovated to meet energy performance requirements\n- Building performance data to become more accessible, with improved funding\n- New incentives to deploy digital solutions, including building modeling and simulation\n\nArticle 7, New buildings, states that member states shall ensure that new buildings are zero-emission buildings in accordance with Article 11\n(a) from 1 January 2028, new buildings owned by public bodies; and\n(b) from 1 January 2030, all new buildings.\n\nArticle 8 discusses existing buildings, Article 10, solar energy in buildings.\n\nIt will be interesting to see how these rulings pan out."
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Stockholm Wood City",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Stockholm Wood City\n\nIn Scandinavia, wood is taking off in AEC.\nFor example, look at\nthe [Stockholm Wood City](https://www.al.se/en/sickla) by Atrium Ljungberg:\n\n> Stockholm Wood City will be built in Sickla, an area in the south of the Swedish capital.\nConstruction on the 250,000 square-metre site will begin in 2025.\nWhen complete, ten years later, it will contain 2,000 homes and 7,000 offices, along with restaurants and shops.\nThe 12bn-krona ($1.4bn) project..."
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Bilinguals Get Dementia Later",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> Bilinguals Get Dementia Later\n\nPersonally, I am interested in human spoken languages as well as programming, and was happy to read\nabout some [advantages of speaking a second language](https://www.economist.com/books-and-arts/2020/02/29/the-advantages-of-speaking-a-second-language):\n\n> Most notably, they have shown that bilinguals get dementia on average four years later than monolinguals, and that they have an edge in “executive control” &ndash; a basket of abilities that aid people doing complex tasks, including focusing attention, ignoring irrelevant information and updating working memory."
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Language Speed And Information Density",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Language Speed And Information Density\n\nAnother recent investigation looks at language speed and information density and discovers\nthe [different languages have similar encoding efficiency: comparable information rates across the human communicative niche](https://www.science.org/doi/10.1126/sciadv.aaw2594).\n\n<center>\n<img src=\"img/language_speed_information.png\" alt=\"Language speed and information density\" title=\"Language speed and information density\" width=\"600\"/>\n</center>"
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Ai Headphones Target Single Person",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> Ai Headphones Target Single Person\n\nAs an elegant lead over from languages to AI,\nnew [AI headphones let wearer listen to a single person in a crowd, by looking at them just once](https://www.washington.edu/news/2024/05/23/ai-headphones-noise-cancelling-target-speech-hearing/)."
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Accurate AI Weather Forecast",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> Accurate AI Weather Forecast\n\nAI may help provide\nmore [accurate weather forecasts](https://arstechnica.com/ai/2024/06/as-a-potentially-historic-hurricane-season-looms-can-ai-forecast-models-help/):\n\n> No physics? No problem.\nAI weather forecasting is already making huge strides.\nNew model that predicts global weather can run on a single desktop computer."
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "General Purpose Interfaces",
    "local_header_href": "#10",
    "chunk_text": "####<a name=\"10\"></a> General Purpose Interfaces\n\nHow to simplify the ever-growing complexity facing us in everyday life and the growing number of devices we use?\nMaybe [general purpose interfaces](https://modemworks.com/research/general-purpose-interfaces/) can help:\n\n> The emergence of AI agents lets us reimagine the ways we interact with our digital devices\n... explore the next phase of user interface design, as enabled by AI\n... principles for designing a single interface that can replace many"
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Llama3V Open Source Multi-Modal LLM",
    "local_header_href": "#11",
    "chunk_text": "####<a name=\"11\"></a> Llama3V Open Source Multi-Modal LLM\n\nMany large popular AI tools are proprietary,\nThat need not be.\nThe [llama3v open source multi-modal LLM](https://huggingface.co/mustafaaljadery/llama3v) provides:\n\n- Comparable performance to GPT4-V, Gemini Ultra and Claude Opus\n- Its model is 100x smaller\n- SOTA open source VLM for Llama3 8B\n- RAG in 10 lines of code"
  },
  {
    "original_filename": "2042_hide_ribbon",
    "header_text": "Open-Endedness for Superhuman AI",
    "local_header_href": "#12",
    "chunk_text": "####<a name=\"12\"></a> Open-Endedness for Superhuman AI\n\nFinally, for a couple of thoughts on the tricky topic of where AI research might head in the coming years, a paper\nexplaining how [open-endedness is essential for artificial superhuman intelligence](https://arxiv.org/abs/2406.04268).\n\nSo, let's end here, with an open end."
  }
][
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- revitlookup\n  https://www.linkedin.com/feed/update/urn:li:activity:7206337441664749569?utm_source=share&utm_medium=member_desktop\n  Roman Karpovich\n  Revit Geometry Visualization\n  Introducing the new Geometry Visualization feature in RevitLookup! Now you can visualize various geometry objects directly within the interface. Enhance your BIM workflow with this powerful tool!\n  https://lnkd.in/dgZk9q7T\n\n- revitlookup\n  2025.0.5\n  2025.0.6\n  2025.0.7\n  Visualization setting: Solid scale feature #251\n  https://github.com/jeremytammik/RevitLookup/issues/251#issuecomment-2159217724\n\ntwitter:\n\nRevitLookup earns 1000 GitHub stars and implementes BIM element geometry visualization and Wiki for the @AutodeskRevit #RevitAPI #BIM @DynamoBIM https://autode.sk/lookupgeometry\n\nNew RevitLookup BIM element geometry visualization, and 1000 GitHub stars\n&ndash; Versions 2025.0.5, 2025.0.6 and 2025.0.7\n&ndash; Wiki...\n\nlinkedin:\n\nRevitLookup earns 1000 GitHub stars and implementes BIM element geometry visualization and Wiki for the #RevitAPI\n\nhttps://autode.sk/lookupgeometry\n\n- Versions 2025.0.5, 2025.0.6 and 2025.0.7\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "RevitLookup Geometry Visualisation",
    "local_header_href": "#revitlookup-geometry-visualisation",
    "chunk_text": "### RevitLookup Geometry Visualisation\n\nA small step for Roman, a giant leap for the Revit add-in developer community:\n\n- [1000 stars on GitHub](#2)\n- [RevitLookup Geometry Visualization](#3)\n- [RevitLookup 2025.0.5](#4)\n- [RevitLookup 2025.0.6](#5)\n- [RevitLookup 2025.0.7](#6)\n- [Versions and Visualisation Wiki](#7)\n\nRevitLookup has been rewarded 1000 well-earned stars on GitHub.\nTo celebrate,\nRoman [@Nice3point](https://t.me/nice3point) Karpovich, aka Роман Карпович,\npresents a huge new chunk of RevitLookup functionality enabling Revit BIM element geometry visualization."
  },
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "1000 Stars and Geometry Visualisation",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> 1000 Stars and Geometry Visualisation\n\nWe are proud to share that RevitLookup has achieved 1000 stars on GitHub!\nThis milestone is a testament to its value and the dedication of our community.\nThank you for helping us reach this landmark!\n\n<center>\n<a href=\"https://star-history.com/#jeremytammik/RevitLookup&Date\">\n    <picture>\n        <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://api.star-history.com/svg?repos=jeremytammik/RevitLookup&type=Date\" />\n        <source media=\"(prefers-color-scheme: light)\" srcset=\"https://api.star-history.com/svg?repos=jeremytammik/RevitLookup&type=Date\" />\n        <img alt=\"Star History Chart\" src=\"https://api.star-history.com/svg?repos=jeremytammik/RevitLookup&type=Date\" />\n    </picture>\n</a>\n</center>\n\nTo celebrate it, we are excited to introduce a major new feature in this release that will transform your interaction with models, offering a deeper understanding of the geometric objects that constitute your models:"
  },
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "RevitLookup Geometry Visualization",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> RevitLookup Geometry Visualization\n\n> Introducing the new Geometry Visualization feature in RevitLookup!\nNow you can visualize various geometry objects directly within the interface.\nEnhance your BIM workflow with this powerful tool!\n\n<center>\n<img src=\"img/geovis01.jpg\" alt=\"RevitLookup geometry visualisation\" title=\"RevitLookup geometry visualisation\" width=\"600\"/>\n</center>\n\nIt is built using the Revit API `DirectContext3D` functionality and described in\nthe [wiki documentation of RevitLookup Geometry Visualization](https://github.com/jeremytammik/RevitLookup/wiki/Visualization).\nIt was mainly implemented in release 2025.0.5, with further enhancements following in 2025.0.6 and 2025.0.7.\n\nPlease feel free to submit your feedback, wishes and suggestions regarding visualization in\nthe [comments on pull request 245](https://github.com/jeremytammik/RevitLookup/pull/245)."
  },
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "RevitLookup 2025.0.5",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> RevitLookup 2025.0.5\n\n[RevitLookup 2025.0.5](https://github.com/jeremytammik/RevitLookup/releases/edit/2025.0.6) includes\ncomprehensive geometry visualization capabilities, enabling users to visualize various geometry objects directly within the RevitLookup interface.\n\nIn Revit, geometry is at the core of every model.\nWhether you are dealing with simple shapes or intricate structures, having the ability to visualize geometric elements can significantly improve your workflow, analysis and understanding of the BIM.\n\nTo illustrate the power of these visualization capabilities, here are samples of the geometric objects you can now explore directly within RevitLookup:\n\nMesh:\n\n<center>\n<img src=\"img/geovis02mesh.png\" alt=\"Mesh\" title=\"Mesh\" width=\"600\"/>\n</center>\n\nFace:\n\n<center>\n<img src=\"img/geovis03face.png\" alt=\"Face\" title=\"Face\" width=\"600\"/>\n</center>\n\nSolid:\n\n<center>\n<img src=\"img/geovis04solid.png\" alt=\"Solid\" title=\"Solid\" width=\"600\"/>\n</center>\n\nCurve:\n\n<center>\n<img src=\"img/geovis05curve.png\" alt=\"Curve\" title=\"Curve\" width=\"600\"/>\n</center>\n\nEdge:\n\n<center>\n<img src=\"img/geovis06edge.png\" alt=\"Edge\" title=\"Edge\" width=\"600\"/>\n</center>\n\nBoundingBox:\n\n<center>\n<img src=\"img/geovis07boundingbox.png\" alt=\"BoundingBox\" title=\"BoundingBox\" width=\"600\"/>\n</center>\n\nXYZ:\n\n<center>\n<img src=\"img/geovis08xyz.png\" alt=\"XYZ\" title=\"XYZ\" width=\"600\"/>\n</center>\n\nFor detailed documentation, check\nthe [wiki documentation of RevitLookup Geometry Visualization](https://github.com/jeremytammik/RevitLookup/wiki/Visualization).\n\nFeel free to leave comments and suggestions regarding visualization in\nthe [pill request 245](https://github.com/jeremytammik/RevitLookup/pull/245).\nYour input help improve this tool for everyone in the Revit community.\n\nOther improvements include:\n\n- **BoundingBoxXYZ** class support\n    - Added `Bounds` method support\n    - Added `MinEnabled` method support\n    - Added `MaxEnabled` method support\n    - Added `BoundEnabled` method support\n- Added **Edit parameter** icon\n- Added **Select** context menu action for Reference type\n- Added **Export family size table** for FamilySizeTableManager type by @SergeyNefyodov in https://github.com/jeremytammik/RevitLookup/pull/244\n\nAdded new extensions:\n\n- Application: GetFormulaFunctions &ndash; Gets list of function names supported by formula engine\n- Application: GetFormulaOperators &ndash; Gets list of operator names supported by formula engine\n- BoundingBoxXYZ: Centroid &ndash; Gets the bounding box center point\n- BoundingBoxXYZ: Vertices &ndash; Gets list of bounding box vertices\n- BoundingBoxXYZ: Volume &ndash; Evaluate bounding box volume\n- BoundingBoxXYZ: SurfaceArea &ndash; Evaluate bounding box surface area\n- Document: GetAllGlobalParameters &ndash; Returns all global parameters available in the given document\n- Document: GetLightGroupManager &ndash; Gets a light group manager object from the given document\n- Document: GetTemporaryGraphicsManager &ndash; Gets a TemporaryGraphicsManager reference of the document\n- Document: GetAnalyticalToPhysicalAssociationManager &ndash; Gets a AnalyticalToPhysicalAssociationManager for this document\n- Document: GetFamilySizeTableManager &ndash; Gets a FamilySizeTableManager from a Family\n- UIApplication: CurrentTheme &ndash; Gets a current theme\n- UIApplication: CurrentCanvasTheme &ndash; Gets a current canvas theme\n- UIApplication: FollowSystemColorTheme &ndash; Indicate if the overall theme follows operating system color theme\n- View: GetSpatialFieldManager &ndash; Retrieves manager object for the given view\n\nHope everyone enjoys the new release.\nThanks!\n\nMade with love by [@Nice3point](https://t.me/nice3point)."
  },
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "RevitLookup 2025.0.6",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> RevitLookup 2025.0.6\n\n[RevitLookup 2025.0.6](https://github.com/jeremytammik/RevitLookup/releases/edit/2025.0.6) implements:\n\n- [Visualization dark theme support](https://github.com/jeremytammik/RevitLookup/issues/250)\n- [Full changelog](https://github.com/jeremytammik/RevitLookup/compare/2025.0.5...2025.0.6)"
  },
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "RevitLookup 2025.0.7",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> RevitLookup 2025.0.7\n\n[RevitLookup 2025.0.7](https://github.com/jeremytammik/RevitLookup/releases/edit/2025.0.7) implements\nsolid scaling, theme synchronisation with Revit and other improvements:\n\nSolid scaling:\n\nVisualisation now supports scaling a solid, relative to its centre.\nExploring small objects is now even easier, cf.,\n[issue 251](https://github.com/jeremytammik/RevitLookup/issues/251):\n\n<center>\n<img src=\"img/geovis09solid2.png\" alt=\"Solid scaling\" title=\"Solid scaling\" width=\"600\"/>\n</center>\n\nTheme synchronisation with Revit:\n\nStarting with Revit 2024, you can choose to automatically change the RevitLookup theme.\nFans of darker colors will no longer have to dig through the settings every time:\n\n<center>\n<img src=\"img/geovis10theme.png\" alt=\"Theme synchronisation\" title=\"Theme synchronisation\" width=\"600\"/>\n</center>\n\nOther improvements:\n\n- Improved arrow position for vertical edges on visualization\n- Multithreading visualization support. Changing settings now does not affect rendering. Previously there were artifacts due to fast settings changes\n\nNew `Element` extensions:\n\n- GetCuttingSolids &ndash; Gets all the solids which cut the input element\n- GetSolidsBeingCut &ndash; Get all the solids which are cut by the input element\n- IsAllowedForSolidCut &ndash; Validates that the element is eligible for a solid-solid cut\n- IsElementFromAppropriateContext &ndash; Validates that the element is from an appropriate document"
  },
  {
    "original_filename": "2043_lookup_geo_visual",
    "header_text": "Versions and Visualisation Wiki",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> Versions and Visualisation Wiki\n\n- [RevitLookup versioning](https://github.com/jeremytammik/RevitLookup/wiki/Versions)\n- [RevitLookup visualization](https://github.com/jeremytammik/RevitLookup/wiki/Visualization)"
  }
][
  {
    "original_filename": "2044_entitle_license",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- Licencing Plugins - What Revit subscriptions have to be considered?\n  https://forums.autodesk.com/t5/revit-api-forum/licencing-plugins-what-revit-subscriptions-have-to-be-considered/m-p/12766353#M78805\n\n- Entitlement Revit API - My update\n  https://forums.autodesk.com/t5/revit-api-forum/entitlement-revit-api-my-update/td-p/12761235\n\ntwitter:\n\nRevit API discussions on @AutodeskRevit #RevitAPI add-in licensing and multi-version use of the AppStore Entitlement API #BIM @DynamoBIM https://autode.sk/entitlement\n\nTwo illuminating posts from the Revit API discussion forum on licensing and the entitlement API\n&ndash; Multi-version Revit entitlement API\n&ndash; Add-in licensing...\n\nlinkedin:\n\nRevit API discussions on #RevitAPI add-in licensing and multi-version use of the AppStore Entitlement API:\n\nhttps://autode.sk/entitlement\n\n- Multi-version Revit entitlement API\n- Add-in licensing...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2044_entitle_license",
    "header_text": "Entitlement API for Revit, Licensing for Add-Ins",
    "local_header_href": "#entitlement-api-for-revit-licensing-for-add-ins",
    "chunk_text": "### Entitlement API for Revit, Licensing for Add-Ins\n\nToday we highlight two illuminating posts from\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) on\nlicensing and the entitlement API:\n\n- [Multi-version Revit entitlement API](#2)\n- [Add-in licensing](#3)"
  },
  {
    "original_filename": "2044_entitle_license",
    "header_text": "Multi-Version Revit Entitlement API",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Multi-Version Revit Entitlement API\n\nJulian [W7k](https://w7k.pl/) Wandzilak shared\nhis [Entitlement Revit API update](https://forums.autodesk.com/t5/revit-api-forum/entitlement-revit-api-my-update/td-p/12761235):\n\n> I am recently updating all my paid apps to 2025.\nThanks to this forum, everything went rather smoothly.\nExcept I had some weird problems with my `CheckOnline` method based the AEC DevBlog article on\nthe [Entitlement API for Revit Exchange Store Apps](https://adndevblog.typepad.com/aec/2015/04/entitlement-api-for-revit-exchange-store-apps.html).\n\n> For some reason in 2025 I had some problems with RestSharp; while checking the licence in the `OnApplicationInitialized` method, the process was abruptly stopped, weirdly enough, without even throwing errors.\n\n> Update helped, but as RestSharp changed, I started having problems with older Revit versions.\nI decided to rewrite it completely, and this time use the default `HttpClient`:\n\n<pre><code class=\"language-cs\">public static bool CheckOnline( string appId, string userId )\n{\n  Uri uri = new Uri( $\"https://apps.exchange.autodesk.com/webservices/checkentitlement/?userid={userId}&appid={appId}\" );\n\n  bool isValid = false;\n\n  try\n  {\n    HttpClient myHttpClient = new HttpClient();\n\n    Task&lt;HttpResponseMessage&gt; task\n      = Task.Run(() =&gt; myHttpClient.GetAsync(uri));\n\n    task.Wait();\n    HttpResponseMessage response = task.Result;\n\n    Task&lt;string&gt; readTask = response.Content.ReadAsStringAsync();\n    string text = readTask.Result;\n\n    EntitlementResponse entitlementResponse\n      = JsonConvert.DeserializeObject&lt;EntitlementResponse&gt;(text);\n\n    isValid = entitlementResponse.IsValid;\n  }\n  catch\n  {\n    return false;\n  }\n  return isValid;\n}\n\n[Serializable]\npublic class EntitlementResponse\n{\n  public string UserId { get; set; }\n  public string AppId { get; set; }\n  public bool IsValid { get; set; }\n  public string Message { get; set; }\n}\n</code></pre>\n\nHere is the code.\nI hope it might be useful to someone.\nWorks for me in all versions from Revit 2020 through Revit 2025.\nMany thanks to Julian for sharing this."
  },
  {
    "original_filename": "2044_entitle_license",
    "header_text": "Add-In Licensing",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> Add-In Licensing\n\nA wealth of ideas and information about how to add licensing to your own add-in is shared by Julian, Luiz Henrique [@ricaun](https://ricaun.com/) Cassettari, Barry Newcombe and others in the discussion\non [licencing plugins &ndash; what Revit subscriptions have to be considered?](https://forums.autodesk.com/t5/revit-api-forum/licencing-plugins-what-revit-subscriptions-have-to-be-considered/m-p/12766353)\n\n**Question:**\nI have built a server-based licensing mechanism for my plugins.\nIt depends on the Autodesk ID (human unrecognizable) and the username.\nSo, this will only work if a user is logged in with their Autodesk account.\nI´m used to that because I worked with the cloud services for a few years now.\nBut I also remember working in another company where logging in was not necessary and user names could be set manually.\nAnd so I would like to know:\n\n- What different subscriptions do i have to consider?\n- What options do i have to bind users to their licence?\n\nFor users that are not logged in with their Autodesk account I only see the option to bind the licence to the machine (cpu / mainboard) and not to the user himself.\n\n**Answer:**\nI think you must be logged in to your Autodesk Account to use Revit.\nThe last version working without it was 2019 (The last perpetual license).\n\nPersonally, I am using Autodesk AppStore and the entitlement tools provided by Autodesk.\nIt works well &ndash; except:\nTo me it looks that Autodesk breaks EU laws about online marketplaces...\nThere is no way of adding floating licenses for services with subscription fee.\nSo, you can’t give someone 10 licenses and let them manage them.\nAlso, if a user gets a license on PayPal, no one can do anything with it &ndash;\nRight now when my users change their employer, I simply add them a new license to their new email.\n\n**Response:**\nUh, an amazing amount of tools you built there on [W7k](https://w7k.pl/)!\nAnd it´s a nice homepage with descriptions for all the tools.\nHow long have you been working on that?\n\nCan you explain a little how it works when licensing with the appstore?\nDo you have to setup anything in the code to make it work? I assume the payment management will all be done by autodesk? I understand the problem with floating licenses and isn´t it also the case that monthly payment is not possible?\n\nI more and more like the idea of using the Autodesk ID for my purposes. The problem is in some companies the users don´t have Autodesk accounts, the Autodesk Licence works differently there. But I think that in general most Revit users have an Autodesk account and if not they should create one.\nI can check the active licenses for my plugins only once a month or even once a year, so the users are not forced to log in every day. I think this solution would be user-friendly enough.\n\nThe only way to bypass my licensing system would be to just create a new Autodesk account every month to start a new 30 day trial. I could additionally create a machine identifier from the cpu/mainboard ids to check if someone is using 30 day trials repeatedly...\n\nI can also implement floating licenses. Only disadvantage with my self-built solution is that I also have to manage payment manually myself.\n\n**Answer:**\nThe response is long, so I decided to split it by topics:\n\nMy tools:\nThanks. It is my way of making the AEC industry slightly less stupid. Or at least less confident about wasting peoples time\nIt is hard to say. It started as my side project (plus a way of learning c#) and then I decided to make a product out of it. I started Drafter a year ago but was not working constantly on it. I am working on my plugins when I don’t have anything to do in my freelancing schedule or I need something to work faster &ndash; so it’s hard to say how much time it took. Plus, right now, I am in the process of publishing the third one\nProbably making documentation and all the icons was the worst So I am super happy that you like it!\n\n- Autodesk AppStore Code in the AEC DevBlog article on\nthe [Entitlement API for Revit Exchange Store Apps](https://adndevblog.typepad.com/aec/2015/04/entitlement-api-for-revit-exchange-store-apps.html)\n\nIn a nutshell, it is connecting with Autodesk App Store and gives you back information about a licence from there. On top of that, I decided that my tools create a local licence file (Documents folder &ndash; not a tool folder as it messes up uninstaller). So, each time you run the tool, it can check the licence without having to connect to the server. I would share the code, but first it needs some refactoring.\n\nNamed users:\nI believe that nowadays you can’t use Revit without named users, but I might be wrong about it.\nLooking for an Autodesk licence? We’re retiring licences based on serial numbers and assigning each subscription to a named user. These new plans provide a range of capabilities for organizations of every size.\nMaintenance plans will retire on May 7, 2021 and multi-user subscriptions will retire on August 7, 2022. If you are still on a maintenance plan or multi-user subscription, choose a trade-in offer.\nFrom [Autodesk licensing options](https://www.autodesk.com/ca-en/licensing/overview).\n\nCreating New Autodesk Account:\nI was thinking about it too. In the end I decided to make my tools as good as possible for someone who bought them &ndash; I can imagine situation when someone is leaving the office and new person must use their old computer.\nIt is dot net, dll and it heavily uses API, so there are the worst things people can do to them pretty easily . Frankly speaking, I am making some videos this weekend where I will show how to code some of my scripts.\nThat’s why I added 30-day trial &ndash; it gives me time to assign proper licences to the people working in the offices which bought the tools from me. I see some free riders who use them without buying them on some weird emails ($14 seriously ) but previously they were wasting my time asking for free licences to be able to show the tool in their offices &ndash; coincidentally they always want only a one licence just for them.\n\nAutodesk App Store Payment:\nSadly, this is where the things become problematic. (it is not a legal advice but as I see it) Autodesk App Store allows us to make payments via PayPal, but it is a very old way of making payments. So, let’s start with some tax information:\nYou are in Europe, so there are two ways of adding VAT:\nTo companies &ndash; inverted 0% &ndash; you need their VAT ID, and they need to pay VAT in their own country later &ndash; great as it is neutral for them,\nTo customers &ndash; according to your local regulations (23% in Poland) up to some amount and above there is EU system to pay it in each separate country according to its regulations.\nSimilar situation is if you sell outside of EU, but it becomes more problematic as you need to check the situation in each country.\nSo, why I said that Autodesk probably breaks the laws here? As an online market they should collect all this information for you and help with adding a correct VAT & Sales tax &ndash; In some countries they can be even the ones who should pay it in your name.\nSadly, right now, the only thing I get after transaction is PayPal account name + email address of PayPal account + Revit email address. So, I am sending an email asking about other information which is a stupid waste of time.\n\nI already raised some of the issues with the Autodesk AppStore Team in January and got some promising info:\n\n> Thank you for reaching out to us.\nSince the Drafter app is subscription based, and for the subscription based apps Users will have to log in to store with their respective account and subscribe to get entitled to use the app, the autorenewal happen for the same account for every renewal period along with the entitlement.\nThus, multi-purchase option for the subscription-based apps is not available.\nYes, you can assign (entitle) each account from the backend itself.\nThank you for your help and explanations! It really clarifies it for me so I can tell client what to do!\nIt would be great to have an option to allow buyers to manage their subscriptions &ndash; Is there a place I could raise the idea of this improvement?\nThank you for the acknowledging.\nAnd yes, we agree with you to have the option of multi-purchase of subscription based app.\nOur engineering team is aware of this, but as the entitlement API is directly dependent with the PayPal subscription, thus it was good to keep it so.\nHowever, this improvement request will be considered and possibly be implemented in the near future or next store update, as we have received lot of such requests.\n\n**Response:**\nThank you for sharing this insight into your work.\nI think I will then use the Autodesk Appstore just for publishing but not for licencing.\nI´ll also share some code snippets here and for sure will report about my experiences as soon my system is ready.\n\n**Answer 2:**\nThe last Autodesk DevCon included some conversations about improving the Autodesk App Store, and the [APS roadmap](https://aps.autodesk.com/aps-roadmap) includes items about the App Store.\n\nAbout the licensing, I created my entitlement API using the Autodesk UserId to identify the user connected inside Revit; without an account connected, the plugin does not work.\n\nI have some plugins in the App Store with Trial or Free, and the payment is done outside the Autodesk App Store on my website using a platform that manages taxes depending on the region where the user is buying the license.\n\nIs kinda simple to recreate a simple API using the Entitlement API as a reference to validate your plugin/user.\n\n<pre><code class=\"language-cs\">public class EntitlementResponse\n{\n  public string UserId { get; set; }\n  public string AppId { get; set; }\n  public bool IsValid { get; set; }\n  public string Message { get; set; }\n}\n</code></pre>\n\nHere is a simple sample command and\nthe [AppEntitlement class to work with Autodesk AppStore: Entitlement API](https://gist.github.com/ricaun/e86e63c42bd1a5add1f8d08d6fa84aff).\n\n**Response:**\nSo, from you experience you would say users are comfortable with the Autodesk ID check on every Revit startup? Because then I would just do the same and skip implementing an additional mechanism with a local file and just tell the users being logged in is necessary.\nIf someone has the patience and would like to explain, I still don´t get how the appstore works.\nHow is it possible that you use the appstore licencing mechanism with an external payment service?\nHow does the appstore know if a user has paid and has an active license?\n\n**Answer:**\nYes, by default you need to have an account connected to use Revit.\nThe plugin checks if the user is connected, and, if that is the case, checks online to validate the license and create a temp file to enable work offline for some time.\n\nI don't use the default Autodesk App Store licensing mechanism, because is not flexible.\nI kinda don't need to have the plugins in App Store, all the payments and licenses are managed by my API system.\n\n**Response:**\nThank you for the explanation!\nI now found out how the Autodesk licensing is called that even made me start this thread: Flexnet license.\nI have worked in a company with 100 Revit users where logging in to an Autodesk account was not necessary.\nBut if you had no connection to the company server you got this message:\n\n<center>\n<img src=\"img/flexnet_license_1.png\" alt=\"Flexnet license\" title=\"Flexnet license\" width=\"300\"/> <!-- Pixel Height: 430 Pixel Width: 496 -->\n</center>\n\n**Answer:**\nI wonder what Revit version of the flexnet license works without a user connected, I suppose the newer Revit version you need to have an account.\nWithout an Autodesk account connected most of the plugins in the Autodesk App Store just not gonna work.\n\n **Answer 2:**\nI was thinking about making my own page with selling options, but right now being seen on the market is probably the biggest source of costumers for me. Especially after recently Drafter got marked as one of the most popular paid apps for Revit. It also helps customers trust me as they are downloading the product from Autodesk App Store. So I see plenty of benefits of being here\nStill, I will probably end up with a cheaper version on my webpage which will collects correct info as per your page and more expensive on an Autodesk App Store. So far I prefer to spend my free time coding something cool 😉\n\nHow the Autodesk app store works (if you use entitlement class provided by Autodesk and their system)\n\n- You submit the app &ndash; after revision by Autodesk, the app is being published on the market.\n- Someone wants to buy your app:\n    - On PayPal &ndash; the process is automated with problems mentioned above. Customers are redirected to PayPal, pay there, and then the system brings them back to the page informing the Autodesk App Store about the successful transaction.\n    - You have a possibility to simply add new users:\n    this is how it looks for my Drafter. Autodesk doesn't care why you are adding these and what are you doing with them &ndash; You can add or delete them however you like (they are marked below as Published Added):\n\n<center>\n<img src=\"img/autodesk_appstore.jpg\" alt=\"Autodesk AppStore\" title=\"Autodesk AppStore\" width=\"600\"/> <!-- Pixel Height: 579 Pixel Width: 1,000 -->\n</center>\n\nSo far I hit 2 problems with it.\n\n- People need to log into the market.\n- They need to agree to the market rules &ndash; to do it they need to download something, really.\nIt is another reason why I made trial for Drafter &ndash; before I had to tell people to download randomly something free.\n- Only after that, you will be able to add them a licence.\n- After that, they will be able to download your app and install it.\n- While starting the app, the correctly implemented entitlement class will try to connect with market server with `userId` and `AppId`. In return, you will get an error, true or false &ndash; it is up to you what you want to do with it or how you're going to manage problems. Personally, after checking, I am creating a hashed licence file with result.  Depending on result, I am freezing and blocking the possibility of using my tools. Also, each command will double-check the licence from my files. That is more or less what's going on there.\n- Users can normally use the app. If they log out, they will be logged out by Autodesk and Revit will stop working.\n- Each time they start Revit, the process will repeat from point 5. You can implement some code to stay offline, so you don't have to check online every time, as it makes Revit start slowly.\n\n**Answer 3:**\nIn your case, it does not make sense to add an option to your website, and yes adding the plugin to the App Store is a great way to get exposure, I have some plugins in there as well.\n\nThat image with an option to Add Download Entitlement is new, never saw any tutorial with that image about the Entitlement API.\n\nIf you use PayPal as a payment and use Entitlement API with the @Julian.Wandzilak examination, this is the way.\n\n**Answer from AppStore:**\nThank you for sharing your concerns. Yes, we are aware of the issues and concerns over Taxation. Our App Store Engineering team is working on these things and will share the details once available.\nCould you please try to implement IPN mechanism for your apps to get more information on the users? Please go through following links:\n\n- [Autodesk App Store: IPN notification format](https://damassets.autodesk.net/content/dam/autodesk/www/adn/pdf/instant-payment-notification-ipn-format.pdf)\n- [GitHub source code for Exchange-IPNListener-Sample](https://github.com/ADN-DevTech/Exchange-IPNListener-Sample)\n\nPlease feel free to contact us via [appsubmissions@autodesk.com](appsubmissions@autodesk.com) for any queries related to App Store.\n\n**Answer:**\nI can confirm that larger organisations use flexnet licencing always. My discipline is structural engineering and I have worked for a lot of global engineering firms such as URS, AECOM, Jacobs, Arup (1000s of Revit users) and smaller national consultancies (more than 10 users, less than 100) and all have used flexnet licencing. I am developing my own plugins at the moment and see the single sign on licence as a constraint on sales to these bigger organisations who use flexnet. Plus I have worked in secure industries where security and internet access can be limited, again if you need to check your licence every time you log in this would cause issues. Another concern I have with trying to sell to the bigger organisations is that many of them cant purchase software for such a small value as £10 , I found out trying to purchase software from the app store through a global organisation two things:\n\n- They often have a minimum purchase order value, i.e., they cant write a cheque or make a payment for less than £200\nand so a local manager was going to purchase the app on his credit card and claim the money back.\n- When the IT dept looked at the App and it didnt have a valid signed security certificate (you know the message that pops up about your app and says 'the publisher of this add in could not be verified') they would not sanction its use on company systems and we could not purchase the app.\n\nFrom this I have come to the following strategy:\n\n- Sell a single sign-on version of the app for a reasonable price on the app store, say £40, licence controlled by the app store REST call.\n- Sell a multi-seat version of the app, say 8 seats for £250 on the app store, for big organisations, This app has no security or licence control and licence control is based on the 'trust system' of these large organisations who often employ dedicated software to manage their licences deployed.\n\nI went through the process of getting a certiport digital security certificate to sign my app DLL with so as to be able to sell to larger organisations. Once signed, the message only pops up once at the start, if the plug in is signed.\n\nThese organisations do use certain plug in such as rushforth tools, who sell an enterprise version on their own website, so a licencing system for flexnet can be implemented; there are pre-purchased licencing software solutions I have seen which can be purchased off the shelf to do this like QLM (quick licence manager) by soraco, but obviously have a cost associated with them.\n\n**Response:**\nAutodesk is planning to add some [Multi-user license](https://portal.productboard.com/autodeskforge/20-autodesk-platform-services-roadmap/c/202-multi-user-license-management).\nThe question is if using flexnet licencing in a modern Revit is possible to run without a user connected. I don't think that is possible.\nToday I only have a single user license in my plugins, I can swap to another user manually. A floating license is a thing that I am planning to create, would be really handy to enable a floating license to all the users with the same domain email.\n\n**Answer:**\nHere are snapshots of the flexnet licence; notice there is no user signed in to Autodesk and Revit fully runs, the bottom right photograph is when you have not connected to the server that is hosting the flexnet licence.\n\n<center>\n<img src=\"img/flexnet_license_2.jpg\" alt=\"Flexnet license\" title=\"Flexnet license\" width=\"496\"/> <!-- Pixel Height: 430 Pixel Width: 496 -->\n</center>\n\nI think the idea of using the domain is the right way to go I think Rushforth tools use this approach. The below text is from the licencing section of Rushforth website, see enterprise licences at the bottom.\n\nSummary:\n\n- For individual licenses, install and click the activation button to complete an individual activation request. Check your spam folder or send a follow up email if your registration key is not sent within 24 hours of sending your activation request email.\n- For Site licenses, all users can input the same key or that process can be automated by deploying a Windows registry key.\n\nInstallation:\n\n- The .exe installer is a per-user installer and does not require any admin install privileges. Don't \"Run as Admin\" or it may not appear on the current user's profile.\n- The .msi installer is a per-machine installer and will require admin install privileges.\n- Both installers have a -quiet switch for silent installation by deployment software.\n\nSingle-User Licenses:\n\n- Purchase\n    - Purchase the quantity of licenses needed for your team.\n    - All licenses purchased are attributed to the company email domain name (unless using a personal email).\n    - Each single user license authorizes you to register two computers for the same user. A unique registration code must be requested from each computer. A separate license should be purchased for each user that will use the tools.\n- Notify Users\n    - You can immediately notify users that they can install and activate the software.\n    - Each user license request will be counted toward the total number purchased for the company on a first come, first served basis. If you would like to submit a list of authorized users via email to control who can request activations, that can be accommodated as well.\n- Click Activate\n    - Your user(s) can immediately install the tools and click the Licensing/Activation button on the RF Tools ribbon in Revit to generate and send in an individual activation request code via email to get back a machine-specific registration key. As long as the user email address domain matches the purchasing company email address domain, the activation will be attributed to the purchase.\n\nEnterprise Site License:\n\n- Install the tools on an unlimited number of computers on a network. A single network license key code can be used to activate any number of computers in any number of offices around the world that share a common network domain name. This license code can be deployed as a windows registry key to all users as well. Site license also includes authorization to request individual activation codes for up to 20 non-network connected computers such as personal laptops or home computers. Previously purchased single-user licenses can be applied toward the purchase of an Enterprise Site License of the same version.\n- To receive the Network License Key: Have one of your users click the 'Licensing/Activation' button on the RF Tools tab in Revit (after they have installed the tools). Click the Enterprise Site License button to request your Network License Key. This will prepare an email with the name of the domain to be registered. Once verified, you will receive a reply with a license key that will work for all computers connected to the same domain name.\n\nMany thanks to all of you for sharing this."
  }
][
  {
    "original_filename": "2045_dll_paradise",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- The difference between Length and ApproximateLength in Curve class\n  https://forums.autodesk.com/t5/revit-api-forum/the-difference-between-length-and-approximatelength-in-curve/m-p/12841543/\n\ntwitter:\n\nClarification on the arc Length versus ApproximateLength properties provided by curve elements and the new RevitLookup add-in dependencies isolation solves @AutodeskRevit #RevitAPI add-in DLL hell #BIM @DynamoBIM https://autode.sk/end_dll_hell\n\nNew RevitLookup solves Revit add-in DLL hell, and a clarification on the arc length properties provided by curve elements\n&ndash; Curve Length versus ApproximateLength\n&ndash; RevitLookup dependency isolation ends DLL hell\n&ndash; Add-in dependencies isolation...\n\nlinkedin:\n\nClarification on the arc Length versus ApproximateLength properties provided by curve elements and the new RevitLookup add-in dependencies isolation solves #RevitAPI add-in DLL hell\n\nhttps://autode.sk/end_dll_hell\n\n- Curve Length versus ApproximateLength\n- RevitLookup dependency isolation ends DLL hell\n- Add-in dependencies isolation...\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2045_dll_paradise",
    "header_text": "Length Query and RevitLookup Heralds DLL Paradise",
    "local_header_href": "#length-query-and-revitlookup-heralds-dll-paradise",
    "chunk_text": "### Length Query and RevitLookup Heralds DLL Paradise\n\nExciting new RevitLookup release solves Revit add-in DLL hell, and a clarification on the arc length properties provided by curve elements:\n\n- [Curve Length versus ApproximateLength](#2)\n- [RevitLookup dependency isolation ends DLL hell](#3)\n- [Add-in dependencies isolation](#4)"
  },
  {
    "original_filename": "2045_dll_paradise",
    "header_text": "Curve Length versus ApproximateLength",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Curve Length versus ApproximateLength\n\nLast week, the Revit development team helped to provide a useful clarification\nof [the difference between `Length` and `ApproximateLength` in `Curve` class](https://forums.autodesk.com/t5/revit-api-forum/the-difference-between-length-and-approximatelength-in-curve/m-p/12841543/):\n\n**Question:**\nThe Curve class provides two properties to get the length of a curve, `Length` and `ApproximateLength`.\nWhat is the difference?\n\n**Answer:**\nFor many types of curves, the results will probably be identical.\nDifferences probably only occur for complex curves.\nFor example, there is no closed-form expression for the arc length of an ellipse.\nOne efficient and fruitful way to address this kind of question is to implement a little test suite with benchmarking and try it out for yourself.\n\nThe development team clarify:\n\nSeems pretty well documented in the remarks for the `ApproximateLength` property to me.\nApproximateLength is completely accurate for uniform curves (lines and arcs) but could be off by as much as 2x for non-uniform curves, and so it may be worth checking the curve’s class and deciding which method to call from there, or just using the `Length` property in all cases, if accuracy is a concern.\nI recommend the latter, as the time savings hasn’t shown to be significant in my work.\n\n`ApproximateLength` uses a rough approximation that depends on the curve type.\nThere's no guarantee that the approximation method will be unchanged in future releases.\n\n`Length` performs a line integral to compute the curve length, which can be considered exact for all practical purposes.\nLines and arcs have closed-form expressions for their lengths that are used instead.\nI agree that a user is unlikely to see a noticeable performance difference between the two methods.\nThe performance differences are mostly relevant for internal usage, e.g., in graphics functionality.\n\n<center>\n<img src=\"img/arc_length.png\" alt=\"Arc length\" title=\"Arc length\" width=\"300\"/>\n</center>"
  },
  {
    "original_filename": "2045_dll_paradise",
    "header_text": "RevitLookup Dependency Isolation Ends DLL Hell",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> RevitLookup Dependency Isolation Ends DLL Hell\n\nThe new [RevitLookup release 2025.0.8](https://github.com/jeremytammik/RevitLookup/releases/tag/2025.0.8) runs\nin an isolated container for addin dependencies.\n\nThis new capability prevents conflicts and compatibility issues arising from different library versions between plugins, ensuring a more stable and reliable environment for plugin execution.\n\nThis enhancement uses the `Nice3point.Revit.Toolkit` to manage the isolation process, effectively eliminating DLL conflicts.\nBy integrating this package, RevitLookup ensures a consistent and predictable user experience.\n\nThe detailed description how it works is provided in the release notes\nfor [RevitToolkit release 2025.0.1](https://github.com/Nice3point/RevitToolkit/releases/tag/2025.0.1),\nalso reproduced [below](#4).\n\n<!--\nPlease note that this is unrelated\nto [the recent RevitLookup hotfix 2025.0.1](https://thebuildingcoder.typepad.com/blog/2024/04/revitlookup-hotfix-and-the-revit-2025-sdk.html#2).\n-->\n\nThe dependency isolation is available starting with Revit 2025.\nNote that the isolation mechanism is implemented by an additional library that must be loaded into Revit at first startup for it to work.\nTherefore, if your other plugins use `Nice3point.Revit.Toolkit`, it must be updated to version `2025.0.1`, which introduces this feature.\n\nRevitLookup 2025.0.8 addresses the following issues:\n\n- Dependency conflicts [latest release won't run #210](https://github.com/jeremytammik/RevitLookup/issues/210) and\n  [I get an error #252](https://github.com/jeremytammik/RevitLookup/issues/252)\n- [Request for adding `WorksharingTooltipInfo` properties #254](https://github.com/jeremytammik/RevitLookup/issues/254)\n- A discussion of the `AssemblyLoadContext` used to implement the dependency isolation,\n  [Build Automation Version is breaking Revit 2025 #246](https://github.com/jeremytammik/RevitLookup/issues/246)\n\nAs further improvements, the following type extensions are added\nfor the [`Part` class, associated classes #255](https://github.com/jeremytammik/RevitLookup/pull/255)\nand [`WorksharingUtils` #257](https://github.com/jeremytammik/RevitLookup/pull/257):\n\nPart:\n\n- IsMergedPart: Is the Part the result of a merge.\n- IsPartDerivedFromLink: Is the Part derived from link geometry\n- GetChainLengthToOriginal: Calculates the length of the longest chain of divisions/ merges to reach to an original non-Part element that is the source of the tested part\n- GetMergedParts: Retrieves the element ids of the source elements of a merged part\n- ArePartsValidForDivide: Identifies if provided members are valid for dividing parts\n- FindMergeableClusters: Segregates a set of elements into subsets which are valid for merge\n- ArePartsValidForMerge: Identifies whether Part elements may be merged\n- GetAssociatedPartMaker: Gets associated PartMaker for an element\n- GetSplittingCurves: Identifies the curves that were used to create the part\n- GetSplittingElements: Identifies the elements ( reference planes, levels, grids ) that were used to create the part\n- HasAssociatedParts: Checks if an element has associated parts\n\nPartMaker:\n- GetPartMakerMethodToDivideVolumeFW: Obtains the object allowing access to the divided volume properties of the PartMaker\n\nElement:\n- GetCheckoutStatus: Gets the ownership status of an element\n- GetWorksharingTooltipInfo: Gets worksharing information about an element to display in an in-canvas tooltip\n- GetModelUpdatesStatus: Gets the status of a single element in the central model\n- AreElementsValidForCreateParts: Identifies if the given elements can be used to create parts"
  },
  {
    "original_filename": "2045_dll_paradise",
    "header_text": "Add-In Dependencies Isolation",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Add-In Dependencies Isolation\n\nThe RevitLookup isolated plugin dependency container is built using .NET `AssemblyLoadContext`.\n\nThis feature enables plugins to run in a separate, isolated context, ensuring independent execution and preventing conflicts from incompatible library versions.\n\nThis enhancement is available for Revit 2025 and higher, addressing the limitations of Revit's traditional plugin loading mechanism, which loads plugins by path without native support for isolation.\n\nHow it works:\n\nThe core functionality centres on `AssemblyLoadContext`, which creates an isolated container for each plugin.\n\nWhen a plugin is loaded, it is assigned a unique `AssemblyLoadContext` instance, encapsulating the plugin and its dependencies to prevent interference with other plugins or the main application.\n\nTo use this isolation feature, developers must inherit their classes from:\n\n- ExternalCommand\n- ExternalApplication\n- ExternalDbApplication\n- ExternalCommandAvailability\n\nThese classes contain the built-in isolation mechanism under the hood.\nPlugins using interfaces such as `IExternalCommand` will not benefit from this isolation and will run in the default context.\n\nLimitations:\n\n- The isolated plugin context feature is available starting with Revit 2025.\n- For older Revit versions, this library uses a ResolveHelper to help load dependencies from the plugin's folder, but does not protect against conflicts arising from incompatible packages.\n- Additionally, plugins that do not inherit from the specified classes will not be isolated and may experience compatibility issues if they rely on the default context.\n\nFor further details, please refer to the discussion between ricaun and Nice3point\non [build automation version breaking Revit 2025 #246](https://github.com/jeremytammik/RevitLookup/issues/246)\n\nThey recommend that Autodesk and Revit adopt similar functionality and include it in the basic Revit API add-in handling architecture, so that all add-in dependencies are automatically isolated and DLL hell conflicts never occur.\n\nricaun recorded a nine-minute video\non [RevitLookup - End of DLL hell - Revit API](https://youtu.be/cpy4J_6-8WY) explaining\nand demonstrating exactly how RevitLookup for Revit 2025 can herald the end of DLL hell:\n\n<center>\n<iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/cpy4J_6-8WY?si=05tXP34MEFOGqFGB\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n</center>\n\nMany thanks to both of you for your thorough implementation, testing, discussion and documentation!"
  }
][
  {
    "original_filename": "2046_mat_asset",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"bc.css\">\n<!-- https://highlightjs.org/#usage\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\n<script>hljs.highlightAll();</script>\n-->\n\n<!-- https://prismjs.com -->\n<link href=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css\" rel=\"stylesheet\" />\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>\n</head>\n\n<!---\n\n- jacob.small 'info' on what I think I know about material assets\n  Create a custom Material Asset\n  https://forums.autodesk.com/t5/revit-api-forum/create-a-custom-material-asset/m-p/12700408#M78130\n\n- future of embedded browser functionality\n  Feedback Request &ndash; Upgrade to WebView2\n  We are excited to inform you that Revit has replaced CefSharp with WebView2 to provide a more robust and seamless web browsing experience within the software.\n  Why the change?\n  WebView2 is a web control provided by Microsoft Edge (Chromium) that allows developers to host web content in native applications. It offers better performance, compatibility, and support compared to the previously used CefSharp. This ensures consistent rendering across all Windows devices, improved security, and the ability to use the latest web technologies.\n  What does this mean for you?\n  The transition to WebView2 is designed to be as seamless as possible. However, as with any significant change, there may be minor adjustments. We kindly ask you to test if all the existing features work fine as usual.\n  How can you help?\n  Please spend some time using Revit as you normally would, and pay particular attention to any features that use web content. If you encounter any issues or notice any changes in functionality, we would greatly appreciate your feedback.\n  We thank you in advance for testing this enhancement!\n\n- Twentytwo\n  a place for BIM Programming enthusiasts\n  WRITTEN BY MIN.NAUNG\n  i mentioned\n  TwentyTwo Add-Ins and Tutorials\n  https://thebuildingcoder.typepad.com/blog/2022/10/element-level-and-ifc-properties-.html#2\n  Now they have also started a blog with high quality Revit API articles\n  REVIT API : SCHEDULE CREATION\n  https://twentytwo.space/2021/05/02/revit-api-schedule-creation/\n  REVIT API SERIES\n  https://twentytwo.space/revit-api-series/\n  helped solve recent question\n  on [Sort/Grouping field in schedule]\n  https://forums.autodesk.com/t5/revit-api-forum/sort-grouping-field-in-schedule/m-p/12869665\n\n- ugrep\n  https://ugrep.com\n  https://github.com/Genivia/ugrep\n  ug --filter='pdf:pdftotext % -' -i jeremy *pdf\n  the ug+ command is the same as the ug command, but also uses filters to search PDFs, documents, and image metadata\n  built-in filters ug+ -i jeremy *pdf\n  fuzzy search ug+ -Z -i jeremmy *pdf\n\n- AI just figured out Meshes\n  https://youtu.be/rQolOT4tuUY\n  original paper: MeshAnything: Artist-Created Mesh Generation with Autoregressive Transformers -- https://huggingface.co/papers/2406.10163\n  demo: MeshAnything: Artist-Created Mesh Generation with Autoregressive Transformers -- https://huggingface.co/spaces/Yiwen-ntu/MeshAnything\n  code: GitHub https://github.com/buaacyw/MeshAnything\n  course: Welcome to the 🤗 Machine Learning for 3D Course -- https://huggingface.co/learn/ml-for-3d-course/unit0/introduction\n\n- Claude Sonnet Selfreflects\n  Claude Sonnet 3.5 Passes the AI Mirror Test\n  https://x.com/joshwhiton/status/1806000237728931910\n  claude_sonnet_selfreflect.jpg\n\n- Artificial Intelligence Is Stupid and Causal Reasoning Will Not Fix It\n  https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2020.513474/full\n  Mark Bishop, \"Deep Stupidity: A Provocation on the Things LLMs Can and Cannot Do.\"\n  https://youtu.be/sN-vsd7SVqs\n\n- Researchers upend AI status quo by eliminating matrix multiplication in LLMs\n  https://arstechnica.com/information-technology/2024/06/researchers-upend-ai-status-quo-by-eliminating-matrix-multiplication-in-llms/\n\ntwitter:\n\n @AutodeskRevit #RevitAPI #BIM @DynamoBIM\n\n&ndash; ...\n\nlinkedin:\n\n#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk\n\nthe [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread\n\n<center>\n<img src=\"img/\" alt=\"\" title=\"\" width=\"600\"/>\n<p style=\"font-size: 80%; font-style:italic\"></p>\n</center>\n\n-->"
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "Material Assets",
    "local_header_href": "#material-assets",
    "chunk_text": "### Material Assets\n\nToday, we look at the Revit API to personalise material assets, access the built-in browser functionality, create schedules, search text and miscellaneous LLM-related news items:\n\n- [Personalised material asset properties](#2)\n- [CefSharp versus WebView2 embedded browser](#3)\n- [Twentytwo on schedule creation](#4)\n- [Ugrep enhanced grep](#5)\n- [AI mesh understanding](#6)\n- [LLM self-reflection](#7)\n- [LLM deep stupidity](#8)\n- [LLM AI sans `MatMul`](#9)\n- [Local LLM AI the easy way](#10)"
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "Personalised Material Asset Properties",
    "local_header_href": "#2",
    "chunk_text": "####<a name=\"2\"></a> Personalised Material Asset Properties\n\nJacob Small provided a useful and succinct summary of info to help answer how\nto [create a custom material asset](https://forums.autodesk.com/t5/revit-api-forum/create-a-custom-material-asset/m-p/12700408):\n\n**Question:**\nI would like to know if it is possible to create a personalised material asset with personalised properties that can be displayed in the Material Browser. For example, a material asset called \"Test\" placed after \"Thermal\". And in \"Test\" put a property like \"Address\".\nIf this isn't possible, is it possible to add the \"Address\" property to an asset that already exists, for example \"Identity\"?\nIf so, can we then create a new section in the Identity asset as \"Additional information\"?\n\n**Answer:**\nSome quick 'info' on what I think I know about material assets:\n\nThe only \"asset types\" in the UI are Appearance, Thermal, and Physical. In the API these are called Appearance, Thermal, and Structural (because why would they match?). I'll be using the API names going forward because we're in that forum (perhaps someone curious can ask about the UI stuff in the other forum).\n\nThe Thermal and Structural asset types can be deleted from a material in the UI and set as an invalid Element Id in the API. The Appearance asset cannot.\n\nThe other tabs in the material editor are collections of properties and parameters of the material element itself, not a linked asset - but are masquerading as an asset due to how they are presented in the UI.  For example to get the name (shows in the identity tab) you get the Name property of a material element. To get the foreground surface pattern (shows in the graphics tab) you'd get the SurfaceForegroundPatternId property. To set the Comments in the Identity tab you'd use a Set method on the comment parameter.\n\nThe only thing unavailable is the keywords (noted as missing in 2019 and as far as I know still unavailable).\n\nSo the question becomes, how can you accomplish what you're after?\n\nYou could map a property from the identity tab (URL looks like an option) to an extensible storage object with the data you need; however users won't be able to edit it in the material editor. Personally I would make 'non-UserModifiable' parameters on the materials category, and associate them to the materials in your template, and let them be edited/reviewed via an add-in which would also allow updating the rest of the assets. This add-in could also ensure that materials added via your tool would have these hidden parameters quickly set when materials from your library (a sub-component of your add-in) are added to the model.\n\nIt'd be a big lift but likely one which would benefit many beyond your company.\n\nMany thanks to Jacob for this helpful summary."
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "CefSharp versus WebView2 Embedded Browser",
    "local_header_href": "#3",
    "chunk_text": "####<a name=\"3\"></a> CefSharp versus WebView2 Embedded Browser\n\nRevit currently includes the CefSharp embedded Chromium browser, and many internal and external add-ins make use of that.\nAnother option for Chromium embedding is provided by WebView2, and some add-ins already use that instead.\nThis StackOverflow question provides a comparison\nof [CefSharp vs WebView2](https://stackoverflow.com/questions/70360189/cefsharp-vs-webview2).\nIf you are interested in new developments in this area in the context of Revit API add-in development,\nyou might want to check in to the corresponding discussion currently opened in\nthe [Revit Preview Project](https://feedback.autodesk.com/key/LHMJFVHGJK085G2M)."
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "Twentytwo on Schedule Creation",
    "local_header_href": "#4",
    "chunk_text": "####<a name=\"4\"></a> Twentytwo on Schedule Creation\n\n[Twentytwo](https://twentytwo.space), written by Min Naung, provides a place and resources for BIM Programming enthusiasts.\nQuite a while ago, I already mentioned\nthe [TwentyTwo add-ins and tutorials](https://thebuildingcoder.typepad.com/blog/2022/10/element-level-and-ifc-properties-.html#2).\nThey also write a blog with high quality Revit API articles,\nthe [Revit API series](https://twentytwo.space/revit-api-series/).\n\nOne of them, for instance,\non [schedule creation](https://twentytwo.space/2021/05/02/revit-api-schedule-creation/),\nrecently came in useful and helped solve the question\non [sort/grouping field in schedule](https://forums.autodesk.com/t5/revit-api-forum/sort-grouping-field-in-schedule/m-p/12869665).\n\nMany thanks to Min Naung for their work on writing and sharing this material!"
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "Ugrep Enhanced Grep",
    "local_header_href": "#5",
    "chunk_text": "####<a name=\"5\"></a> Ugrep Enhanced Grep\n\nI use `grep` in my everyday work to search for text in text files.\nWith `ugrep`, this workflow can be easily expanded to cover all kinds of other file formats and directory structures,\ncf. [the ugrep file pattern searcher](https://ugrep.com), with\nits [ugrep GitHub repo](https://github.com/Genivia/ugrep).\n\nFor instance, PDF support can be obtained by specifying a filter like this:\n\n<pre><code class=\"language-sh\">ug --filter='pdf:pdftotext % -' -i searchtext *pdf</code></pre>\n\nThe `ug+` command is the same as the `ug` command plus built-in filters to search PDFs, documents, and image metadata:\n\n<pre><code class=\"language-sh\">ug+ -i searchtext *pdf</code></pre>\n\nFuzzy search is also supported, among tons of other features:\n\n<pre><code class=\"language-sh\">ug+ -Z -i searchtext *pdf</code></pre>"
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "AI Mesh Understanding",
    "local_header_href": "#6",
    "chunk_text": "####<a name=\"6\"></a> AI Mesh Understanding\n\nAI and LLMs can be used with 3D objects, but often have trouble understanding and efficiently handling them.\nThe MeshAnything project aims to generate more effective meshing of 3D objects:\n\n- 44-second video blurb: [AI just figured out Meshes](https://youtu.be/rQolOT4tuUY)\n- Original paper on [MeshAnything: Artist-Created Mesh Generation with Autoregressive Transformers](https://huggingface.co/papers/2406.10163)\n- [MeshAnything demo](https://huggingface.co/spaces/Yiwen-ntu/MeshAnything)\n- [MeshAnything GitHub code repository](https://github.com/buaacyw/MeshAnything)\n- Huggingface [Machine Learning for 3D Course](https://huggingface.co/learn/ml-for-3d-course/unit0/introduction)"
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "LLM Self-Reflection",
    "local_header_href": "#7",
    "chunk_text": "####<a name=\"7\"></a> LLM Self-Reflection\n\n[Josh Whiton](https://x.com/joshwhiton/) performed an experiment on LLM self-reflection showing\nthat [Claude Sonnet 3.5 passes the AI mirror test](https://x.com/joshwhiton/status/1806000237728931910),\nending with an LLM-generated poem on the topic:\n\n<center>\n<img src=\"img/claude_sonnet_selfreflect.jpg\" alt=\"Claude Sonnet Selfreflects\" title=\"Claude Sonnet Selfreflects\" width=\"500\"/>\n</center>"
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "LLM Deep Stupidity",
    "local_header_href": "#8",
    "chunk_text": "####<a name=\"8\"></a> LLM Deep Stupidity\n\nOn the other hand, Mark Bishop shares a critical article stating\nthat [artificial intelligence is stupid and causal reasoning will not fix it](https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2020.513474/full),\nalso presented as a 90-minute video\non [deep stupidity, a provocation on the things LLMs can and cannot do](https://youtu.be/sN-vsd7SVqs)."
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "LLM AI Sans MatMul",
    "local_header_href": "#9",
    "chunk_text": "####<a name=\"9\"></a> LLM AI Sans MatMul\n\nThis new research may affect both the enormous resources consumed by AI and the chip maker stock prices:\n[Researchers upend AI status quo by eliminating matrix multiplication in LLMs](https://arstechnica.com/information-technology/2024/06/researchers-upend-ai-status-quo-by-eliminating-matrix-multiplication-in-llms/)."
  },
  {
    "original_filename": "2046_mat_asset",
    "header_text": "Local LLM AI the Easy Way",
    "local_header_href": "#10",
    "chunk_text": "####<a name=\"10\"></a> Local LLM AI the Easy Way\n\nFor experimentation and learning,\nthe [CodeProject.AI Server provides AI the easy way](https://www.codeproject.com/Articles/5322557/CodeProject-AI-Server-AI-the-easy-way):\n\n> CodeProject.AI Server is a locally installed, self-hosted, fast, free and open-source AI server for any platform, any language.\nNo off-device or out of network data transfer, no messing around with dependencies, and able to be used from any platform, any language.\nRuns as a Windows Service or a Docker container."
  }
]