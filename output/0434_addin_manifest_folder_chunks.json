[
  {
    "original_filename": "0434_addin_manifest_folder",
    "header_text": "Introduction",
    "local_header_href": "#introduction",
    "chunk_text": "<head>\n<link href=\"bc.css\" rel=\"stylesheet\" type=\"text/css\"/>\n</head>"
  },
  {
    "original_filename": "0434_addin_manifest_folder",
    "header_text": "Network Access to Add-In Manifest and Icons",
    "local_header_href": "#network-access-to-add-in-manifest-and-icons",
    "chunk_text": "<h3>Network Access to Add-In Manifest and Icons</h3><p>We already discussed quite a few aspects of the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/addin-manifest-and-guidize.html\">\nadd-in manifest files</a>, \n\nincluding:\n\n<!--\n331_revit_2011_guids.htm\n336_addinutility.htm\n354_guidizer.htm\n360_p2c.htm\n369_addinutility_32_64_bit.htm\n373_addin_visibility_mode.htm\n378_multi_flavour_apps.htm\n390_client_versus_addin_id.htm\n-->\n<ul>\n<li>A simple example of creating one for my first Revit 2011 plug-in, the \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/05/pipe-to-conduit-converter.html\">\npipe to conduit converter</a>.\n\n<li>The <a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/revitaddinutility.html\">\nRevitAddInUtility</a> which \n\ncan be used to read and write add-in manifest files.\n\n<li>My <a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/addin-manifest-and-guidize.html\">\nGuidize utility</a> which\n\ncan populate the add-in manifest ClientId GUID.\n\n<li>A <a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/addin-manifest-and-guidize.html\">\nGuidize update</a> which \n\nalso handles the AddInId tag.\n\n<li>The <a href=\"http://thebuildingcoder.typepad.com/blog/2010/05/addin-visibility-mode.html\">\nvisibility mode</a> which \n\ncontrols which in which Revit editor contexts an external command add-in appears.\n\n<li>How to handle <a href=\"http://thebuildingcoder.typepad.com/blog/2010/06/addin-applications-for-multiple-revit-products.html\">\nexternal applications for multiple flavours</a> of Revit.\n\n</li></li></li></li></li></li></ul>\n<p>Here is a new question on the location of the add-in manifest files:\n\n<p><strong>Question:</strong> Is there a way to make Revit look for add-in manifest files in any other locations than the All Users and current user's AppData folders? \nI have a client that would like to place them on a server rather than distribute them across many machines.\n\n<p><strong>Answer:</strong> As you say, add-in manifest files are automatically picked up and processed by Revit simply by placing them in \n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2010/04/addin-manifest-and-guidize.html#1\">\nspecific folders</a> in\n\nthe local file system.\nPlacing these files elsewhere on a network may be difficult due to .NET permissions and security issues.\nHere are some considerations which may apply:\n \n<span style=\"color:darkblue\">\n<p>Due to inherent security settings in the Microsoft .NET Framework, .NET applications cannot access registry settings or the file system without permission when applications (.dlls) are loaded from a network location.  \nTo grant permission to run such applications from a network (to simplify distribution/update of .dll files), .NET Framework policies must be set on the users' machines.  \nThe following statements (1) enable such permissions, (2) list the permissions to verify the setting, and (3) remove the permissions.  Refer to Microsoft .NET Framework documentation for further information:\n \n<ol>\n<li>C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\caspol.exe -addgroup 1.2 -url \\\\someserver\\someshare\\somefolder\\* FullTrust\n<li>C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\caspol.exe -listgroups\n<li>C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\caspol.exe -remgroup 1.2.3\n</li></li></li></ol>\n</p></span>\n<p>Revit itself does not provide any option in Revit to modify the add-in manifest location. \nYou don't mention which OS the customer is using, but I would expect that the most likely route for a solution would be some sort of network drive mapping or file copying approach to copy/link the files from the server to the standard location on each machine.\n\n<p>Here is another issue concerning ribbon image resources that may have a related cause, which also includes a pointer to more up-to-date information on the .NET framework security settings:\n\n<h4>Loading Ribbon Images from a Network Drive</h4>\n<p><strong>Question:</strong> Is the creation of a ribbon panel with some UI widgets on it by an external application stored on a network drive possible?\nWe would like to also store the associated DLLs and icon images on the network.\nThat would make the application easier to maintain and update.\nEven though all the necessary permissions have been set, as far as we can tell, Revit throws a SecurityException when we try to load the application.\nWe have confirmed that the permissions to the folder and files are open to everyone.\nThe same application works fine when it is all installed on the local hard drive.\n\n<p>Is there a limitation when using network shares? \n\n<p>It seems the error is associated with making the .PNG file into a bitmap for the ribbon panel. \nEven with this error being raised the rest of the code still works as expected, one just does not have the icon in the ribbon panel.\nIs there a way to easily deploy this application companywide?\n\n<p><strong>Answer:</strong> I suspect this is not a Revit issue, but rather related to the .NET framework, similarly to above. \nLikely a .NET Framework security policy issue not related to user/file/folder read/write access settings.\nWhen trying to load an AutoCAD.NET application from a network drive, I ran into a similar issue and found that the .NET framework considerations listed above were causing it.\n\n<p>Here is some more recent information on the\n\n<a href=\"http://brandonpotter.wordpress.com/2010/01/23/code-access-security-policy-caspol-exe-gui-utility\">\ncode access security policy (caspol.exe) GUI utility</a>,\n\nwhich includes the following note on when one might need to modify the policy: 'I want to run some .NET apps off a network share, and the machine I'm using doesn't have .NET 3.5 SP1.'\n\n<p>From that statement, one might possibly also infer that a simple upgrade of the .NET framework may help?\n</p></p></p></p></p></p></p></p></p></p></p></p>"
  },
  {
    "original_filename": "0434_addin_manifest_folder",
    "header_text": "Loading Ribbon Images from a Network Drive",
    "local_header_href": "#loading-ribbon-images-from-a-network-drive",
    "chunk_text": "<h4>Loading Ribbon Images from a Network Drive</h4><p><strong>Question:</strong> Is the creation of a ribbon panel with some UI widgets on it by an external application stored on a network drive possible?\nWe would like to also store the associated DLLs and icon images on the network.\nThat would make the application easier to maintain and update.\nEven though all the necessary permissions have been set, as far as we can tell, Revit throws a SecurityException when we try to load the application.\nWe have confirmed that the permissions to the folder and files are open to everyone.\nThe same application works fine when it is all installed on the local hard drive.\n\n<p>Is there a limitation when using network shares? \n\n<p>It seems the error is associated with making the .PNG file into a bitmap for the ribbon panel. \nEven with this error being raised the rest of the code still works as expected, one just does not have the icon in the ribbon panel.\nIs there a way to easily deploy this application companywide?\n\n<p><strong>Answer:</strong> I suspect this is not a Revit issue, but rather related to the .NET framework, similarly to above. \nLikely a .NET Framework security policy issue not related to user/file/folder read/write access settings.\nWhen trying to load an AutoCAD.NET application from a network drive, I ran into a similar issue and found that the .NET framework considerations listed above were causing it.\n\n<p>Here is some more recent information on the\n\n<a href=\"http://brandonpotter.wordpress.com/2010/01/23/code-access-security-policy-caspol-exe-gui-utility\">\ncode access security policy (caspol.exe) GUI utility</a>,\n\nwhich includes the following note on when one might need to modify the policy: 'I want to run some .NET apps off a network share, and the machine I'm using doesn't have .NET 3.5 SP1.'\n\n<p>From that statement, one might possibly also infer that a simple upgrade of the .NET framework may help?\n</p></p></p></p></p></p>"
  }
]